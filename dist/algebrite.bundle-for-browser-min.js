"use strict";(()=>{var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var To=A((UU,Mu)=>{var Gt=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,o=T(n),i="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function u(f,m,b,q){return typeof f>"u"?u[0]:typeof m<"u"?+m==10&&!b?qe(f):jE(f,m,b,q):qe(f)}function c(f,m){this.value=f,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function d(f){this.value=f,this.sign=f<0,this.isSmall=!0}d.prototype=Object.create(u.prototype);function _(f){this.value=f}_.prototype=Object.create(u.prototype);function R(f){return-n<f&&f<n}function T(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function k(f){V(f);var m=f.length;if(m<4&&Vn(f,o)<0)switch(m){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function V(f){for(var m=f.length;f[--m]===0;);f.length=m+1}function z(f){for(var m=new Array(f),b=-1;++b<f;)m[b]=0;return m}function Ae(f){return f>0?Math.floor(f):Math.ceil(f)}function et(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for($=0;$<q;$++)L=f[$]+m[$]+x,x=L>=P?1:0,O[$]=L-x*P;for(;$<b;)L=f[$]+x,x=L===P?1:0,O[$++]=L-x*P;return x>0&&O.push(x),O}function Ve(f,m){return f.length>=m.length?et(f,m):et(m,f)}function De(f,m){var b=f.length,q=new Array(b),O=t,x,P;for(P=0;P<b;P++)x=f[P]-O+m,m=Math.floor(x/O),q[P]=x-m*O,m+=1;for(;m>0;)q[P++]=m%O,m=Math.floor(m/O);return q}c.prototype.add=function(f){var m=qe(f);if(this.sign!==m.sign)return this.subtract(m.negate());var b=this.value,q=m.value;return m.isSmall?new c(De(b,Math.abs(q)),this.sign):new c(Ve(b,q),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.subtract(m.negate());var q=m.value;if(m.isSmall){if(R(b+q))return new d(b+q);q=T(Math.abs(q))}return new c(De(q,Math.abs(b)),b<0)},d.prototype.plus=d.prototype.add,_.prototype.add=function(f){return new _(this.value+qe(f).value)},_.prototype.plus=_.prototype.add;function it(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for(L=0;L<q;L++)$=f[L]-x-m[L],$<0?($+=P,x=1):x=0,O[L]=$;for(L=q;L<b;L++){if($=f[L]-x,$<0)$+=P;else{O[L++]=$;break}O[L]=$}for(;L<b;L++)O[L]=f[L];return V(O),O}function Oe(f,m,b){var q;return Vn(f,m)>=0?q=it(f,m):(q=it(m,f),b=!b),q=k(q),typeof q=="number"?(b&&(q=-q),new d(q)):new c(q,b)}function st(f,m,b){var q=f.length,O=new Array(q),x=-m,P=t,L,$;for(L=0;L<q;L++)$=f[L]+x,x=Math.floor($/P),$%=P,O[L]=$<0?$+P:$;return O=k(O),typeof O=="number"?(b&&(O=-O),new d(O)):new c(O,b)}c.prototype.subtract=function(f){var m=qe(f);if(this.sign!==m.sign)return this.add(m.negate());var b=this.value,q=m.value;return m.isSmall?st(b,Math.abs(q),this.sign):Oe(b,q,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.add(m.negate());var q=m.value;return m.isSmall?new d(b-q):st(q,Math.abs(b),b>=0)},d.prototype.minus=d.prototype.subtract,_.prototype.subtract=function(f){return new _(this.value-qe(f).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var f=this.sign,m=new d(-this.value);return m.sign=!f,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function or(f,m){var b=f.length,q=m.length,O=b+q,x=z(O),P=t,L,$,xe,Ge,Me;for(xe=0;xe<b;++xe){Ge=f[xe];for(var rt=0;rt<q;++rt)Me=m[rt],L=Ge*Me+x[xe+rt],$=Math.floor(L/P),x[xe+rt]=L-$*P,x[xe+rt+1]+=$}return V(x),x}function Bt(f,m){var b=f.length,q=new Array(b),O=t,x=0,P,L;for(L=0;L<b;L++)P=f[L]*m+x,x=Math.floor(P/O),q[L]=P-x*O;for(;x>0;)q[L++]=x%O,x=Math.floor(x/O);return q}function vr(f,m){for(var b=[];m-- >0;)b.push(0);return b.concat(f)}function Nt(f,m){var b=Math.max(f.length,m.length);if(b<=30)return or(f,m);b=Math.ceil(b/2);var q=f.slice(b),O=f.slice(0,b),x=m.slice(b),P=m.slice(0,b),L=Nt(O,P),$=Nt(q,x),xe=Nt(Ve(O,q),Ve(P,x)),Ge=Ve(Ve(L,vr(it(it(xe,L),$),b)),vr($,2*b));return V(Ge),Ge}function ci(f,m){return-.012*f-.012*m+15e-6*f*m>0}c.prototype.multiply=function(f){var m=qe(f),b=this.value,q=m.value,O=this.sign!==m.sign,x;if(m.isSmall){if(q===0)return u[0];if(q===1)return this;if(q===-1)return this.negate();if(x=Math.abs(q),x<t)return new c(Bt(b,x),O);q=T(x)}return ci(b.length,q.length)?new c(Nt(b,q),O):new c(or(b,q),O)},c.prototype.times=c.prototype.multiply;function Yn(f,m,b){return f<t?new c(Bt(m,f),b):new c(or(m,T(f)),b)}d.prototype._multiplyBySmall=function(f){return R(f.value*this.value)?new d(f.value*this.value):Yn(Math.abs(f.value),T(Math.abs(this.value)),this.sign!==f.sign)},c.prototype._multiplyBySmall=function(f){return f.value===0?u[0]:f.value===1?this:f.value===-1?this.negate():Yn(Math.abs(f.value),this.value,this.sign!==f.sign)},d.prototype.multiply=function(f){return qe(f)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,_.prototype.multiply=function(f){return new _(this.value*qe(f).value)},_.prototype.times=_.prototype.multiply;function el(f){var m=f.length,b=z(m+m),q=t,O,x,P,L,$;for(P=0;P<m;P++){L=f[P],x=0-L*L;for(var xe=P;xe<m;xe++)$=f[xe],O=2*(L*$)+b[P+xe]+x,x=Math.floor(O/q),b[P+xe]=O-x*q;b[P+m]=x}return V(b),b}c.prototype.square=function(){return new c(el(this.value),!1)},d.prototype.square=function(){var f=this.value*this.value;return R(f)?new d(f):new c(el(T(Math.abs(this.value))),!1)},_.prototype.square=function(f){return new _(this.value*this.value)};function xu(f,m){var b=f.length,q=m.length,O=t,x=z(m.length),P=m[q-1],L=Math.ceil(O/(2*P)),$=Bt(f,L),xe=Bt(m,L),Ge,Me,rt,wr,hr,If,Sf;for($.length<=b&&$.push(0),xe.push(0),P=xe[q-1],Me=b-q;Me>=0;Me--){for(Ge=O-1,$[Me+q]!==P&&(Ge=Math.floor(($[Me+q]*O+$[Me+q-1])/P)),rt=0,wr=0,If=xe.length,hr=0;hr<If;hr++)rt+=Ge*xe[hr],Sf=Math.floor(rt/O),wr+=$[Me+hr]-(rt-Sf*O),rt=Sf,wr<0?($[Me+hr]=wr+O,wr=-1):($[Me+hr]=wr,wr=0);for(;wr!==0;){for(Ge-=1,rt=0,hr=0;hr<If;hr++)rt+=$[Me+hr]-O+xe[hr],rt<0?($[Me+hr]=rt+O,rt=0):($[Me+hr]=rt,rt=1);wr+=rt}x[Me]=Ge}return $=tl($,L)[0],[k(x),k($)]}function pu(f,m){for(var b=f.length,q=m.length,O=[],x=[],P=t,L,$,xe,Ge,Me;b;){if(x.unshift(f[--b]),V(x),Vn(x,m)<0){O.push(0);continue}$=x.length,xe=x[$-1]*P+x[$-2],Ge=m[q-1]*P+m[q-2],$>q&&(xe=(xe+1)*P),L=Math.ceil(xe/Ge);do{if(Me=Bt(m,L),Vn(Me,x)<=0)break;L--}while(L);O.push(L),x=it(x,Me)}return O.reverse(),[k(O),k(x)]}function tl(f,m){var b=f.length,q=z(b),O=t,x,P,L,$;for(L=0,x=b-1;x>=0;--x)$=L*O+f[x],P=Ae($/m),L=$-P*m,q[x]=P|0;return[q,L|0]}function rn(f,m){var b,q=qe(m);if(s)return[new _(f.value/q.value),new _(f.value%q.value)];var O=f.value,x=q.value,P;if(x===0)throw new Error("Cannot divide by zero");if(f.isSmall)return q.isSmall?[new d(Ae(O/x)),new d(O%x)]:[u[0],f];if(q.isSmall){if(x===1)return[f,u[0]];if(x==-1)return[f.negate(),u[0]];var L=Math.abs(x);if(L<t){b=tl(O,L),P=k(b[0]);var $=b[1];return f.sign&&($=-$),typeof P=="number"?(f.sign!==q.sign&&(P=-P),[new d(P),new d($)]):[new c(P,f.sign!==q.sign),new d($)]}x=T(L)}var xe=Vn(O,x);if(xe===-1)return[u[0],f];if(xe===0)return[u[f.sign===q.sign?1:-1],u[0]];O.length+x.length<=200?b=xu(O,x):b=pu(O,x),P=b[0];var Ge=f.sign!==q.sign,Me=b[1],rt=f.sign;return typeof P=="number"?(Ge&&(P=-P),P=new d(P)):P=new c(P,Ge),typeof Me=="number"?(rt&&(Me=-Me),Me=new d(Me)):Me=new c(Me,rt),[P,Me]}c.prototype.divmod=function(f){var m=rn(this,f);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(f){return rn(this,f)[0]},_.prototype.over=_.prototype.divide=function(f){return new _(this.value/qe(f).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(f){return rn(this,f)[1]},_.prototype.mod=_.prototype.remainder=function(f){return new _(this.value%qe(f).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O,x,P;if(q===0)return u[1];if(b===0)return u[0];if(b===1)return u[1];if(b===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&R(O=Math.pow(b,q)))return new d(Ae(O));for(x=this,P=u[1];q&!0&&(P=P.times(x),--q),q!==0;)q/=2,x=x.square();return P},d.prototype.pow=c.prototype.pow,_.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O=BigInt(0),x=BigInt(1),P=BigInt(2);if(q===O)return u[1];if(b===O)return u[0];if(b===x)return u[1];if(b===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(O);for(var L=this,$=u[1];(q&x)===x&&($=$.times(L),--q),q!==O;)q/=P,L=L.square();return $},c.prototype.modPow=function(f,m){if(f=qe(f),m=qe(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var b=u[1],q=this.mod(m);for(f.isNegative()&&(f=f.multiply(u[-1]),q=q.modInv(m));f.isPositive();){if(q.isZero())return u[0];f.isOdd()&&(b=b.multiply(q).mod(m)),f=f.divide(2),q=q.square().mod(m)}return b},_.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function Vn(f,m){if(f.length!==m.length)return f.length>m.length?1:-1;for(var b=f.length-1;b>=0;b--)if(f[b]!==m[b])return f[b]>m[b]?1:-1;return 0}c.prototype.compareAbs=function(f){var m=qe(f),b=this.value,q=m.value;return m.isSmall?1:Vn(b,q)},d.prototype.compareAbs=function(f){var m=qe(f),b=Math.abs(this.value),q=m.value;return m.isSmall?(q=Math.abs(q),b===q?0:b>q?1:-1):-1},_.prototype.compareAbs=function(f){var m=this.value,b=qe(f).value;return m=m>=0?m:-m,b=b>=0?b:-b,m===b?0:m>b?1:-1},c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Vn(b,q)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return m.isSmall?b==q?0:b>q?1:-1:b<0!==m.sign?b<0?-1:1:b<0?1:-1},d.prototype.compareTo=d.prototype.compare,_.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=this.value,b=qe(f).value;return m===b?0:m>b?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(f){return this.compare(f)===0},_.prototype.eq=_.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(f){return this.compare(f)!==0},_.prototype.neq=_.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(f){return this.compare(f)>0},_.prototype.gt=_.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(f){return this.compare(f)<0},_.prototype.lt=_.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},_.prototype.geq=_.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},_.prototype.leq=_.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},d.prototype.isEven=function(){return(this.value&1)===0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},d.prototype.isOdd=function(){return(this.value&1)===1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(f){var m=qe(f);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function hu(f){var m=f.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function rl(f,m){for(var b=f.prev(),q=b,O=0,x,P,L,$;q.isEven();)q=q.divide(2),O++;e:for(L=0;L<m.length;L++)if(!f.lesser(m[L])&&($=Gt(m[L]).modPow(q,f),!($.isUnit()||$.equals(b)))){for(x=O-1;x!=0;x--){if($=$.square().mod(f),$.isUnit())return!1;if($.equals(b))continue e}return!1}return!0}c.prototype.isPrime=function(f){var m=hu(this);if(m!==e)return m;var b=this.abs(),q=b.bitLength();if(q<=64)return rl(b,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var O=Math.log(2)*q.toJSNumber(),x=Math.ceil(f===!0?2*Math.pow(O,2):O),P=[],L=0;L<x;L++)P.push(Gt(L+2));return rl(b,P)},_.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(f,m){var b=hu(this);if(b!==e)return b;for(var q=this.abs(),O=f===e?5:f,x=[],P=0;P<O;P++)x.push(Gt.randBetween(2,q.minus(2),m));return rl(q,x)},_.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(f){for(var m=Gt.zero,b=Gt.one,q=qe(f),O=this.abs(),x,P,L;!O.isZero();)x=q.divide(O),P=m,L=q,m=b,q=O,b=P.subtract(x.multiply(b)),O=L.subtract(x.multiply(O));if(!q.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(f)),this.isNegative()?m.negate():m},_.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var f=this.value;return this.sign?st(f,1,this.sign):new c(De(f,1),this.sign)},d.prototype.next=function(){var f=this.value;return f+1<n?new d(f+1):new c(o,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var f=this.value;return this.sign?new c(De(f,1),!0):st(f,1,this.sign)},d.prototype.prev=function(){var f=this.value;return f-1>-n?new d(f-1):new c(o,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var nn=[1];2*nn[nn.length-1]<=t;)nn.push(2*nn[nn.length-1]);var fi=nn.length,Zn=nn[fi-1];function Au(f){return Math.abs(f)<=t}c.prototype.shiftLeft=function(f){var m=qe(f).toJSNumber();if(!Au(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var b=this;if(b.isZero())return b;for(;m>=fi;)b=b.multiply(Zn),m-=fi-1;return b.multiply(nn[m])},_.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(f){var m,b=qe(f).toJSNumber();if(!Au(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftLeft(-b);for(var q=this;b>=fi;){if(q.isZero()||q.isNegative()&&q.isUnit())return q;m=rn(q,Zn),q=m[1].isNegative()?m[0].prev():m[0],b-=fi-1}return m=rn(q,nn[b]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function nl(f,m,b){m=qe(m);for(var q=f.isNegative(),O=m.isNegative(),x=q?f.not():f,P=O?m.not():m,L=0,$=0,xe=null,Ge=null,Me=[];!x.isZero()||!P.isZero();)xe=rn(x,Zn),L=xe[1].toJSNumber(),q&&(L=Zn-1-L),Ge=rn(P,Zn),$=Ge[1].toJSNumber(),O&&($=Zn-1-$),x=xe[0],P=Ge[0],Me.push(b(L,$));for(var rt=b(q?1:0,O?1:0)!==0?Gt(-1):Gt(0),wr=Me.length-1;wr>=0;wr-=1)rt=rt.multiply(Zn).add(Gt(Me[wr]));return rt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(f){return nl(this,f,function(m,b){return m&b})},_.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(f){return nl(this,f,function(m,b){return m|b})},_.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(f){return nl(this,f,function(m,b){return m^b})},_.prototype.xor=d.prototype.xor=c.prototype.xor;var ol=1<<30,Nf=(t&-t)*(t&-t)|ol;function ns(f){var m=f.value,b=typeof m=="number"?m|ol:typeof m=="bigint"?m|BigInt(ol):m[0]+m[1]*t|Nf;return b&-b}function Ou(f,m){if(m.compareTo(f)<=0){var b=Ou(f,m.square(m)),q=b.p,O=b.e,x=q.multiply(m);return x.compareTo(f)<=0?{p:x,e:O*2+1}:{p:q,e:O*2}}return{p:Gt(1),e:0}}c.prototype.bitLength=function(){var f=this;return f.compareTo(Gt(0))<0&&(f=f.negate().subtract(Gt(1))),f.compareTo(Gt(0))===0?Gt(0):Gt(Ou(f,Gt(2)).e).add(Gt(1))},_.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function il(f,m){return f=qe(f),m=qe(m),f.greater(m)?f:m}function os(f,m){return f=qe(f),m=qe(m),f.lesser(m)?f:m}function X_(f,m){if(f=qe(f).abs(),m=qe(m).abs(),f.equals(m))return f;if(f.isZero())return m;if(m.isZero())return f;for(var b=u[1],q,O;f.isEven()&&m.isEven();)q=os(ns(f),ns(m)),f=f.divide(q),m=m.divide(q),b=b.multiply(q);for(;f.isEven();)f=f.divide(ns(f));do{for(;m.isEven();)m=m.divide(ns(m));f.greater(m)&&(O=m,m=f,f=O),m=m.subtract(f)}while(!m.isZero());return b.isUnit()?f:f.multiply(b)}function GE(f,m){return f=qe(f).abs(),m=qe(m).abs(),f.divide(X_(f,m)).multiply(m)}function FE(f,m,b){f=qe(f),m=qe(m);var q=b||Math.random,O=os(f,m),x=il(f,m),P=x.subtract(O).add(1);if(P.isSmall)return O.add(Math.floor(q()*P));for(var L=sl(P,t).value,$=[],xe=!0,Ge=0;Ge<L.length;Ge++){var Me=xe?L[Ge]+(Ge+1<L.length?L[Ge+1]/t:0):t,rt=Ae(q()*Me);$.push(rt),rt<L[Ge]&&(xe=!1)}return O.add(u.fromArray($,t,!1))}var jE=function(f,m,b,q){b=b||i,f=String(f),q||(f=f.toLowerCase(),b=b.toLowerCase());var O=f.length,x,P=Math.abs(m),L={};for(x=0;x<b.length;x++)L[b[x]]=x;for(x=0;x<O;x++){var $=f[x];if($!=="-"&&$ in L&&L[$]>=P){if($==="1"&&P===1)continue;throw new Error($+" is not a valid digit in base "+m+".")}}m=qe(m);var xe=[],Ge=f[0]==="-";for(x=Ge?1:0;x<f.length;x++){var $=f[x];if($ in L)xe.push(qe(L[$]));else if($==="<"){var Me=x;do x++;while(f[x]!==">"&&x<f.length);xe.push(qe(f.slice(Me+1,x)))}else throw new Error($+" is not a valid character")}return H_(xe,m,Ge)};function H_(f,m,b){var q=u[0],O=u[1],x;for(x=f.length-1;x>=0;x--)q=q.add(f[x].times(O)),O=O.times(m);return b?q.negate():q}function zE(f,m){return m=m||i,f<m.length?m[f]:"<"+f+">"}function sl(f,m){if(m=Gt(m),m.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var b=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return b.unshift([1]),{value:[].concat.apply([],b),isNegative:!1}}var q=!1;if(f.isNegative()&&m.isPositive()&&(q=!0,f=f.abs()),m.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:q};for(var O=[],x=f,P;x.isNegative()||x.compareAbs(m)>=0;){P=x.divmod(m),x=P.quotient;var L=P.remainder;L.isNegative()&&(L=m.minus(L).abs(),x=x.next()),O.push(L.toJSNumber())}return O.push(x.toJSNumber()),{value:O.reverse(),isNegative:q}}function Q_(f,m,b){var q=sl(f,m);return(q.isNegative?"-":"")+q.value.map(function(O){return zE(O,b)}).join("")}c.prototype.toArray=function(f){return sl(this,f)},d.prototype.toArray=function(f){return sl(this,f)},_.prototype.toArray=function(f){return sl(this,f)},c.prototype.toString=function(f,m){if(f===e&&(f=10),f!==10)return Q_(this,f,m);for(var b=this.value,q=b.length,O=String(b[--q]),x="0000000",P;--q>=0;)P=String(b[q]),O+=x.slice(P.length)+P;var L=this.sign?"-":"";return L+O},d.prototype.toString=function(f,m){return f===e&&(f=10),f!=10?Q_(this,f,m):String(this.value)},_.prototype.toString=d.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function W_(f){if(R(+f)){var m=+f;if(m===Ae(m))return s?new _(BigInt(m)):new d(m);throw new Error("Invalid integer: "+f)}var b=f[0]==="-";b&&(f=f.slice(1));var q=f.split(/e/i);if(q.length>2)throw new Error("Invalid integer: "+q.join("e"));if(q.length===2){var O=q[1];if(O[0]==="+"&&(O=O.slice(1)),O=+O,O!==Ae(O)||!R(O))throw new Error("Invalid integer: "+O+" is not a valid exponent.");var x=q[0],P=x.indexOf(".");if(P>=0&&(O-=x.length-P-1,x=x.slice(0,P)+x.slice(P+1)),O<0)throw new Error("Cannot include negative exponent part for integers");x+=new Array(O+1).join("0"),f=x}var L=/^([0-9][0-9]*)$/.test(f);if(!L)throw new Error("Invalid integer: "+f);if(s)return new _(BigInt(b?"-"+f:f));for(var $=[],xe=f.length,Ge=r,Me=xe-Ge;xe>0;)$.push(+f.slice(Me,xe)),Me-=Ge,Me<0&&(Me=0),xe-=Ge;return V($),new c($,b)}function YE(f){if(s)return new _(BigInt(f));if(R(f)){if(f!==Ae(f))throw new Error(f+" is not an integer.");return new d(f)}return W_(f.toString())}function qe(f){return typeof f=="number"?YE(f):typeof f=="string"?W_(f):typeof f=="bigint"?new _(f):f}for(var di=0;di<1e3;di++)u[di]=qe(di),di>0&&(u[-di]=qe(-di));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=il,u.min=os,u.gcd=X_,u.lcm=GE,u.isInstance=function(f){return f instanceof c||f instanceof d||f instanceof _},u.randBetween=FE,u.fromArray=function(f,m,b){return H_(f.map(qe),qe(m||10),b)},u}();typeof Mu<"u"&&Mu.hasOwnProperty("exports")&&(Mu.exports=Gt);typeof define=="function"&&define.amd&&define(function(){return Gt})});var Tu=A(is=>{"use strict";var VE=is&&is.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(is,"__esModule",{value:!0});is.mcmp=void 0;var BU=VE(To());function ZE(e,t){return e.compare(t)}is.mcmp=ZE});var ir=A(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.findPossibleExponentialForm=No.findPossibleClockForm=No.Find=void 0;var Nu=H(),XE=Ne(),Xt=N(),HE=U();function al(e,t){if((0,XE.equal)(e,t))return!0;if((0,Xt.istensor)(e)){for(let r=0;r<e.tensor.nelem;r++)if(al(e.tensor.elem[r],t))return!0;return!1}return(0,Xt.iscons)(e)?[...e].some(r=>al(r,t)):!1}No.Find=al;function Rf(e,t){if((0,Nu.isimaginaryunit)(e))return!1;if((0,Xt.ispower)(e)&&!(0,Nu.isinteger)((0,Xt.caddr)(t))&&al((0,Xt.cadr)(e),Xt.Constants.imaginaryunit)||(0,Xt.ispower)(e)&&(0,Nu.equaln)((0,Xt.cadr)(e),-1)&&!(0,Nu.isinteger)((0,Xt.caddr)(t)))return!0;if((0,Xt.istensor)(e)){for(let r=0;r<e.tensor.nelem;r++)if(Rf(e.tensor.elem[r],t))return!0;return!1}return(0,Xt.iscons)(e)?[...e].some(r=>Rf(r,t)):!1}No.findPossibleClockForm=Rf;function wf(e){if((0,Xt.ispower)(e)&&(0,Xt.cadr)(e)===(0,HE.symbol)(Xt.E))return al((0,Xt.caddr)(e),Xt.Constants.imaginaryunit);if((0,Xt.istensor)(e)){for(let t=0;t<e.tensor.nelem;t++)if(wf(e.tensor.elem[t]))return!0;return!1}return(0,Xt.iscons)(e)?[...e].some(wf):!1}No.findPossibleExponentialForm=wf});var eb=A(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.set_component=ss.index_function=void 0;var J_=It(),Lf=N(),xn=Ee(),K_=F(),mi=qt();function QE(e,t){let{ndim:r}=e.tensor,n=t.length;n>r&&(0,xn.stop)("too many indices for tensor");let o=0;for(let u=0;u<n;u++){let c=(0,K_.nativeInt)(t[u]);(c<1||c>e.tensor.dim[u])&&(0,xn.stop)("index out of range"),o=o*e.tensor.dim[u]+c-1}if(r===n)return e.tensor.elem[o];o=e.tensor.dim.slice(n).reduce((u,c)=>u*c,o);let i=e.tensor.dim.slice(n).reduce((u,c)=>u*c,1),s=(0,J_.alloc_tensor)(i);s.tensor.ndim=r-n,s.tensor.dim=e.tensor.dim.slice(n);for(let u=0;u<i;u++)s.tensor.elem[u]=e.tensor.elem[o+u];return(0,mi.check_tensor_dimensions)(e),(0,mi.check_tensor_dimensions)(s),s}ss.index_function=QE;function WE(e,...t){t.length<2&&(0,xn.stop)("error in indexed assign");let[r,...n]=t;(0,Lf.istensor)(r)||(0,xn.stop)("error in indexed assign: assigning to something that is not a tensor");let{ndim:o}=r.tensor,i=n.length;i>o&&(0,xn.stop)("error in indexed assign");let s=0;for(let c=0;c<i;c++){let d=(0,K_.nativeInt)(n[c]);(d<1||d>r.tensor.dim[c])&&(0,xn.stop)(`error in indexed assign
`),s=s*r.tensor.dim[c]+d-1}for(let c=i;c<o;c++)s=s*r.tensor.dim[c]+0;let u=(0,J_.alloc_tensor)(r.tensor.nelem);if(u.tensor.ndim=r.tensor.ndim,u.tensor.dim=Array.from(r.tensor.dim),u.tensor.elem=Array.from(r.tensor.elem),(0,mi.check_tensor_dimensions)(r),(0,mi.check_tensor_dimensions)(u),r=u,o===i)return(0,Lf.istensor)(e)&&(0,xn.stop)("error in indexed assign"),r.tensor.elem[s]=e,(0,mi.check_tensor_dimensions)(r),r;(0,Lf.istensor)(e)||(0,xn.stop)("error in indexed assign"),o-i!==e.tensor.ndim&&(0,xn.stop)("error in indexed assign");for(let c=0;c<e.tensor.ndim;c++)r.tensor.dim[i+c]!==e.tensor.dim[c]&&(0,xn.stop)("error in indexed assign");for(let c=0;c<e.tensor.nelem;c++)r.tensor.elem[s+c]=e.tensor.elem[c];return(0,mi.check_tensor_dimensions)(r),(0,mi.check_tensor_dimensions)(e),r}ss.set_component=WE});var K=A(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.makeList=void 0;var tb=N(),JE=U();function KE(...e){let t=(0,JE.symbol)(tb.NIL);for(let r=e.length-1;r>=0;r--)t=new tb.Cons(e[r],t);return t}Iu.makeList=KE});var Cf=A(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.Eval_function_reference=as.define_user_function=void 0;var Xn=N(),ex=Ee(),Su=U(),tx=G(),rx=K();function nx(e){let t=(0,Xn.caadr)(e),r=(0,Xn.cdadr)(e),n=(0,Xn.caddr)(e);return(0,Xn.issymbol)(t)||(0,ex.stop)("function name?"),(0,Xn.car)(n)===(0,Su.symbol)(Xn.EVAL)&&(n=(0,tx.Eval)((0,Xn.cadr)(n))),n=(0,rx.makeList)((0,Su.symbol)(Xn.FUNCTION),n,r),(0,Su.set_binding)(t,n),(0,Su.symbol)(Xn.NIL)}as.define_user_function=nx;function ox(e){return e}as.Eval_function_reference=ox});var Df=A(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.lcm=ls.Eval_lcm=void 0;var Ru=N(),rb=G(),ix=_i(),Pf=Z();function sx(e){e=(0,Ru.cdr)(e);let t=(0,rb.Eval)((0,Ru.car)(e));return(0,Ru.iscons)(e)&&(t=e.tail().reduce((r,n)=>nb(r,(0,rb.Eval)(n)),t)),t}ls.Eval_lcm=sx;function nb(e,t){return(0,Ru.doexpand)(ax,e,t)}ls.lcm=nb;function ax(e,t){return(0,Pf.inverse)((0,Pf.divide)((0,Pf.divide)((0,ix.gcd)(e,t),e),t))}});var ll=A(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.filter=us.Eval_filter=void 0;var lx=It(),Hn=N(),ux=ir(),cx=ue(),ob=G();function fx(e){e=(0,Hn.cdr)(e);let t=(0,ob.Eval)((0,Hn.car)(e));return(0,Hn.iscons)(e)&&(t=e.tail().reduce((r,n)=>wu(r,(0,ob.Eval)(n)),t)),t}us.Eval_filter=fx;function wu(e,t){return dx(e,t)}us.filter=wu;function dx(e,t){return(0,Hn.isadd)(e)?mx(e,t):(0,Hn.istensor)(e)?_x(e,t):(0,ux.Find)(e,t)?Hn.Constants.zero:e}function mx(e,t){return(0,Hn.iscons)(e)?e.tail().reduce((r,n)=>(0,cx.add)(r,wu(n,t)),Hn.Constants.zero):Hn.Constants.zero}function _x(e,t){let r=e.tensor.nelem,n=(0,lx.alloc_tensor)(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>wu(o,t)),n}});var Yr=A(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.subst=void 0;var bx=It(),bi=N(),gx=Ne(),yx=qt(),ib=U();function Lu(e,t,r){if(t===(0,ib.symbol)(bi.NIL)||r===(0,ib.symbol)(bi.NIL))return e;if((0,bi.istensor)(e)){let n=(0,bx.alloc_tensor)(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>{let i=Lu(o,t,r);return(0,yx.check_tensor_dimensions)(n),i}),n}return(0,gx.equal)(e,t)?r:(0,bi.iscons)(e)?new bi.Cons(Lu((0,bi.car)(e),t,r),Lu((0,bi.cdr)(e),t,r)):e}Cu.subst=Lu});var gi=A(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.coeff=cs.Eval_coeff=void 0;var Io=N(),sb=U(),vx=Ne(),qx=ue(),Pu=G(),Ex=ll(),ab=Z(),xx=Et(),px=Yr();function hx(e){let t=(0,Pu.Eval)((0,Io.cadddr)(e)),r=(0,Pu.Eval)((0,Io.caddr)(e)),n=(0,Pu.Eval)((0,Io.cadr)(e));return t===(0,sb.symbol)(Io.NIL)&&(t=r,r=(0,sb.symbol)(Io.SYMBOL_X)),(0,Ex.filter)((0,ab.divide)(n,(0,xx.power)(r,t)),r)}cs.Eval_coeff=hx;function Ax(e,t){let r=[];for(;;){let n=(0,Pu.Eval)((0,px.subst)(e,t,Io.Constants.zero));if(r.push(n),e=(0,qx.subtract)(e,n),(0,vx.equal)(e,Io.Constants.zero))return r;e=(0,Io.doexpand)(ab.divide,e,t)}}cs.coeff=Ax});var Du=A(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.clockform=fs.Eval_clock=void 0;var ul=N(),Ox=U(),lb=on(),kf=ds(),Mx=G(),Tx=K(),$f=Z(),Nx=!1;function Ix(e){return ub((0,Mx.Eval)((0,ul.cadr)(e)))}fs.Eval_clock=Ix;function ub(e){let t=(0,Tx.makeList)((0,Ox.symbol)(ul.POWER),ul.Constants.negOne,(0,$f.divide)((0,kf.arg)(e),ul.Constants.Pi())),r=(0,$f.multiply)((0,lb.abs)(e),t);return Nx&&(console.log(`clockform: abs of ${e} : ${(0,lb.abs)(e)}`),console.log(`clockform: arg of ${e} : ${(0,kf.arg)(e)}`),console.log(`clockform: divide : ${(0,$f.divide)((0,kf.arg)(e),ul.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}fs.clockform=ub});var ku=A(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.polar=ms.Eval_polar=void 0;var Uf=N(),Sx=Ne(),Rx=on(),wx=ds(),Lx=G(),cb=Z();function Cx(e){return fb((0,Lx.Eval)((0,Uf.cadr)(e)))}ms.Eval_polar=Cx;function fb(e){return(0,Uf.evalPolar)(()=>(0,cb.multiply)((0,Rx.abs)(e),(0,Sx.exponential)((0,cb.multiply)(Uf.Constants.imaginaryunit,(0,wx.arg)(e)))))}ms.polar=fb});var yi=A(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.conjugate=_s.Eval_conj=void 0;var $u=N(),Px=ir(),Dx=Du(),db=G(),kx=Z(),$x=ku(),Ux=Yr();function Bx(e){return e=(0,db.Eval)((0,$u.cadr)(e)),(0,Px.Find)(e,$u.Constants.imaginaryunit)?Bf(e):(0,Dx.clockform)(Bf((0,$x.polar)(e)))}_s.Eval_conj=Bx;function Bf(e){return(0,db.Eval)((0,Ux.subst)(e,$u.Constants.imaginaryunit,(0,kx.negate)($u.Constants.imaginaryunit)))}_s.conjugate=Bf});var Vr=A(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.guess=void 0;var sn=N(),cl=ir(),an=U();function Gx(e){return(0,cl.Find)(e,(0,an.symbol)(sn.SYMBOL_X))?(0,an.symbol)(sn.SYMBOL_X):(0,cl.Find)(e,(0,an.symbol)(sn.SYMBOL_Y))?(0,an.symbol)(sn.SYMBOL_Y):(0,cl.Find)(e,(0,an.symbol)(sn.SYMBOL_Z))?(0,an.symbol)(sn.SYMBOL_Z):(0,cl.Find)(e,(0,an.symbol)(sn.SYMBOL_T))?(0,an.symbol)(sn.SYMBOL_T):(0,cl.Find)(e,(0,an.symbol)(sn.SYMBOL_S))?(0,an.symbol)(sn.SYMBOL_S):(0,an.symbol)(sn.SYMBOL_X)}Uu.guess=Gx});var Gf=A(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.msub=bs.madd=void 0;function Fx(e,t){return e.add(t)}bs.madd=Fx;function jx(e,t){return e.subtract(t)}bs.msub=jx});var ys=A(gs=>{"use strict";var zx=gs&&gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gs,"__esModule",{value:!0});gs.mgcd=void 0;var Yx=zx(To());function Vx(e,t){return Yx.default.gcd(e,t)}gs.mgcd=Vx});var ln=A(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.mdivrem=pn.mmod=pn.mdiv=pn.mmul=void 0;function Zx(e,t){return e.multiply(t)}pn.mmul=Zx;function Xx(e,t){return e.divide(t)}pn.mdiv=Xx;function Hx(e,t){return e.mod(t)}pn.mmod=Hx;function Qx(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}pn.mdivrem=Qx});var Ff=A(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.mprime=void 0;function Wx(e){return e.isProbablePrime()}Bu.mprime=Wx});var yb=A(qs=>{"use strict";var Jx=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qs,"__esModule",{value:!0});qs.factor_number=void 0;var Kx=Jx(To()),Ro=N(),_b=Tu(),ep=Ee(),bb=U(),So=F(),jf=H(),gb=K(),mb=Gf(),tp=ys(),vs=ln(),rp=Ff(),Ft=(0,Kx.default)(0);function np(e){if((0,jf.equaln)(e,0)||(0,jf.equaln)(e,1)||(0,jf.equaln)(e,-1))return e;Ft=e.q.a;let t=op();return t.length==1?t[0]:(0,gb.makeList)((0,bb.symbol)(Ro.MULTIPLY),...t)}qs.factor_number=np;function op(){let e=[];Ft.isNegative()&&(Ft=(0,So.setSignTo)(Ft,1),e.push(Ro.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...ip(t)),Ft.compare(1)===0)return e;return e.push(...sp()),e}function ip(e){let t=[],r,n=(0,So.mint)(Ro.primetab[e]),o=0;for(;;){if(Ft.compare(1)===0)return o&&t.push(fl(n,o)),t;let i;if([r,i]=Array.from((0,vs.mdivrem)(Ft,n)),i.isZero())o++,Ft=r;else break}return o&&t.push(fl(n,o)),(0,_b.mcmp)(r,n)===-1&&(t.push(fl(Ft,1)),Ft=(0,So.mint)(1)),t}function sp(){let e=[],t=(0,So.mint)(1),r=(0,So.mint)(5),n=(0,So.mint)(2),o=1,i=1;for(;;){if((0,rp.mprime)(Ft))return e.push(fl(Ft,1)),e;for(;;){Ro.defs.esc_flag&&(0,ep.stop)("esc");let s=(0,mb.msub)(n,r);s=(0,So.setSignTo)(s,1);let u=(0,tp.mgcd)(s,Ft);if((0,Ro.MEQUAL)(u,1)){--o===0&&(n=r,i*=2,o=i),s=(0,vs.mmul)(r,r),r=(0,mb.madd)(s,t),s=(0,vs.mmod)(r,Ft),r=s;continue}if(e.push(fl(u,1)),(0,_b.mcmp)(u,Ft)===0)return e;s=(0,vs.mdiv)(Ft,u),Ft=s,s=(0,vs.mmod)(r,Ft),r=s,s=(0,vs.mmod)(n,Ft),n=s;break}}}function fl(e,t){let r=new Ro.Num(e);return t>1&&(r=(0,gb.makeList)((0,bb.symbol)(Ro.POWER),r,new Ro.Num((0,So.mint)(t)))),r}});var dl=A(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.factor_small_number=wo.factor=wo.Eval_factor=void 0;var hn=N(),ap=Ee(),lp=U(),zf=F(),Yf=G(),qb=Es(),up=Vr(),cp=H(),fp=Z(),dp=yb();function mp(e){let t=(0,Yf.Eval)((0,hn.cadr)(e)),r=(0,Yf.Eval)((0,hn.caddr)(e)),n=r===(0,lp.symbol)(hn.NIL)?(0,up.guess)(t):r,o=Eb(t,n);return e=(0,hn.cdddr)(e),(0,hn.iscons)(e)&&(o=[...e].reduce((i,s)=>_p(i,(0,Yf.Eval)(s)),o)),o}wo.Eval_factor=mp;function _p(e,t){if((0,hn.ismultiply)(e)){let n=[];return e.tail().forEach(o=>vb(n,o,t)),(0,fp.multiply_all_noexpand)(n)}let r=[];return vb(r,e,t),r[0]}function vb(e,t,r){let n=(0,qb.factorpoly)(t,r);if((0,hn.ismultiply)(n)){e.push(...n.tail());return}e.push(n)}function Eb(e,t){return(0,cp.isinteger)(e)?(0,dp.factor_number)(e):(0,qb.factorpoly)(e,t)}wo.factor=Eb;function bp(e){isNaN(e)&&(0,ap.stop)("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<hn.MAXPRIMETAB;r++){let n=hn.primetab[r];if(n>e/n)break;let o=0;for(;e%n===0;)e/=n,o++;o&&(t.push((0,zf.integer)(n)),t.push((0,zf.integer)(o)))}return e>1&&(t.push((0,zf.integer)(e)),t.push(hn.Constants.one)),t}wo.factor_small_number=bp});var Zf=A(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.ydivisors=ps.divisors=void 0;var gp=_i(),yp=It(),ke=N(),xb=Ne(),vp=ue(),xs=F(),Gu=dl(),qp=H(),Vf=Z(),Ep=Et();function xp(e){let t=pb(e),r=t.length;t.sort(xb.cmp_expr);let n=(0,yp.alloc_tensor)(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}ps.divisors=xp;var pp=e=>[].concat(...e);function pb(e){let t=[];if((0,ke.isNumericAtom)(e))t.push(...(0,Gu.factor_small_number)((0,xs.nativeInt)(e)));else if((0,ke.isadd)(e))t.push(...hp(e));else if((0,ke.ismultiply)(e)){if(e=(0,ke.cdr)(e),(0,ke.isNumericAtom)((0,ke.car)(e))&&(t.push(...(0,Gu.factor_small_number)((0,xs.nativeInt)((0,ke.car)(e)))),e=(0,ke.cdr)(e)),(0,ke.iscons)(e)){let n=[...e].map(o=>(0,ke.ispower)(o)?[(0,ke.cadr)(o),(0,ke.caddr)(o)]:[o,ke.Constants.one]);t.push(...pp(n))}}else(0,ke.ispower)(e)?t.push((0,ke.cadr)(e),(0,ke.caddr)(e)):t.push(e,ke.Constants.one);let r=t.length;return t.push(ke.Constants.one),hb(t,0,r),t.slice(r)}ps.ydivisors=pb;function hb(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let o=e[t+0],i=e[t+1],s=(0,xs.nativeInt)(i);if(!isNaN(s))for(let u=0;u<=Math.abs(s);u++)e.push((0,Vf.multiply)(n,(0,Ep.power)(o,(0,xs.integer)((0,xb.sign)(s)*u)))),hb(e,t+2,r)}function hp(e){let t=(0,ke.iscons)(e)?e.tail().reduce(gp.gcd):(0,ke.car)(e),r=[],n=t;if((0,qp.isplusone)(n))return r.push(e,ke.Constants.one),r;if((0,ke.isNumericAtom)(n))r.push(...(0,Gu.factor_small_number)((0,xs.nativeInt)(n)));else if((0,ke.ismultiply)(n)){let i=(0,ke.cdr)(n);(0,ke.isNumericAtom)((0,ke.car)(i))?r.push(...(0,Gu.factor_small_number)((0,xs.nativeInt)((0,ke.car)(i)))):r.push((0,ke.car)(i),ke.Constants.one),(0,ke.iscons)(i)&&i.tail().forEach(s=>r.push(s,ke.Constants.one))}else r.push(n,ke.Constants.one);n=(0,Vf.inverse)(n);let o=(0,ke.iscons)(e)?e.tail().reduce((i,s)=>(0,vp.add)(i,(0,Vf.multiply)(n,s)),ke.Constants.zero):(0,ke.cdr)(e);return r.push(o,ke.Constants.one),r}});var Fu=A(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.divpoly=As.Eval_quotient=void 0;var hs=N(),Ab=U(),Ob=ue(),Ap=F(),Mb=gi(),Xf=G(),Hf=Z(),Op=Et();function Mp(e){let t=(0,Xf.Eval)((0,hs.cadr)(e)),r=(0,Xf.Eval)((0,hs.caddr)(e)),n=(0,Xf.Eval)((0,hs.cadddr)(e));return n===(0,Ab.symbol)(hs.NIL)&&(n=(0,Ab.symbol)(hs.SYMBOL_X)),Tb(t,r,n)}As.Eval_quotient=Mp;function Tb(e,t,r){let n=(0,Mb.coeff)(e,r),o=n.length-1,i=(0,Mb.coeff)(t,r),s=i.length-1,u=o-s,c=hs.Constants.zero;for(;u>=0;){let d=(0,Hf.divide)(n[o],i[s]);for(let _=0;_<=s;_++)n[u+_]=(0,Ob.subtract)(n[u+_],(0,Hf.multiply)(i[_],d));c=(0,Ob.add)(c,(0,Hf.multiply)(d,(0,Op.power)(r,(0,Ap.integer)(u)))),o--,u--}return c}As.divpoly=Tb});var Qn=A(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.sine=Ms.Eval_sin=void 0;var Ct=N(),ju=U(),Qf=ue(),jt=F(),Nb=Lo(),Tp=G(),Sb=H(),Ib=K(),un=Z(),Os=Et();function Np(e){return ml((0,Tp.Eval)((0,Ct.cadr)(e)))}Ms.Eval_sin=Np;function ml(e){return(0,Ct.isadd)(e)?Ip(e):Rb(e)}Ms.sine=ml;function Ip(e){let t=(0,Ct.cdr)(e);for(;(0,Ct.iscons)(t);){let r=(0,Ct.car)(t);if((0,Sb.isnpi)(r)){let n=(0,Qf.subtract)(e,r);return(0,Qf.add)((0,un.multiply)(ml(n),(0,Nb.cosine)(r)),(0,un.multiply)((0,Nb.cosine)(n),ml(r)))}t=(0,Ct.cdr)(t)}return Rb(e)}function Rb(e){if((0,Ct.car)(e)===(0,ju.symbol)(Ct.ARCSIN))return(0,Ct.cadr)(e);if((0,Ct.isdouble)(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),(0,jt.double)(r)}if((0,Sb.isnegative)(e))return(0,un.negate)(ml((0,un.negate)(e)));if((0,Ct.car)(e)===(0,ju.symbol)(Ct.ARCTAN))return(0,un.multiply)((0,Ct.cadr)(e),(0,Os.power)((0,Qf.add)(Ct.Constants.one,(0,Os.power)((0,Ct.cadr)(e),(0,jt.integer)(2))),(0,jt.rational)(-1,2)));let t=(0,jt.nativeInt)((0,un.divide)((0,un.multiply)(e,(0,jt.integer)(180)),Ct.Constants.Pi()));if(t<0||isNaN(t))return(0,Ib.makeList)((0,ju.symbol)(Ct.SIN),e);switch(t%360){case 0:case 180:return Ct.Constants.zero;case 30:case 150:return(0,jt.rational)(1,2);case 210:case 330:return(0,jt.rational)(-1,2);case 45:case 135:return(0,un.multiply)((0,jt.rational)(1,2),(0,Os.power)((0,jt.integer)(2),(0,jt.rational)(1,2)));case 225:case 315:return(0,un.multiply)((0,jt.rational)(-1,2),(0,Os.power)((0,jt.integer)(2),(0,jt.rational)(1,2)));case 60:case 120:return(0,un.multiply)((0,jt.rational)(1,2),(0,Os.power)((0,jt.integer)(3),(0,jt.rational)(1,2)));case 240:case 300:return(0,un.multiply)((0,jt.rational)(-1,2),(0,Os.power)((0,jt.integer)(3),(0,jt.rational)(1,2)));case 90:return Ct.Constants.one;case 270:return Ct.Constants.negOne;default:return(0,Ib.makeList)((0,ju.symbol)(Ct.SIN),e)}}});var Lo=A(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.cosine=Ns.Eval_cos=void 0;var sr=N(),zu=U(),Wf=ue(),zt=F(),Sp=G(),Cb=H(),wb=K(),Wn=Z(),Ts=Et(),Lb=Qn();function Rp(e){return Yu((0,Sp.Eval)((0,sr.cadr)(e)))}Ns.Eval_cos=Rp;function Yu(e){return(0,sr.isadd)(e)?wp(e):Pb(e)}Ns.cosine=Yu;function wp(e){if((0,sr.iscons)(e)){for(let t of e.tail())if((0,Cb.isnpi)(t)){let r=(0,Wf.subtract)(e,t);return(0,Wf.subtract)((0,Wn.multiply)(Yu(r),Yu(t)),(0,Wn.multiply)((0,Lb.sine)(r),(0,Lb.sine)(t)))}}return Pb(e)}function Pb(e){if((0,sr.car)(e)===(0,zu.symbol)(sr.ARCCOS))return(0,sr.cadr)(e);if((0,sr.isdouble)(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),(0,zt.double)(r)}if((0,Cb.isnegative)(e)&&(e=(0,Wn.negate)(e)),(0,sr.car)(e)===(0,zu.symbol)(sr.ARCTAN)){let r=(0,Wf.add)(sr.Constants.one,(0,Ts.power)((0,sr.cadr)(e),(0,zt.integer)(2)));return(0,Ts.power)(r,(0,zt.rational)(-1,2))}let t=(0,zt.nativeInt)((0,Wn.divide)((0,Wn.multiply)(e,(0,zt.integer)(180)),sr.Constants.Pi()));if(t<0||isNaN(t))return(0,wb.makeList)((0,zu.symbol)(sr.COS),e);switch(t%360){case 90:case 270:return sr.Constants.zero;case 60:case 300:return(0,zt.rational)(1,2);case 120:case 240:return(0,zt.rational)(-1,2);case 45:case 315:return(0,Wn.multiply)((0,zt.rational)(1,2),(0,Ts.power)((0,zt.integer)(2),(0,zt.rational)(1,2)));case 135:case 225:return(0,Wn.multiply)((0,zt.rational)(-1,2),(0,Ts.power)((0,zt.integer)(2),(0,zt.rational)(1,2)));case 30:case 330:return(0,Wn.multiply)((0,zt.rational)(1,2),(0,Ts.power)((0,zt.integer)(3),(0,zt.rational)(1,2)));case 150:case 210:return(0,Wn.multiply)((0,zt.rational)(-1,2),(0,Ts.power)((0,zt.integer)(3),(0,zt.rational)(1,2)));case 0:return sr.Constants.one;case 180:return sr.Constants.negOne;default:return(0,wb.makeList)((0,zu.symbol)(sr.COS),e)}}});var Kn=A(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.rect=Ss.Eval_rect=void 0;var mr=N(),Is=ir(),Jn=U(),Db=on(),Jf=ue(),vi=ds(),Kf=Lo(),Lp=G(),Vu=H(),Cp=K(),Zu=Z(),Xu=Qn(),_l=!1;function Pp(e){return ed((0,Lp.Eval)((0,mr.cadr)(e)))}Ss.Eval_rect=Pp;function ed(e){let t=e;if(_l&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${(0,Is.findPossibleClockForm)(t,e)}`)),(0,mr.issymbol)(e))return _l&&console.log(` rect: simple symbol: ${t}`),(0,Vu.isZeroAtomOrTensor)((0,Jn.get_binding)((0,Jn.symbol)(mr.ASSUME_REAL_VARIABLES)))?(0,Cp.makeList)((0,Jn.symbol)(mr.YYRECT),e):e;if(!(0,Vu.isZeroAtomOrTensor)((0,Jn.get_binding)((0,Jn.symbol)(mr.ASSUME_REAL_VARIABLES)))&&!(0,Is.findPossibleExponentialForm)(e)&&!(0,Is.findPossibleClockForm)(e,e)&&!((0,Is.Find)(e,(0,Jn.symbol)(mr.SIN))&&(0,Is.Find)(e,(0,Jn.symbol)(mr.COS))&&(0,Is.Find)(e,mr.Constants.imaginaryunit)))return _l&&console.log(` rect: simple symbol: ${t}`),e;if((0,mr.ismultiply)(e)&&(0,Vu.isimaginaryunit)((0,mr.cadr)(e))&&!(0,Vu.isZeroAtomOrTensor)((0,Jn.get_binding)((0,Jn.symbol)(mr.ASSUME_REAL_VARIABLES))))return e;if((0,mr.isadd)(e))return _l&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,o)=>(0,Jf.add)(n,ed(o)),mr.Constants.zero);let r=(0,Zu.multiply)((0,Db.abs)(e),(0,Jf.add)((0,Kf.cosine)((0,vi.arg)(e)),(0,Zu.multiply)(mr.Constants.imaginaryunit,(0,Xu.sine)((0,vi.arg)(e)))));return _l&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${(0,Db.abs)(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${(0,Kf.cosine)((0,vi.arg)(e))}`),console.log(` rect - ${t} sine: ${(0,Xu.sine)((0,vi.arg)(e))}`),console.log(` rect - ${t} i * sine: ${(0,Zu.multiply)(mr.Constants.imaginaryunit,(0,Xu.sine)((0,vi.arg)(e)))}`),console.log(` rect - ${t} cos + i * sine: ${(0,Jf.add)((0,Kf.cosine)((0,vi.arg)(e)),(0,Zu.multiply)(mr.Constants.imaginaryunit,(0,Xu.sine)((0,vi.arg)(e))))}`),console.log(`rect of ${t} : ${r}`)),r}Ss.rect=ed});var Es=A(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.factorpoly=void 0;var Dp=Df(),Se=N(),kp=ir(),$p=Ee(),Up=Ne(),An=ue(),Co=F(),kb=gi(),$b=gl(),Bp=yi(),Gp=Mn(),Ub=Zf(),On=H(),Ot=Z(),Rs=Et(),Fp=eo(),jp=Fu(),td=Kn();function zp(e,t){return!(0,kp.Find)(e,t)||!(0,On.ispolyexpandedform)(e,t)||!(0,Se.issymbol)(t)?e:Yp(e,t)}Hu.factorpoly=zp;function Yp(e,t){let r,n,o,i;(0,On.isfloating)(e)&&(0,$p.stop)("floating point numbers in polynomial");let s=(0,kb.coeff)(e,t),u=s.length-1,c=Vp(s),d="real",_=null;for(;u>0;){var R,T;if((0,On.isZeroAtomOrTensor)(s[0])?(r=Se.Constants.one,n=Se.Constants.zero):d==="real"?[T,r,n]=Zp(s,u,t,r,n):d==="complex"&&([R,r]=Xp(_,s,u)),d==="real")if(T===!1){d="complex";continue}else{for(o=(0,An.add)((0,Ot.multiply)(r,t),n),Se.DEBUG&&console.log(`success
FACTOR=${o}`),c=(0,Ot.multiply_noexpand)(c,o),Hp(r,n,s,u);u&&(0,On.isZeroAtomOrTensor)(s[u]);)u--;let V=Se.Constants.zero;for(let z=0;z<=u;z++)V=(0,An.add)(V,(0,Ot.multiply)(s[z],(0,Rs.power)(t,(0,Co.integer)(z))));_=V}else if(d==="complex"){if(R===!1)break;{let V=(0,An.subtract)(r,t),z=(0,An.subtract)((0,Bp.conjugate)(r),t);o=(0,Ot.multiply)(V,z),Se.DEBUG&&console.log(`success
FACTOR=${o}`);let Ae=c;if(c=(0,Ot.multiply_noexpand)(c,o),_==null){let Oe=Se.Constants.zero;for(let st=0;st<=u;st++)Oe=(0,An.add)(Oe,(0,Ot.multiply)(s[st],(0,Rs.power)(t,(0,Co.integer)(st))));_=Oe}let et=t,Ve=o,De=_;_=(0,jp.divpoly)(De,Ve,et);let it=(0,Ot.multiply)(_,o);if(!(0,Up.equal)(it,De))return Se.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Ae} * ${De}`)),(0,Ot.multiply_noexpand)(Ae,(0,Se.noexpand)($b.yycondense,De));for(let Oe=0;Oe<=u;Oe++)s.pop();s.push(...(0,kb.coeff)(_,t)),u-=2}}}let k=Se.Constants.zero;for(let V=0;V<=u;V++)k=(0,An.add)(k,(0,Ot.multiply)(s[V],(0,Rs.power)(t,(0,Co.integer)(V))));return e=k,Se.DEBUG&&console.log(`POLY=${e}`),e=(0,Se.noexpand)($b.yycondense,e),u>0&&(0,On.isnegativeterm)(s[u])&&(e=(0,Ot.negate)(e),c=(0,Ot.negate_noexpand)(c)),c=(0,Ot.multiply_noexpand)(c,e),Se.DEBUG&&console.log(`RESULT=${c}`),c}function Vp(e){let t=Se.Constants.one;for(let r of e)t=(0,Dp.lcm)((0,Gp.denominator)(r),t);for(let r=0;r<e.length;r++)e[r]=(0,Ot.multiply)(t,e[r]);return t=(0,Ot.reciprocate)(t),Se.DEBUG&&console.log("rationalize_coefficients result"),t}function Zp(e,t,r,n,o){let i,s,u;if(Se.DEBUG){let _=Se.Constants.zero;for(let R=0;R<=t;R++)_=(0,An.add)(_,(0,Ot.multiply)(e[R],(0,Rs.power)(r,(0,Co.integer)(R))));i=_,console.log(`POLY=${i}`)}let c=(0,Ub.ydivisors)(e[t]),d=(0,Ub.ydivisors)(e[0]);if(Se.DEBUG){console.log("divisors of base term");for(let _=0;_<d.length;_++)console.log(`, ${d[_]}`);console.log("divisors of leading term");for(let _=0;_<c.length;_++)console.log(`, ${c[_]}`)}for(let _=0;_<c.length;_++)for(let R=0;R<d.length;R++){if(n=c[_],o=d[R],s=(0,Ot.negate)((0,Ot.divide)(o,n)),u=bl(s,e,t),Se.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),(0,On.isZeroAtomOrTensor)(u))return Se.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o];if(o=(0,Ot.negate)(o),s=(0,Ot.negate)(s),u=bl(s,e,t),Se.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),(0,On.isZeroAtomOrTensor)(u))return Se.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o]}return Se.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,o]}function Xp(e,t,r){let n,o,i,s;if(r<=2)return Se.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,o];if(n=e,Se.DEBUG&&console.log(`complex root finding for POLY=${n}`),o=(0,td.rect)((0,Rs.power)(Se.Constants.negOne,(0,Co.rational)(2,3))),Se.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=bl(i,t,r),Se.DEBUG&&console.log(`complex root finding result: ${s}`),(0,On.isZeroAtomOrTensor)(s))return Se.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];if(o=(0,td.rect)((0,Rs.power)(Se.Constants.one,(0,Co.rational)(2,3))),Se.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=bl(i,t,r),Se.DEBUG&&console.log(`complex root finding result: ${s}`),(0,On.isZeroAtomOrTensor)(s))return Se.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];for(let u=-10;u<=10;u++)for(let c=1;c<=5;c++){o=(0,td.rect)((0,An.add)((0,Co.integer)(u),(0,Ot.multiply)((0,Co.integer)(c),Se.Constants.imaginaryunit)));let _=bl(o,t,r);if((0,On.isZeroAtomOrTensor)(_))return Se.DEBUG&&console.log(`found complex root: ${_}`),[!0,o]}return Se.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,o]}function Hp(e,t,r,n){let o=Se.Constants.zero;for(let i=n;i>0;i--){let s=(0,Ot.divide)(r[i],e);r[i]=o,o=s,r[i-1]=(0,An.subtract)(r[i-1],(0,Ot.multiply)(o,t))}r[0]=o,Se.DEBUG&&console.log("yydivpoly Q:")}function bl(e,t,r){let n=Se.Constants.zero;for(let o=r;o>=0;o--)Se.DEBUG&&(console.log("Evalpoly top of stack:"),console.log((0,Fp.print_list)(n))),n=(0,An.add)((0,Ot.multiply)(n,e),t[o]);return n}});var _i=A(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.areunivarpolysfactoredorexpandedform=Do.gcd=Do.Eval_gcd=void 0;var X=N(),Bb=U(),qi=Ne(),Qp=ue(),Wp=F(),Gb=G(),Fb=Es(),nd=H(),jb=K(),Po=Z(),rd=Et();function Jp(e){e=(0,X.cdr)(e);let t=(0,Gb.Eval)((0,X.car)(e));return(0,X.iscons)(e)&&(t=e.tail().reduce((r,n)=>to(r,(0,Gb.Eval)(n)),t)),t}Do.Eval_gcd=Jp;function to(e,t){return(0,X.doexpand)(Kp,e,t)}Do.gcd=to;function Kp(e,t){let r;return(0,qi.equal)(e,t)?e:(0,X.isrational)(e)&&(0,X.isrational)(t)?(0,Wp.gcd_numbers)(e,t):(r=Yb(e,t))?eh(e,t,r):(0,X.isadd)(e)&&(0,X.isadd)(t)?th(e,t):((0,X.isadd)(e)&&(e=zb(e)),(0,X.isadd)(t)&&(t=zb(t)),(0,X.ismultiply)(e)?rh(e,t):(0,X.ismultiply)(t)?nh(e,t):(0,X.ismultiply)(e)&&(0,X.ismultiply)(t)?Vb(e,t):Zb(e,t))}function Yb(e,t){let r;if((r=(0,nd.isunivarpolyfactoredorexpandedform)(e))&&(0,nd.isunivarpolyfactoredorexpandedform)(t,r))return r}Do.areunivarpolysfactoredorexpandedform=Yb;function eh(e,t,r){return e=(0,Fb.factorpoly)(e,r),t=(0,Fb.factorpoly)(t,r),((0,X.ismultiply)(e)||(0,X.ismultiply)(t))&&((0,X.ismultiply)(e)||(e=(0,jb.makeList)((0,Bb.symbol)(X.MULTIPLY),e,X.Constants.one)),(0,X.ismultiply)(t)||(t=(0,jb.makeList)((0,Bb.symbol)(X.MULTIPLY),t,X.Constants.one))),(0,X.ismultiply)(e)&&(0,X.ismultiply)(t)?Vb(e,t):Zb(e,t)}function Vb(e,t){let r=(0,X.cdr)(e),n=(0,X.cdr)(t);if((0,X.iscons)(r))return[...r].reduce((o,i)=>{if((0,X.iscons)(n))return(0,Po.multiply)(o,[...n].reduce((s,u)=>(0,Po.multiply)(s,to(i,u)),X.Constants.one))},X.Constants.one)}function Zb(e,t){let r,n,o;if((0,X.ispower)(e)?(r=(0,X.caddr)(e),e=(0,X.cadr)(e)):r=X.Constants.one,(0,X.ispower)(t)?(n=(0,X.caddr)(t),t=(0,X.cadr)(t)):n=X.Constants.one,!(0,qi.equal)(e,t))return X.Constants.one;if((0,X.isNumericAtom)(r)&&(0,X.isNumericAtom)(n)){let u=(0,qi.lessp)(r,n)?r:n;return(0,rd.power)(e,u)}let i=(0,Po.divide)(r,n);if((0,X.isNumericAtom)(i)){i=(0,X.ismultiply)(r)&&(0,X.isNumericAtom)((0,X.cadr)(r))?(0,X.cadr)(r):X.Constants.one,o=(0,X.ismultiply)(n)&&(0,X.isNumericAtom)((0,X.cadr)(n))?(0,X.cadr)(n):X.Constants.one;let u=(0,qi.lessp)(i,o)?r:n;return(0,rd.power)(e,u)}if(i=(0,Qp.subtract)(r,n),!(0,X.isNumericAtom)(i))return X.Constants.one;let s=(0,nd.isnegativenumber)(i)?r:n;return(0,rd.power)(e,s)}function th(e,t){let r,n,o,i;return(0,qi.length)(e)!==(0,qi.length)(t)?X.Constants.one:(r=(0,X.iscons)(e)?e.tail().reduce(to):(0,X.car)((0,X.cdr)(e)),n=(0,X.iscons)(t)?t.tail().reduce(to):(0,X.car)((0,X.cdr)(t)),o=(0,Po.divide)(e,r),i=(0,Po.divide)(t,n),(0,qi.equal)(o,i)?(0,Po.multiply)(o,to(r,n)):X.Constants.one)}function zb(e){return(0,X.iscons)(e)?e.tail().reduce(to):(0,X.car)((0,X.cdr)(e))}function rh(e,t){return(0,X.iscons)(e)?e.tail().reduce((r,n)=>(0,Po.multiply)(r,to(n,t)),X.Constants.one):X.Constants.one}function nh(e,t){return(0,X.iscons)(t)?t.tail().reduce((r,n)=>(0,Po.multiply)(r,to(e,n)),X.Constants.one):X.Constants.one}});var gl=A(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.yycondense=ko.Condense=ko.Eval_condense=void 0;var Qu=N(),oh=Ne(),ih=ue(),sh=G(),ah=_i(),od=Z();function lh(e){return Xb((0,sh.Eval)((0,Qu.cadr)(e)))}ko.Eval_condense=lh;function Xb(e){return(0,Qu.noexpand)(Hb,e)}ko.Condense=Xb;function Hb(e){if(!(0,Qu.isadd)(e))return e;let t=e.tail().reduce(ah.gcd),r=(0,od.inverse)(t),n=e.tail().reduce((i,s)=>(0,ih.add)(i,(0,od.multiply_noexpand)(r,s)),Qu.Constants.zero),o=(0,oh.yyexpand)(n);return(0,od.divide)(o,r)}ko.yycondense=Hb});var yl=A(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.rationalize=Ls.Eval_rationalize=void 0;var ar=N(),uh=ue(),ch=gl(),eg=G(),fh=_i(),Qb=H(),ws=Z(),dh=qt();function mh(e){return id((0,eg.Eval)((0,ar.cadr)(e)))}Ls.Eval_rationalize=mh;function id(e){let t=ar.defs.expanding,r=_h(e);return ar.defs.expanding=t,r}Ls.rationalize=id;function _h(e){if((0,ar.istensor)(e))return gh(e);if(ar.defs.expanding=!1,!(0,ar.isadd)(e))return e;let t=bh(e),r=ar.Constants.zero;return(0,ar.iscons)(e)&&(r=e.tail().reduce((n,o)=>(0,uh.add)(n,(0,ws.multiply)(t,o)),r)),(0,ws.divide)((0,ch.Condense)(r),t)}function bh(e){return(0,ar.isadd)(e)?e.tail().reduce((t,r)=>Wb(r,t),ar.Constants.one):Wb(e,ar.Constants.one)}function Wb(e,t){return(0,ar.ismultiply)(e)?e.tail().reduce((r,n)=>Jb(n,r),t):Jb(e,t)}function Jb(e,t){if(!(0,ar.ispower)(e))return t;let r=e;return e=(0,ar.caddr)(e),(0,Qb.isnegativenumber)(e)||(0,ar.ismultiply)(e)&&(0,Qb.isnegativenumber)((0,ar.cadr)(e))?Kb(t,(0,ws.inverse)(r)):t}function gh(e){return e=(0,eg.Eval)(e),(0,ar.istensor)(e)&&(e.tensor.elem=e.tensor.elem.map(id),(0,dh.check_tensor_dimensions)(e)),e}function Kb(e,t){return(0,ws.divide)((0,ws.multiply)(e,t),(0,fh.gcd)(e,t))}});var Mn=A(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.denominator=Cs.Eval_denominator=void 0;var ro=N(),yh=F(),vh=G(),tg=H(),rg=Z(),qh=yl();function Eh(e){return sd((0,vh.Eval)((0,ro.cadr)(e)))}Cs.Eval_denominator=Eh;function sd(e){return(0,ro.isadd)(e)&&(e=(0,qh.rationalize)(e)),(0,ro.ismultiply)(e)&&!(0,tg.isplusone)((0,ro.car)((0,ro.cdr)(e)))?(0,rg.multiply_all)(e.tail().map(sd)):(0,ro.isrational)(e)?(0,yh.mp_denominator)(e):(0,ro.ispower)(e)&&(0,tg.isnegativeterm)((0,ro.caddr)(e))?(0,rg.reciprocate)(e):ro.Constants.one}Cs.denominator=sd});var oo=A(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.numerator=Ps.Eval_numerator=void 0;var no=N(),xh=F(),ph=G(),ng=H(),hh=Z(),Ah=yl();function Oh(e){return ad((0,ph.Eval)((0,no.cadr)(e)))}Ps.Eval_numerator=Oh;function ad(e){return(0,no.isadd)(e)&&(e=(0,Ah.rationalize)(e)),(0,no.ismultiply)(e)&&!(0,ng.isplusone)((0,no.car)((0,no.cdr)(e)))?(0,hh.multiply_all)(e.tail().map(ad)):(0,no.isrational)(e)?(0,xh.mp_numerator)(e):(0,no.ispower)(e)&&(0,ng.isnegativeterm)((0,no.caddr)(e))?no.Constants.one:e}Ps.numerator=ad});var ud=A(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.arctan=Ds.Eval_arctan=void 0;var pe=N(),og=ir(),Ei=U(),Mh=Ne(),Wu=F(),Th=Mn(),Nh=G(),Tn=H(),Ih=K(),vl=Z(),Sh=oo();function Rh(e){return ld((0,Nh.Eval)((0,pe.cadr)(e)))}Ds.Eval_arctan=Rh;function ld(e){if((0,pe.car)(e)===(0,Ei.symbol)(pe.TAN))return(0,pe.cadr)(e);if((0,pe.isdouble)(e))return(0,Wu.double)(Math.atan(e.d));if((0,Tn.isZeroAtomOrTensor)(e))return pe.Constants.zero;if((0,Tn.isnegative)(e))return(0,vl.negate)(ld((0,vl.negate)(e)));if((0,og.Find)(e,(0,Ei.symbol)(pe.SIN))&&(0,og.Find)(e,(0,Ei.symbol)(pe.COS))){let t=(0,Sh.numerator)(e),r=(0,Th.denominator)(e);if((0,pe.car)(t)===(0,Ei.symbol)(pe.SIN)&&(0,pe.car)(r)===(0,Ei.symbol)(pe.COS)&&(0,Mh.equal)((0,pe.cadr)(t),(0,pe.cadr)(r)))return(0,pe.cadr)(t)}return(0,pe.ispower)(e)&&(0,Tn.equaln)((0,pe.cadr)(e),3)&&(0,Tn.equalq)((0,pe.caddr)(e),-1,2)||(0,pe.ismultiply)(e)&&(0,Tn.equalq)((0,pe.car)((0,pe.cdr)(e)),1,3)&&(0,pe.car)((0,pe.car)((0,pe.cdr)((0,pe.cdr)(e))))===(0,Ei.symbol)(pe.POWER)&&(0,Tn.equaln)((0,pe.car)((0,pe.cdr)((0,pe.car)((0,pe.cdr)((0,pe.cdr)(e))))),3)&&(0,Tn.equalq)((0,pe.car)((0,pe.cdr)((0,pe.cdr)((0,pe.car)((0,pe.cdr)((0,pe.cdr)(e)))))),1,2)?(0,vl.multiply)((0,Wu.rational)(1,6),pe.Constants.Pi()):(0,Tn.equaln)(e,1)?(0,vl.multiply)((0,Wu.rational)(1,4),pe.Constants.Pi()):(0,pe.ispower)(e)&&(0,Tn.equaln)((0,pe.cadr)(e),3)&&(0,Tn.equalq)((0,pe.caddr)(e),1,2)?(0,vl.multiply)((0,Wu.rational)(1,3),pe.Constants.Pi()):(0,Ih.makeList)((0,Ei.symbol)(pe.ARCTAN),e)}Ds.arctan=ld});var ql=A(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.imag=ks.Eval_imag=void 0;var sg=N(),wh=ue(),Lh=F(),Ch=yi(),Ph=G(),ig=Z(),Dh=Kn(),kh=!1;function $h(e){return ag((0,Ph.Eval)((0,sg.cadr)(e)))}ks.Eval_imag=$h;function ag(e){let t=(0,Dh.rect)(e),r=(0,Ch.conjugate)(t),n=(0,ig.divide)((0,wh.subtract)(t,r),(0,Lh.integer)(2)),o=(0,ig.divide)(n,sg.Constants.imaginaryunit);return kh&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${o}`)),o}ks.imag=ag});var Us=A($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.real=$s.Eval_real=void 0;var Uh=N(),Bh=ue(),Gh=F(),Fh=yi(),jh=G(),zh=Z(),Yh=Kn();function Vh(e){return lg((0,jh.Eval)((0,Uh.cadr)(e)))}$s.Eval_real=Vh;function lg(e){let t=(0,Yh.rect)(e);return(0,zh.divide)((0,Bh.add)(t,(0,Fh.conjugate)(t)),(0,Gh.integer)(2))}$s.real=lg});var ds=A(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.arg=Bs.Eval_arg=void 0;var Fe=N(),xi=U(),Ju=ue(),Zh=ud(),Xh=Mn(),Hh=G(),ug=ql(),io=H(),cg=K(),El=Z(),Qh=oo(),Wh=Us(),Jh=Kn(),Kh=!1;function e2(e){return Ku((0,Hh.Eval)((0,Fe.cadr)(e)))}Bs.Eval_arg=e2;function Ku(e){return(0,Ju.subtract)(fg((0,Qh.numerator)(e)),fg((0,Xh.denominator)(e)))}Bs.arg=Ku;function fg(e){if((0,io.ispositivenumber)(e)||e===(0,xi.symbol)(Fe.PI))return(0,Fe.isdouble)(e)||Fe.defs.evaluatingAsFloats?Fe.Constants.zeroAsDouble:Fe.Constants.zero;if((0,io.isnegativenumber)(e)){let t=(0,Fe.isdouble)(e)||Fe.defs.evaluatingAsFloats?Fe.Constants.piAsDouble:(0,xi.symbol)(Fe.PI);return(0,El.negate)(t)}if((0,Fe.issymbol)(e))return(0,cg.makeList)((0,xi.symbol)(Fe.ARG),e);if((0,Fe.ispower)(e)&&(0,io.equaln)((0,Fe.cadr)(e),-1))return(0,El.multiply)(Fe.Constants.Pi(),(0,Fe.caddr)(e));if((0,Fe.ispower)(e)&&(0,Fe.cadr)(e)===(0,xi.symbol)(Fe.E))return(0,ug.imag)((0,Fe.caddr)(e));if((0,Fe.ispower)(e)&&(0,io.isoneovertwo)((0,Fe.caddr)(e))){let t=Ku((0,Fe.cadr)(e));return Kh&&(console.log(`arg of a sqrt: ${e}`),Fe.breakpoint,console.log(` = 1/2 * ${t}`)),(0,El.multiply)(t,(0,Fe.caddr)(e))}if((0,Fe.ismultiply)(e))return e.tail().map(Ku).reduce(Ju.add,Fe.Constants.zero);if((0,Fe.isadd)(e)){e=(0,Jh.rect)(e);let t=(0,Wh.real)(e),r=(0,ug.imag)(e);if((0,io.isZeroAtomOrTensor)(t))return(0,io.isnegative)(r)?(0,El.negate)(Fe.Constants.Pi()):Fe.Constants.Pi();{let n=(0,Zh.arctan)((0,El.divide)(r,t));return(0,io.isnegative)(t)?(0,io.isnegative)(r)?(0,Ju.subtract)(n,Fe.Constants.Pi()):(0,Ju.add)(n,Fe.Constants.Pi()):n}}return(0,io.isZeroAtomOrTensor)((0,xi.get_binding)((0,xi.symbol)(Fe.ASSUME_REAL_VARIABLES)))?(0,cg.makeList)((0,xi.symbol)(Fe.ARG),e):Fe.Constants.zero}});var dg=A(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.dpow=void 0;var t2=N(),r2=Ee(),n2=ue(),cd=F(),o2=Z();function i2(e,t){if(e===0&&t<0&&(0,r2.stop)("divide by zero"),e>=0||t%1===0)return(0,cd.double)(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,o=0,i=0;return t%.5===0?(o=0,i=Math.sin(n)):(o=Math.cos(n),i=Math.sin(n)),(0,n2.add)((0,cd.double)(o*r),(0,o2.multiply)((0,cd.double)(i*r),t2.Constants.imaginaryunit))}ec.dpow=i2});var pi=A(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.factorial=void 0;var s2=N(),pB=Ne(),hB=ue(),mg=F(),a2=K(),AB=Z(),OB=Et(),l2=U();function u2(e){let t=(0,mg.nativeInt)(e);return t<0||isNaN(t)?(0,a2.makeList)((0,l2.symbol)(s2.FACTORIAL),e):(0,mg.bignum_factorial)(t)}tc.factorial=u2});var nc=A(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.mpow=void 0;function c2(e,t){return e.pow(t)}rc.mpow=c2});var _g=A(Gs=>{"use strict";var f2=Gs&&Gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.mroot=void 0;var oc=f2(To()),d2=Tu(),m2=Ee(),_2=F(),b2=nc();function g2(e,t){e=e.abs(),t===0&&(0,m2.stop)("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return(0,_2.mint)(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),o=(0,oc.default)(n);for(let i=0;i<n;i++)o=o.and((0,oc.default)(1).shiftLeft(i).not());for(;r>=0;){o=o.or((0,oc.default)(1).shiftLeft(r));let i=(0,b2.mpow)(o,t);switch((0,d2.mcmp)(i,e)){case 0:return o;case 1:o=o.and((0,oc.default)(1).shiftLeft(r).not());break}r--}return 0}Gs.mroot=g2});var Eg=A(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});Fs.quickpower=Fs.quickfactor=void 0;var bg=N(),y2=ue(),ic=F(),v2=dl(),q2=H(),gg=K(),yg=Z(),vg=U();function E2(e,t){let r=(0,v2.factor_small_number)((0,ic.nativeInt)(e)),n=r.length;for(let o=0;o<n;o+=2)r.push(...qg(r[o],(0,yg.multiply)(r[o+1],t)));return(0,yg.multiply_all)(r.slice(n))}Fs.quickfactor=E2;function qg(e,t){let r=(0,ic.bignum_truncate)(t),n=(0,y2.subtract)(t,r),o;(0,q2.isZeroAtomOrTensor)(n)||(o=(0,gg.makeList)((0,vg.symbol)(bg.POWER),e,n));let i=(0,ic.nativeInt)(r);if(isNaN(i)){let u=(0,gg.makeList)((0,vg.symbol)(bg.POWER),e,r);return o?[o,u]:[u]}if(i===0)return[o];let s=(0,ic.bignum_power_number)(e,i);return o?[o,s]:[s]}Fs.quickpower=qg});var pg=A(js=>{"use strict";var x2=js&&js.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(js,"__esModule",{value:!0});js.qpow=void 0;var p2=x2(To()),qr=N(),h2=Ee(),xg=ue(),so=F(),Lr=H(),sc=K(),fd=nc(),A2=_g(),xl=Z(),O2=Eg(),ac=U();function pl(e,t){return M2(e,t)}js.qpow=pl;function M2(e,t){if((0,Lr.isplusone)(e)||(0,Lr.isZeroAtomOrTensor)(t))return qr.Constants.one;if((0,Lr.isminusone)(e)&&(0,Lr.isoneovertwo)(t))return qr.Constants.imaginaryunit;if((0,Lr.isZeroAtomOrTensor)(e))return(0,Lr.isnegativenumber)(t)&&(0,h2.stop)("divide by zero"),qr.Constants.zero;if((0,Lr.isplusone)(t))return e;let r=0,n,o;if((0,Lr.isinteger)(t)){if(r=(0,so.nativeInt)(t),isNaN(r))return(0,sc.makeList)((0,ac.symbol)(qr.POWER),e,t);if(n=(0,fd.mpow)(e.q.a,Math.abs(r)),o=(0,fd.mpow)(e.q.b,Math.abs(r)),r<0){let u=n;n=o,o=u,n=(0,so.makeSignSameAs)(n,o),o=(0,so.makePositive)(o)}return new qr.Num(n,o)}if((0,Lr.isminusone)(e))return T2(t);if((0,Lr.isnegativenumber)(e))return(0,xl.multiply)(pl((0,xl.negate)(e),t),pl(qr.Constants.negOne,t));if(!(0,Lr.isinteger)(e))return(0,xl.multiply)(pl((0,so.mp_numerator)(e),t),pl((0,so.mp_denominator)(e),(0,xl.negate)(t)));if(N2(e))return(0,O2.quickfactor)(e,t);if(!(0,so.isSmall)(t.q.a)||!(0,so.isSmall)(t.q.b))return(0,sc.makeList)((0,ac.symbol)(qr.POWER),e,t);let{a:i,b:s}=t.q;return n=(0,A2.mroot)(e.q.a,s.toJSNumber()),n===0?(0,sc.makeList)((0,ac.symbol)(qr.POWER),e,t):(o=(0,fd.mpow)(n,i),t.q.a.isNegative()?new qr.Num(p2.default.one,o):new qr.Num(o))}function T2(e){if((0,Lr.isinteger)(e))return e.q.a.isOdd()?qr.Constants.negOne:qr.Constants.one;let t=(0,so.bignum_truncate)(e);(0,Lr.isnegativenumber)(e)&&(t=(0,xg.add)(t,qr.Constants.negOne));let r=(0,xg.subtract)(e,t),n=(0,sc.makeList)((0,ac.symbol)(qr.POWER),qr.Constants.negOne,r);return t.q.a.isOdd()&&(n=(0,xl.negate)(n)),n}function N2(e){return(0,so.isSmall)(e.q.a)}});var Et=A(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.power=Ys.Eval_power=void 0;var B=N(),lc=ir(),Yt=U(),hl=Ne(),hg=on(),uc=ue(),I2=ds(),Ar=F(),S2=yi(),R2=Lo(),w2=dg(),Ag=G(),Mg=pi(),xt=H(),zs=K(),Ht=Z(),L2=pg(),Og=Kn(),C2=Qn(),P2=qt(),We=!1;function D2(e){We&&B.breakpoint;let t=(0,Ag.Eval)((0,B.cadr)(e)),r=(0,Ag.Eval)((0,B.caddr)(e));return Or(t,r)}Ys.Eval_power=D2;function Or(e,t){return k2(e,t)}Ys.power=Or;function k2(e,t){We&&B.breakpoint;let r=t,n=e;if(We&&console.log(`POWER: ${e} ^ ${t}`),(0,hl.equal)(e,B.Constants.one)||(0,xt.isZeroAtomOrTensor)(t)){let d=B.Constants.One();return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if((0,hl.equal)(t,B.Constants.one))return We&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if((0,xt.isminusone)(e)&&(0,xt.isminusone)(t)){let d=(0,Ht.negate)(B.Constants.One());return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if((0,xt.isminusone)(e)&&(0,xt.isoneovertwo)(t)){let d=B.Constants.imaginaryunit;return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if((0,xt.isminusone)(e)&&(0,xt.isminusoneovertwo)(t)){let d=(0,Ht.negate)(B.Constants.imaginaryunit);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let o;if((0,xt.isminusone)(e)&&!(0,B.isdouble)(e)&&(0,B.isrational)(t)&&!(0,xt.isinteger)(t)&&(0,xt.ispositivenumber)(t)&&!B.defs.evaluatingAsFloats){We&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?o=(0,zs.makeList)((0,Yt.symbol)(B.POWER),e,t):(o=(0,zs.makeList)((0,Yt.symbol)(B.MULTIPLY),e,(0,zs.makeList)((0,Yt.symbol)(B.POWER),e,(0,Ar.rational)(t.q.a.mod(t.q.b),t.q.b))),We&&console.log(` trick applied : ${o}`));let d=(0,Og.rect)(o);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if((0,B.isrational)(e)&&(0,B.isrational)(t)){We&&console.log("   power: isrational(base) && isrational(exponent)");let d=(0,L2.qpow)(e,t);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if((0,B.isNumericAtom)(e)&&(0,B.isNumericAtom)(t)){let d=(0,w2.dpow)((0,Ar.nativeDouble)(e),(0,Ar.nativeDouble)(t));return We&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if((0,B.istensor)(e)){let d=(0,P2.power_tensor)(e,t);return We&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if((0,B.car)(e)===(0,Yt.symbol)(B.ABS)&&(0,xt.iseveninteger)(t)&&!(0,xt.isZeroAtomOrTensor)((0,Yt.get_binding)((0,Yt.symbol)(B.ASSUME_REAL_VARIABLES)))){let d=Or((0,B.cadr)(e),t);return We&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===(0,Yt.symbol)(B.E)&&(0,B.car)(t)===(0,Yt.symbol)(B.LOG)){let d=(0,B.cadr)(t);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(e===(0,Yt.symbol)(B.E)&&(0,B.isdouble)(t)){let d=(0,Ar.double)(Math.exp(t.d));return We&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===(0,Yt.symbol)(B.E)&&(0,lc.Find)(t,B.Constants.imaginaryunit)&&(0,lc.Find)(t,(0,Yt.symbol)(B.PI))&&!B.defs.evaluatingPolar){let d=(0,zs.makeList)((0,Yt.symbol)(B.POWER),e,t);We&&console.log(`   power: turning complex exponential to rect: ${d}`);let _=(0,Og.rect)(d);if(!(0,lc.Find)(_,(0,Yt.symbol)(B.PI)))return We&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if((0,B.ismultiply)(e)&&(0,xt.isinteger)(t)){e=(0,B.cdr)(e);let d=Or((0,B.car)(e),t);return(0,B.iscons)(e)&&(d=e.tail().reduce((_,R)=>(0,Ht.multiply)(_,Or(R,t)),d)),We&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}let i=!1;if((0,B.isNumericAtom)((0,B.cadr)(e))&&(i=(0,hl.sign)((0,Ar.compare_numbers)((0,B.cadr)(e),B.Constants.zero))>0),(0,B.ispower)(e)&&((0,xt.isinteger)(t)||i)){let d=Or((0,B.cadr)(e),(0,Ht.multiply)((0,B.caddr)(e),t));return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let s=!1;if((0,xt.iseveninteger)((0,B.caddr)(e))){let d=(0,Ht.multiply)((0,B.caddr)(e),t);(0,xt.isone)(d)&&(s=!0)}if((0,B.ispower)(e)&&s){let d=(0,hg.abs)((0,B.cadr)(e));return We&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.expanding&&(0,B.isadd)(e)&&(0,B.isNumericAtom)(t)){let d=(0,Ar.nativeInt)(t);if(d>1&&!isNaN(d)){We&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=$2(d,e);return We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if(B.defs.trigmode===1&&(0,B.car)(e)===(0,Yt.symbol)(B.SIN)&&(0,xt.iseveninteger)(t)){let d=Or((0,uc.subtract)(B.Constants.one,Or((0,R2.cosine)((0,B.cadr)(e)),(0,Ar.integer)(2))),(0,Ht.multiply)(t,(0,Ar.rational)(1,2)));return We&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.trigmode===2&&(0,B.car)(e)===(0,Yt.symbol)(B.COS)&&(0,xt.iseveninteger)(t)){let d=Or((0,uc.subtract)(B.Constants.one,Or((0,C2.sine)((0,B.cadr)(e)),(0,Ar.integer)(2))),(0,Ht.multiply)(t,(0,Ar.rational)(1,2)));return We&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if((0,xt.iscomplexnumber)(e)){if(We&&console.log(" power - handling the case (a + ib) ^ n"),(0,xt.isinteger)(t)){let d=(0,S2.conjugate)(e),_=(0,Ht.divide)(d,(0,Ht.multiply)(d,e));return(0,xt.isone)(t)||(_=Or(_,(0,Ht.negate)(t))),We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if((0,B.isNumericAtom)(t)){let d=B.defs.evaluatingAsFloats||(0,xt.iscomplexnumberdouble)(e)&&(0,B.isdouble)(t)?(0,Ar.double)(Math.PI):(0,Yt.symbol)(B.PI),_=(0,Ht.multiply)(Or((0,hg.abs)(e),t),Or(B.Constants.negOne,(0,Ht.divide)((0,Ht.multiply)((0,I2.arg)(e),t),d)));return B.avoidCalculatingPowersIntoArctans&&(0,lc.Find)(_,(0,Yt.symbol)(B.ARCTAN))&&(_=(0,zs.makeList)((0,Yt.symbol)(B.POWER),e,t)),We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=U2(t);if(u!==void 0)return We&&console.log("   power: using simplify_polar"),u;let c=(0,zs.makeList)((0,Yt.symbol)(B.POWER),e,t);return We&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function $2(e,t){let r=[],n=(0,hl.length)(t)-1,o=[];t=(0,B.cdr)(t);for(let i=0;i<n;i++){for(let s=0;s<=e;s++)o[i*(e+1)+s]=Or((0,B.car)(t),(0,Ar.integer)(s));t=(0,B.cdr)(t)}t=(0,Mg.factorial)((0,Ar.integer)(e));for(let i=0;i<n;i++)r[i]=0;return Tg(n,e,r,0,e,o,t,B.Constants.zero)}function Tg(e,t,r,n,o,i,s,u){if(n<e-1){for(let d=0;d<=o;d++)r[n]=d,u=Tg(e,t,r,n+1,o-d,i,s,u);return u}r[n]=o;let c=s;for(let d=0;d<e;d++)c=(0,Ht.divide)(c,(0,Mg.factorial)((0,Ar.integer)(r[d])));for(let d=0;d<e;d++)c=(0,Ht.multiply)(c,i[d*(t+1)+r[d]]);return(0,uc.add)(u,c)}function U2(e){let t=(0,xt.isquarterturn)(e);switch(t){case 0:break;case 1:return B.Constants.one;case 2:return B.Constants.negOne;case 3:return B.Constants.imaginaryunit;case 4:return(0,Ht.negate)(B.Constants.imaginaryunit)}if((0,B.isadd)(e)){let r=(0,B.cdr)(e);for(;(0,B.iscons)(r)&&(t=(0,xt.isquarterturn)((0,B.car)(r)),!t);)r=(0,B.cdr)(r);let n;switch(t){case 0:return;case 1:n=B.Constants.one;break;case 2:n=B.Constants.negOne;break;case 3:n=B.Constants.imaginaryunit;break;case 4:n=(0,Ht.negate)(B.Constants.imaginaryunit);break}return(0,Ht.multiply)(n,(0,hl.exponential)((0,uc.subtract)(e,(0,B.car)(r))))}}});var Z=A(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.negate_noexpand=St.negate=St.reciprocate=St.inverse=St.divide=St.multiply_all_noexpand=St.multiply_all=St.multiply_noexpand=St.multiply=St.Eval_multiply=void 0;var D=N(),B2=lo(),Sg=Ee(),$o=U(),G2=Ne(),Ol=ue(),ao=F(),Ng=G(),lr=H(),Vs=K(),Rg=Et(),Ig=qt();function F2(e){let t=(0,Ng.Eval)((0,D.cadr)(e));return e=(0,D.cddr)(e),(0,D.iscons)(e)&&(t=[...e].reduce((r,n)=>Uo(r,(0,Ng.Eval)(n)),t)),t}St.Eval_multiply=F2;function Uo(e,t){return D.defs.esc_flag&&(0,Sg.stop)("escape key stop"),(0,D.isNumericAtom)(e)&&(0,D.isNumericAtom)(t)?(0,ao.multiply_numbers)(e,t):j2(e,t)}St.multiply=Uo;function j2(e,t){if((0,lr.isZeroAtom)(e)||(0,lr.isZeroAtom)(t))return D.Constants.Zero();if(D.defs.expanding&&(0,D.isadd)(e))return e.tail().reduce((c,d)=>(0,Ol.add)(c,Uo(d,t)),D.Constants.Zero());if(D.defs.expanding&&(0,D.isadd)(t))return t.tail().reduce((c,d)=>(0,Ol.add)(c,Uo(e,d)),D.Constants.Zero());if(!(0,D.istensor)(e)&&(0,D.istensor)(t))return(0,Ig.scalar_times_tensor)(e,t);if((0,D.istensor)(e)&&!(0,D.istensor)(t))return(0,Ig.tensor_times_scalar)(e,t);e=(0,D.ismultiply)(e)?(0,D.cdr)(e):(0,Vs.makeList)(e),t=(0,D.ismultiply)(t)?(0,D.cdr)(t):(0,Vs.makeList)(t);let r=[];if((0,D.isNumericAtom)((0,D.car)(e))&&(0,D.isNumericAtom)((0,D.car)(t))){let c=(0,D.car)(e),d=(0,D.car)(t);r.push((0,ao.multiply_numbers)(c,d)),e=(0,D.cdr)(e),t=(0,D.cdr)(t)}else(0,D.isNumericAtom)((0,D.car)(e))?(r.push((0,D.car)(e)),e=(0,D.cdr)(e)):(0,D.isNumericAtom)((0,D.car)(t))?(r.push((0,D.car)(t)),t=(0,D.cdr)(t)):r.push(D.Constants.One());let[n,o]=cc(e),[i,s]=fc(t);for(;(0,D.iscons)(e)&&(0,D.iscons)(t);){if((0,D.caar)(e)===(0,$o.symbol)(D.OPERATOR)&&(0,D.caar)(t)===(0,$o.symbol)(D.OPERATOR)){r.push(new D.Cons((0,$o.symbol)(D.OPERATOR),(0,B2.append)((0,D.cdar)(e),(0,D.cdar)(t)))),e=(0,D.cdr)(e),t=(0,D.cdr)(t),[n,o]=cc(e),[i,s]=fc(t);continue}switch((0,G2.cmp_expr)(n,i)){case-1:r.push((0,D.car)(e)),e=(0,D.cdr)(e),[n,o]=cc(e);break;case 1:r.push((0,D.car)(t)),t=(0,D.cdr)(t),[i,s]=fc(t);break;case 0:z2(r,i,o,s),e=(0,D.cdr)(e),t=(0,D.cdr)(t),[n,o]=cc(e),[i,s]=fc(t);break;default:(0,Sg.stop)("internal error 2")}}if((0,D.iscons)(e)&&r.push(...e),(0,D.iscons)(t)&&r.push(...t),H2(r),D.defs.expanding){for(let c=0;c<r.length;c++)if((0,D.isadd)(r[c]))return md(r)}let u=r.length;return u===1?r.pop():(0,D.isrational)(r[0])&&(0,lr.equaln)(r[0],1)?u===2?r.pop():(r[0]=(0,$o.symbol)(D.MULTIPLY),(0,Vs.makeList)(...r)):new D.Cons((0,$o.symbol)(D.MULTIPLY),(0,Vs.makeList)(...r))}function cc(e){let t=(0,D.car)(e),r=D.Constants.One();return(0,D.ispower)(t)&&(r=(0,D.caddr)(t),t=(0,D.cadr)(t)),[t,r]}function fc(e){let t=(0,D.car)(e),r=D.Constants.One();return(0,D.ispower)(t)&&(r=(0,D.caddr)(t),t=(0,D.cadr)(t)),[t,r]}function z2(e,t,r,n){let o=(0,Rg.power)(t,(0,Ol.add)(r,n));if((0,D.isNumericAtom)(o))e[0]=(0,ao.multiply_numbers)(e[0],o);else if((0,D.ismultiply)(o))if((0,D.isNumericAtom)((0,D.cadr)(o))&&(0,D.cdddr)(o)===(0,$o.symbol)(D.NIL)){let i=e[0],s=(0,D.cadr)(o);e[0]=(0,ao.multiply_numbers)(i,s),e.push((0,D.caddr)(o))}else e.push(o);else e.push(o)}function Y2(e,t){return(0,D.noexpand)(Uo,e,t)}St.multiply_noexpand=Y2;function md(e){if(e.length===1)return e[0];if(e.length===0)return D.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Uo(t,e[r]);return t}St.multiply_all=md;function V2(e){return(0,D.noexpand)(md,e)}St.multiply_all_noexpand=V2;function Al(e,t){return(0,D.isNumericAtom)(e)&&(0,D.isNumericAtom)(t)?(0,ao.divide_numbers)(e,t):Uo(e,_d(t))}St.divide=Al;function _d(e){return(0,D.isNumericAtom)(e)?(0,ao.invert_number)(e):(0,Rg.power)(e,D.Constants.negOne)}St.inverse=_d;function Z2(e){return _d(e)}St.reciprocate=Z2;function wg(e){return(0,D.isNumericAtom)(e)?(0,ao.negate_number)(e):Uo(e,D.Constants.NegOne())}St.negate=wg;function X2(e){return(0,D.noexpand)(wg,e)}St.negate_noexpand=X2;function H2(e){let t=0;if((0,lr.isplusone)(e[0])||(0,lr.isminusone)(e[0])||(0,D.isdouble)(e[0]))return;for(t=1;t<e.length&&!dd(e[t]);t++);if(t===e.length)return;let r=(0,ao.mp_numerator)(e[0]);for(let o=1;o<e.length&&!((0,lr.isplusone)(r)||(0,lr.isminusone)(r));o++){if(!dd(e[o]))continue;let i=(0,D.cadr)(e[o]),s=(0,D.caddr)(e[o]);if(!(0,lr.isnegativenumber)(s))continue;let u=Al(r,i);!(0,lr.isinteger)(u)||(r=u,e[o]=(0,Vs.makeList)((0,$o.symbol)(D.POWER),i,(0,Ol.add)(D.Constants.One(),s)))}let n=(0,ao.mp_denominator)(e[0]);for(let o=1;o<e.length&&!(0,lr.isplusone)(n);o++){if(!dd(e[o]))continue;let i=(0,D.cadr)(e[o]),s=(0,D.caddr)(e[o]);if((0,lr.isnegativenumber)(s))continue;let u=Al(n,i);if(!(0,lr.isinteger)(u))continue;n=u;let c=(0,Ol.subtract)(s,D.Constants.one);if(D.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&(0,lr.isinteger)(i)&&!(0,lr.isinteger)(c)&&(0,lr.isnegativenumber)(c)){r=Al(r,i);break}e[o]=(0,Vs.makeList)((0,$o.symbol)(D.POWER),i,c)}e[0]=Al(r,n)}function dd(e){return(0,D.ispower)(e)&&(0,D.isNumericAtom)((0,D.cadr)(e))&&(0,lr.isfraction)((0,D.caddr)(e))&&!(0,lr.isminusone)((0,D.cadr)(e))}});var mc=A(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.determinant=Zs.det=void 0;var Bo=N(),Lg=Ne(),Cg=ue(),Q2=F(),W2=K(),hi=Z(),J2=qt(),K2=U();function eA(e){if(!(0,J2.is_square_matrix)(e))return(0,W2.makeList)((0,K2.symbol)(Bo.DET),e);let t=e.tensor.elem;return t.every(n=>(0,Bo.isNumericAtom)(n))?tA(e):Pg(t,e.tensor.dim[0])}Zs.det=eA;function Pg(e,t){let r=0,n=[];for(let s=0;s<t;s++)n[s]=s,n[s+t]=0,n[s+t+t]=1;let o=1,i=Bo.Constants.zero;for(;;){let s=(0,Q2.integer)(o);for(let R=0;R<t;R++){let T=t*n[R]+R;s=(0,hi.multiply)(s,e[T])}i=(0,Cg.add)(i,s);let u=t-1,c=0,d=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){d=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(d)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,o=o===1?-1:1}return i}Zs.determinant=Pg;function tA(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return rA(r,t)}function Nn(e,t,r,n){return e[t*r+n]}function dc(e,t,r,n,o){e[t*r+n]=o}function rA(e,t){let r=Bo.Constants.one;for(let n=0;n<t-1;n++){if((0,Lg.equal)(Nn(e,t,n,n),Bo.Constants.zero)){let o=0;for(o=n+1;o<t&&(0,Lg.equal)(Nn(e,t,o,n),Bo.Constants.zero);o++);if(o===t){r=Bo.Constants.zero;break}for(let i=n;i<t;i++){let s=Nn(e,t,n,i);dc(e,t,n,i,Nn(e,t,o,i)),dc(e,t,o,i,s)}r=(0,hi.negate)(r)}r=(0,hi.multiply)(r,Nn(e,t,n,n));for(let o=n+1;o<t;o++){let i=(0,hi.negate)((0,hi.divide)(Nn(e,t,o,n),Nn(e,t,n,n)));dc(e,t,o,n,Bo.Constants.zero);for(let s=n+1;s<t;s++){let u=(0,Cg.add)((0,hi.multiply)(Nn(e,t,n,s),i),Nn(e,t,o,s));dc(e,t,o,s,u)}}}return(0,hi.multiply)(r,Nn(e,t,t-1,t-1))}});var vd=A(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.hermite=void 0;var Xs=N(),bd=U(),nA=ue(),yd=F(),oA=G(),iA=K(),gd=Z(),sA=Yr();function aA(e,t){return lA(e,t)}_c.hermite=aA;function lA(e,t){let r=(0,yd.nativeInt)(t);return r<0||isNaN(r)?(0,iA.makeList)((0,bd.symbol)(Xs.HERMITE),e,t):(0,Xs.issymbol)(e)?Dg(r,e):(0,oA.Eval)((0,sA.subst)(Dg(r,(0,bd.symbol)(Xs.SECRETX)),(0,bd.symbol)(Xs.SECRETX),e))}function Dg(e,t){let r=Xs.Constants.zero,n=Xs.Constants.one;for(let o=0;o<e;o++){let i=r;r=n,n=(0,gd.multiply)((0,nA.subtract)((0,gd.multiply)(t,r),(0,gd.multiply)((0,yd.integer)(o),i)),(0,yd.integer)(2))}return n}});var $g=A(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.hilbert=void 0;var uA=N(),cA=Ne(),kg=F(),fA=K(),dA=Z(),mA=U();function _A(e){let t=(0,kg.nativeInt)(e);if(t<2)return(0,fA.makeList)((0,mA.symbol)(uA.HILBERT),e);let r=(0,cA.zero_matrix)(t,t);for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[n*t+o]=(0,dA.inverse)((0,kg.integer)(n+o+1));return r}bc.hilbert=_A});var pd=A(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.cofactor=Hs.Eval_cofactor=void 0;var qd=N(),Ed=Ee(),bA=mc(),xd=G(),gA=Z(),yA=qt();function vA(e){let t=(0,xd.Eval)((0,qd.cadr)(e));(0,yA.is_square_matrix)(t)||(0,Ed.stop)("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=(0,xd.evaluate_integer)((0,qd.caddr)(e));(n<1||n>r)&&(0,Ed.stop)("cofactor: 2nd arg: row index expected");let o=(0,xd.evaluate_integer)((0,qd.cadddr)(e));return(o<1||o>r)&&(0,Ed.stop)("cofactor: 3rd arg: column index expected"),Ug(t,r,n-1,o-1)}Hs.Eval_cofactor=vA;function Ug(e,t,r,n){let o=[];for(let s=0;s<t;s++)for(let u=0;u<t;u++)s!==r&&u!==n&&o.push(e.tensor.elem[t*s+u]);let i=(0,bA.determinant)(o,t-1);return(r+n)%2&&(i=(0,gA.negate)(i)),i}Hs.cofactor=Ug});var hd=A(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.adj=Qs.Eval_adj=void 0;var qA=It(),EA=N(),xA=Ee(),pA=pd(),hA=G(),AA=qt();function OA(e){return Bg((0,hA.Eval)((0,EA.cadr)(e)))}Qs.Eval_adj=OA;function Bg(e){(0,AA.is_square_matrix)(e)||(0,xA.stop)("adj: square matrix expected");let t=e.tensor.dim[0],r=(0,qA.alloc_tensor)(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[t*o+n]=(0,pA.cofactor)(e,t,n,o);return r}Qs.adj=Bg});var Go=A(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.inner=Ws.Eval_inner=void 0;var MA=It(),ce=N(),Od=Ee(),Zr=U(),Ml=ue(),Ad=G(),jg=Il(),Tl=H(),Md=K(),gc=Z(),Gg=qt();function zg(e){let t=[];t.push((0,ce.car)((0,ce.cdr)(e))),(0,ce.car)((0,ce.cdr)((0,ce.cdr)(e)))===(0,Zr.symbol)(ce.NIL)&&(0,Od.stop)("pattern needs at least a template and a transformed version");let n=(0,ce.cdr)((0,ce.cdr)(e));for(;n!==(0,Zr.symbol)(ce.NIL);)t.push((0,ce.car)(n)),n=(0,ce.cdr)(n);if(t.length>2){let s=(0,Md.makeList)((0,Zr.symbol)(ce.INNER),t[t.length-2],t[t.length-1]);for(let u=2;u<t.length;u++)s=(0,Md.makeList)((0,Zr.symbol)(ce.INNER),t[t.length-u-1],s);return zg(s)}let o=[];yc(e,o);let i=[];for(let s=0;s<o.length;s++)o[s]!==(0,Zr.symbol)(ce.SYMBOL_IDENTITY_MATRIX)&&i.push(o[s]);if(o=i,i=[],o.length>1){let s=0;for(let u=0;u<o.length&&u+s+1<=o.length-1;u++){if((0,ce.isNumericAtomOrTensor)(o[u+s])||(0,ce.isNumericAtomOrTensor)(o[u+s+1]))i.push(o[u+s]);else{let c=(0,jg.inv)((0,Ad.Eval)(o[u+s])),d=(0,Ad.Eval)(o[u+s+1]),_=(0,Ml.subtract)(c,d);(0,Tl.isZeroAtomOrTensor)(_)?s+=1:i.push(o[u+s])}if(u+s===o.length-2&&i.push(o[o.length-1]),u+s>=o.length-1)break}o=i}return o.length==0?(0,Zr.symbol)(ce.SYMBOL_IDENTITY_MATRIX):(o=o.map(Ad.Eval),o.reduce(Nl))}Ws.Eval_inner=zg;function Nl(e,t){if((0,Tl.isnegativeterm)(t)&&(0,Tl.isnegativeterm)(e)&&(t=(0,gc.negate)(t),e=(0,gc.negate)(e)),(0,ce.isinnerordot)(e)&&(t=Nl((0,ce.car)((0,ce.cdr)((0,ce.cdr)(e))),t),e=(0,ce.car)((0,ce.cdr)(e))),e===(0,Zr.symbol)(ce.SYMBOL_IDENTITY_MATRIX))return t;if(t===(0,Zr.symbol)(ce.SYMBOL_IDENTITY_MATRIX))return e;if((0,ce.istensor)(e)&&(0,ce.istensor)(t))return TA(e,t);if(!((0,ce.isNumericAtomOrTensor)(e)||(0,ce.isNumericAtomOrTensor)(t))){let r=(0,Ml.subtract)(e,(0,jg.inv)(t));if((0,Tl.isZeroAtomOrTensor)(r))return(0,Zr.symbol)(ce.SYMBOL_IDENTITY_MATRIX)}return ce.defs.expanding&&(0,ce.isadd)(e)?e.tail().reduce((r,n)=>(0,Ml.add)(r,Nl(n,t)),ce.Constants.zero):ce.defs.expanding&&(0,ce.isadd)(t)?t.tail().reduce((r,n)=>(0,Ml.add)(r,Nl(e,n)),ce.Constants.zero):(0,ce.istensor)(e)&&(0,ce.isNumericAtom)(t)?(0,Gg.tensor_times_scalar)(e,t):(0,ce.isNumericAtom)(e)&&(0,ce.istensor)(t)?(0,Gg.scalar_times_tensor)(e,t):(0,ce.isNumericAtom)(e)||(0,ce.isNumericAtom)(t)?(0,gc.multiply)(e,t):(0,Md.makeList)((0,Zr.symbol)(ce.INNER),e,t)}Ws.inner=Nl;function TA(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(ce.breakpoint,(0,Od.stop)("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>ce.MAXDIM&&(0,Od.stop)("inner: rank of result exceeds maximum");let o=e.tensor.elem,i=t.tensor.elem,s=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,R)=>_*R,1),u=t.tensor.dim.slice(1).reduce((_,R)=>_*R,1),c=(0,MA.alloc_tensor)(s*u),d=c.tensor.elem;for(let _=0;_<s;_++)for(let R=0;R<r;R++)if(!(0,Tl.isZeroAtomOrTensor)(o[_*r+R]))for(let T=0;T<u;T++)d[_*u+T]=(0,Ml.add)((0,gc.multiply)(o[_*r+R],i[R*u+T]),d[_*u+T]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function yc(e,t){if(!(0,ce.iscons)(e)){Fg(e,t);return}if((0,ce.cdr)(e)===(0,Zr.symbol)(ce.NIL)){yc((0,ce.car)(e),t);return}if((0,ce.isinnerordot)(e)){yc((0,ce.car)((0,ce.cdr)(e)),t),yc((0,ce.cdr)((0,ce.cdr)(e)),t);return}Fg(e,t)}function Fg(e,t){e!==(0,Zr.symbol)(ce.NIL)&&t.push(e)}});var Il=A(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.invg=Js.inv=void 0;var NA=It(),Mr=N(),Zg=Ee(),Yg=Ne(),Vg=ue(),IA=hd(),SA=mc(),RA=Go(),wA=H(),Xg=K(),Sl=Z(),Hg=qt(),Qg=U();function Wg(e){if((0,Mr.isinv)(e))return(0,Mr.car)((0,Mr.cdr)(e));if((0,Mr.isidentitymatrix)(e))return e;if(Mr.defs.expanding&&(0,Mr.isinnerordot)(e)){let n=((0,Mr.iscons)(e)?e.tail():[]).map(Wg);for(let o=n.length-1;o>0;o--)n[o-1]=(0,RA.inner)(n[o],n[o-1]);return n[0]}if(!(0,Hg.is_square_matrix)(e))return(0,Xg.makeList)((0,Qg.symbol)(Mr.INV),e);if((0,Mr.isNumericAtomOrTensor)(e))return Jg(e);let t=(0,SA.det)(e);return(0,wA.isZeroAtomOrTensor)(t)&&(0,Zg.stop)("inverse of singular matrix"),(0,Sl.divide)((0,IA.adj)(e),t)}Js.inv=Wg;function LA(e){return(0,Hg.is_square_matrix)(e)?Jg(e):(0,Xg.makeList)((0,Qg.symbol)(Mr.INVG),e)}Js.invg=LA;function Jg(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Mr.Constants.zero);for(let i=0;i<t;i++)r[i*t+i]=Mr.Constants.one;let n=CA(r,e.tensor.elem,t),o=(0,NA.alloc_tensor)(t*t);return o.tensor.ndim=2,o.tensor.dim[0]=t,o.tensor.dim[1]=t,o.tensor.elem=n,o}function CA(e,t,r){for(let n=0;n<r;n++){if((0,Yg.equal)(t[r*n+n],Mr.Constants.zero)){let i=0;for(i=n+1;i<r&&(0,Yg.equal)(t[r*i+n],Mr.Constants.zero);i++);i===r&&(0,Zg.stop)("inverse of singular matrix");for(let s=0;s<r;s++){let u=t[r*n+s];t[r*n+s]=t[r*i+s],t[r*i+s]=u,u=e[r*n+s],e[r*n+s]=e[r*i+s],e[r*i+s]=u}}let o=t[r*n+n];for(let i=0;i<r;i++)i>n&&(t[r*n+i]=(0,Sl.divide)(t[r*n+i],o)),e[r*n+i]=(0,Sl.divide)(e[r*n+i],o);for(let i=0;i<r;i++){if(i===n)continue;let s=t[r*i+n];for(let u=0;u<r;u++)u>n&&(t[r*i+u]=(0,Vg.subtract)(t[r*i+u],(0,Sl.multiply)(t[r*n+u],s))),e[r*i+u]=(0,Vg.subtract)(e[r*i+u],(0,Sl.multiply)(e[r*n+u],s))}}return e}});var Nd=A(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.besselj=Ks.Eval_besselj=void 0;var Qt=N(),PA=lo(),Rl=U(),vc=ue(),cn=F(),DA=Lo(),Kg=G(),wl=H(),Td=K(),ur=Z(),Ll=Et(),kA=Qn();function $A(e){return qc((0,Kg.Eval)((0,Qt.cadr)(e)),(0,Kg.Eval)((0,Qt.caddr)(e)))}Ks.Eval_besselj=$A;function qc(e,t){return UA(e,t)}Ks.besselj=qc;function UA(e,t){let r=(0,cn.nativeInt)(t);if((0,Qt.isdouble)(e)&&!isNaN(r)){let n=(0,PA.jn)(r,e.d);return(0,cn.double)(n)}if((0,wl.isZeroAtomOrTensor)(e)&&(0,wl.isZeroAtomOrTensor)(t))return Qt.Constants.one;if((0,wl.isZeroAtomOrTensor)(e)&&!isNaN(r))return Qt.Constants.zero;if(t.k===Qt.NUM&&(0,Qt.MEQUAL)(t.q.b,2)){if((0,Qt.MEQUAL)(t.q.a,1)){let o=Qt.defs.evaluatingAsFloats?(0,cn.double)(2/Math.PI):(0,ur.divide)((0,cn.integer)(2),(0,Rl.symbol)(Qt.PI));return(0,ur.multiply)((0,Ll.power)((0,ur.divide)(o,e),(0,cn.rational)(1,2)),(0,kA.sine)(e))}if((0,Qt.MEQUAL)(t.q.a,-1)){let o=Qt.defs.evaluatingAsFloats?(0,cn.double)(2/Math.PI):(0,ur.divide)((0,cn.integer)(2),(0,Rl.symbol)(Qt.PI));return(0,ur.multiply)((0,Ll.power)((0,ur.divide)(o,e),(0,cn.rational)(1,2)),(0,DA.cosine)(e))}let n=(0,cn.integer)((0,Qt.MSIGN)(t.q.a));return(0,vc.subtract)((0,ur.multiply)((0,ur.multiply)((0,ur.divide)((0,cn.integer)(2),e),(0,vc.subtract)(t,n)),qc(e,(0,vc.subtract)(t,n))),qc(e,(0,vc.subtract)(t,(0,ur.multiply)((0,cn.integer)(2),n))))}return(0,wl.isnegativeterm)(e)?(0,ur.multiply)((0,ur.multiply)((0,Ll.power)((0,ur.negate)(e),t),(0,Ll.power)(e,(0,ur.negate)(t))),(0,Td.makeList)((0,Rl.symbol)(Qt.BESSELJ),(0,ur.negate)(e),t)):(0,wl.isnegativeterm)(t)?(0,ur.multiply)((0,Ll.power)(Qt.Constants.negOne,t),(0,Td.makeList)((0,Rl.symbol)(Qt.BESSELJ),e,(0,ur.negate)(t))):(0,Td.makeList)((0,Rl.symbol)(Qt.BESSELJ),e,t)}});var Id=A(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.bessely=ta.Eval_bessely=void 0;var ea=N(),BA=lo(),ey=U(),ty=F(),ry=G(),GA=H(),ny=K(),oy=Z(),FA=Et();function jA(e){return iy((0,ry.Eval)((0,ea.cadr)(e)),(0,ry.Eval)((0,ea.caddr)(e)))}ta.Eval_bessely=jA;function iy(e,t){return zA(e,t)}ta.bessely=iy;function zA(e,t){let r=(0,ty.nativeInt)(t);if((0,ea.isdouble)(e)&&!isNaN(r)){let n=(0,BA.yn)(r,e.d);return(0,ty.double)(n)}return(0,GA.isnegativeterm)(t)?(0,oy.multiply)((0,FA.power)(ea.Constants.negOne,t),(0,ny.makeList)((0,ey.symbol)(ea.BESSELY),e,(0,oy.negate)(t))):(0,ny.makeList)((0,ey.symbol)(ea.BESSELY),e,t)}});var Sd=A(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.ycosh=ra.Eval_cosh=void 0;var Ai=N(),sy=U(),YA=F(),VA=G(),ZA=H(),XA=K();function HA(e){return ay((0,VA.Eval)((0,Ai.cadr)(e)))}ra.Eval_cosh=HA;function ay(e){if((0,Ai.car)(e)===(0,sy.symbol)(Ai.ARCCOSH))return(0,Ai.cadr)(e);if((0,Ai.isdouble)(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),(0,YA.double)(t)}return(0,ZA.isZeroAtomOrTensor)(e)?Ai.Constants.one:(0,XA.makeList)((0,sy.symbol)(Ai.COSH),e)}ra.ycosh=ay});var Cd=A(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.dirac=na.Eval_dirac=void 0;var Er=N(),Rd=U(),QA=G(),wd=H(),Ld=K(),WA=ln(),ly=Z();function JA(e){return uy((0,QA.Eval)((0,Er.cadr)(e)))}na.Eval_dirac=JA;function uy(e){return KA(e)}na.dirac=uy;function KA(e){return(0,Er.isdouble)(e)?e.d===0?Er.Constants.one:Er.Constants.zero:(0,Er.isrational)(e)?(0,Er.MZERO)((0,WA.mmul)(e.q.a,e.q.b))?Er.Constants.one:Er.Constants.zero:(0,Er.ispower)(e)?(0,Ld.makeList)((0,Rd.symbol)(Er.DIRAC),(0,Er.cadr)(e)):(0,wd.isnegativeterm)(e)?(0,Ld.makeList)((0,Rd.symbol)(Er.DIRAC),(0,ly.negate)(e)):(((0,wd.isnegativeterm)(e)||(0,Er.isadd)(e)&&(0,wd.isnegativeterm)((0,Er.cadr)(e)))&&(e=(0,ly.negate)(e)),(0,Ld.makeList)((0,Rd.symbol)(Er.DIRAC),e))}});var fy=A(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.partition=void 0;var Pd=N(),eO=ir(),cy=Z();function tO(e,t){let r=Pd.Constants.one,n=r;if(e=(0,Pd.cdr)(e),!(0,Pd.iscons)(e))return[r,n];for(let o of e)(0,eO.Find)(o,t)?n=(0,cy.multiply)(n,o):r=(0,cy.multiply)(r,o);return[r,n]}Ec.partition=tO});var Yo=A(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.scan_meta=aa.scan=void 0;var rO=It(),Q=N(),Fo=lo(),nO=Ee(),dt=U(),dy=F(),oO=H(),Vt=K(),xc=Z(),iO=qt(),Fd=1001,jd=1002,pc=1003,zd=1004,$d=1006,Yd=1007,_y=1008,by=1009,gy=1010,yy=1011,Ud=1012,ee="",Dl=0,Vd=0,Xr=0,W=0,ia=0,ft="",hc=null,Ze=null,Pl=null,zo=null,sa=null,Je=null,jo=!1,Bd=null,ge="";function sO(e){Q.DEBUG&&console.log(`#### scanning ${e}`),hc=null,Ze=[],Pl=[],zo=!0,sa=[],Je=[""],Bd=!1,ge=e,Vd=0;let t=Q.defs.expanding;if(Q.defs.expanding=!0,Xr=0,W=0,Ce(),ee==="")return Q.defs.expanding=t,[0,(0,dt.symbol)(Q.NIL)];let r=co();return Q.defs.expanding=t,Bd||(Q.defs.symbolsInExpressionsWithoutAssignments=Q.defs.symbolsInExpressionsWithoutAssignments.concat(Pl)),[ia-Xr,r]}aa.scan=sO;function aO(e){ge=e,Vd=1;let t=Q.defs.expanding;if(Q.defs.expanding=!0,Xr=0,W=0,Ce(),ee==="")return Q.defs.expanding=t,(0,dt.symbol)(Q.NIL);let r=co();return Q.defs.expanding=t,r}aa.scan_meta=aO;function co(){let e=my(),t=!1;if(ee===Ud&&(t=!0),ee===Ud||ee==="="){let r=hc;Q.DEBUG&&console.log("assignment!"),Bd=!0,zo=!1,Ce();let n=my();if(t&&(n=(0,Vt.makeList)((0,dt.symbol)(Q.QUOTE),n)),e=(0,Vt.makeList)((0,dt.symbol)(Q.SETQ),e,n),zo=!0,Q.defs.codeGen){let o=Ze.indexOf(r);if(o!==-1&&(Ze.splice(o,1),Q.defs.symbolsHavingReassignments.push(r)),Q.DEBUG){console.log(`locally, ${r} depends on: `);for(let s of Array.from(Ze))console.log(`  ${s}`)}Q.defs.symbolsDependencies[r]==null&&(Q.defs.symbolsDependencies[r]=[]);let i=Q.defs.symbolsDependencies[r];for(let s of Array.from(Ze))i.indexOf(s)===-1&&i.push(s);Ze=[]}}return e}function my(){let e=uo(),t;switch(ee){case gy:return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.TESTEQ),e,t);case yy:return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.NOT),(0,Vt.makeList)((0,dt.symbol)(Q.TESTEQ),e,t));case by:return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.TESTLE),e,t);case _y:return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.TESTGE),e,t);case"<":return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.TESTLT),e,t);case">":return Ce(),t=uo(),(0,Vt.makeList)((0,dt.symbol)(Q.TESTGT),e,t)}return e}function uo(){let e=[(0,dt.symbol)(Q.ADD)];switch(ee){case"+":Ce(),e.push(Cl());break;case"-":Ce(),e.push((0,xc.negate)(Cl()));break;default:e.push(Cl())}for(;Dl===0&&(ee==="+"||ee==="-");)ee==="+"?(Ce(),e.push(Cl())):(Ce(),e.push((0,xc.negate)(Cl())));return e.length===2?e[1]:(0,Vt.makeList)(...e)}function Zd(){if(typeof ee=="string")return ee.charCodeAt(0)}function lO(){if(Zd()===Q.dotprod_unicode)return!0;switch(ee){case"*":case"/":return!0;case"(":case pc:case zd:case Fd:case jd:case Yd:return Dl?(W=ia,!1):!0}return!1}function Dd(e){e.length>0&&(0,Q.isrational)(e[e.length-1])&&(0,oO.equaln)(e[e.length-1],1)&&e.pop()}function uO(e){if(e.length>1&&(0,Q.isNumericAtom)(e[e.length-2])&&(0,Q.isNumericAtom)(e[e.length-1])){let t=e.pop(),r=e.pop();e.push((0,xc.multiply)(r,t))}}function Cl(){let e=[oa()];for(Q.parse_time_simplifications&&Dd(e);lO();)ee==="*"?(Ce(),e.push(oa())):ee==="/"?(Dd(e),Ce(),e.push((0,xc.inverse)(oa()))):Zd()===Q.dotprod_unicode?(Ce(),e.push((0,Vt.makeList)((0,dt.symbol)(Q.INNER),e.pop(),oa()))):e.push(oa()),Q.parse_time_simplifications&&(uO(e),Dd(e));return e.length===0?Q.Constants.one:e.length==1?e[0]:(0,Vt.makeList)((0,dt.symbol)(Q.MULTIPLY),...e)}function cO(e){return ee==="^"?(Ce(),(0,Vt.makeList)((0,dt.symbol)(Q.POWER),e,oa())):e}function fO(e){Ce();let t=[(0,dt.symbol)(Q.INDEX),e,uo()];for(;ee===",";)Ce(),t.push(uo());return ee!=="]"&&In("] expected"),Ce(),(0,Vt.makeList)(...t)}function oa(){let e=!1,t;for(ee==="("?t=yO():ee===pc?t=mO():ee===zd?t=bO():ee==="["?t=vO():ee===Fd?(e=!0,t=(0,dy.bignum_scan_integer)(ft),ee=Ce()):ee===jd?(e=!0,t=(0,dy.bignum_scan_float)(ft),ee=Ce()):ee===Yd?t=_O():In("syntax error");ee==="["||ee==="("&&Dl===0&&!e;)ee==="["?t=fO(t):ee==="("&&(t=gO(t));for(;ee==="!";)Ce(),t=(0,Vt.makeList)((0,dt.symbol)(Q.FACTORIAL),t);for(;Zd()===Q.transpose_unicode;)Ce(),t=(0,Vt.makeList)((0,dt.symbol)(Q.TRANSPOSE),t);return cO(t)}function Gd(e){if(Q.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Ze.indexOf(e)===-1&&Ze.indexOf("'"+e)===-1&&!jo){Q.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<Je.length;r++)Je[r]!==""&&(t+=Je[r]+"_"+r+"_");e=t+e,Ze.push(e)}}function dO(e){if(Q.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Pl.indexOf(e)===-1&&Pl.indexOf("'"+e)===-1&&!jo){Q.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<Je.length;r++)Je[r]!==""&&(t+=Je[r]+"_"+r+"_");e=t+e,Pl.push(e)}}function mO(){ee!==pc&&In("symbol expected");let e;if(Vd&&typeof ft=="string"&&ft.length===1)switch(ft[0]){case"a":e=(0,dt.symbol)(Q.METAA);break;case"b":e=(0,dt.symbol)(Q.METAB);break;case"x":e=(0,dt.symbol)(Q.METAX);break;default:e=(0,dt.usr_symbol)(ft)}else e=(0,dt.usr_symbol)(ft);return sa.length===0?(Q.DEBUG&&console.log(`out of scanning parameters, processing ${ft}`),hc=ft,zo&&dO(ft)):(Q.DEBUG&&console.log(`still scanning parameters, skipping ${ft}`),zo&&Gd("'"+ft)),Q.DEBUG&&console.log(`found symbol: ${ft} left of assignment: ${zo}`),zo||Gd(ft),Ce(),e}function _O(){let e=new Q.Str(ft);return Ce(),e}function bO(){Q.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,r=[(0,dt.usr_symbol)(ft)],n=ft;if((n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Je.push(ft),hc=ft,zo||Gd(ft),Ce(),Ce(),sa.push(!0),ee!==")"){for(r.push(co()),e++;ee===",";)Ce(),e===2&&Je[Je.length-1].indexOf("roots")!==-1&&(Ze=Ze.filter(o=>!new RegExp("roots_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("sum")!==-1&&(Ze=Ze.filter(o=>!new RegExp("sum_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("product")!==-1&&(Ze=Ze.filter(o=>!new RegExp("product_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("for")!==-1&&(Ze=Ze.filter(o=>!new RegExp("for_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),Je[Je.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3===0)&&(Ze=Ze.filter(o=>!new RegExp("defint_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),r.push(co()),jo=!1,e++;e===2&&Je[Je.length-1].indexOf("roots")!==-1&&(Ze=Ze.filter(o=>!new RegExp("roots_"+(Je.length-1)+"_x").test(o)))}sa.pop();for(let o=0;o<=Ze.length;o++)Ze[o]!=null&&(n==="roots"&&(Ze[o]=Ze[o].replace(new RegExp("roots_"+(Je.length-1)+"_"),"")),n==="defint"&&(Ze[o]=Ze[o].replace(new RegExp("defint_"+(Je.length-1)+"_"),"")),n==="sum"&&(Ze[o]=Ze[o].replace(new RegExp("sum_"+(Je.length-1)+"_"),"")),n==="product"&&(Ze[o]=Ze[o].replace(new RegExp("product_"+(Je.length-1)+"_"),"")),n==="for"&&(Ze[o]=Ze[o].replace(new RegExp("for_"+(Je.length-1)+"_"),"")));return ee!==")"&&In(") expected"),Ce(),(n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Je.pop(),n===(0,dt.symbol)(Q.PATTERN).printname&&(Q.defs.patternHasBeenFound=!0),Q.DEBUG&&console.log("-- scan_function_call_with_function_name end"),(0,Vt.makeList)(...r)}function gO(e){Q.DEBUG&&console.log("-- scan_function_call_without_function_name start");let r=[(0,Vt.makeList)((0,dt.symbol)(Q.EVAL),e)];if(Ce(),sa.push(!0),ee!==")")for(r.push(co());ee===",";)Ce(),r.push(co());return sa.pop(),ee!==")"&&In(") expected"),Ce(),Q.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${r[r.length-1]}`),(0,Vt.makeList)(...r)}function yO(){ee!=="("&&In("( expected"),ee=Ce();let t=co();return ee!==")"&&In(") expected"),Ce(),t}function vO(){ee!=="["&&In("[ expected"),Ce();let e=[co()];for(;ee===",";)ee=Ce(),e.push(co());let t=qO(e);return ee!=="]"&&In("] expected"),Ce(),t}function In(e){for(Q.defs.errorMessage="";Xr!==W&&!((ge[Xr]===`
`||ge[Xr]==="\r")&&Xr+1===W);)Q.defs.errorMessage+=ge[Xr++];for(Q.defs.errorMessage+=" ? ";ge[Xr]&&ge[Xr]!==`
`&&ge[Xr]!=="\r";)Q.defs.errorMessage+=ge[Xr++];Q.defs.errorMessage+=`
`,(0,nO.stop)(e)}function qO(e){let t=(0,rO.alloc_tensor)(e.length);t.tensor.ndim=1,t.tensor.dim[0]=e.length;for(let r=0;r<e.length;r++)t.tensor.elem[r]=e[r];return(0,iO.check_tensor_dimensions)(t),t}function Ce(){for(Dl=0;EO(),ee===$d;)Dl=1;return Q.DEBUG&&console.log(`get_next_token token: ${ee}`),ee}function EO(){for(;(0,Fo.isspace)(ge[W]);){if(ge[W]===`
`||ge[W]==="\r"){ee=$d,W++;return}W++}if(ia=W,W===ge.length){ee="";return}if((0,Fo.isdigit)(ge[W])||ge[W]==="."){for(;(0,Fo.isdigit)(ge[W]);)W++;if(ge[W]==="."){for(W++;(0,Fo.isdigit)(ge[W]);)W++;if(ge[W]==="e"&&(ge[W+1]==="+"||ge[W+1]==="-"||(0,Fo.isdigit)(ge[W+1])))for(W+=2;(0,Fo.isdigit)(ge[W]);)W++;ee=jd}else ee=Fd;kd(ia,W);return}if((0,Fo.isalpha)(ge[W])){for(;(0,Fo.isalnumorunderscore)(ge[W]);)W++;ge[W]==="("?ee=zd:ee=pc,kd(ia,W);return}if(ge[W]==='"'){for(W++;ge[W]!=='"';)W===ge.length-1&&(W++,In("runaway string"),W--),W++;W++,ee=Yd,kd(ia+1,W-1);return}if(ge[W]==="#"||ge[W]==="-"&&ge[W+1]==="-"){for(;ge[W]&&ge[W]!==`
`&&ge[W]!=="\r";)W++;ge[W]&&W++,ee=$d;return}if(ge[W]===":"&&ge[W+1]==="="){W+=2,ee=Ud;return}if(ge[W]==="="&&ge[W+1]==="="){W+=2,ee=gy;return}if(ge[W]==="!"&&ge[W+1]==="="){W+=2,ee=yy;return}if(ge[W]==="<"&&ge[W+1]==="="){W+=2,ee=by;return}if(ge[W]===">"&&ge[W+1]==="="){W+=2,ee=_y;return}ee=ge[W++]}function kd(e,t){ft=ge.substring(e,t)}});var Rn=A(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.yyfloat=Vo.zzfloat=Vo.Eval_float=void 0;var VB=Oc(),Sn=N(),ZB=Ee(),vy=U(),qy=F(),Ac=G(),xO=K(),pO=qt();function hO(e){return(0,Sn.evalFloats)(()=>(0,Ac.Eval)(Hd((0,Ac.Eval)((0,Sn.cadr)(e)))))}Vo.Eval_float=hO;function AO(e){return(0,Sn.evalFloats)(()=>{e=(0,Ac.Eval)(e),e=Hd(e),e=(0,Ac.Eval)(e)}),e}Vo.zzfloat=AO;function Hd(e){return(0,Sn.evalFloats)(Xd,e)}Vo.yyfloat=Hd;function Xd(e){return(0,Sn.iscons)(e)?(0,xO.makeList)(...e.map(Xd)):(0,Sn.istensor)(e)?(e=(0,pO.copy_tensor)(e),e.tensor.elem=e.tensor.elem.map(Xd),e):(0,Sn.isrational)(e)?(0,qy.bignum_float)(e):e===(0,vy.symbol)(Sn.PI)?Sn.Constants.piAsDouble:e===(0,vy.symbol)(Sn.E)?(0,qy.double)(Math.E):e}});var Qd=A(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.roots=ua.Eval_roots=void 0;var OO=It(),we=N(),py=Ee(),cr=U(),MO=Ne(),Mc=on(),he=ue(),j=F(),TO=gi(),la=G(),NO=Es(),IO=Vr(),_r=H(),M=Z(),Xe=Et(),Wt=Zo(),nt={debug:e=>{we.DEBUG&&console.log(e)}},SO=e=>[].concat(...e);function RO(e){let t=(0,we.cadr)(e),r;(0,we.car)(t)===(0,cr.symbol)(we.SETQ)||(0,we.car)(t)===(0,cr.symbol)(we.TESTEQ)?r=(0,he.subtract)((0,la.Eval)((0,we.cadr)(t)),(0,la.Eval)((0,we.caddr)(t))):(t=(0,la.Eval)(t),(0,we.car)(t)===(0,cr.symbol)(we.SETQ)||(0,we.car)(t)===(0,cr.symbol)(we.TESTEQ)?r=(0,he.subtract)((0,la.Eval)((0,we.cadr)(t)),(0,la.Eval)((0,we.caddr)(t))):r=t),t=(0,la.Eval)((0,we.caddr)(e));let n=t===(0,cr.symbol)(we.NIL)?(0,IO.guess)(r):t;return(0,_r.ispolyexpandedform)(r,n)||(0,py.stop)("roots: 1st argument is not a polynomial in the variable "+n),kl(r,n)}ua.Eval_roots=RO;function wO(e){return e.some(t=>(0,_r.iscomplexnumber)(t))}function LO(e){return e.length<=2||(0,_r.isZeroAtomOrTensor)(e[0])?!1:e.slice(1,e.length-1).every(t=>(0,_r.isZeroAtomOrTensor)(t))}function Tc(e,t){let r=(0,TO.coeff)(e,t),n=r[r.length-1];return r.map(o=>(0,M.divide)(o,n))}function kl(e,t){if(we.defs.recursionLevelNestedRadicalsRemoval>1)return(0,cr.symbol)(we.NIL);nt.debug(`checking if ${e} is a case of simple roots`);let r=Tc(e,t),n=[];if(LO(r)){nt.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let s=r.length,u=r[0],c=r.pop(),d=CO(s,c,u);n.push(...d)}else{let s=PO(e,t);n.push(...s)}let o=n.length;if(o===0&&(0,py.stop)("roots: the polynomial is not factorable, try nroots"),o===1)return n[0];(0,MO.sort)(n);let i=(0,OO.alloc_tensor)(o);i.tensor.ndim=1,i.tensor.dim[0]=o;for(let s=0;s<o;s++)i.tensor.elem[s]=n[s];return console.log(`roots returning ${i}`),i}ua.roots=kl;function CO(e,t,r){nt.debug("getSimpleRoots"),e=e-1;let n=(0,M.divide)((0,Xe.power)(r,(0,j.rational)(1,e)),(0,Xe.power)(t,(0,j.rational)(1,e))),o=[];if(e%2===0){for(let i=1;i<=e;i+=2){let s=(0,M.multiply)(n,(0,Xe.power)(we.Constants.negOne,(0,j.rational)(i,e)));o.push(s),o.push((0,M.negate)(s))}return o}for(let i=1;i<=e;i++){let s=(0,M.multiply)(n,(0,Xe.power)(we.Constants.negOne,(0,j.rational)(i,e)));i%2===0&&(s=(0,M.negate)(s)),o.push(s)}return o}function PO(e,t){let r=Tc(e,t);if(wO(r)||(e=(0,NO.factorpoly)(e,t)),(0,we.ismultiply)(e)){let n=e.tail().map(o=>Ey(o,t));return SO(n)}return Ey(e,t)}function Ey(e,t){if((0,we.ispower)(e)&&(0,_r.ispolyexpandedform)((0,we.cadr)(e),t)&&(0,_r.isposint)((0,we.caddr)(e))){let r=Tc((0,we.cadr)(e),t);return xy(r)}if((0,_r.ispolyexpandedform)(e,t)){let r=Tc(e,t);return xy(r)}return[]}function xy(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return DO(r,n)}if(t===3){let r=e.pop(),n=e.pop(),o=e.pop();return kO(r,n,o)}if(t===4){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop();return $O(r,n,o,i)}if(t===5){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop(),s=e.pop();return BO(r,n,o,i,s)}return[]}function DO(e,t){return[(0,M.negate)((0,M.divide)(t,e))]}function kO(e,t,r){let n=(0,Xe.power)((0,he.subtract)((0,Xe.power)(t,(0,j.integer)(2)),(0,M.multiply)((0,M.multiply)((0,j.integer)(4),e),r)),(0,j.rational)(1,2)),o=(0,M.divide)((0,he.subtract)(n,t),(0,M.multiply)(e,(0,j.integer)(2))),i=(0,M.multiply)((0,M.divide)((0,M.negate)((0,he.add)(n,t)),e),(0,j.rational)(1,2));return[o,i]}function $O(e,t,r,n){let o=(0,M.multiply)((0,M.multiply)(r,r),r),i=(0,M.multiply)(t,t),s=(0,M.multiply)(i,t),u=(0,M.multiply)((0,M.multiply)(s,n),(0,j.integer)(-4)),c=(0,M.multiply)(s,(0,j.integer)(2)),d=(0,M.multiply)((0,j.integer)(3),e),_=(0,M.multiply)((0,M.multiply)(e,e),n),R=(0,M.multiply)(_,(0,j.integer)(27)),T=(0,M.multiply)((0,M.multiply)(_,n),(0,j.integer)(-27)),k=(0,M.multiply)((0,M.multiply)(e,r),t),V=(0,M.multiply)((0,M.multiply)(e,r),(0,j.integer)(3)),z=(0,M.multiply)((0,j.integer)(-4),(0,M.multiply)(e,o)),Ae=(0,M.negate)((0,M.multiply)(k,(0,j.integer)(9))),et=(0,M.multiply)((0,M.multiply)(k,n),(0,j.integer)(18)),Ve=(0,he.subtract)(i,V),De=(0,M.multiply)(i,(0,M.multiply)(r,r)),it=(0,M.divide)((0,M.negate)(t),d),Oe=(0,M.multiply)((0,Xe.power)(Ve,(0,j.integer)(3)),(0,j.integer)(4)),st=(0,Mc.absValFloat)((0,Wt.simplify)(Ve)),or=(0,Mc.absValFloat)((0,Wt.simplify)((0,he.add_all)([et,u,De,z,T]))),Bt=(0,he.add_all)([c,Ae,R]),vr=(0,Wt.simplify)((0,Xe.power)((0,he.subtract)((0,Xe.power)(Bt,(0,j.integer)(2)),Oe),(0,j.rational)(1,2)));if(nt.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),nt.debug(`cubic: D0: ${Ve}`),nt.debug(`cubic: D0 as float: ${st}`),nt.debug(`cubic: DETERMINANT: ${or}`),nt.debug(`cubic: D1: ${Bt}`),(0,_r.isZeroAtomOrTensor)(or))return UO(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:st,R_m_b_over_3a:it,R_DELTA0:Ve,R_b3:s,R_a_b_c:k});let Nt=!1,ci=!1,Yn;for(;!Nt;){let il=ci?(0,M.negate)(vr):vr;Yn=(0,Wt.simplify)((0,Xe.power)((0,M.multiply)((0,he.add)(il,Bt),(0,j.rational)(1,2)),(0,j.rational)(1,3)));let os=(0,Mc.absValFloat)((0,Wt.simplify)(Yn));nt.debug(`cubic: C: ${Yn}`),nt.debug(`cubic: C as absval and float: ${os}`),(0,_r.isZeroAtomOrTensor)(os)?(nt.debug(" cubic: C IS ZERO flipping the sign"),ci=!0):Nt=!0}let el=(0,M.multiply)((0,M.multiply)(Yn,d),(0,j.integer)(2)),xu=(0,M.multiply)(we.Constants.imaginaryunit,(0,Xe.power)((0,j.integer)(3),(0,j.rational)(1,2))),pu=(0,he.add)(we.Constants.one,xu),tl=(0,he.subtract)(we.Constants.one,xu),rn=(0,M.divide)(Yn,d),Vn=it,hu=(0,M.negate)(rn),rl=(0,M.negate)((0,M.divide)(Ve,(0,M.multiply)(Yn,d))),nn=(0,Wt.simplify)((0,he.add_all)([Vn,hu,rl])),fi=it,Zn=(0,M.divide)((0,M.multiply)(rn,pu),(0,j.integer)(2)),Au=(0,M.divide)((0,M.multiply)(tl,Ve),el),nl=(0,Wt.simplify)((0,he.add_all)([fi,Zn,Au])),ol=it,Nf=(0,M.divide)((0,M.multiply)(rn,tl),(0,j.integer)(2)),ns=(0,M.divide)((0,M.multiply)(pu,Ve),el),Ou=(0,Wt.simplify)((0,he.add_all)([ol,Nf,ns]));return[nn,nl,Ou]}function UO(e,t,r,n,o){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:s,R_DELTA0:u,R_b3:c,R_a_b_c:d}=o;if((0,_r.isZeroAtomOrTensor)(i))return nt.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[s];nt.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=(0,M.divide)((0,he.subtract)((0,M.multiply)(e,(0,M.multiply)(n,(0,j.integer)(9))),(0,M.multiply)(t,r)),(0,M.multiply)(u,(0,j.integer)(2))),R=(0,M.negate)(c),T=(0,M.negate)((0,M.multiply)(e,(0,M.multiply)(e,(0,M.multiply)(n,(0,j.integer)(9))))),k=(0,M.multiply)(d,(0,j.integer)(4)),V=(0,M.divide)((0,he.add_all)([k,T,R]),(0,M.multiply)(e,u));return[_,_,V]}function BO(e,t,r,n,o){return nt.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),(0,_r.isZeroAtomOrTensor)(t)&&(0,_r.isZeroAtomOrTensor)(n)&&!(0,_r.isZeroAtomOrTensor)(r)&&!(0,_r.isZeroAtomOrTensor)(o)?GO(e,t,r,n,o):(0,_r.isZeroAtomOrTensor)(t)?FO(e,t,r,n,o):jO(e,t,r,n,o)}function GO(e,t,r,n,o){nt.debug("biquadratic case");let i=kl((0,he.add)((0,M.multiply)(e,(0,Xe.power)((0,cr.symbol)(we.SECRETX),(0,j.integer)(2))),(0,he.add)((0,M.multiply)(r,(0,cr.symbol)(we.SECRETX)),o)),(0,cr.symbol)(we.SECRETX)),s=[];for(let u of i.tensor.elem)s.push((0,Wt.simplify)((0,Xe.power)(u,(0,j.rational)(1,2)))),s.push((0,Wt.simplify)((0,M.negate)((0,Xe.power)(u,(0,j.rational)(1,2)))));return s}function FO(e,t,r,n,o){let i=r,s=n,u=o,c=(0,M.multiply)((0,j.rational)(5,2),i),d=(0,he.subtract)((0,M.multiply)((0,j.integer)(2),(0,Xe.power)(i,(0,j.integer)(2))),u),_=(0,he.add)((0,M.multiply)((0,j.rational)(-1,2),(0,M.multiply)(i,u)),(0,he.add)((0,M.divide)((0,Xe.power)(i,(0,j.integer)(3)),(0,j.integer)(2)),(0,M.multiply)((0,j.rational)(-1,8),(0,Xe.power)(s,(0,j.integer)(2))))),R=(0,he.add)((0,Xe.power)((0,cr.symbol)(we.SECRETX),(0,j.integer)(3)),(0,he.add)((0,M.multiply)(c,(0,Xe.power)((0,cr.symbol)(we.SECRETX),(0,j.integer)(2))),(0,he.add)((0,M.multiply)(d,(0,cr.symbol)(we.SECRETX)),_)));nt.debug(`resolventCubic: ${R}`);let T=kl(R,(0,cr.symbol)(we.SECRETX));nt.debug(`resolventCubicSolutions: ${T}`);let k=null;for(let vr of T.tensor.elem){nt.debug(`examining solution: ${vr}`);let Nt=(0,Mc.absValFloat)((0,he.add)((0,M.multiply)(vr,(0,j.integer)(2)),i));if(nt.debug(`abs value is: ${vr}`),!(0,_r.isZeroAtomOrTensor)(Nt)){k=vr;break}}nt.debug(`chosen solution: ${k}`);let V=(0,Wt.simplify)((0,Xe.power)((0,he.add)((0,M.multiply)(k,(0,j.integer)(2)),i),(0,j.rational)(1,2))),z=(0,Wt.simplify)((0,M.divide)((0,M.multiply)(s,(0,j.integer)(2)),V)),Ae=(0,he.add)((0,M.multiply)(i,(0,j.integer)(3)),(0,M.multiply)(k,(0,j.integer)(2))),et=(0,Wt.simplify)((0,Xe.power)((0,M.negate)((0,he.add)(Ae,z)),(0,j.rational)(1,2))),Ve=(0,M.divide)((0,he.add)(V,et),(0,j.integer)(2)),De=(0,Wt.simplify)((0,Xe.power)((0,M.negate)((0,he.add)(Ae,z)),(0,j.rational)(1,2))),it=(0,M.divide)((0,he.subtract)(V,De),(0,j.integer)(2)),Oe=(0,Wt.simplify)((0,Xe.power)((0,M.negate)((0,he.subtract)(Ae,z)),(0,j.rational)(1,2))),st=(0,M.divide)((0,he.add)((0,M.negate)(V),Oe),(0,j.integer)(2)),or=(0,Wt.simplify)((0,Xe.power)((0,M.negate)((0,he.subtract)(Ae,z)),(0,j.rational)(1,2))),Bt=(0,M.divide)((0,he.subtract)((0,M.negate)(V),or),(0,j.integer)(2));return[Ve,it,st,Bt]}function jO(e,t,r,n,o){let i=(0,M.divide)((0,he.add)((0,M.multiply)((0,j.integer)(8),(0,M.multiply)(r,e)),(0,M.multiply)((0,j.integer)(-3),(0,Xe.power)(t,(0,j.integer)(2)))),(0,M.multiply)((0,j.integer)(8),(0,Xe.power)(e,(0,j.integer)(2)))),s=(0,M.divide)((0,he.add)((0,Xe.power)(t,(0,j.integer)(3)),(0,he.add)((0,M.multiply)((0,j.integer)(-4),(0,M.multiply)(e,(0,M.multiply)(t,r))),(0,M.multiply)((0,j.integer)(8),(0,M.multiply)(n,(0,Xe.power)(e,(0,j.integer)(2)))))),(0,M.multiply)((0,j.integer)(8),(0,Xe.power)(e,(0,j.integer)(3)))),u=(0,M.multiply)((0,M.multiply)(e,e),e),c=(0,M.multiply)(t,t),d=(0,M.multiply)((0,M.multiply)(e,e),n),_=(0,M.divide)((0,he.add)((0,M.multiply)((0,Xe.power)(t,(0,j.integer)(4)),(0,j.integer)(-3)),(0,he.add)((0,M.multiply)((0,j.integer)(256),(0,M.multiply)(u,o)),(0,he.add)((0,M.multiply)((0,j.integer)(-64),(0,M.multiply)(d,t)),(0,M.multiply)((0,j.integer)(16),(0,M.multiply)(c,(0,M.multiply)(e,r)))))),(0,M.multiply)((0,j.integer)(256),(0,Xe.power)(e,(0,j.integer)(4)))),R=(0,Xe.power)((0,cr.symbol)(we.SECRETX),(0,j.integer)(4)),T=(0,M.multiply)(i,(0,Xe.power)((0,cr.symbol)(we.SECRETX),(0,j.integer)(2))),k=(0,M.multiply)(s,(0,cr.symbol)(we.SECRETX)),V=(0,Wt.simplify)((0,he.add_all)([R,T,k,_])),z=kl(V,(0,cr.symbol)(we.SECRETX));return nt.debug(`p for depressed quartic: ${i}`),nt.debug(`q for depressed quartic: ${s}`),nt.debug(`r for depressed quartic: ${_}`),nt.debug(`4 * x^4: ${R}`),nt.debug(`R_p * x^2: ${T}`),nt.debug(`R_q * x: ${k}`),nt.debug(`R_r: ${_}`),nt.debug(`solving depressed quartic: ${V}`),nt.debug(`depressedSolutions: ${z}`),z.tensor.elem.map(Ae=>{let et=(0,Wt.simplify)((0,he.subtract)(Ae,(0,M.divide)(t,(0,M.multiply)((0,j.integer)(4),e))));return nt.debug(`solution from depressed: ${et}`),et})}});var Oy=A(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.simfac=void 0;var _e=N(),Wd=U(),hy=Ne(),Xo=ue(),QB=G(),Nc=pi(),fn=H(),ca=Z();function zO(e){if((0,_e.isadd)(e)){let t=e.tail().map(Ay);return(0,Xo.add_all)(t)}return Ay(e)}Ic.simfac=zO;function Ay(e){if(!(0,_e.ismultiply)(e))return e;let t=e.tail();for(;YO(t););return(0,ca.multiply_all_noexpand)(t)}function YO(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let o=e[n];if((0,_e.isfactorial)(r)&&(0,_e.ispower)(o)&&(0,fn.isminusone)((0,_e.caddr)(o))&&(0,hy.equal)((0,_e.cadr)(r),(0,_e.cadr)(o)))return e[t]=(0,Nc.factorial)((0,Xo.subtract)((0,_e.cadr)(r),_e.Constants.one)),e[n]=_e.Constants.one,!0;if((0,_e.ispower)(o)&&(0,fn.isminusone)((0,_e.caddr)(o))&&(0,_e.caadr)(o)===(0,Wd.symbol)(_e.FACTORIAL)&&(0,hy.equal)(r,(0,_e.cadadr)(o)))return e[t]=(0,ca.reciprocate)((0,Nc.factorial)((0,Xo.add)(r,_e.Constants.negOne))),e[n]=_e.Constants.one,!0;if((0,_e.isfactorial)(o)){let i=(0,Xo.subtract)(r,(0,_e.cadr)(o));if((0,fn.isplusone)(i))return e[t]=(0,Nc.factorial)(r),e[n]=_e.Constants.one,!0}if((0,_e.ispower)(r)&&(0,fn.isminusone)((0,_e.caddr)(r))&&(0,_e.ispower)(o)&&(0,fn.isminusone)((0,_e.caddr)(o))&&(0,_e.caadr)(o)===(0,Wd.symbol)(_e.FACTORIAL)){let i=(0,Xo.subtract)((0,_e.cadr)(r),(0,_e.cadr)((0,_e.cadr)(o)));if((0,fn.isplusone)(i))return e[t]=(0,ca.reciprocate)((0,Nc.factorial)((0,_e.cadr)(r))),e[n]=_e.Constants.one,!0}if((0,_e.isfactorial)(r)&&(0,_e.ispower)(o)&&(0,fn.isminusone)((0,_e.caddr)(o))&&(0,_e.caadr)(o)===(0,Wd.symbol)(_e.FACTORIAL)){let i=(0,Xo.subtract)((0,_e.cadr)(r),(0,_e.cadr)((0,_e.cadr)(o)));if((0,fn.isplusone)(i))return e[t]=(0,_e.cadr)(r),e[n]=_e.Constants.one,!0;if((0,fn.isminusone)(i))return e[t]=(0,ca.reciprocate)((0,_e.cadr)((0,_e.cadr)(o))),e[n]=_e.Constants.one,!0;if((0,fn.equaln)(i,2))return e[t]=(0,_e.cadr)(r),e[n]=(0,Xo.add)((0,_e.cadr)(r),_e.Constants.negOne),!0;if((0,fn.equaln)(i,-2))return e[t]=(0,ca.reciprocate)((0,_e.cadr)((0,_e.cadr)(o))),e[n]=(0,ca.reciprocate)((0,Xo.add)((0,_e.cadr)((0,_e.cadr)(o)),_e.Constants.negOne)),!0}}}return!1}});var Jd=A(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.decomp=fa.Eval_decomp=void 0;var je=N(),$l=ir(),My=U(),Ny=Ne(),VO=ue(),Ty=G(),ZO=Vr(),XO=K(),Iy=Z();function HO(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=(0,Ty.Eval)((0,je.cadr)(e));e=(0,Ty.Eval)((0,je.caddr)(e));let r=e===(0,My.symbol)(je.NIL)?(0,ZO.guess)(t):e,n=Ul(!1,t,r);return(0,XO.makeList)((0,My.symbol)(je.NIL),...n)}fa.Eval_decomp=HO;function QO(e,t){return e.length>0&&(0,Ny.equal)(t,e[e.length-1])?!1:(e.push(t),!0)}function Ul(e,t,r){if(je.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!(0,je.iscons)(t))return je.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!(0,$l.Find)(t,r))return je.DEBUG&&console.log(" entire expression is constant"),[t];if((0,je.isadd)(t))return WO(e,t,r);if((0,je.ismultiply)(t))return JO(e,t,r);let n=(0,je.cdr)(t);je.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let o=[];for(;(0,je.iscons)(n);)e&&o.push((0,je.car)(n)),je.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${(0,je.car)(n)}`),console.log(`p2: ${r}`)),o.push(...Ul(e,(0,je.car)(n),r)),n=(0,je.cdr)(n);return o}fa.decomp=Ul;function WO(e,t,r){je.DEBUG&&console.log(" decomposing the sum ");let n=(0,je.cdr)(t),o=[];for(;(0,je.iscons)(n);)((0,$l.Find)((0,je.car)(n),r)||e)&&o.push(...Ul(e,(0,je.car)(n),r)),n=(0,je.cdr)(n);n=(0,je.cdr)(t);let i=[...n].filter(s=>!(0,$l.Find)(s,r));return i.length&&(n=(0,VO.add_all)(i),QO(o,n),o.push((0,Iy.negate)(n))),o}function JO(e,t,r){je.DEBUG&&console.log(" decomposing the product ");let n=(0,je.cdr)(t),o=[];for(;(0,je.iscons)(n);)((0,$l.Find)((0,je.car)(n),r)||e)&&o.push(...Ul(e,(0,je.car)(n),r)),n=(0,je.cdr)(n);n=(0,je.cdr)(t);let i=[];for(;(0,je.iscons)(n);){let s=(0,je.car)(n);(0,$l.Find)(s,r)||(i.length<1||!(0,Ny.equal)(s,i[i.length-1]))&&i.push(s),n=(0,je.cdr)(n)}return i.length>0&&o.push((0,Iy.multiply_all)(i)),o}});var em=A(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.transform=void 0;var ne=N(),Te=U(),KO=ue(),eM=tm(),tM=Jd(),Sc=G(),Sy=H(),rM=K(),nM=Yo(),Kd=Yr();function wy(e,t,r,n){ne.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let o=oM();(0,Te.set_binding)((0,Te.symbol)(ne.METAX),t);let i=(0,eM.polyform)(e,t),s=(0,tM.decomp)(n,i,t);if(ne.DEBUG){console.log(`  ${s.length} decomposed elements ====== `);for(let _=0;_<s.length;_++)console.log(`  decomposition element ${_}: ${s[_]}`)}let u=!1,c;if(n){if(!(0,ne.isNumericAtom)(e)){let _=r;ne.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let R=(0,Kd.subst)(_,(0,Te.symbol)(ne.SYMBOL_A_UNDERSCORE),(0,Te.symbol)(ne.METAA));R=(0,Kd.subst)(R,(0,Te.symbol)(ne.SYMBOL_B_UNDERSCORE),(0,Te.symbol)(ne.METAB));let T=(0,Kd.subst)(R,(0,Te.symbol)(ne.SYMBOL_X_UNDERSCORE),(0,Te.symbol)(ne.METAX)),k=(0,ne.car)(T);ne.DEBUG&&console.log(`template expression: ${k}`),c=(0,ne.cadr)(T);let V=(0,ne.cddr)(T);if(Ry([ne.Constants.one,...s],n,e,k,V))u=!0;else{ne.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${(0,ne.car)(e)}`));let z=[],Ae=e;for((0,ne.iscons)(Ae)&&(z.push((0,ne.car)(e)),Ae=(0,ne.cdr)(e));(0,ne.iscons)(Ae);){let et=(0,ne.car)(Ae);Ae=(0,ne.cdr)(Ae),ne.DEBUG&&(console.log(`testing: ${et}`),console.log(`about to try to simplify other term: ${et}`));let[Ve,De]=wy(et,(0,Te.symbol)(ne.NIL),r,n);u=u||De,z.push(Ve),ne.DEBUG&&console.log(`tried to simplify other term: ${et} ...successful?: ${De} ...transformed: ${z[z.length-1]}`)}z.length!==0&&(c=(0,rM.makeList)(...z))}}}else for(let _ of Array.from(r))if(ne.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&ne.breakpoint),_){let R=(0,nM.scan_meta)(_),T=(0,ne.cadr)(R);c=(0,ne.caddr)(R);let k=(0,ne.cdddr)(R);if(Ry([ne.Constants.one,...s],n,e,T,k)){u=!0;break}}let d=u?(0,Sc.Eval)(c):n?e:(0,Te.symbol)(ne.NIL);return iM(o),[d,u]}Rc.transform=wy;function oM(){return{METAA:(0,Te.get_binding)((0,Te.symbol)(ne.METAA)),METAB:(0,Te.get_binding)((0,Te.symbol)(ne.METAB)),METAX:(0,Te.get_binding)((0,Te.symbol)(ne.METAX))}}function iM(e){(0,Te.set_binding)((0,Te.symbol)(ne.METAX),e.METAX),(0,Te.set_binding)((0,Te.symbol)(ne.METAB),e.METAB),(0,Te.set_binding)((0,Te.symbol)(ne.METAA),e.METAA)}function Ry(e,t,r,n,o){for(let i of e){(0,Te.set_binding)((0,Te.symbol)(ne.METAA),i),ne.DEBUG&&console.log(`  binding METAA to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAA))}`);for(let s of e){(0,Te.set_binding)((0,Te.symbol)(ne.METAB),s),ne.DEBUG&&console.log(`  binding METAB to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAB))}`);let u=o;for(;(0,ne.iscons)(u);){let d=(0,Sc.Eval)((0,ne.car)(u));if((0,Sy.isZeroAtomOrTensor)(d))break;u=(0,ne.cdr)(u)}if((0,ne.iscons)(u))continue;let c=t?(0,ne.noexpand)(Sc.Eval,n):(0,Sc.Eval)(n);if(ne.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAA))} and binding METAB to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAB))} and binding METAX to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),(0,Sy.isZeroAtomOrTensor)((0,KO.subtract)(r,c)))return ne.DEBUG&&(console.log(`binding METAA to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAA))}`),console.log(`binding METAB to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAB))}`),console.log(`binding METAX to ${(0,Te.get_binding)((0,Te.symbol)(ne.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var om=A(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.transpose=_a.Eval_transpose=void 0;var sM=It(),$e=N(),aM=Ee(),ma=U(),da=Ne(),lM=ue(),nm=F(),rm=G(),uM=Go(),Cr=H(),Ly=K(),cM=Z();function fM(e){let t=(0,rm.Eval)((0,$e.cadr)(e)),r=$e.Constants.one,n=(0,nm.integer)(2);return(0,$e.cddr)(e)!==(0,ma.symbol)($e.NIL)&&(r=(0,rm.Eval)((0,$e.caddr)(e)),n=(0,rm.Eval)((0,$e.cadddr)(e))),Bl(t,r,n)}_a.Eval_transpose=fM;function Bl(e,t,r){let n=0,o=Array($e.MAXDIM).fill(0),i=Array($e.MAXDIM).fill(0);if((0,$e.isNumericAtom)(e)||((0,Cr.isplusone)(t)&&(0,Cr.isplustwo)(r)||(0,Cr.isplusone)(r)&&(0,Cr.isplustwo)(t))&&(0,$e.isidentitymatrix)(e))return e;if((0,$e.istranspose)(e)){let T=(0,$e.car)((0,$e.cdr)((0,$e.cdr)(e))),k=(0,$e.car)((0,$e.cdr)((0,$e.cdr)((0,$e.cdr)(e))));if((0,da.equal)(T,r)&&(0,da.equal)(k,t)||(0,da.equal)(k,r)&&(0,da.equal)(T,t)||(0,da.equal)(T,(0,ma.symbol)($e.NIL))&&(0,da.equal)(k,(0,ma.symbol)($e.NIL))&&((0,Cr.isplusone)(r)&&(0,Cr.isplustwo)(t)||(0,Cr.isplusone)(t)&&(0,Cr.isplustwo)(r)))return(0,$e.car)((0,$e.cdr)(e))}if($e.defs.expanding&&(0,$e.isadd)(e))return e.tail().reduce((T,k)=>(0,lM.add)(T,Bl(k,t,r)),$e.Constants.zero);if($e.defs.expanding&&(0,$e.ismultiply)(e))return e.tail().reduce((T,k)=>(0,cM.multiply)(T,Bl(k,t,r)),$e.Constants.one);if($e.defs.expanding&&(0,$e.isinnerordot)(e)){let T=[];return(0,$e.iscons)(e)&&T.push(...e.tail().map(k=>[k,t,r])),T.reverse(),T.reduce((k,V)=>(0,uM.inner)(k,Bl(V[0],V[1],V[2])),(0,ma.symbol)($e.SYMBOL_IDENTITY_MATRIX))}if(!(0,$e.istensor)(e))return(0,Cr.isZeroAtomOrTensor)(e)?$e.Constants.zero:(!(0,Cr.isplusone)(t)||!(0,Cr.isplustwo)(r))&&(!(0,Cr.isplusone)(r)||!(0,Cr.isplustwo)(t))?(0,Ly.makeList)((0,ma.symbol)($e.TRANSPOSE),e,t,r):(0,Ly.makeList)((0,ma.symbol)($e.TRANSPOSE),e);let{ndim:s,nelem:u}=e.tensor;if(s===1)return e;let c=(0,nm.nativeInt)(t),d=(0,nm.nativeInt)(r);(c<1||c>s||d<1||d>s)&&(0,aM.stop)("transpose: index out of range"),c--,d--,t=(0,sM.alloc_tensor)(u),t.tensor.ndim=s,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[d],t.tensor.dim[d]=e.tensor.dim[c];let _=e.tensor.elem,R=t.tensor.elem;for(let T=0;T<s;T++)o[T]=0,i[T]=e.tensor.dim[T];for(let T=0;T<u;T++){n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n;let k=0;for(let V=0;V<s;V++)k=k*i[V]+o[V];n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n,R[k]=_[T];for(let V=s-1;V>=0&&!(++o[V]<i[V]);V--)o[V]=0}return t}_a.transpose=Bl});var Zo=A(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.simplify_trig=wn.simplify=wn.simplifyForCodeGeneration=wn.Eval_simplify=void 0;var dM=It(),mt=Oc(),I=N(),Ti=ir(),sm=Ee(),He=U(),fo=ue(),Pt=F(),mM=Du(),lm=gl(),Ni=G(),Oi=Rn(),_M=Go(),$t=H(),Dy=K(),ba=Ne(),Ue=Z(),bM=ku(),dn=Et(),Ho=yl(),Mi=Us(),gM=Kn(),yM=Qd(),Cy=Oy(),vM=qt(),qM=em(),EM=om(),xM=Mn(),Py=_i(),im=dl(),pM=oo();function hM(e){let t=ky((0,I.cadr)(e));return Hr((0,Ni.Eval)(t))}wn.Eval_simplify=hM;function ky(e){if(I.defs.userSimplificationsInListForm.length===0||(0,Ti.Find)(e,(0,He.symbol)(I.INTEGRAL)))return e;I.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=(0,I.noexpand)(Ni.Eval,e);if(I.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let o of Array.from(I.defs.userSimplificationsInListForm))console.log(`...${o}`)}let r=!0,n=0;for(;r&&n<I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let o of Array.from(I.defs.userSimplificationsInListForm)){let i=!0,s=0;for(;i&&s<I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)s++,I.DEBUG&&console.log(`simplify - checking pattern: ${o} on: ${t}`),[t,i]=(0,qM.transform)(t,(0,He.symbol)(I.NIL),o,!0),i&&(r=!0),I.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);s===I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&(0,sm.stop)(`maximum application of single transformation rule exceeded: ${o}`)}}return n===I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&(0,sm.stop)("maximum application of all transformation rules exceeded "),I.DEBUG&&(console.log(`METAX = ${(0,He.get_binding)((0,He.symbol)(I.METAX))}`),console.log(`METAA = ${(0,He.get_binding)((0,He.symbol)(I.METAA))}`),console.log(`METAB = ${(0,He.get_binding)((0,He.symbol)(I.METAB))}`)),t}function AM(e){let t=ky(e);I.defs.codeGen=!0;let r=Hr(t);return I.defs.codeGen=!1,r}wn.simplifyForCodeGeneration=AM;function Hr(e){if(I.defs.codeGen&&(0,I.car)(e)===(0,He.symbol)(I.FUNCTION)){let t=(0,I.cadr)(e),r=Hr((0,Ni.Eval)(t)),n=(0,I.caddr)(e);e=(0,Dy.makeList)((0,He.symbol)(I.FUNCTION),r,n)}if((0,I.istensor)(e))return OM(e);if((0,Ti.Find)(e,(0,He.symbol)(I.FACTORIAL))){let t=(0,Cy.simfac)(e),r=(0,Cy.simfac)((0,Ho.rationalize)(e));e=(0,mt.count)(t)<(0,mt.count)(r)?t:r}if(e=IM(e),e=MM(e),e=TM(e),e=NM(e),e=SM(e),e=$y(e),e=wM(e),e=CM(e),I.do_simplify_nested_radicals){let t;if([t,e]=PM(e),t)return I.DEBUG&&console.log("de-nesting successful into: "+e.toString()),Hr(e)}return e=LM(e),e=Uy(e),e}wn.simplify=Hr;function OM(e){let t=(0,dM.alloc_tensor)(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(Hr),(0,vM.check_tensor_dimensions)(t),(0,$t.isZeroAtomOrTensor)(t)&&(t=I.Constants.zero),t}function MM(e){if(!(0,I.isadd)(e))return e;let t=(0,Ho.rationalize)(e);return(0,mt.count)(t)<(0,mt.count)(e)&&(e=t),e}function TM(e){if(!(0,I.isadd)(e))return e;let t=(0,lm.Condense)(e);return(0,mt.count)(t)<=(0,mt.count)(e)&&(e=t),e}function NM(e){let t=(0,Ho.rationalize)((0,Ue.negate)((0,Ho.rationalize)((0,Ue.negate)((0,Ho.rationalize)(e)))));return(0,mt.count)(t)<(0,mt.count)(e)&&(e=t),e}function IM(e){let t=(0,I.car)(e);if((t===(0,He.symbol)(I.MULTIPLY)||(0,I.isinnerordot)(e))&&(0,I.car)((0,I.car)((0,I.cdr)(e)))===(0,He.symbol)(I.TRANSPOSE)&&(0,I.car)((0,I.car)((0,I.cdr)((0,I.cdr)(e))))===(0,He.symbol)(I.TRANSPOSE)){I.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=(0,I.cadr)((0,I.car)((0,I.cdr)(e))),n=(0,I.cadr)((0,I.car)((0,I.cdr)((0,I.cdr)(e)))),o;t===(0,He.symbol)(I.MULTIPLY)?o=(0,Ue.multiply)(r,n):(0,I.isinnerordot)(e)?o=(0,_M.inner)(n,r):o=(0,sm.stop)("f10: nothing to pop.");let i=(0,I.noexpand)(()=>(0,EM.transpose)(o,I.Constants.one,(0,Pt.integer)(2)));(0,mt.count)(i)<(0,mt.count)(e)&&(e=i),I.DEBUG&&console.log(`collecting a transpose ${i}`)}return e}function SM(e){if((0,$t.isZeroAtomOrTensor)(e))return e;let t=(0,Ho.rationalize)((0,Ue.inverse)((0,Ho.rationalize)((0,Ue.inverse)((0,Ho.rationalize)(e)))));return(0,mt.count)(t)<(0,mt.count)(e)&&(e=t),e}function RM(e){return $y(e)}wn.simplify_trig=RM;function $y(e){if(!(0,Ti.Find)(e,(0,He.symbol)(I.SIN))&&!(0,Ti.Find)(e,(0,He.symbol)(I.COS)))return e;let t=e;I.defs.trigmode=1;let r=(0,Ni.Eval)(t);I.defs.trigmode=2;let n=(0,Ni.Eval)(t);return I.defs.trigmode=0,((0,mt.count)(n)<(0,mt.count)(r)||wc(n)<wc(r))&&(r=n),((0,mt.count)(r)<(0,mt.count)(e)||wc(r)<wc(e))&&(e=r),e}function wM(e){if(!(0,I.isadd)(e))return e;let t=(0,I.cdr)(e);return(0,I.iscons)(t)&&(t=[...t].reduce((r,n)=>Uy((0,fo.add)(r,Hr(n))),I.Constants.zero)),(0,mt.count)(t)<(0,mt.count)(e)&&(e=t),e}function Uy(e){var t,r,n,o,i;if(t=(0,xM.denominator)(e),(0,$t.isone)(t)||(r=(0,pM.numerator)(e),(0,$t.isone)(r))||!(o=(0,Py.areunivarpolysfactoredorexpandedform)(r,t))||(i=(0,im.factor)((0,Py.gcd)(r,t),o),(0,$t.isone)(i)))return e;let s=(0,im.factor)(r,o),u=(0,Ue.inverse)(i),c=(0,Ue.multiply_noexpand)(s,u),d=Hr(c),_=(0,im.factor)(t,o),R=(0,Ue.multiply_noexpand)(_,u),T=Hr(R),k=(0,Ue.divide)(d,T);return n=(0,lm.Condense)(k),(0,mt.count)(n)<(0,mt.count)(e)?n:e}function LM(e){let t;return!(0,Ti.Find)(e,(0,He.symbol)(I.SIN))&&!(0,Ti.Find)(e,(0,He.symbol)(I.COS))||(t=(0,mM.clockform)((0,Ni.Eval)(e)),I.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),(0,mt.count)(t)<(0,mt.count)(e)&&(e=t)),e}function CM(e){let t=am(e),r=(0,Ni.Eval)(t);return(0,mt.count)(r)<(0,mt.count)(e)&&(e=r),e}function am(e){if((0,$t.isimaginaryunit)(e))return e;if((0,ba.equal)((0,I.car)(e),(0,He.symbol)(I.POWER))&&(0,$t.isminusone)((0,I.cadr)(e))){let t=(0,Ue.negate)(I.Constants.one),r=am((0,I.caddr)(e));return(0,gM.rect)((0,bM.polar)((0,dn.power)(t,r)))}else return(0,I.iscons)(e)?e.map(am):e}function wc(e){return(0,I.isadd)(e)?(0,ba.length)(e)-1:1}function PM(e){if(I.defs.recursionLevelNestedRadicalsRemoval>0)return I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=Lc(e),n=(0,I.noexpand)(lm.yycondense,t);return e=(0,mt.countOccurrencesOfSymbol)((0,He.symbol)(I.POWER),t)<(0,mt.countOccurrencesOfSymbol)((0,He.symbol)(I.POWER),n)?t:n,[r,e]}function Lc(e){return I.defs.recursionLevelNestedRadicalsRemoval>0?(I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):(0,ba.equal)((0,I.car)(e),(0,He.symbol)(I.POWER))?DM(e):(0,I.iscons)(e)?$M(e):[e,!1]}function DM(e){let t=(0,I.cadr)(e),r=(0,I.caddr)(e);if((0,$t.isminusone)(r)||!(0,ba.equal)((0,I.car)(t),(0,He.symbol)(I.ADD))||!(0,$t.isfraction)(r)||!(0,$t.equalq)(r,1,3)&&!(0,$t.equalq)(r,1,2))return[e,!1];let n=(0,I.cadr)(t);Lc(n);let o=(0,I.caddr)(t);Lc(o);let i=0,s=t;for(;(0,I.cdr)(s)!==(0,He.symbol)(I.NIL);)i++,s=(0,I.cdr)(s);if(i>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=kM(o);if(u.length===0)return[e,!1];let d=n,_=u.reduce(Ue.multiply,I.Constants.one),R=c.reduce(Ue.multiply,I.Constants.one),T;if((0,$t.equalq)(r,1,3)){let De=(0,Ue.divide)((0,Ue.multiply)((0,Ue.negate)(d),_),R),it=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(De)));if(Math.abs(it)>Math.pow(2,32))return[e,!1];let Oe=(0,Ue.multiply)((0,Pt.integer)(3),_),st=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(Oe)));if(Math.abs(st)>Math.pow(2,32))return[e,!1];let or=(0,Ue.multiply)(Oe,(0,He.symbol)(I.SECRETX)),Bt=(0,Ue.divide)((0,Ue.multiply)((0,Pt.integer)(-3),d),R),vr=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(Bt)));if(Math.abs(vr)>Math.pow(2,32))return[e,!1];T=(0,fo.add_all)([De,or,(0,Ue.multiply)(Bt,(0,dn.power)((0,He.symbol)(I.SECRETX),(0,Pt.integer)(2))),(0,Ue.multiply)(I.Constants.one,(0,dn.power)((0,He.symbol)(I.SECRETX),(0,Pt.integer)(3)))])}else if((0,$t.equalq)(r,1,2)){let De=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(_)));if(Math.abs(De)>Math.pow(2,32))return[e,!1];let it=(0,Ue.divide)((0,Ue.multiply)((0,Pt.integer)(-2),d),R),Oe=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(it)));if(Math.abs(Oe)>Math.pow(2,32))return[e,!1];T=(0,fo.add)(_,(0,fo.add)((0,Ue.multiply)(it,(0,He.symbol)(I.SECRETX)),(0,Ue.multiply)(I.Constants.one,(0,dn.power)((0,He.symbol)(I.SECRETX),(0,Pt.integer)(2)))))}I.defs.recursionLevelNestedRadicalsRemoval++;let k=(0,yM.roots)(T,(0,He.symbol)(I.SECRETX));if(I.defs.recursionLevelNestedRadicalsRemoval--,(0,ba.equal)(k,(0,He.symbol)(I.NIL)))return I.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let V=k.elem.filter(De=>!(0,Ti.Find)(De,(0,He.symbol)(I.POWER)));if(V.length===0)return[e,!1];let z=[],Ae=[];for(let De of Array.from(V)){let it=(0,Pt.nativeDouble)((0,Oi.yyfloat)((0,Mi.real)(De)));z.push(De),Ae.push(it)}let et=Ae.indexOf(Math.max.apply(Math,Ae)),Ve=z[et];if(!(0,$t.equalq)(r,1,3)&&!(0,$t.equalq)(r,1,2))return[e,!1];if((0,$t.equalq)(r,1,3)){let De=(0,dn.power)((0,Ue.divide)(d,(0,fo.add)((0,dn.power)(Ve,(0,Pt.integer)(3)),(0,Ue.multiply)((0,Ue.multiply)((0,Pt.integer)(3),_),Ve))),(0,Pt.rational)(1,3)),it=(0,Ue.multiply)(De,Ve);return[Hr((0,fo.add)((0,Ue.multiply)(De,(0,dn.power)(_,(0,Pt.rational)(1,2))),it)),!0]}if((0,$t.equalq)(r,1,2)){let De=(0,dn.power)((0,Ue.divide)(d,(0,fo.add)((0,dn.power)(Ve,(0,Pt.integer)(2)),_)),(0,Pt.rational)(1,2)),it=(0,Ue.multiply)(De,Ve),Oe=Hr((0,fo.add)((0,Ue.multiply)(De,(0,dn.power)(_,(0,Pt.rational)(1,2))),it)),st=(0,Oi.yyfloat)((0,Mi.real)(Oe));return(0,$t.isnegativenumber)(st)?[Hr((0,fo.add)((0,Ue.multiply)((0,Ue.negate)(De),(0,dn.power)(_,(0,Pt.rational)(1,2))),(0,Ue.negate)(it))),!0]:[Oe,!0]}return[null,!0]}function kM(e){let t=null,r=[],n=[];if((0,I.ismultiply)(e)){let o=(0,I.cdr)(e);if((0,I.iscons)(o))for(;(0,I.iscons)(o);){let i=(0,I.car)(o);if((0,I.ispower)(i)){let s=(0,I.cadr)(i),u=(0,I.caddr)(i);(0,$t.equalq)(u,1,2)&&(t==null?(t=u,r.push(s)):(0,ba.equal)(u,t)&&r.push(s))}else n.push(i);o=(0,I.cdr)(o)}}else if((0,I.ispower)(e)){let o=(0,I.cadr)(e),i=(0,I.caddr)(e);t==null&&(0,$t.equalq)(i,1,2)&&(t=i,r.push(o))}return{commonBases:r,termsThatAreNotPowers:n}}function $M(e){let t=!1,r=[];if((0,I.iscons)(e)){let n=Array.from(e).map(o=>{if(!t){let i;return[i,t]=Lc(o),i}return o});r.push(...n)}return[(0,Dy.makeList)(...r),t]}});var Fl=A(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.make_hashed_itab=Qo.integral=Qo.Eval_integral=void 0;var de=N(),ga=ir(),Fy=Ee(),Ln=U(),UM=Ne(),BM=ue(),jy=F(),GM=Ri(),Ii=G(),By=Vr(),Gl=H(),Gy=K(),FM=Z(),jM=fy(),zM=Yo(),YM=Zo(),VM=em(),ZM=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function XM(e){let t=0;e=(0,de.cdr)(e);let r=(0,Ii.Eval)((0,de.car)(e));e=(0,de.cdr)(e);let n=(0,Ii.Eval)((0,de.car)(e)),o,i;for(n===(0,Ln.symbol)(de.NIL)?(i=(0,By.guess)(r),o=(0,Ln.symbol)(de.NIL)):(0,de.isNumericAtom)(n)?(i=(0,By.guess)(r),o=n):(i=n,e=(0,de.cdr)(e),o=(0,Ii.Eval)((0,de.car)(e)));;){(0,de.isNumericAtom)(o)?(t=(0,jy.nativeInt)(o),isNaN(t)&&(0,Fy.stop)("nth integral: check n")):t=1;let s=r;if(t>=0)for(let u=0;u<t;u++)s=Cc(s,i);else{t=-t;for(let u=0;u<t;u++)s=(0,GM.derivative)(s,i)}if(r=s,o===(0,Ln.symbol)(de.NIL))break;if((0,de.isNumericAtom)(o)){if(e=(0,de.cdr)(e),o=(0,Ii.Eval)((0,de.car)(e)),o===(0,Ln.symbol)(de.NIL))break;(0,de.isNumericAtom)(o)||(i=o,e=(0,de.cdr)(e),o=(0,Ii.Eval)((0,de.car)(e)))}else i=o,e=(0,de.cdr)(e),o=(0,Ii.Eval)((0,de.car)(e))}return r}Qo.Eval_integral=XM;function Cc(e,t){let r;return(0,de.isadd)(e)?r=HM(e,t):(0,de.ismultiply)(e)?r=QM(e,t):r=zy(e,t),(0,ga.Find)(r,(0,Ln.symbol)(de.INTEGRAL))&&(0,Fy.stop)("integral: sorry, could not find a solution"),(0,Ii.Eval)((0,YM.simplify)(r))}Qo.integral=Cc;function HM(e,t){e=(0,de.cdr)(e);let r=Cc((0,de.car)(e),t);return(0,de.iscons)(e)&&(r=e.tail().reduce((n,o)=>(0,BM.add)(n,Cc(o,t)),r)),r}function QM(e,t){let[r,n]=(0,jM.partition)(e,t);return(0,FM.multiply)(r,zy(n,t))}function zy(e,t){let r=Si(e,t).toFixed(6),n=tT[r];if(!n)return(0,Gy.makeList)((0,Ln.symbol)(de.INTEGRAL),e,t);let[o,i]=(0,VM.transform)(e,t,n,!1);return o===(0,Ln.symbol)(de.NIL)?(0,Gy.makeList)((0,Ln.symbol)(de.INTEGRAL),e,t):o}var Cn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function Si(e,t){if((0,de.issymbol)(e))return(0,UM.equal)(e,t)?Cn.x:Cn.constant;if((0,de.iscons)(e)){let n=(0,de.car)(e);switch((0,de.issymbol)(n)&&n.printname){case de.ADD:return JM((0,de.cdr)(e),t);case de.MULTIPLY:return KM((0,de.cdr)(e),t);case de.POWER:return um((0,de.cadr)(e),(0,de.caddr)(e),t);case de.EXP:return um((0,Ln.symbol)(de.E),(0,de.cadr)(e),t);case de.SQRT:var r=(0,jy.double)(.5);return um((0,de.cadr)(e),r,t);default:return WM(e,t)}}return Cn.constant}function WM(e,t){if(!(0,ga.Find)((0,de.cadr)(e),t))return Cn.constant;let r=(0,de.car)(e),n=Si((0,de.cadr)(e),t),o=Cn[r.printname];if(!o)throw new Error("Unsupported function "+r.printname);return Math.pow(o,n)}function JM(e,t){let r={};for(;(0,de.iscons)(e);){let o=(0,de.car)(e);e=(0,de.cdr)(e);let i=0;(0,ga.Find)(o,t)?i=Si(o,t):i=Cn.constant,r[i.toFixed(6)]=!0}let n=0;for(let o of Object.keys(r||{})){let i=r[o];n=n+Number(o)}return n}function KM(e,t){let r=1;return(0,de.iscons)(e)&&[...e].forEach(n=>{(0,ga.Find)(n,t)&&(r=r*Si(n,t))}),r}function um(e,t,r){let n=Cn.constant,o=Cn.constexp;if((0,ga.Find)(e,r)&&(n=Si(e,r)),(0,ga.Find)(t,r))o=Si(t,r);else{if(n===Cn.constant)return Cn.constant;(0,Gl.isminusone)(t)?o=-1:(0,Gl.isoneovertwo)(t)?o=.5:(0,Gl.isminusoneovertwo)(t)?o=-.5:(0,Gl.equalq)(t,2,1)?o=2:(0,Gl.equalq)(t,-2,1)&&(o=-2)}return Math.pow(n,o)}function eT(){let e={};for(let t of Array.from(ZM)){let r=(0,zM.scan_meta)(t),n=(0,de.cadr)(r),i=Si(n,(0,Ln.symbol)(de.METAX)).toFixed(6);e[i]||(e[i]=[]),e[i].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}Qo.make_hashed_itab=eT;var tT={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var mm=A(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.logarithm=ya.Eval_log=void 0;var Pr=N(),Yy=U(),cm=ue(),rT=F(),nT=Mn(),oT=G(),fm=H(),iT=K(),dm=Z(),sT=oo();function aT(e){return wi((0,oT.Eval)((0,Pr.cadr)(e)))}ya.Eval_log=aT;function wi(e){return e===(0,Yy.symbol)(Pr.E)?Pr.Constants.one:(0,fm.equaln)(e,1)?Pr.Constants.zero:(0,fm.isnegativenumber)(e)?(0,cm.add)(wi((0,dm.negate)(e)),(0,dm.multiply)(Pr.Constants.imaginaryunit,Pr.Constants.Pi())):(0,Pr.isdouble)(e)?(0,rT.double)(Math.log(e.d)):(0,fm.isfraction)(e)?(0,cm.subtract)(wi((0,sT.numerator)(e)),wi((0,nT.denominator)(e))):(0,Pr.ispower)(e)?(0,dm.multiply)((0,Pr.caddr)(e),wi((0,Pr.cadr)(e))):(0,Pr.ismultiply)(e)?e.tail().map(wi).reduce(cm.add,Pr.Constants.zero):(0,iT.makeList)((0,Yy.symbol)(Pr.LOG),e)}ya.logarithm=wi});var bm=A(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.sgn=va.Eval_sgn=void 0;var xr=N(),Vy=U(),lT=on(),uT=G(),Zy=H(),Xy=K(),Hy=ln(),_m=Z(),cT=Et();function fT(e){return Qy((0,uT.Eval)((0,xr.cadr)(e)))}va.Eval_sgn=fT;function Qy(e){return(0,xr.isdouble)(e)?e.d>0||e.d===0?xr.Constants.one:xr.Constants.negOne:(0,xr.isrational)(e)?(0,xr.MSIGN)((0,Hy.mmul)(e.q.a,e.q.b))===-1?xr.Constants.negOne:(0,xr.MZERO)((0,Hy.mmul)(e.q.a,e.q.b))?xr.Constants.zero:xr.Constants.one:(0,Zy.iscomplexnumber)(e)?(0,_m.multiply)((0,cT.power)(xr.Constants.negOne,(0,lT.absval)(e)),e):(0,Zy.isnegativeterm)(e)?(0,_m.multiply)((0,Xy.makeList)((0,Vy.symbol)(xr.SGN),(0,_m.negate)(e)),xr.Constants.negOne):(0,Xy.makeList)((0,Vy.symbol)(xr.SGN),e)}va.sgn=Qy});var gm=A(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ysinh=qa.Eval_sinh=void 0;var Li=N(),Wy=U(),dT=F(),mT=G(),_T=H(),bT=K();function gT(e){return Jy((0,mT.Eval)((0,Li.cadr)(e)))}qa.Eval_sinh=gT;function Jy(e){if((0,Li.car)(e)===(0,Wy.symbol)(Li.ARCSINH))return(0,Li.cadr)(e);if((0,Li.isdouble)(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),(0,dT.double)(t)}return(0,_T.isZeroAtomOrTensor)(e)?Li.Constants.zero:(0,bT.makeList)((0,Wy.symbol)(Li.SINH),e)}qa.ysinh=Jy});var Ri=A(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.derivative=xa.Eval_derivative=void 0;var E=N(),yT=ir(),rv=Ee(),Pe=U(),zl=Ne(),Tr=ue(),Pc=Nd(),Ky=Id(),Dt=F(),nv=Lo(),ov=Sd(),vT=Cd(),Ea=G(),ev=Vr(),qT=vd(),ET=Fl(),iv=H(),jl=K(),xT=mm(),ye=Z(),br=Et(),pT=bm(),hT=Zo(),AT=Qn(),OT=gm(),tv=Yr(),ym=qt();function MT(e){e=(0,E.cdr)(e);let t=(0,Ea.Eval)((0,E.car)(e));e=(0,E.cdr)(e);let r,n,o=(0,Ea.Eval)((0,E.car)(e));for(o===(0,Pe.symbol)(E.NIL)?(r=(0,ev.guess)(t),n=(0,Pe.symbol)(E.NIL)):(0,E.isNumericAtom)(o)?(r=(0,ev.guess)(t),n=o):(r=o,e=(0,E.cdr)(e),n=(0,Ea.Eval)((0,E.car)(e)));;){let i;(0,E.isNumericAtom)(n)?(i=(0,Dt.nativeInt)(n),isNaN(i)&&(0,rv.stop)("nth derivative: check n")):i=1;let s=t;if(i>=0)for(let u=0;u<i;u++)s=tt(s,r);else{i=-i;for(let u=0;u<i;u++)s=(0,ET.integral)(s,r)}if(t=s,n===(0,Pe.symbol)(E.NIL))break;if((0,E.isNumericAtom)(n)){if(e=(0,E.cdr)(e),n=(0,Ea.Eval)((0,E.car)(e)),n===(0,Pe.symbol)(E.NIL))break;(0,E.isNumericAtom)(n)||(r=n,e=(0,E.cdr)(e),n=(0,Ea.Eval)((0,E.car)(e)))}else r=n,e=(0,E.cdr)(e),n=(0,Ea.Eval)((0,E.car)(e))}return t}xa.Eval_derivative=MT;function tt(e,t){return(0,E.isNumericAtom)(t)&&(0,rv.stop)("undefined function"),(0,E.istensor)(e)?(0,E.istensor)(t)?(0,ym.d_tensor_tensor)(e,t):(0,ym.d_tensor_scalar)(e,t):(0,E.istensor)(t)?(0,ym.d_scalar_tensor)(e,t):TT(e,t)}xa.derivative=tt;function TT(e,t){if((0,E.issymbol)(t))return NT(e,t);let r=(0,tv.subst)(e,t,(0,Pe.symbol)(E.SECRETX));return(0,tv.subst)(tt(r,(0,Pe.symbol)(E.SECRETX)),(0,Pe.symbol)(E.SECRETX),t)}function NT(e,t){if((0,zl.equal)(e,t))return E.Constants.one;if(!(0,E.iscons)(e))return E.Constants.zero;if((0,E.isadd)(e))return IT(e,t);switch((0,E.car)(e)){case(0,Pe.symbol)(E.MULTIPLY):return ST(e,t);case(0,Pe.symbol)(E.POWER):return RT(e,t);case(0,Pe.symbol)(E.DERIVATIVE):return LT(e,t);case(0,Pe.symbol)(E.LOG):return wT(e,t);case(0,Pe.symbol)(E.SIN):return PT(e,t);case(0,Pe.symbol)(E.COS):return DT(e,t);case(0,Pe.symbol)(E.TAN):return kT(e,t);case(0,Pe.symbol)(E.ARCSIN):return $T(e,t);case(0,Pe.symbol)(E.ARCCOS):return UT(e,t);case(0,Pe.symbol)(E.ARCTAN):return BT(e,t);case(0,Pe.symbol)(E.SINH):return GT(e,t);case(0,Pe.symbol)(E.COSH):return FT(e,t);case(0,Pe.symbol)(E.TANH):return jT(e,t);case(0,Pe.symbol)(E.ARCSINH):return zT(e,t);case(0,Pe.symbol)(E.ARCCOSH):return YT(e,t);case(0,Pe.symbol)(E.ARCTANH):return VT(e,t);case(0,Pe.symbol)(E.ABS):return ZT(e,t);case(0,Pe.symbol)(E.SGN):return XT(e,t);case(0,Pe.symbol)(E.HERMITE):return HT(e,t);case(0,Pe.symbol)(E.ERF):return QT(e,t);case(0,Pe.symbol)(E.ERFC):return WT(e,t);case(0,Pe.symbol)(E.BESSELJ):return JT(e,t);case(0,Pe.symbol)(E.BESSELY):return tN(e,t);default:}return(0,E.car)(e)===(0,Pe.symbol)(E.INTEGRAL)&&(0,E.caddr)(e)===t?oN(e):CT(e,t)}function IT(e,t){let r=(0,E.iscons)(e)?e.tail().map(n=>tt(n,t)):[];return(0,Tr.add_all)(r)}function ST(e,t){let r=(0,zl.length)(e)-1,n=[];for(let o=0;o<r;o++){let i=[],s=(0,E.cdr)(e);for(let u=0;u<r;u++){let c=(0,E.car)(s);o===u&&(c=tt(c,t)),i.push(c),s=(0,E.cdr)(s)}n.push((0,ye.multiply_all)(i))}return(0,Tr.add_all)(n)}function RT(e,t){let r=(0,ye.divide)((0,E.caddr)(e),(0,E.cadr)(e)),n=tt((0,E.cadr)(e),t),o=(0,xT.logarithm)((0,E.cadr)(e)),i=tt((0,E.caddr)(e),t);return(0,ye.multiply)((0,Tr.add)((0,ye.multiply)(r,n),(0,ye.multiply)(o,i)),e)}function wT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.divide)(r,(0,E.cadr)(e))}function LT(e,t){let r=tt((0,E.cadr)(e),t);return(0,E.car)(r)===(0,Pe.symbol)(E.DERIVATIVE)?(0,zl.lessp)((0,E.caddr)(r),(0,E.caddr)(e))?(0,jl.makeList)((0,Pe.symbol)(E.DERIVATIVE),(0,jl.makeList)((0,Pe.symbol)(E.DERIVATIVE),(0,E.cadr)(r),(0,E.caddr)(r)),(0,E.caddr)(e)):(0,jl.makeList)((0,Pe.symbol)(E.DERIVATIVE),(0,jl.makeList)((0,Pe.symbol)(E.DERIVATIVE),(0,E.cadr)(r),(0,E.caddr)(e)),(0,E.caddr)(r)):tt(r,(0,E.caddr)(e))}function CT(e,t){let r=(0,E.cdr)(e);return r===(0,Pe.symbol)(E.NIL)||(0,yT.Find)(r,t)?(0,jl.makeList)((0,Pe.symbol)(E.DERIVATIVE),e,t):E.Constants.zero}function PT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,nv.cosine)((0,E.cadr)(e)))}function DT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.negate)((0,ye.multiply)(r,(0,AT.sine)((0,E.cadr)(e))))}function kT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,br.power)((0,nv.cosine)((0,E.cadr)(e)),(0,Dt.integer)(-2)))}function $T(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,br.power)((0,Tr.subtract)(E.Constants.one,(0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2))),(0,Dt.rational)(-1,2)))}function UT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.negate)((0,ye.multiply)(r,(0,br.power)((0,Tr.subtract)(E.Constants.one,(0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2))),(0,Dt.rational)(-1,2))))}function BT(e,t){let r=tt((0,E.cadr)(e),t);return(0,hT.simplify)((0,ye.multiply)(r,(0,ye.inverse)((0,Tr.add)(E.Constants.one,(0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2))))))}function GT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,ov.ycosh)((0,E.cadr)(e)))}function FT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,OT.ysinh)((0,E.cadr)(e)))}function jT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,br.power)((0,ov.ycosh)((0,E.cadr)(e)),(0,Dt.integer)(-2)))}function zT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,br.power)((0,Tr.add)((0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2)),E.Constants.one),(0,Dt.rational)(-1,2)))}function YT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,br.power)((0,Tr.add)((0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2)),E.Constants.negOne),(0,Dt.rational)(-1,2)))}function VT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,ye.inverse)((0,Tr.subtract)(E.Constants.one,(0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2)))))}function ZT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,pT.sgn)((0,E.cadr)(e)))}function XT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)(r,(0,vT.dirac)((0,E.cadr)(e))),(0,Dt.integer)(2))}function HT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)(r,(0,ye.multiply)((0,Dt.integer)(2),(0,E.caddr)(e))),(0,qT.hermite)((0,E.cadr)(e),(0,Tr.add)((0,E.caddr)(e),E.Constants.negOne)))}function QT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)((0,ye.multiply)((0,zl.exponential)((0,ye.multiply)((0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2)),E.Constants.negOne)),(0,br.power)(E.Constants.Pi(),(0,Dt.rational)(-1,2))),(0,Dt.integer)(2)),r)}function WT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)((0,ye.multiply)((0,zl.exponential)((0,ye.multiply)((0,br.power)((0,E.cadr)(e),(0,Dt.integer)(2)),E.Constants.negOne)),(0,br.power)(E.Constants.Pi(),(0,Dt.rational)(-1,2))),(0,Dt.integer)(-2)),r)}function JT(e,t){return(0,iv.isZeroAtomOrTensor)((0,E.caddr)(e))?KT(e,t):eN(e,t)}function KT(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)(r,(0,Pc.besselj)((0,E.cadr)(e),E.Constants.one)),E.Constants.negOne)}function eN(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,Tr.add)((0,Pc.besselj)((0,E.cadr)(e),(0,Tr.add)((0,E.caddr)(e),E.Constants.negOne)),(0,ye.multiply)((0,ye.divide)((0,ye.multiply)((0,E.caddr)(e),E.Constants.negOne),(0,E.cadr)(e)),(0,Pc.besselj)((0,E.cadr)(e),(0,E.caddr)(e)))))}function tN(e,t){return(0,iv.isZeroAtomOrTensor)((0,E.caddr)(e))?rN(e,t):nN(e,t)}function rN(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)((0,ye.multiply)(r,(0,Pc.besselj)((0,E.cadr)(e),E.Constants.one)),E.Constants.negOne)}function nN(e,t){let r=tt((0,E.cadr)(e),t);return(0,ye.multiply)(r,(0,Tr.add)((0,Ky.bessely)((0,E.cadr)(e),(0,Tr.add)((0,E.caddr)(e),E.Constants.negOne)),(0,ye.multiply)((0,ye.divide)((0,ye.multiply)((0,E.caddr)(e),E.Constants.negOne),(0,E.cadr)(e)),(0,Ky.bessely)((0,E.cadr)(e),(0,E.caddr)(e)))))}function oN(e){return(0,E.cadr)(e)}});var av=A(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.Eval_user_function=void 0;var ze=N(),vm=Ee(),Ci=U(),iN=Ri(),qm=G(),Em=K(),sv=qt();function sN(e){if(ze.DEBUG&&console.log(`Eval_user_function evaluating: ${(0,ze.car)(e)}`),(0,ze.car)(e)===(0,Ci.symbol)(ze.SYMBOL_D)&&(0,Ci.get_binding)((0,Ci.symbol)(ze.SYMBOL_D))===(0,Ci.symbol)(ze.SYMBOL_D))return(0,iN.Eval_derivative)(e);let t=(0,qm.Eval)((0,ze.car)(e));(0,ze.isNumericAtom)(t)?(0,vm.stop)("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):(0,ze.istensor)(t)?(0,vm.stop)("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):(0,ze.isstr)(t)&&(0,vm.stop)("expected function, found string instead.");let r=(0,ze.car)((0,ze.cdr)(t)),n=(0,ze.car)((0,ze.cdr)((0,ze.cdr)(t))),o=(0,ze.cdr)(e);if((0,ze.car)(t)!==(0,Ci.symbol)(ze.FUNCTION)||t===(0,ze.car)(e))return(0,Em.makeList)(t,...(0,qm.evalList)(o));e=n;let i=o,s=[];for(;(0,ze.iscons)(e)&&(0,ze.iscons)(i);)s.push((0,ze.car)(e)),s.push((0,ze.car)(i)),e=(0,ze.cdr)(e),i=(0,ze.cdr)(i);return s.length&&(r=Dc(r,s)),(0,qm.Eval)(r)}kc.Eval_user_function=sN;function Dc(e,t){if((0,ze.istensor)(e))return aN(e,t);if((0,ze.iscons)(e)){let n=[];for((0,ze.car)(e)===t[0]?n.push((0,Em.makeList)((0,Ci.symbol)(ze.EVAL),t[1])):n.push((0,ze.car)(e)),e=(0,ze.cdr)(e);(0,ze.iscons)(e);)n.push(Dc((0,ze.car)(e),t)),e=(0,ze.cdr)(e);return(0,Em.makeList)(...n)}if(!(0,ze.issymbol)(e))return e;for(let n=0;n<t.length;n+=2)if(e===t[n])return t[n+1];let r=(0,Ci.get_binding)(e);return e!==r&&Dc(r,t)===r?e:r}function aN(e,t){return e=(0,sv.copy_tensor)(e),e.tensor.elem=e.tensor.elem.map(r=>Dc(r,t)),(0,sv.check_tensor_dimensions)(e),e}});var G=A(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.evalList=J.Eval_predicate=J.Eval_unit=J.Eval_subst=J.Eval_stop=J.Eval_sqrt=J.Eval_setq=J.Eval_rank=J.Eval_quote=J.Eval_operator=J.Eval_number=J.Eval_isinteger=J.Eval_invg=J.Eval_inv=J.Eval_index=J.Eval_hilbert=J.Eval_hermite=J.Eval_factorpoly=J.Eval_factorial=J.Eval_exp=J.Eval_Eval=J.Eval_dsolve=J.Eval_do=J.Eval_divisors=J.Eval_dim=J.Eval_det=J.Eval_check=J.Eval_binding=J.Eval_cons=J.Eval_sym=J.Eval=J.evaluate_integer=void 0;var cv=eb(),lN=It(),w=N(),mo=Ee(),pr=U(),Pi=F(),uN=Cf(),cN=mc(),fN=Zf(),dN=pi(),lv=Es(),mN=vd(),_N=$g(),fv=Il(),$c=H(),Uc=K(),bN=Ne(),gN=Et(),dv=Yr(),mv=qt(),uv=av();function xm(e){return(0,Pi.nativeInt)(Re(e))}J.evaluate_integer=xm;function Re(e){let t;(0,mo.check_esc_flag)(),e==null&&w.breakpoint,!w.defs.evaluatingAsFloats&&(0,$c.isfloating)(e)&&(t=!0,w.defs.evaluatingAsFloats=!0);try{switch(e.k){case w.CONS:return bv(e);case w.NUM:return w.defs.evaluatingAsFloats?(0,Pi.double)((0,Pi.convert_rational_to_double)(e)):e;case w.DOUBLE:case w.STR:return e;case w.TENSOR:return(0,mv.Eval_tensor)(e);case w.SYM:return _v(e);default:(0,mo.stop)("atom?")}}finally{t&&(w.defs.evaluatingAsFloats=!1)}}J.Eval=Re;function _v(e){if((0,pr.iskeyword)(e))return Re((0,Uc.makeList)(e,(0,pr.symbol)(w.LAST)));if(e===(0,pr.symbol)(w.PI)&&w.defs.evaluatingAsFloats)return w.Constants.piAsDouble;let t=(0,pr.get_binding)(e);if(w.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),e!==t){let r=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let o=r;o<w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;o++)n+=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[o].printname+" -> ";n+=e.printname,(0,mo.stop)("recursive evaluation of symbols: "+n);return}w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),t=Re(t),w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return t}J.Eval_sym=_v;function bv(e){let t=(0,w.car)(e);return(0,w.car)(t)===(0,pr.symbol)(w.EVAL)?(0,uv.Eval_user_function)(e):((0,w.issymbol)(t)||(0,mo.stop)("cons?"),t.keyword?t.keyword(e):(0,uv.Eval_user_function)(e))}J.Eval_cons=bv;function yN(e){return(0,pr.get_binding)((0,w.cadr)(e))}J.Eval_binding=yN;function vN(e){let t=(0,$c.isZeroLikeOrNonZeroLikeOrUndetermined)((0,w.cadr)(e));return t==null?e:(0,Pi.integer)(Number(t))}J.Eval_check=vN;function qN(e){let t=Re((0,w.cadr)(e));return(0,cN.det)(t)}J.Eval_det=qN;function EN(e){let t=Re((0,w.cadr)(e)),r=(0,w.iscons)((0,w.cddr)(e))?xm((0,w.caddr)(e)):1;return(0,w.istensor)(t)?r<1||r>t.tensor.ndim?e:(0,Pi.integer)(t.tensor.dim[r-1]):w.Constants.one}J.Eval_dim=EN;function xN(e){return(0,fN.divisors)(Re((0,w.cadr)(e)))}J.Eval_divisors=xN;function pN(e){let t=(0,w.car)(e);for(e=(0,w.cdr)(e);(0,w.iscons)(e);)t=Re((0,w.car)(e)),e=(0,w.cdr)(e);return t}J.Eval_do=pN;function hN(e){let t=Re((0,w.cadr)(e)),r=Re((0,w.caddr)(e)),n=Re((0,w.cadddr)(e));(0,mo.stop)("dsolve")}J.Eval_dsolve=hN;function AN(e){let t=Re((0,w.cadr)(e));for(e=(0,w.cddr)(e);(0,w.iscons)(e);)t=(0,dv.subst)(t,Re((0,w.car)(e)),Re((0,w.cadr)(e))),e=(0,w.cddr)(e);return Re(t)}J.Eval_Eval=AN;function ON(e){return(0,bN.exponential)(Re((0,w.cadr)(e)))}J.Eval_exp=ON;function MN(e){return(0,dN.factorial)(Re((0,w.cadr)(e)))}J.Eval_factorial=MN;function TN(e){e=(0,w.cdr)(e);let t=Re((0,w.car)(e));e=(0,w.cdr)(e);let r=Re((0,w.car)(e)),n=(0,lv.factorpoly)(t,r);return(0,w.iscons)(e)&&(n=e.tail().reduce((o,i)=>(0,lv.factorpoly)(o,Re(i)),n)),n}J.Eval_factorpoly=TN;function NN(e){let t=Re((0,w.caddr)(e)),r=Re((0,w.cadr)(e));return(0,mN.hermite)(r,t)}J.Eval_hermite=NN;function IN(e){return(0,_N.hilbert)(Re((0,w.cadr)(e)))}J.Eval_hilbert=IN;function SN(e){let t=e;e=(0,w.cdr)(e);let r=Re((0,w.car)(e));if((0,w.isNumericAtom)(r)&&(0,mo.stop)("trying to access a scalar as a tensor"),!(0,w.istensor)(r))return t;let n=[];for(e=(0,w.cdr)(e);(0,w.iscons)(e);){if(n.push(Re((0,w.car)(e))),!(0,$c.isintegerorintegerfloat)(n[n.length-1]))return t;e=(0,w.cdr)(e)}return(0,cv.index_function)(r,n)}J.Eval_index=SN;function RN(e){let t=Re((0,w.cadr)(e));return(0,fv.inv)(t)}J.Eval_inv=RN;function wN(e){let t=Re((0,w.cadr)(e));return(0,fv.invg)(t)}J.Eval_invg=wN;function LN(e){return e=Re((0,w.cadr)(e)),(0,w.isrational)(e)?(0,$c.isinteger)(e)?w.Constants.one:w.Constants.zero:(0,w.isdouble)(e)?Math.floor(e.d)===e.d?w.Constants.one:w.Constants.zero:(0,Uc.makeList)((0,pr.symbol)(w.ISINTEGER),e)}J.Eval_isinteger=LN;function CN(e){return e=Re((0,w.cadr)(e)),e.k===w.NUM||e.k===w.DOUBLE?w.Constants.one:w.Constants.zero}J.Eval_number=CN;function PN(e){return(0,Uc.makeList)((0,pr.symbol)(w.OPERATOR),...gv((0,w.cdr)(e)))}J.Eval_operator=PN;function DN(e){return(0,w.cadr)(e)}J.Eval_quote=DN;function kN(e){return e=Re((0,w.cadr)(e)),(0,w.istensor)(e)?(0,Pi.integer)(e.tensor.ndim):w.Constants.zero}J.Eval_rank=kN;function $N(e){if((0,w.caadr)(e)===(0,pr.symbol)(w.INDEX))return UN(e);if((0,w.iscons)((0,w.cadr)(e)))return(0,uN.define_user_function)(e);(0,w.issymbol)((0,w.cadr)(e))||(0,mo.stop)("symbol assignment: error in symbol");let t=Re((0,w.caddr)(e));return(0,pr.set_binding)((0,w.cadr)(e),t),(0,pr.symbol)(w.NIL)}J.Eval_setq=$N;function UN(e){let t=(0,w.cadadr)(e);console.log(`p4: ${t}`),(0,w.issymbol)(t)||(0,mo.stop)("indexed assignment: expected a symbol name");let r=Re((0,w.caddr)(e)),n=[],o=(0,w.cdadr)(e);(0,w.iscons)(o)&&(n=[...o].map(Re));let i=(0,cv.set_component)(r,...n);return(0,pr.set_binding)(t,i),(0,pr.symbol)(w.NIL)}function BN(e){let t=Re((0,w.cadr)(e));return(0,gN.power)(t,(0,Pi.rational)(1,2))}J.Eval_sqrt=BN;function GN(){(0,mo.stop)("user stop")}J.Eval_stop=GN;function FN(e){let t=Re((0,w.cadr)(e)),r=Re((0,w.caddr)(e)),n=Re((0,w.cadddr)(e));return Re((0,dv.subst)(n,r,t))}J.Eval_subst=FN;function jN(e){let t=xm((0,w.cadr)(e));if(isNaN(t)||t<1)return e;e=(0,lN.alloc_tensor)(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=w.Constants.one;return(0,mv.check_tensor_dimensions)(e),e}J.Eval_unit=jN;function zN(e){return(0,w.car)(e)===(0,pr.symbol)(w.SETQ)&&(e=(0,Uc.makeList)((0,pr.symbol)(w.TESTEQ),(0,w.cadr)(e),(0,w.caddr)(e))),Re(e)}J.Eval_predicate=zN;function*gv(e){if((0,w.iscons)(e))for(let t of e)yield Re(t)}J.evalList=gv});var ue=A(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.subtract=Pn.add_all=Pn.add=Pn.Eval_add=void 0;var ae=N(),YN=Ee(),Di=U(),yv=F(),VN=G(),pm=H(),ZN=K(),vv=Ne(),qv=Z(),XN=eo(),HN=qt(),Yl=0;function QN(e){let t=[];e=(0,ae.cdr)(e);for(let r of e){let n=(0,VN.Eval)(r);Bc(t,n)}return hm(t)}Pn.Eval_add=QN;function hm(e){if(ae.DEBUG)for(let t of e)console.log((0,XN.print_list)(t));for(let t=0;t<10&&!(e.length<2||(Yl=0,e.sort(JN),Yl===0));t++)KN(e);switch(e.length){case 0:return ae.Constants.Zero();case 1:return e[0];default:return e.unshift((0,Di.symbol)(ae.ADD)),(0,ZN.makeList)(...e)}}var WN=0;function JN(e,t){if(WN++,(0,ae.isNumericAtom)(e)&&(0,ae.isNumericAtom)(t))return Yl=1,0;if((0,ae.istensor)(e)&&(0,ae.istensor)(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return Yl=1,0}(0,ae.ismultiply)(e)&&(e=(0,ae.cdr)(e),(0,ae.isNumericAtom)((0,ae.car)(e))&&(e=(0,ae.cdr)(e),(0,ae.cdr)(e)===(0,Di.symbol)(ae.NIL)&&(e=(0,ae.car)(e)))),(0,ae.ismultiply)(t)&&(t=(0,ae.cdr)(t),(0,ae.isNumericAtom)((0,ae.car)(t))&&(t=(0,ae.cdr)(t),(0,ae.cdr)(t)===(0,Di.symbol)(ae.NIL)&&(t=(0,ae.car)(t))));let r=(0,vv.cmp_expr)(e,t);return r===0&&(Yl=1),r}function KN(e){let t=0;for(;t<e.length-1;){(0,YN.check_esc_flag)();let r,n,o=e[t],i=e[t+1];if((0,ae.istensor)(o)&&(0,ae.istensor)(i)){r=(0,HN.tensor_plus_tensor)(o,i),r!==(0,Di.symbol)(ae.NIL)&&(e.splice(t,2,r),t--),t++;continue}if((0,ae.istensor)(o)||(0,ae.istensor)(i)){t++;continue}if((0,ae.isNumericAtom)(o)&&(0,ae.isNumericAtom)(i)){r=(0,yv.add_numbers)(o,i),(0,pm.isZeroAtomOrTensor)(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if((0,ae.isNumericAtom)(o)||(0,ae.isNumericAtom)(i)){t++;continue}r=ae.Constants.One(),n=ae.Constants.One();let s=0;if((0,ae.ismultiply)(o)&&(o=(0,ae.cdr)(o),s=1,(0,ae.isNumericAtom)((0,ae.car)(o))&&(r=(0,ae.car)(o),o=(0,ae.cdr)(o),(0,ae.cdr)(o)===(0,Di.symbol)(ae.NIL)&&(o=(0,ae.car)(o),s=0))),(0,ae.ismultiply)(i)&&(i=(0,ae.cdr)(i),(0,ae.isNumericAtom)((0,ae.car)(i))&&(n=(0,ae.car)(i),i=(0,ae.cdr)(i),(0,ae.cdr)(i)===(0,Di.symbol)(ae.NIL)&&(i=(0,ae.car)(i)))),!(0,vv.equal)(o,i)){t++;continue}if(r=(0,yv.add_numbers)(r,n),(0,pm.isZeroAtomOrTensor)(r)){e.splice(t,2),t--,t++;continue}let u=s?new ae.Cons((0,Di.symbol)(ae.MULTIPLY),o):o;e.splice(t,2,(0,qv.multiply)(r,u)),t--,t++}}function Bc(e,t){(0,ae.isadd)(t)?e.push(...t.tail()):(0,pm.isZeroAtom)(t)||e.push(t)}function Ev(e,t){let r=[];return Bc(r,e),Bc(r,t),hm(r)}Pn.add=Ev;function eI(e){let t=[];for(let r of e)Bc(t,r);return hm(t)}Pn.add_all=eI;function tI(e,t){return Ev(e,(0,qv.negate)(t))}Pn.subtract=tI});var on=A(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.absval=Dn.abs=Dn.absValFloat=Dn.Eval_abs=void 0;var ct=N(),Am=ir(),rI=Ee(),Vl=U(),nI=Ne(),oI=ue(),Gc=F(),iI=yi(),sI=Mn(),jc=G(),aI=Rn(),lI=ql(),uI=Go(),ki=H(),xv=K(),Fc=Z(),cI=oo(),Zl=Et(),pv=Us(),fI=Kn(),hv=Zo(),Nr=!1;function dI(e){return Om((0,jc.Eval)((0,ct.cadr)(e)))}Dn.Eval_abs=dI;function mI(e){return(0,aI.zzfloat)((0,jc.Eval)(Xl((0,jc.Eval)(e))))}Dn.absValFloat=mI;function Om(e){let t=(0,cI.numerator)(e),r=Xl(t),n=(0,sI.denominator)(e),o=Xl(n),i=(0,Fc.divide)(r,o);return Nr&&(console.trace(">>>>  ABS of "+e),console.log(`ABS numerator ${t}`),console.log(`ABSVAL numerator: ${r}`),console.log(`ABS denominator: ${n}`),console.log(`ABSVAL denominator: ${o}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}Dn.abs=Om;function Xl(e){let t=e;if(Nr&&console.log(`ABS of ${e}`),(0,ki.isZeroAtomOrTensor)(e))return Nr&&(console.log(` abs: ${e} just zero`),console.log(" --> ABS of "+t+" : "+ct.Constants.zero)),ct.Constants.zero;if((0,ki.isnegativenumber)(e))return Nr&&console.log(` abs: ${e} just a negative`),(0,Fc.negate)(e);if((0,ki.ispositivenumber)(e))return Nr&&(console.log(` abs: ${e} just a positive`),console.log(` --> ABS of ${t} : ${e}`)),e;if(e===(0,Vl.symbol)(ct.PI))return Nr&&(console.log(` abs: ${e} of PI`),console.log(` --> ABS of ${t} : ${e}`)),e;if((0,ct.isadd)(e)&&((0,Am.findPossibleClockForm)(e,e)||(0,Am.findPossibleExponentialForm)(e)||(0,Am.Find)(e,ct.Constants.imaginaryunit))){Nr&&(console.log(` abs: ${e} is a sum`),console.log("abs of a sum")),e=(0,fI.rect)(e);let n=(0,hv.simplify_trig)((0,Zl.power)((0,oI.add)((0,Zl.power)((0,pv.real)(e),(0,Gc.integer)(2)),(0,Zl.power)((0,lI.imag)(e),(0,Gc.integer)(2))),(0,Gc.rational)(1,2)));return Nr&&console.log(` --> ABS of ${t} : ${n}`),n}if((0,ct.ispower)(e)&&(0,ki.equaln)((0,ct.cadr)(e),-1)){let n=ct.Constants.One();if(Nr){console.log(` abs: ${e} is -1 to any power`);let o=ct.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(o),console.log(` --> ABS of ${t} : ${n}`)}return n}if((0,ct.ispower)(e)&&(0,ki.ispositivenumber)((0,ct.caddr)(e))){let n=(0,Zl.power)(Om((0,ct.cadr)(e)),(0,ct.caddr)(e));return Nr&&(console.log(` abs: ${e} is something to the power of a positive number`),console.log(` --> ABS of ${t} : ${n}`)),n}if((0,ct.ispower)(e)&&(0,ct.cadr)(e)===(0,Vl.symbol)(ct.E)){let n=(0,nI.exponential)((0,pv.real)((0,ct.caddr)(e)));return Nr&&(console.log(` abs: ${e} is an exponential`),console.log(` --> ABS of ${t} : ${n}`)),n}if((0,ct.ismultiply)(e)){let n=e.tail().map(Xl).reduce(Fc.multiply);return Nr&&(console.log(` abs: ${e} is a product`),console.log(` --> ABS of ${t} : ${n}`)),n}if((0,ct.car)(e)===(0,Vl.symbol)(ct.ABS)){let n=(0,xv.makeList)((0,Vl.symbol)(ct.ABS),(0,ct.cadr)(e));return Nr&&(console.log(` abs: ${e} is abs of a abs`),console.log(` --> ABS of ${t} : ${n}`)),n}if((0,ct.istensor)(e))return _I(e);((0,ki.isnegativeterm)(e)||(0,ct.isadd)(e)&&(0,ki.isnegativeterm)((0,ct.cadr)(e)))&&(e=(0,Fc.negate)(e));let r=(0,xv.makeList)((0,Vl.symbol)(ct.ABS),e);return Nr&&(console.log(` abs: ${e} is nothing decomposable`),console.log(` --> ABS of ${t} : ${r}`)),r}Dn.absval=Xl;function _I(e){return e.tensor.ndim!==1&&(0,rI.stop)("abs(tensor) with tensor rank > 1"),(0,jc.Eval)((0,hv.simplify)((0,Zl.power)((0,uI.inner)(e,(0,iI.conjugate)(e)),(0,Gc.rational)(1,2))))}});var H=A(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.isnpi=Y.isquarterturn=Y.isimaginaryunit=Y.isfloating=Y.isMinusSqrtThreeOverTwo=Y.isSqrtThreeOverTwo=Y.isminusoneoversqrttwo=Y.isoneoversqrttwo=Y.isminusoneovertwo=Y.isoneovertwo=Y.equalq=Y.equaln=Y.isfraction=Y.isoneover=Y.isNumberOneOverSomething=Y.isintegerfactor=Y.issymbolic=Y.isnegative=Y.iseveninteger=Y.iscomplexnumber=Y.iscomplexnumberdouble=Y.isimaginarynumber=Y.isnegativeterm=Y.ispolyexpandedform=Y.isunivarpolyfactoredorexpandedform=Y.isposint=Y.isnonnegativeinteger=Y.isintegerorintegerfloat=Y.isinteger=Y.isone=Y.isminusone=Y.isplusone=Y.isplustwo=Y.ispositivenumber=Y.isnegativenumber=Y.isZeroLikeOrNonZeroLikeOrUndetermined=Y.isZeroAtomOrTensor=Y.isZeroAtom=void 0;var h=N(),pa=ir(),Wo=U(),Jt=Ne(),bI=on(),Yc=F(),Av=G(),gI=Rn(),yI=Vr(),Iv=Z(),Ql=!1;function Sv(e){switch(e.k){case h.NUM:if((0,h.MZERO)(e.q.a))return!0;break;case h.DOUBLE:if(e.d===0)return!0;break}return!1}Y.isZeroAtom=Sv;function vI(e){return(0,h.istensor)(e)?e.tensor.elem.every(t=>Hl(t)):!1}function Hl(e){return Sv(e)||vI(e)}Y.isZeroAtomOrTensor=Hl;function qI(e){let t=(0,Av.Eval_predicate)(e);if(Hl(t))return!1;if((0,h.isNumericAtomOrTensor)(t))return!0;if(t=(0,gI.zzfloat)(t),Hl(t))return!1;if((0,h.isNumericAtomOrTensor)(t))return!0;if((0,pa.Find)(t,h.Constants.imaginaryunit)){if(t=(0,Av.Eval_predicate)((0,bI.absValFloat)(t)),Hl(t))return!1;if((0,h.isNumericAtomOrTensor)(t))return!0}return null}Y.isZeroLikeOrNonZeroLikeOrUndetermined=qI;function Vc(e){switch(e.k){case h.NUM:if((0,h.MSIGN)(e.q.a)===-1)return!0;break;case h.DOUBLE:if(e.d<0)return!0;break}return!1}Y.isnegativenumber=Vc;function EI(e){switch(e.k){case h.NUM:if((0,h.MSIGN)(e.q.a)===1)return!0;break;case h.DOUBLE:if(e.d>0)return!0;break}return!1}Y.ispositivenumber=EI;function xI(e){switch(e.k){case h.NUM:if((0,h.MEQUAL)(e.q.a,2)&&(0,h.MEQUAL)(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===2)return!0;break}return!1}Y.isplustwo=xI;function Rv(e){switch(e.k){case h.NUM:if((0,h.MEQUAL)(e.q.a,1)&&(0,h.MEQUAL)(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===1)return!0;break}return!1}Y.isplusone=Rv;function Nm(e){switch(e.k){case h.NUM:if((0,h.MEQUAL)(e.q.a,-1)&&(0,h.MEQUAL)(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===-1)return!0;break}return!1}Y.isminusone=Nm;function pI(e){return Rv(e)||Nm(e)}Y.isone=pI;function $i(e){return e.k===h.NUM&&(0,h.MEQUAL)(e.q.b,1)}Y.isinteger=$i;function hI(e){return e.k===h.DOUBLE?e.d===Math.round(e.d):$i(e)}Y.isintegerorintegerfloat=hI;function AI(e){return(0,h.isrational)(e)&&(0,h.MEQUAL)(e.q.b,1)&&(0,h.MSIGN)(e.q.a)===1}Y.isnonnegativeinteger=AI;function Zc(e){return $i(e)&&(0,h.MSIGN)(e.q.a)===1}Y.isposint=Zc;function OI(e,t){return t==null&&(t=(0,yI.guess)(e)),TI(e,t)&&MI((0,pa.Find)(e,(0,Wo.symbol)(h.SYMBOL_X)),(0,pa.Find)(e,(0,Wo.symbol)(h.SYMBOL_Y)),(0,pa.Find)(e,(0,Wo.symbol)(h.SYMBOL_Z)))===1?t:!1}Y.isunivarpolyfactoredorexpandedform=OI;function MI(...e){return e.reduce((t,r)=>t+Number(r),0)}function TI(e,t){return NI(e,t)}function NI(e,t){return(0,h.ismultiply)(e)?e.tail().every(r=>{let n=Ov(r,t);return h.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):Ov(e,t)}function Ov(e,t){return(0,h.ispower)(e)?(h.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Zc((0,h.caddr)(e)),h.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+zc((0,h.cadr)(e),t)):void 0)),Zc((0,h.caddr)(e))&&zc((0,h.cadr)(e),t)):(h.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),zc(e,t))}function II(e,t){return(0,pa.Find)(e,t)?zc(e,t):!1}Y.ispolyexpandedform=II;function zc(e,t){return(0,h.isadd)(e)?e.tail().every(r=>Mv(r,t)):Mv(e,t)}function Mv(e,t){return(0,h.ismultiply)(e)?e.tail().every(r=>Tv(r,t)):Tv(e,t)}function Tv(e,t){return(0,Jt.equal)(e,t)?!0:(0,h.ispower)(e)&&(0,Jt.equal)((0,h.cadr)(e),t)?Zc((0,h.caddr)(e)):!(0,pa.Find)(e,t)}function Mm(e){return Vc(e)||(0,h.ismultiply)(e)&&Vc((0,h.cadr)(e))}Y.isnegativeterm=Mm;function wv(e){return(0,h.ispower)(e)&&(0,h.isrational)((0,h.car)((0,h.cdr)((0,h.cdr)(e))))&&Vc((0,h.car)((0,h.cdr)(e)))?(Ql&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(Ql&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function Nv(e){return(0,h.ismultiply)(e)&&(0,Jt.length)(e)===3&&(0,h.isdouble)((0,h.cadr)(e))&&wv((0,h.caddr)(e))||(0,Jt.equal)(e,h.Constants.imaginaryunit)}function Tm(e){return(0,h.ismultiply)(e)&&(0,Jt.length)(e)===3&&(0,h.isNumericAtom)((0,h.cadr)(e))&&(0,Jt.equal)((0,h.caddr)(e),h.Constants.imaginaryunit)||(0,Jt.equal)(e,h.Constants.imaginaryunit)||wv((0,h.caddr)(e))?(Ql&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(Ql&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}Y.isimaginarynumber=Tm;function SI(e){return(0,h.isadd)(e)&&(0,Jt.length)(e)===3&&(0,h.isdouble)((0,h.cadr)(e))&&Nv((0,h.caddr)(e))||Nv(e)}Y.iscomplexnumberdouble=SI;function RI(e){return Ql&&h.breakpoint,(0,h.isadd)(e)&&(0,Jt.length)(e)===3&&(0,h.isNumericAtom)((0,h.cadr)(e))&&Tm((0,h.caddr)(e))||Tm(e)?(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}Y.iscomplexnumber=RI;function wI(e){return $i(e)&&e.q.a.isEven()}Y.iseveninteger=wI;function LI(e){return(0,h.isadd)(e)&&Mm((0,h.cadr)(e))||Mm(e)}Y.isnegative=LI;function Lv(e){return(0,h.issymbol)(e)?!0:(0,h.iscons)(e)?[...e].some(Lv):!1}Y.issymbolic=Lv;function CI(e){return $i(e)||(0,h.ispower)(e)&&$i((0,h.cadr)(e))&&$i((0,h.caddr)(e))}Y.isintegerfactor=CI;function PI(e){return Cv(e)&&(0,h.MEQUAL)(e.q.a.abs(),1)}Y.isNumberOneOverSomething=PI;function DI(e){return(0,h.ispower)(e)&&Nm((0,h.caddr)(e))}Y.isoneover=DI;function Cv(e){return e.k===h.NUM&&!(0,h.MEQUAL)(e.q.b,1)}Y.isfraction=Cv;function Xc(e,t){switch(e.k){case h.NUM:return(0,h.MEQUAL)(e.q.a,t)&&(0,h.MEQUAL)(e.q.b,1);case h.DOUBLE:return e.d===t;default:return!1}}Y.equaln=Xc;function Hc(e,t,r){switch(e.k){case h.NUM:return(0,h.MEQUAL)(e.q.a,t)&&(0,h.MEQUAL)(e.q.b,r);case h.DOUBLE:return e.d===t/r;default:return!1}}Y.equalq=Hc;function Im(e){return Hc(e,1,2)}Y.isoneovertwo=Im;function Pv(e){return Hc(e,-1,2)}Y.isminusoneovertwo=Pv;function Dv(e){return(0,h.ispower)(e)&&Xc((0,h.cadr)(e),2)&&Hc((0,h.caddr)(e),-1,2)}Y.isoneoversqrttwo=Dv;function kI(e){return(0,h.ismultiply)(e)&&Xc((0,h.cadr)(e),-1)&&Dv((0,h.caddr)(e))&&(0,Jt.length)(e)===3}Y.isminusoneoversqrttwo=kI;function $I(e){return(0,h.ismultiply)(e)&&Im((0,h.cadr)(e))&&kv((0,h.caddr)(e))&&(0,Jt.length)(e)===3}Y.isSqrtThreeOverTwo=$I;function UI(e){return(0,h.ismultiply)(e)&&Pv((0,h.cadr)(e))&&kv((0,h.caddr)(e))&&(0,Jt.length)(e)===3}Y.isMinusSqrtThreeOverTwo=UI;function kv(e){return(0,h.ispower)(e)&&Xc((0,h.cadr)(e),3)&&Im((0,h.caddr)(e))}function $v(e){return e.k===h.DOUBLE||e===(0,Wo.symbol)(h.FLOATF)?!0:(0,h.iscons)(e)?[...e].some($v):!1}Y.isfloating=$v;function BI(e){return(0,Jt.equal)(e,h.Constants.imaginaryunit)}Y.isimaginaryunit=BI;function GI(e){let t=0;if(!(0,h.ismultiply)(e))return 0;if((0,Jt.equal)((0,h.cadr)(e),h.Constants.imaginaryunit))return(0,h.caddr)(e)!==(0,Wo.symbol)(h.PI)||(0,Jt.length)(e)!==3?0:2;if(!(0,h.isNumericAtom)((0,h.cadr)(e))||!(0,Jt.equal)((0,h.caddr)(e),h.Constants.imaginaryunit)||(0,h.cadddr)(e)!==(0,Wo.symbol)(h.PI)||(0,Jt.length)(e)!==4)return 0;let r=(0,Yc.nativeInt)((0,Iv.multiply)((0,h.cadr)(e),(0,Yc.integer)(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}Y.isquarterturn=GI;function FI(e){let t=0;return e===(0,Wo.symbol)(h.PI)?2:!(0,h.ismultiply)(e)||!(0,h.isNumericAtom)((0,h.cadr)(e))||(0,h.caddr)(e)!==(0,Wo.symbol)(h.PI)||(0,Jt.length)(e)!==3||(t=(0,Yc.nativeInt)((0,Iv.multiply)((0,h.cadr)(e),(0,Yc.integer)(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}Y.isnpi=FI});var lo=A(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.yn=Rt.jn=Rt.append=Rt.isalnumorunderscore=Rt.isalpha=Rt.isdigit=Rt.isspace=Rt.clear_term=Rt.doubleToReasonableString=Rt.strcmp=void 0;var jI=F(),zI=H(),YI=K(),Jo=N(),Uv=Ee(),Qc=U();function VI(e,t){return e===t?0:e>t?1:-1}Rt.strcmp=VI;function ZI(e){let t;if(Jo.defs.codeGen||Jo.defs.fullDoubleOutput)return""+e;if((0,zI.isZeroAtomOrTensor)((0,Qc.get_binding)((0,Qc.symbol)(Jo.FORCE_FIXED_PRINTOUT))))t=""+e,Jo.defs.printMode===Jo.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=(0,jI.nativeInt)((0,Qc.get_binding)((0,Qc.symbol)(Jo.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}Rt.doubleToReasonableString=ZI;function XI(){}Rt.clear_term=XI;function HI(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}Rt.isspace=HI;function Bv(e){return e==null?!1:/^\d+$/.test(e)}Rt.isdigit=Bv;function QI(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}Rt.isalpha=QI;function WI(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function JI(e){return e==null?!1:WI(e)||Bv(e)}Rt.isalnumorunderscore=JI;function KI(e,t){let r=[];return(0,Jo.iscons)(e)&&r.push(...e),(0,Jo.iscons)(t)&&r.push(...t),(0,YI.makeList)(...r)}Rt.append=KI;function eS(e,t){(0,Uv.stop)("Not implemented")}Rt.jn=eS;function tS(e,t){(0,Uv.stop)("Not implemented")}Rt.yn=tS});var Gv=A(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.qadd=void 0;var Sm=N(),rS=F(),nS=Gf(),oS=ys(),Wl=ln();function iS(e,t){let r=(0,Wl.mmul)(e.q.a,t.q.b),n=(0,Wl.mmul)(e.q.b,t.q.a),o=(0,nS.madd)(r,n);if((0,Sm.MZERO)(o))return Sm.Constants.zero;let i=(0,Wl.mmul)(e.q.b,t.q.b),s=(0,oS.mgcd)(o,i);s=(0,rS.makeSignSameAs)(s,i);let u=(0,Wl.mdiv)(o,s),c=(0,Wl.mdiv)(i,s);return new Sm.Num(u,c)}Wc.qadd=iS});var Fv=A(e0=>{"use strict";Object.defineProperty(e0,"__esModule",{value:!0});e0.qdiv=void 0;var Jc=N(),sS=Ee(),aS=F(),lS=ys(),Kc=ln();function uS(e,t){if((0,Jc.MZERO)(t.q.a)&&(0,sS.stop)("divide by zero"),(0,Jc.MZERO)(e.q.a))return Jc.Constants.zero;let r=(0,Kc.mmul)(e.q.a,t.q.b),n=(0,Kc.mmul)(e.q.b,t.q.a),o=(0,lS.mgcd)(r,n);return o=(0,aS.makeSignSameAs)(o,n),new Jc.Num((0,Kc.mdiv)(r,o),(0,Kc.mdiv)(n,o))}e0.qdiv=uS});var jv=A(n0=>{"use strict";Object.defineProperty(n0,"__esModule",{value:!0});n0.qmul=void 0;var t0=N(),cS=F(),fS=ys(),r0=ln();function dS(e,t){if((0,t0.MZERO)(e.q.a)||(0,t0.MZERO)(t.q.a))return t0.Constants.zero;let r=(0,r0.mmul)(e.q.a,t.q.a),n=(0,r0.mmul)(e.q.b,t.q.b),o=(0,fS.mgcd)(r,n);return o=(0,cS.makeSignSameAs)(o,n),new t0.Num((0,r0.mdiv)(r,o),(0,r0.mdiv)(n,o))}n0.qmul=dS});var F=A(oe=>{"use strict";var mS=oe&&oe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oe,"__esModule",{value:!0});oe.bignum_factorial=oe.bignum_float=oe.nativeDouble=oe.gcd_numbers=oe.print_number=oe.bignum_scan_float=oe.bignum_scan_integer=oe.nativeInt=oe.rational=oe.double=oe.integer=oe.convert_rational_to_double=oe.bignum_power_number=oe.mp_denominator=oe.mp_numerator=oe.bignum_truncate=oe.negate_number=oe.compare_numbers=oe.invert_number=oe.divide_numbers=oe.multiply_numbers=oe.add_numbers=oe.makePositive=oe.makeSignSameAs=oe.setSignTo=oe.isSmall=oe.mint=void 0;var kt=mS(To()),fe=N(),_S=Tu(),bS=lo(),Rm=Ee(),ha=H(),zv=ys(),o0=ln(),Yv=nc(),gS=Z(),yS=Gv(),vS=Fv(),qS=jv();function ES(e){return(0,kt.default)(e)}oe.mint=ES;function Vv(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}oe.isSmall=Vv;function i0(e,t){if(e.isPositive()){if(t<0)return e.multiply((0,kt.default)(-1))}else if(t>0)return e.multiply((0,kt.default)(-1));return e}oe.setSignTo=i0;function wm(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply((0,kt.default)(-1))}else if(t.isPositive())return e.multiply((0,kt.default)(-1));return e}oe.makeSignSameAs=wm;function xS(e){return e.isNegative()?e.multiply((0,kt.default)(-1)):e}oe.makePositive=xS;function pS(e,t){if((0,fe.isrational)(e)&&(0,fe.isrational)(t))return(0,yS.qadd)(e,t);let r=(0,fe.isdouble)(e)?e.d:mn(e),n=(0,fe.isdouble)(t)?t.d:mn(t);return Lm(r+n)}oe.add_numbers=pS;function hS(e,t){if((0,fe.isrational)(e)&&(0,fe.isrational)(t))return(0,qS.qmul)(e,t);let r=(0,fe.isdouble)(e)?e.d:mn(e),n=(0,fe.isdouble)(t)?t.d:mn(t);return new fe.Double(r*n)}oe.multiply_numbers=hS;function AS(e,t){if((0,fe.isrational)(e)&&(0,fe.isrational)(t))return(0,vS.qdiv)(e,t);(0,ha.isZeroAtomOrTensor)(t)&&(0,Rm.stop)("divide by zero");let r=(0,fe.isdouble)(e)?e.d:mn(e),n=(0,fe.isdouble)(t)?t.d:mn(t);return new fe.Double(r/n)}oe.divide_numbers=AS;function OS(e){if((0,ha.isZeroAtomOrTensor)(e)&&(0,Rm.stop)("divide by zero"),(0,fe.isdouble)(e))return new fe.Double(1/e.d);let t=(0,kt.default)(e.q.a),r=(0,kt.default)(e.q.b);return r=wm(r,t),t=i0(t,1),new fe.Num(r,t)}oe.invert_number=OS;function MS(e,t){let r=(0,o0.mmul)(e.q.a,t.q.b),n=(0,o0.mmul)(e.q.b,t.q.a);return(0,_S.mcmp)(r,n)}function TS(e,t){if((0,fe.isrational)(e)&&(0,fe.isrational)(t))return MS(e,t);let r=(0,fe.isdouble)(e)?e.d:mn(e),n=(0,fe.isdouble)(t)?t.d:mn(t);return r<n?-1:r>n?1:0}oe.compare_numbers=TS;function NS(e){if((0,ha.isZeroAtomOrTensor)(e))return e;switch(e.k){case fe.NUM:return new fe.Num((0,kt.default)(e.q.a.multiply(kt.default.minusOne)),(0,kt.default)(e.q.b));case fe.DOUBLE:return new fe.Double(-e.d);default:(0,Rm.stop)("bug caught in mp_negate_number")}}oe.negate_number=NS;function IS(e){let t=(0,o0.mdiv)(e.q.a,e.q.b);return new fe.Num(t)}oe.bignum_truncate=IS;function SS(e){return(0,fe.isrational)(e)?new fe.Num((0,kt.default)(e.q.a)):fe.Constants.one}oe.mp_numerator=SS;function RS(e){return(0,fe.isrational)(e)?new fe.Num((0,kt.default)(e.q.b)):fe.Constants.one}oe.mp_denominator=RS;function wS(e,t){let r=(0,Yv.mpow)(e.q.a,Math.abs(t)),n=(0,Yv.mpow)(e.q.b,Math.abs(t));if(t<0){let o=r;r=n,n=o,r=wm(r,n),n=i0(n,1)}return new fe.Num(r,n)}oe.bignum_power_number=wS;function mn(e){e.q==null&&fe.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}oe.convert_rational_to_double=mn;function LS(e){return new fe.Num((0,kt.default)(e))}oe.integer=LS;function Lm(e){return new fe.Double(e)}oe.double=Lm;function CS(e,t){return new fe.Num((0,kt.default)(e),(0,kt.default)(t))}oe.rational=CS;function PS(e){let t=NaN;switch(e.k){case fe.NUM:(0,ha.isinteger)(e)&&Vv(e.q.a)&&(t=e.q.a.toJSNumber());break;case fe.DOUBLE:fe.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(fe.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}oe.nativeInt=PS;function DS(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=(0,kt.default)(e.substring(t)),o=new fe.Num(n);return r==="-"&&(o=(0,gS.negate)(o)),o}oe.bignum_scan_integer=DS;function kS(e){return Lm(parseFloat(e))}oe.bignum_scan_float=kS;function $S(e,t){let r="",n="",o="";switch(e.k){case fe.NUM:var i=e.q.a.toString();t||i[0]==="-"&&(i=i.substring(1)),fe.defs.printMode===fe.PRINTMODE_LATEX&&(0,ha.isfraction)(e)&&(i="\\frac{"+i+"}{"),r+=i,(0,ha.isfraction)(e)&&(fe.defs.printMode!==fe.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),fe.defs.printMode===fe.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case fe.DOUBLE:i=(0,bS.doubleToReasonableString)(e.d),t||i[0]==="-"&&(i=i.substring(1)),r+=i;break}return r}oe.print_number=$S;function US(e,t){let r=(0,zv.mgcd)(e.q.a,t.q.a),n=(0,zv.mgcd)(e.q.b,t.q.b);return new fe.Num(i0(r,1),n)}oe.gcd_numbers=US;function BS(e){let t=0;switch(e.k){case fe.NUM:t=mn(e);break;case fe.DOUBLE:({d:t}=e);break;default:t=0}return t}oe.nativeDouble=BS;function GS(e){let t=mn(e);return new fe.Double(t)}oe.bignum_float=GS;function FS(e){return new fe.Num(jS(e))}oe.bignum_factorial=FS;function jS(e){let t;if(e===0||e===1)return t=(0,kt.default)(1),t;t=(0,kt.default)(2);let r=(0,kt.default)(0);if(3<=e)for(let n=3;n<=e;n++)r=(0,kt.default)(n),t=(0,o0.mmul)(t,r);return t}});var tm=A(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.polyform=Oa.bake=void 0;var Mt=N(),zS=F(),YS=gi(),Ko=H(),Jl=K(),Ir=U();function Zv(e){return(0,Mt.doexpand)(VS,e)}Oa.bake=Zv;function VS(e){let t=(0,Ko.ispolyexpandedform)(e,(0,Ir.symbol)(Mt.SYMBOL_S)),r=(0,Ko.ispolyexpandedform)(e,(0,Ir.symbol)(Mt.SYMBOL_T)),n=(0,Ko.ispolyexpandedform)(e,(0,Ir.symbol)(Mt.SYMBOL_X)),o=(0,Ko.ispolyexpandedform)(e,(0,Ir.symbol)(Mt.SYMBOL_Y)),i=(0,Ko.ispolyexpandedform)(e,(0,Ir.symbol)(Mt.SYMBOL_Z)),s;return t&&!r&&!n&&!o&&!i?s=Aa(e,(0,Ir.symbol)(Mt.SYMBOL_S)):!t&&r&&!n&&!o&&!i?s=Aa(e,(0,Ir.symbol)(Mt.SYMBOL_T)):!t&&!r&&n&&!o&&!i?s=Aa(e,(0,Ir.symbol)(Mt.SYMBOL_X)):!t&&!r&&!n&&o&&!i?s=Aa(e,(0,Ir.symbol)(Mt.SYMBOL_Y)):!t&&!r&&!n&&!o&&i?s=Aa(e,(0,Ir.symbol)(Mt.SYMBOL_Z)):(0,Mt.iscons)(e)&&(0,Mt.car)(e)!==(0,Ir.symbol)(Mt.FOR)?s=(0,Jl.makeList)((0,Mt.car)(e),...e.tail().map(Zv)):s=e,s}function Xv(e,t){return(0,Ko.ispolyexpandedform)(e,t)?Aa(e,t):(0,Mt.iscons)(e)?(0,Jl.makeList)((0,Mt.car)(e),...e.tail().map(r=>Xv(r,t))):e}Oa.polyform=Xv;function Aa(e,t){let r=(0,YS.coeff)(e,t),n=[];for(let o=r.length-1;o>=0;o--){let i=r[o];n.push(...ZS(o,i,t))}return n.length>1?new Mt.Cons((0,Ir.symbol)(Mt.ADD),(0,Jl.makeList)(...n)):n[0]}function ZS(e,t,r){if((0,Ko.isZeroAtomOrTensor)(t))return[];if(e===0)return(0,Mt.isadd)(t)?t.tail():[t];let n=[];return(0,Mt.ismultiply)(t)?n.push(...t.tail()):(0,Ko.equaln)(t,1)||n.push(t),e===1?n.push(r):n.push((0,Jl.makeList)((0,Ir.symbol)(Mt.POWER),r,(0,zS.integer)(e))),n.length>1?[(0,Jl.makeList)((0,Ir.symbol)(Mt.MULTIPLY),...n)]:n}});var Dm=A(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.testApprox=Qr.approxAll=Qr.approxRationalsOfLogs=Qr.approxRadicals=Qr.Eval_approxratio=void 0;var XS=It(),_o=N(),HS=U(),Hv=F(),QS=Rn(),WS=K(),JS=qt();function KS(e){return s0((0,_o.cadr)(e))}Qr.Eval_approxratio=KS;function s0(e){if((0,_o.istensor)(e)){let t=(0,XS.alloc_tensor)(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=s0(r);return(0,JS.check_tensor_dimensions)(t),n}),t}return e.k===_o.DOUBLE?eR(e):(0,_o.iscons)(e)?new _o.Cons(s0((0,_o.car)(e)),s0((0,_o.cdr)(e))):e}function eR(e){let t=(0,QS.zzfloat)(e);if(t.k===_o.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let o=n[1].length,i=1/Math.pow(10,o),s=tR(r,i);return(0,Hv.rational)(s[0],s[1])}return(0,Hv.integer)(r)}return(0,WS.makeList)((0,HS.symbol)(_o.APPROXRATIO),t)}function tR(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,o=0,i=1,s;for(;;){n=1/(n-Math.floor(n));let u=i;if(i=i*Math.floor(n)+o,o=u,s=Math.floor(e*i+.5),!(Math.abs(e-s/i)>t)||n===Math.floor(n))break}return s=r*s,[s,i]}var Wr=0,rR=1,Qv=2,Wv=3,Cm=4,nR=6,Jv=7,oR=8,iR=9;function sR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let s=1;s<=10;s++){let u,c,d,_=Math.sqrt(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * sqrt( ${i} ) / ${s}`,nR,c,i,s])}}return n}function aR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let s of[1,2,3,5,6,7,8,10]){let u,c,d,_=Math.sqrt(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (sqrt( ${i} / ${s} )`,Cm,c,i,s])}}return n}function Ui(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=sR(e);if(n!=null)return n;let o=aR(e);return o!=null?o:null}Qr.approxRadicals=Ui;function Kl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Kv(e);if(n!=null)return n;let o=lR(e);return o!=null?o:null}function Kv(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/s))===Math.abs(c/s))&&u<2.2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} ) / ${s}`,iR,c,i,s])}}return n}Qr.approxRationalsOfLogs=Kv;function lR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<1.96*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} / ${s} )`,oR,c,i,s])}}return n}function e1(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.E,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (e ^ ${i} ) / ${s}`,Jv,c,i,s])}}return n}function Pm(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.PI,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (pi ^ ${i} ) / ${s} )`,Wv,c,i,s])}}return n}function eu(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=uR(e);if(n!=null)return n;let o=cR(e);return o!=null?o:null}function uR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let s=1;s<=4;s++){let u,c,d,_=i/s,R=Math.sin(_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<2*t){let T=Dr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} )`,rR,c,i,s])}}return n}function cR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let s=1;s<=13;s++){let u,c,d,_=i/s,R=Math.sin(Math.PI*_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<23*t){let T=Dr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} * pi )`,Qv,c,i,s])}}return n}function Ie(e){let t,r=e.toString().split(".");if(r.length===2){let T=r[1].length;t=1/Math.pow(10,T)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,o=0,i=null,s=!0,u=Ui(e);u!=null&&(o=Dr(u),o<n?(s&&console.log(`better explanation by approxRadicals: ${u} complexity: ${o}`),n=o,i=u):s&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${o}`));let c=Kl(e);c!=null&&(o=Dr(c),o<n?(s&&console.log(`better explanation by approxLogs: ${c} complexity: ${o}`),n=o,i=c):s&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${o}`));let d=e1(e);d!=null&&(o=Dr(d),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`),n=o,i=d):s&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`));let _=Pm(e);_!=null&&(o=Dr(_),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`),n=o,i=_):s&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`));let R=eu(e);return R!=null&&(o=Dr(R),o<n?(s&&console.log(`better explanation by approxTrigonometric: ${R} complexity: ${o}`),n=o,i=R):s&&console.log(`subpar explanation by approxTrigonometric: ${R} complexity: ${o}`)),i}Qr.approxAll=Ie;function Dr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case Qv:n=4;break;case Wv:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case Jv:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function fR(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=Ui(o),s=i[2]*Math.sqrt(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${i}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=o.toFixed(4),s=Ui(Number(i)),u=s[2]*Math.sqrt(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${s}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=Ui(o);if(i!=null){let s=i[2]*Math.sqrt(i[3]/i[4]);i[1]===Cm&&Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${i}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=o.toFixed(4),s=Ui(Number(i)),u=s[2]*Math.sqrt(s[3]/s[4]);s[1]===Cm&&Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=Ie(o),s=i[2]*Math.log(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=o.toFixed(4),s=Ie(Number(i)),u=s[2]*Math.log(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,o=Math.log(t/r),i=Ie(o),s=i[2]*Math.log(i[3]/i[4]);Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,o=Math.log(t/r),i=o.toFixed(4),s=Ie(Number(i)),u=s[2]*Math.log(s[3]/s[4]);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=Ie(o),s=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=o.toFixed(4),s=e1(Number(i)),u=s[2]*Math.pow(Math.E,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=Ie(o),s=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=o.toFixed(4),s=Pm(Number(i)),u=s[2]*Math.pow(Math.PI,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,o=Math.sin(n),i=Ie(o),s=i[3]/i[4],u=i[2]*Math.sin(s);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${i}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(5),s=Ie(Number(i));s==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(4),s=Ie(Number(i));s==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}let e=0;Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),Ie(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,Ie(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,Ui(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Kl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),Ie(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,Ie(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,Ie(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,Ie(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,Ie(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),eu(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),eu(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,Ie(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,Ie(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,Ie(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,Ie(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,Ie(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,Ie(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),Ie(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),Ie(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,Pm(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let o=eu(e),i=o[3]/o[4],s=o[2]*Math.sin(Math.PI*i);Math.abs(e-s)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${o}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,o=Math.sin(Math.PI*n),i=o.toFixed(4),s=eu(Number(i)),u=s[3]/s[4],c=s[2]*Math.sin(Math.PI*u),d=Math.abs(o-c);d>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${s} error: ${d}`)}return console.log("testApprox done")}Qr.testApprox=fR});var r1=A(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.Eval_arccos=void 0;var te=N(),Jr=U(),fr=F(),dR=G(),kn=H(),t1=K(),ei=Z();function mR(e){return _R((0,dR.Eval)((0,te.cadr)(e)))}a0.Eval_arccos=mR;function _R(e){if((0,te.car)(e)===(0,Jr.symbol)(te.COS))return(0,te.cadr)(e);if((0,te.isdouble)(e))return(0,fr.double)(Math.acos(e.d));if((0,kn.isoneoversqrttwo)(e)||(0,te.ismultiply)(e)&&(0,kn.equalq)((0,te.car)((0,te.cdr)(e)),1,2)&&(0,te.car)((0,te.car)((0,te.cdr)((0,te.cdr)(e))))===(0,Jr.symbol)(te.POWER)&&(0,kn.equaln)((0,te.car)((0,te.cdr)((0,te.car)((0,te.cdr)((0,te.cdr)(e))))),2)&&(0,kn.equalq)((0,te.car)((0,te.cdr)((0,te.cdr)((0,te.car)((0,te.cdr)((0,te.cdr)(e)))))),1,2))return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI/4):(0,ei.multiply)((0,fr.rational)(1,4),(0,Jr.symbol)(te.PI));if((0,kn.isminusoneoversqrttwo)(e)||(0,te.ismultiply)(e)&&(0,kn.equalq)((0,te.car)((0,te.cdr)(e)),-1,2)&&(0,te.car)((0,te.car)((0,te.cdr)((0,te.cdr)(e))))===(0,Jr.symbol)(te.POWER)&&(0,kn.equaln)((0,te.car)((0,te.cdr)((0,te.car)((0,te.cdr)((0,te.cdr)(e))))),2)&&(0,kn.equalq)((0,te.car)((0,te.cdr)((0,te.cdr)((0,te.car)((0,te.cdr)((0,te.cdr)(e)))))),1,2))return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI*3/4):(0,ei.multiply)((0,fr.rational)(3,4),(0,Jr.symbol)(te.PI));if((0,kn.isSqrtThreeOverTwo)(e))return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI/6):(0,ei.multiply)((0,fr.rational)(1,6),(0,Jr.symbol)(te.PI));if((0,kn.isMinusSqrtThreeOverTwo)(e))return te.defs.evaluatingAsFloats?(0,fr.double)(5*Math.PI/6):(0,ei.multiply)((0,fr.rational)(5,6),(0,Jr.symbol)(te.PI));if(!(0,te.isrational)(e))return(0,t1.makeList)((0,Jr.symbol)(te.ARCCOS),e);switch((0,fr.nativeInt)((0,ei.multiply)(e,(0,fr.integer)(2)))){case-2:return te.Constants.Pi();case-1:return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI*2/3):(0,ei.multiply)((0,fr.rational)(2,3),(0,Jr.symbol)(te.PI));case 0:return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI/2):(0,ei.multiply)((0,fr.rational)(1,2),(0,Jr.symbol)(te.PI));case 1:return te.defs.evaluatingAsFloats?(0,fr.double)(Math.PI/3):(0,ei.multiply)((0,fr.rational)(1,3),(0,Jr.symbol)(te.PI));case 2:return te.Constants.Zero();default:return(0,t1.makeList)((0,Jr.symbol)(te.ARCCOS),e)}}});var o1=A(l0=>{"use strict";Object.defineProperty(l0,"__esModule",{value:!0});l0.Eval_arccosh=void 0;var Bi=N(),bR=Ee(),n1=U(),gR=F(),yR=G(),vR=H(),qR=K();function ER(e){return xR((0,yR.Eval)((0,Bi.cadr)(e)))}l0.Eval_arccosh=ER;function xR(e){if((0,Bi.car)(e)===(0,n1.symbol)(Bi.COSH))return(0,Bi.cadr)(e);if((0,Bi.isdouble)(e)){let{d:t}=e;return t<1&&(0,bR.stop)("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),(0,gR.double)(t)}return(0,vR.isplusone)(e)?Bi.Constants.zero:(0,qR.makeList)((0,n1.symbol)(Bi.ARCCOSH),e)}});var s1=A(u0=>{"use strict";Object.defineProperty(u0,"__esModule",{value:!0});u0.Eval_arcsin=void 0;var re=N(),kr=U(),Kt=F(),pR=G(),$n=H(),i1=K(),bo=Z();function hR(e){return AR((0,pR.Eval)((0,re.cadr)(e)))}u0.Eval_arcsin=hR;function AR(e){if((0,re.car)(e)===(0,kr.symbol)(re.SIN))return(0,re.cadr)(e);if((0,re.isdouble)(e))return(0,Kt.double)(Math.asin(e.d));if((0,$n.isoneoversqrttwo)(e)||(0,re.ismultiply)(e)&&(0,$n.equalq)((0,re.car)((0,re.cdr)(e)),1,2)&&(0,re.car)((0,re.car)((0,re.cdr)((0,re.cdr)(e))))===(0,kr.symbol)(re.POWER)&&(0,$n.equaln)((0,re.car)((0,re.cdr)((0,re.car)((0,re.cdr)((0,re.cdr)(e))))),2)&&(0,$n.equalq)((0,re.car)((0,re.cdr)((0,re.cdr)((0,re.car)((0,re.cdr)((0,re.cdr)(e)))))),1,2))return(0,bo.multiply)((0,Kt.rational)(1,4),(0,kr.symbol)(re.PI));if((0,$n.isminusoneoversqrttwo)(e)||(0,re.ismultiply)(e)&&(0,$n.equalq)((0,re.car)((0,re.cdr)(e)),-1,2)&&(0,re.car)((0,re.car)((0,re.cdr)((0,re.cdr)(e))))===(0,kr.symbol)(re.POWER)&&(0,$n.equaln)((0,re.car)((0,re.cdr)((0,re.car)((0,re.cdr)((0,re.cdr)(e))))),2)&&(0,$n.equalq)((0,re.car)((0,re.cdr)((0,re.cdr)((0,re.car)((0,re.cdr)((0,re.cdr)(e)))))),1,2))return re.defs.evaluatingAsFloats?(0,Kt.double)(-Math.PI/4):(0,bo.multiply)((0,Kt.rational)(-1,4),(0,kr.symbol)(re.PI));if((0,$n.isSqrtThreeOverTwo)(e))return re.defs.evaluatingAsFloats?(0,Kt.double)(Math.PI/3):(0,bo.multiply)((0,Kt.rational)(1,3),(0,kr.symbol)(re.PI));if((0,$n.isMinusSqrtThreeOverTwo)(e))return re.defs.evaluatingAsFloats?(0,Kt.double)(-Math.PI/3):(0,bo.multiply)((0,Kt.rational)(-1,3),(0,kr.symbol)(re.PI));if(!(0,re.isrational)(e))return(0,i1.makeList)((0,kr.symbol)(re.ARCSIN),e);switch((0,Kt.nativeInt)((0,bo.multiply)(e,(0,Kt.integer)(2)))){case-2:return re.defs.evaluatingAsFloats?(0,Kt.double)(-Math.PI/2):(0,bo.multiply)((0,Kt.rational)(-1,2),(0,kr.symbol)(re.PI));case-1:return re.defs.evaluatingAsFloats?(0,Kt.double)(-Math.PI/6):(0,bo.multiply)((0,Kt.rational)(-1,6),(0,kr.symbol)(re.PI));case 0:return re.Constants.Zero();case 1:return re.defs.evaluatingAsFloats?(0,Kt.double)(Math.PI/6):(0,bo.multiply)((0,Kt.rational)(1,6),(0,kr.symbol)(re.PI));case 2:return re.defs.evaluatingAsFloats?(0,Kt.double)(Math.PI/2):(0,bo.multiply)((0,Kt.rational)(1,2),(0,kr.symbol)(re.PI));default:return(0,i1.makeList)((0,kr.symbol)(re.ARCSIN),e)}}});var l1=A(c0=>{"use strict";Object.defineProperty(c0,"__esModule",{value:!0});c0.Eval_arcsinh=void 0;var Gi=N(),a1=U(),OR=F(),MR=G(),TR=H(),NR=K();function IR(e){return SR((0,MR.Eval)((0,Gi.cadr)(e)))}c0.Eval_arcsinh=IR;function SR(e){if((0,Gi.car)(e)===(0,a1.symbol)(Gi.SINH))return(0,Gi.cadr)(e);if((0,Gi.isdouble)(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),(0,OR.double)(t)}return(0,TR.isZeroAtomOrTensor)(e)?Gi.Constants.zero:(0,NR.makeList)((0,a1.symbol)(Gi.ARCSINH),e)}});var c1=A(f0=>{"use strict";Object.defineProperty(f0,"__esModule",{value:!0});f0.Eval_arctanh=void 0;var Fi=N(),RR=Ee(),u1=U(),wR=F(),LR=G(),CR=H(),PR=K();function DR(e){return kR((0,LR.Eval)((0,Fi.cadr)(e)))}f0.Eval_arctanh=DR;function kR(e){if((0,Fi.car)(e)===(0,u1.symbol)(Fi.TANH))return(0,Fi.cadr)(e);if((0,Fi.isdouble)(e)){let{d:t}=e;return(t<-1||t>1)&&(0,RR.stop)("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,(0,wR.double)(t)}return(0,CR.isZeroAtomOrTensor)(e)?Fi.Constants.zero:(0,PR.makeList)((0,u1.symbol)(Fi.ARCTANH),e)}});var m1=A(d0=>{"use strict";Object.defineProperty(d0,"__esModule",{value:!0});d0.Eval_binomial=void 0;var go=N(),km=Ne(),$R=ue(),f1=G(),$m=pi(),d1=Z();function UR(e){let t=(0,f1.Eval)((0,go.cadr)(e)),r=(0,f1.Eval)((0,go.caddr)(e));return BR(t,r)}d0.Eval_binomial=UR;function BR(e,t){return GR(e,t)}function GR(e,t){return FR(e,t)?(0,d1.divide)((0,d1.divide)((0,$m.factorial)(e),(0,$m.factorial)(t)),(0,$m.factorial)((0,$R.subtract)(e,t))):go.Constants.zero}function FR(e,t){return(0,go.isNumericAtom)(e)&&(0,km.lessp)(e,go.Constants.zero)||(0,go.isNumericAtom)(t)&&(0,km.lessp)(t,go.Constants.zero)?!1:!((0,go.isNumericAtom)(e)&&(0,go.isNumericAtom)(t)&&(0,km.lessp)(e,t))}});var b1=A(m0=>{"use strict";Object.defineProperty(m0,"__esModule",{value:!0});m0.Eval_ceiling=void 0;var Ma=N(),jR=U(),zR=ue(),YR=F(),VR=G(),_1=H(),ZR=K(),XR=ln();function HR(e){return QR((0,VR.Eval)((0,Ma.cadr)(e)))}m0.Eval_ceiling=HR;function QR(e){return WR(e)}function WR(e){if(!(0,Ma.isNumericAtom)(e))return(0,ZR.makeList)((0,jR.symbol)(Ma.CEILING),e);if((0,Ma.isdouble)(e))return(0,YR.double)(Math.ceil(e.d));if((0,_1.isinteger)(e))return e;let t=new Ma.Num((0,XR.mdiv)(e.q.a,e.q.b));return(0,_1.isnegativenumber)(e)||(t=(0,zR.add)(t,Ma.Constants.one)),t}});var v1=A(_0=>{"use strict";Object.defineProperty(_0,"__esModule",{value:!0});_0.Eval_choose=void 0;var yo=N(),Um=Ne(),JR=ue(),g1=G(),Bm=pi(),y1=Z();function KR(e){let t=(0,g1.Eval)((0,yo.cadr)(e)),r=(0,g1.Eval)((0,yo.caddr)(e));return ew(t,r)}_0.Eval_choose=KR;function ew(e,t){return tw(e,t)?(0,y1.divide)((0,y1.divide)((0,Bm.factorial)(e),(0,Bm.factorial)(t)),(0,Bm.factorial)((0,JR.subtract)(e,t))):yo.Constants.zero}function tw(e,t){return(0,yo.isNumericAtom)(e)&&(0,Um.lessp)(e,yo.Constants.zero)||(0,yo.isNumericAtom)(t)&&(0,Um.lessp)(t,yo.Constants.zero)?!1:!((0,yo.isNumericAtom)(e)&&(0,yo.isNumericAtom)(t)&&(0,Um.lessp)(e,t))}});var Fm=A(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.expcos=Ta.Eval_expcos=void 0;var Gm=N(),q1=Ne(),rw=ue(),E1=F(),nw=G(),tu=Z();function ow(e){return x1((0,nw.Eval)((0,Gm.cadr)(e)))}Ta.Eval_expcos=ow;function x1(e){return(0,rw.add)((0,tu.multiply)((0,q1.exponential)((0,tu.multiply)(Gm.Constants.imaginaryunit,e)),(0,E1.rational)(1,2)),(0,tu.multiply)((0,q1.exponential)((0,tu.multiply)((0,tu.negate)(Gm.Constants.imaginaryunit),e)),(0,E1.rational)(1,2)))}Ta.expcos=x1});var jm=A(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.expsin=Na.Eval_expsin=void 0;var ru=N(),p1=Ne(),iw=ue(),h1=F(),sw=G(),ji=Z();function aw(e){return A1((0,sw.Eval)((0,ru.cadr)(e)))}Na.Eval_expsin=aw;function A1(e){return(0,iw.subtract)((0,ji.multiply)((0,ji.divide)((0,p1.exponential)((0,ji.multiply)(ru.Constants.imaginaryunit,e)),ru.Constants.imaginaryunit),(0,h1.rational)(1,2)),(0,ji.multiply)((0,ji.divide)((0,p1.exponential)((0,ji.multiply)((0,ji.negate)(ru.Constants.imaginaryunit),e)),ru.Constants.imaginaryunit),(0,h1.rational)(1,2)))}Na.expsin=A1});var M1=A(b0=>{"use strict";Object.defineProperty(b0,"__esModule",{value:!0});b0.Eval_circexp=void 0;var _t=N(),Ia=U(),zi=Ne(),Sa=ue(),zm=F(),O1=G(),lw=Fm(),uw=jm(),_n=Z(),cw=qt();function fw(e){let t=Ym((0,O1.Eval)((0,_t.cadr)(e)));return(0,O1.Eval)(t)}b0.Eval_circexp=fw;function Ym(e){if((0,_t.car)(e)===(0,Ia.symbol)(_t.COS))return(0,lw.expcos)((0,_t.cadr)(e));if((0,_t.car)(e)===(0,Ia.symbol)(_t.SIN))return(0,uw.expsin)((0,_t.cadr)(e));if((0,_t.car)(e)===(0,Ia.symbol)(_t.TAN)){e=(0,_t.cadr)(e);let t=(0,zi.exponential)((0,_n.multiply)(_t.Constants.imaginaryunit,e)),r=(0,zi.exponential)((0,_n.negate)((0,_n.multiply)(_t.Constants.imaginaryunit,e)));return(0,_n.divide)((0,_n.multiply)((0,Sa.subtract)(r,t),_t.Constants.imaginaryunit),(0,Sa.add)(t,r))}return(0,_t.car)(e)===(0,Ia.symbol)(_t.COSH)?(e=(0,_t.cadr)(e),(0,_n.multiply)((0,Sa.add)((0,zi.exponential)(e),(0,zi.exponential)((0,_n.negate)(e))),(0,zm.rational)(1,2))):(0,_t.car)(e)===(0,Ia.symbol)(_t.SINH)?(e=(0,_t.cadr)(e),(0,_n.multiply)((0,Sa.subtract)((0,zi.exponential)(e),(0,zi.exponential)((0,_n.negate)(e))),(0,zm.rational)(1,2))):(0,_t.car)(e)===(0,Ia.symbol)(_t.TANH)?(e=(0,zi.exponential)((0,_n.multiply)((0,_t.cadr)(e),(0,zm.integer)(2))),(0,_n.divide)((0,Sa.subtract)(e,_t.Constants.one),(0,Sa.add)(e,_t.Constants.one))):(0,_t.iscons)(e)?e.map(Ym):(e.k===_t.TENSOR&&(e=(0,cw.copy_tensor)(e),e.tensor.elem=e.tensor.elem.map(Ym)),e)}});var N1=A(g0=>{"use strict";Object.defineProperty(g0,"__esModule",{value:!0});g0.Eval_contract=void 0;var dw=It(),vo=N(),T1=Ee(),mw=U(),_w=ue(),Zm=F(),Vm=G(),bw=H();function gw(e){let t=(0,Vm.Eval)((0,vo.cadr)(e)),r,n;return(0,vo.cddr)(e)===(0,mw.symbol)(vo.NIL)?(r=vo.Constants.one,n=(0,Zm.integer)(2)):(r=(0,Vm.Eval)((0,vo.caddr)(e)),n=(0,Vm.Eval)((0,vo.cadddr)(e))),yw(t,r,n)}g0.Eval_contract=gw;function yw(e,t,r){let n=[],o=[];if(!(0,vo.istensor)(e))return(0,bw.isZeroAtomOrTensor)(e)||(0,T1.stop)("contract: tensor expected, 1st arg is not a tensor"),vo.Constants.zero;let i=(0,Zm.nativeInt)(t),s=(0,Zm.nativeInt)(r),{ndim:u}=e.tensor;(i<1||i>u||s<1||s>u||i===s||e.tensor.dim[i-1]!==e.tensor.dim[s-1])&&(0,T1.stop)("contract: index out of range"),i--,s--;let c=e.tensor.dim[i],d=1;for(let k=0;k<u;k++)k!==i&&k!==s&&(d*=e.tensor.dim[k]);t=(0,dw.alloc_tensor)(d),t.tensor.ndim=u-2;let _=0;for(let k=0;k<u;k++)k!==i&&k!==s&&(t.tensor.dim[_++]=e.tensor.dim[k]);let R=e.tensor.elem,T=t.tensor.elem;for(let k=0;k<u;k++)n[k]=0,o[k]=e.tensor.dim[k];for(let k=0;k<d;k++){let V=vo.Constants.zero;for(let z=0;z<c;z++){n[i]=z,n[s]=z;let Ae=0;for(let et=0;et<u;et++)Ae=Ae*o[et]+n[et];V=(0,_w.add)(V,R[Ae])}T[k]=V;for(let z=u-1;z>=0;z--)if(!(z===i||z===s)){if(++n[z]<o[z])break;n[z]=0}}return d===1?T[0]:t}});var S1=A(y0=>{"use strict";Object.defineProperty(y0,"__esModule",{value:!0});y0.Eval_defint=void 0;var qo=N(),vw=ue(),Ra=G(),qw=Fl(),I1=Yr();function Ew(e){let t=(0,Ra.Eval)((0,qo.cadr)(e));for(e=(0,qo.cddr)(e);(0,qo.iscons)(e);){let r=(0,Ra.Eval)((0,qo.car)(e));e=(0,qo.cdr)(e);let n=(0,Ra.Eval)((0,qo.car)(e));e=(0,qo.cdr)(e);let o=(0,Ra.Eval)((0,qo.car)(e));e=(0,qo.cdr)(e),t=(0,qw.integral)(t,r);let i=(0,Ra.Eval)((0,I1.subst)(t,r,o)),s=(0,Ra.Eval)((0,I1.subst)(t,r,n));t=(0,vw.subtract)(i,s)}return t}y0.Eval_defint=Ew});var v0=A(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.degree=wa.Eval_degree=void 0;var Kr=N(),xw=U(),Xm=Ne(),R1=G(),pw=Vr(),hw=H();function Aw(e){let t=(0,R1.Eval)((0,Kr.cadr)(e));e=(0,R1.Eval)((0,Kr.caddr)(e));let r=e===(0,xw.symbol)(Kr.NIL)?(0,pw.guess)(t):e;return w1(t,r)}wa.Eval_degree=Aw;function w1(e,t){return L1(e,t,Kr.Constants.zero)}wa.degree=w1;function L1(e,t,r){return(0,Xm.equal)(e,t)?(0,hw.isZeroAtomOrTensor)(r)&&(r=Kr.Constants.one):(0,Kr.ispower)(e)?(0,Xm.equal)((0,Kr.cadr)(e),t)&&(0,Kr.isNumericAtom)((0,Kr.caddr)(e))&&(0,Xm.lessp)(r,(0,Kr.caddr)(e))&&(r=(0,Kr.caddr)(e)):(0,Kr.iscons)(e)&&(r=e.tail().reduce((n,o)=>L1(o,t,n),r)),r}});var $1=A(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.Eval_eigenvec=ti.Eval_eigenval=ti.Eval_eigen=void 0;var $r=N(),q0=Ee(),Yi=U(),C1=F(),P1=G(),Ow=Rn(),k1=K(),Mw=eo(),D1=qt(),le=0,Zt=[],Eo=[];function Tw(e){let{arg:t}=Hm(e);t||(0,q0.stop)("eigen: argument is not a square matrix");let[r,n]=Qm($r.EIGEN,t);return e=(0,Yi.usr_symbol)("D"),(0,Yi.set_binding)(e,r),e=(0,Yi.usr_symbol)("Q"),(0,Yi.set_binding)(e,n),(0,Yi.symbol)($r.NIL)}ti.Eval_eigen=Tw;function Nw(e){let{arg:t,invalid:r}=Hm(e);if(r)return(0,k1.makeList)((0,Yi.symbol)($r.EIGENVAL),r);let[n,o]=Qm($r.EIGENVAL,t);return n}ti.Eval_eigenval=Nw;function Iw(e){let{arg:t,invalid:r}=Hm(e);if(r)return(0,k1.makeList)((0,Yi.symbol)($r.EIGENVEC),r);let[n,o]=Qm($r.EIGENVEC,t);return o}ti.Eval_eigenvec=Iw;function Hm(e){if(e=(0,P1.Eval)((0,Ow.yyfloat)((0,P1.Eval)((0,$r.cadr)(e)))),!(0,$r.istensor)(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&(0,q0.stop)("eigen: argument is not a square matrix"),le=e.tensor.dim[0],Sw(e)||(0,q0.stop)("eigen: matrix is not numerical");for(let t=0;t<le-1;t++)for(let r=t+1;r<le;r++){let n=e.tensor.elem[le*t+r],o=e.tensor.elem[le*r+t];Math.abs(n.d-o.d)>1e-10&&(0,q0.stop)("eigen: matrix is not symmetrical")}return{arg:e}}function Sw(e){for(let t=0;t<le;t++)for(let r=0;r<le;r++)if(!(0,$r.isdouble)(e.tensor.elem[le*t+r]))return!1;return!0}function Qm(e,t){for(let i=0;i<le*le;i++)Zt[i]=0;for(let i=0;i<le*le;i++)Eo[i]=0;for(let i=0;i<le;i++){Zt[le*i+i]=t.tensor.elem[le*i+i].d;for(let s=i+1;s<le;s++)Zt[le*i+s]=t.tensor.elem[le*i+s].d,Zt[le*s+i]=t.tensor.elem[le*i+s].d}for(let i=0;i<le;i++){Eo[le*i+i]=1;for(let s=i+1;s<le;s++)Eo[le*i+s]=0,Eo[le*s+i]=0}let r=0;for(r=0;r<100&&Rw()!==0;r++);r===100&&(0,Mw.print_str)(`
note: eigen did not converge
`);let n;if(e===$r.EIGEN||e===$r.EIGENVAL){n=(0,D1.copy_tensor)(t);for(let i=0;i<le;i++)for(let s=0;s<le;s++)n.tensor.elem[le*i+s]=(0,C1.double)(Zt[le*i+s])}let o;if(e===$r.EIGEN||e===$r.EIGENVEC){o=(0,D1.copy_tensor)(t);for(let i=0;i<le;i++)for(let s=0;s<le;s++)o.tensor.elem[le*i+s]=(0,C1.double)(Eo[le*i+s])}return[n,o]}function Rw(){let e=0;for(let t=0;t<le-1;t++)for(let r=t+1;r<le;r++)Zt[le*t+r]!==0&&(ww(t,r),e++);return e}function ww(e,t){let r=.5*(Zt[le*e+e]-Zt[le*t+t])/Zt[le*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let o=1/Math.sqrt(n*n+1),i=n*o;for(let s=0;s<le;s++){let u=Zt[le*e+s],c=Zt[le*t+s];Zt[le*e+s]=o*u+i*c,Zt[le*t+s]=o*c-i*u}for(let s=0;s<le;s++){let u=Zt[le*s+e],c=Zt[le*s+t];Zt[le*s+e]=o*u+i*c,Zt[le*s+t]=o*c-i*u}for(let s=0;s<le;s++){let u=Eo[le*e+s],c=Eo[le*t+s];Eo[le*e+s]=o*u+i*c,Eo[le*t+s]=o*c-i*u}Zt[le*e+t]=0,Zt[le*t+e]=0}});var Wm=A(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.erfc=La.Eval_erfc=void 0;var E0=N(),Lw=U(),Cw=F(),Pw=G(),Dw=H(),kw=K();function $w(e){return Uw((0,Pw.Eval)((0,E0.cadr)(e)))}La.Eval_erfc=$w;function Uw(e){if((0,E0.isdouble)(e)){let t=U1(e.d);return(0,Cw.double)(t)}return(0,Dw.isZeroAtomOrTensor)(e)?E0.Constants.one:(0,kw.makeList)((0,Lw.symbol)(E0.ERFC),e)}function U1(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}La.erfc=U1});var z1=A(x0=>{"use strict";Object.defineProperty(x0,"__esModule",{value:!0});x0.Eval_erf=void 0;var nu=N(),B1=U(),Bw=F(),Gw=Wm(),Fw=G(),G1=H(),F1=K(),j1=Z();function jw(e){return zw((0,Fw.Eval)((0,nu.cadr)(e)))}x0.Eval_erf=jw;function zw(e){return(0,nu.isdouble)(e)?(0,Bw.double)(1-(0,Gw.erfc)(e.d)):(0,G1.isZeroAtomOrTensor)(e)?nu.Constants.zero:(0,G1.isnegativeterm)(e)?(0,j1.negate)((0,F1.makeList)((0,B1.symbol)(nu.ERF),(0,j1.negate)(e))):(0,F1.makeList)((0,B1.symbol)(nu.ERF),e)}});var Z1=A(p0=>{"use strict";Object.defineProperty(p0,"__esModule",{value:!0});p0.factors=void 0;var V1=N();function Yw(e){let t=[];return(0,V1.isadd)(e)?e.tail().forEach(r=>t.push(...Y1(r))):t.push(...Y1(e)),t}p0.factors=Yw;function Y1(e){return(0,V1.ismultiply)(e)?e.tail():[e]}});var tq=A(h0=>{"use strict";Object.defineProperty(h0,"__esModule",{value:!0});h0.Eval_expand=void 0;var e_=It(),at=N(),J1=ir(),Vw=U(),Zw=Ne(),Jm=ue(),Ur=F(),K1=v0(),Xw=Mn(),Km=G(),Hw=Es(),X1=Z1(),eq=ll(),Qw=Vr(),H1=Go(),Ww=Il(),ou=H(),Br=Z(),Jw=oo(),ri=Et(),Kw=Fu(),eL=qt();function tL(e){let t=(0,Km.Eval)((0,at.cadr)(e)),r=(0,Km.Eval)((0,at.caddr)(e)),n=r===(0,Vw.symbol)(at.NIL)?(0,Qw.guess)(t):r;return t_(t,n)}h0.Eval_expand=tL;function t_(e,t){if((0,at.istensor)(e))return rL(e,t);if((0,at.isadd)(e))return e.tail().reduce((u,c)=>(0,Jm.add)(u,t_(c,t)),at.Constants.zero);let r=(0,Jw.numerator)(e),n=(0,Xw.denominator)(e);if([n,r]=nL(n,r,t),((0,ou.isone)(r)||(0,ou.isone)(n))&&(!(0,ou.ispolyexpandedform)(n,t)||(0,ou.isone)(n)))return e;let o=(0,Kw.divpoly)(r,n,t);if(r=(0,Jm.subtract)(r,(0,Br.multiply)(n,o)),(0,ou.isZeroAtomOrTensor)(r))return o;n=(0,Hw.factorpoly)(n,t);let i=oL(n,t);r=sL(r,i,t),n=aL(n,i,t);let s;if((0,at.istensor)(i)){let u=(0,at.doexpand)(Ww.inv,i);s=(0,H1.inner)((0,H1.inner)(u,r),n)}else{let u=(0,at.doexpand)(Br.divide,r,i);s=(0,Br.multiply)(u,n)}return(0,Jm.add)(s,o)}function rL(e,t){return e=(0,eL.copy_tensor)(e),e.tensor.elem=e.tensor.elem.map(r=>t_(r,t)),e}function nL(e,t,r){let n=[...(0,X1.factors)(e),...(0,X1.factors)(t)],o=0;for(let i=0;i<n.length;i++){let s=n[i];if(!(0,at.ispower)(s)||(0,at.cadr)(s)!==r)continue;let u=(0,Ur.nativeInt)((0,at.caddr)(s));isNaN(u)||u<o&&(o=u)}return o===0?[e,t]:(e=(0,Br.multiply)(e,(0,ri.power)(r,(0,Ur.integer)(-o))),t=(0,Br.multiply)(t,(0,ri.power)(r,(0,Ur.integer)(-o))),[e,t])}function oL(e,t){let r=[];(0,at.ismultiply)(e)?e.tail().forEach(i=>r.push(...Q1(e,i,t))):r.push(...Q1(e,e,t));let n=r.length;if(n===1)return r[0];let o=(0,e_.alloc_tensor)(n*n);o.tensor.ndim=2,o.tensor.dim[0]=n,o.tensor.dim[1]=n;for(let i=0;i<n;i++)for(let s=0;s<n;s++){let u=(0,ri.power)(t,(0,Ur.integer)(i)),c=(0,at.doexpand)(Br.divide,r[s],u);o.tensor.elem[n*i+s]=(0,eq.filter)(c,t)}return o}function Q1(e,t,r){let n,o=0;if(!(0,J1.Find)(t,r))return[];let i=(0,at.doexpand)(iL,e,t);(0,at.ispower)(t)?(o=(0,Ur.nativeInt)((0,at.caddr)(t)),n=(0,at.cadr)(t)):(o=1,n=t);let s=[],u=(0,Ur.nativeInt)((0,K1.degree)(n,r));for(let c=0;c<o;c++)for(let d=0;d<u;d++){let _=(0,ri.power)(n,(0,Ur.integer)(c)),R=(0,at.doexpand)(Br.multiply,i,_);_=(0,ri.power)(r,(0,Ur.integer)(d));let T=(0,at.doexpand)(Br.multiply,R,_);s.push(T)}return s}function iL(e,t){let r=at.Constants.one;if((0,at.ismultiply)(e)){let n=[];e.tail().forEach(o=>{(0,Zw.equal)(o,t)||n.push((0,Km.Eval)(o))}),r=(0,Br.multiply_all)(n)}return r}function sL(e,t,r){if(!(0,at.istensor)(t))return e;let n=t.tensor.dim[0],o=(0,e_.alloc_tensor)(n);o.tensor.ndim=1,o.tensor.dim[0]=n;for(let i=0;i<n;i++){let s=(0,ri.power)(r,(0,Ur.integer)(i)),u=(0,at.doexpand)(Br.divide,e,s);o.tensor.elem[i]=(0,eq.filter)(u,r)}return o}function aL(e,t,r){if(!(0,at.istensor)(t))return(0,Br.reciprocate)(e);let n=[];(0,at.ismultiply)(e)?e.tail().forEach(s=>{n.push(...W1(s,r))}):n=W1(e,r);let o=n.length,i=(0,e_.alloc_tensor)(o);return i.tensor.ndim=1,i.tensor.dim[0]=o,i.tensor.elem=n,i}function W1(e,t){let r=1;if(!(0,J1.Find)(e,t))return[];(0,at.ispower)(e)&&(r=(0,Ur.nativeInt)((0,at.caddr)(e)),e=(0,at.cadr)(e));let n=[],o=(0,Ur.nativeInt)((0,K1.degree)(e,t));for(let i=r;i>0;i--)for(let s=0;s<o;s++)n.push((0,Br.multiply)((0,Br.reciprocate)((0,ri.power)(e,(0,Ur.integer)(i))),(0,ri.power)(t,(0,Ur.integer)(s))));return n}});var nq=A(A0=>{"use strict";Object.defineProperty(A0,"__esModule",{value:!0});A0.Eval_floor=void 0;var Ca=N(),lL=U(),uL=ue(),cL=F(),fL=G(),rq=H(),dL=K(),mL=ln();function _L(e){return bL((0,fL.Eval)((0,Ca.cadr)(e)))}A0.Eval_floor=_L;function bL(e){return gL(e)}function gL(e){if(!(0,Ca.isNumericAtom)(e))return(0,dL.makeList)((0,lL.symbol)(Ca.FLOOR),e);if((0,Ca.isdouble)(e))return(0,cL.double)(Math.floor(e.d));if((0,rq.isinteger)(e))return e;let t=new Ca.Num((0,mL.mdiv)(e.q.a,e.q.b));return(0,rq.isnegativenumber)(e)&&(t=(0,uL.add)(t,Ca.Constants.negOne)),t}});var oq=A(M0=>{"use strict";Object.defineProperty(M0,"__esModule",{value:!0});M0.Eval_for=void 0;var Pa=N(),yL=Ee(),O0=U(),vL=F(),r_=G();function qL(e){let t=(0,Pa.caddr)(e);(0,Pa.issymbol)(t)||(0,yL.stop)("for: 2nd arg should be the variable to loop over");let r=(0,r_.evaluate_integer)((0,Pa.cadddr)(e));if(isNaN(r))return e;let n=(0,r_.evaluate_integer)((0,Pa.caddddr)(e));if(isNaN(n))return e;let o=(0,O0.get_binding)(t);for(let i=r;i<=n;i++)(0,O0.set_binding)(t,(0,vL.integer)(i)),(0,r_.Eval)((0,Pa.cadr)(e));return(0,O0.set_binding)(t,o),(0,O0.symbol)(Pa.NIL)}M0.Eval_for=qL});var lq=A(N0=>{"use strict";Object.defineProperty(N0,"__esModule",{value:!0});N0.Eval_gamma=void 0;var Qe=N(),sq=U(),EL=ue(),n_=F(),xL=G(),pL=H(),aq=K(),xo=Z(),iq=Et(),hL=Qn();function AL(e){return T0((0,xL.Eval)((0,Qe.cadr)(e)))}N0.Eval_gamma=AL;function T0(e){return OL(e)}function OL(e){return(0,Qe.isrational)(e)&&(0,Qe.MEQUAL)(e.q.a,1)&&(0,Qe.MEQUAL)(e.q.b,2)?(0,iq.power)(Qe.Constants.Pi(),(0,n_.rational)(1,2)):(0,Qe.isrational)(e)&&(0,Qe.MEQUAL)(e.q.a,3)&&(0,Qe.MEQUAL)(e.q.b,2)?(0,xo.multiply)((0,iq.power)(Qe.Constants.Pi(),(0,n_.rational)(1,2)),(0,n_.rational)(1,2)):(0,pL.isnegativeterm)(e)?(0,xo.divide)((0,xo.multiply)(Qe.Constants.Pi(),Qe.Constants.negOne),(0,xo.multiply)((0,xo.multiply)((0,hL.sine)((0,xo.multiply)(Qe.Constants.Pi(),e)),e),T0((0,xo.negate)(e)))):(0,Qe.isadd)(e)?ML(e):(0,aq.makeList)((0,sq.symbol)(Qe.GAMMA),e)}function ML(e){let t=(0,Qe.cdr)(e);return(0,Qe.isrational)((0,Qe.car)(t))&&(0,Qe.MEQUAL)((0,Qe.car)(t).q.a,1)&&(0,Qe.MEQUAL)((0,Qe.car)(t).q.b,1)?(0,xo.multiply)((0,Qe.cadr)(t),T0((0,Qe.cadr)(t))):(0,Qe.isrational)((0,Qe.car)(t))&&(0,Qe.MEQUAL)((0,Qe.car)(t).q.a,-1)&&(0,Qe.MEQUAL)((0,Qe.car)(t).q.b,1)?(0,xo.divide)(T0((0,Qe.cadr)(t)),(0,EL.add)((0,Qe.cadr)(t),Qe.Constants.negOne)):(0,aq.makeList)((0,sq.symbol)(Qe.GAMMA),e)}});var uq=A(I0=>{"use strict";Object.defineProperty(I0,"__esModule",{value:!0});I0.Eval_isprime=void 0;var o_=N(),TL=G(),NL=H(),IL=Ff();function SL(e){return RL((0,TL.Eval)((0,o_.cadr)(e)))}I0.Eval_isprime=SL;function RL(e){return(0,NL.isnonnegativeinteger)(e)&&(0,IL.mprime)(e.q.a)?o_.Constants.one:o_.Constants.zero}});var fq=A(C0=>{"use strict";Object.defineProperty(C0,"__esModule",{value:!0});C0.Eval_laguerre=void 0;var bn=N(),R0=U(),S0=ue(),w0=F(),L0=G(),wL=K(),i_=Z(),LL=Yr();function CL(e){let t=(0,L0.Eval)((0,bn.cadr)(e)),r=(0,L0.Eval)((0,bn.caddr)(e)),n=(0,L0.Eval)((0,bn.cadddr)(e)),o=n===(0,R0.symbol)(bn.NIL)?bn.Constants.zero:n;return PL(t,r,o)}C0.Eval_laguerre=CL;function PL(e,t,r){let n=(0,w0.nativeInt)(t);return n<0||isNaN(n)?(0,wL.makeList)((0,R0.symbol)(bn.LAGUERRE),e,t,r):(0,bn.issymbol)(e)?cq(n,e,r):(0,L0.Eval)((0,LL.subst)(cq(n,(0,R0.symbol)(bn.SECRETX),r),(0,R0.symbol)(bn.SECRETX),e))}function cq(e,t,r){let n=bn.Constants.zero,o=bn.Constants.one;for(let i=0;i<e;i++){let s=(0,i_.divide)((0,S0.subtract)((0,i_.multiply)((0,S0.add)((0,S0.subtract)((0,w0.integer)(2*i+1),t),r),o),(0,i_.multiply)((0,S0.add)((0,w0.integer)(i),r),n)),(0,w0.integer)(i+1));n=o,o=s}return o}});var mq=A(P0=>{"use strict";Object.defineProperty(P0,"__esModule",{value:!0});P0.Eval_leading=void 0;var s_=N(),DL=U(),kL=v0(),dq=G(),$L=ll(),UL=Vr(),BL=Z(),GL=Et();function FL(e){let t=(0,dq.Eval)((0,s_.cadr)(e));e=(0,dq.Eval)((0,s_.caddr)(e));let r=e===(0,DL.symbol)(s_.NIL)?(0,UL.guess)(t):e;return jL(t,r)}P0.Eval_leading=FL;function jL(e,t){let r=(0,kL.degree)(e,t);return(0,$L.filter)((0,BL.divide)(e,(0,GL.power)(t,r)),t)}});var gq=A(k0=>{"use strict";Object.defineProperty(k0,"__esModule",{value:!0});k0.Eval_legendre=void 0;var er=N(),Da=U(),a_=Ne(),bq=ue(),Zi=F(),zL=Lo(),YL=Ri(),D0=G(),VL=K(),Vi=Z(),ZL=Et(),XL=Qn(),HL=Yr();function QL(e){let t=(0,D0.Eval)((0,er.cadr)(e)),r=(0,D0.Eval)((0,er.caddr)(e)),n=(0,D0.Eval)((0,er.cadddr)(e)),o=n===(0,Da.symbol)(er.NIL)?er.Constants.zero:n;return WL(t,r,o)}k0.Eval_legendre=QL;function WL(e,t,r){return JL(e,t,r)}function JL(e,t,r){let n=(0,Zi.nativeInt)(t),o=(0,Zi.nativeInt)(r);if(n<0||isNaN(n)||o<0||isNaN(o))return(0,VL.makeList)((0,Da.symbol)(er.LEGENDRE),e,t,r);let i;if((0,er.issymbol)(e))i=_q(n,o,e);else{let s=_q(n,o,(0,Da.symbol)(er.SECRETX));i=(0,D0.Eval)((0,HL.subst)(s,(0,Da.symbol)(er.SECRETX),e))}return i=KL(i,o,e)||i,i}function _q(e,t,r){let n=er.Constants.zero,o=er.Constants.one;for(let i=0;i<e;i++){let s=(0,Vi.divide)((0,bq.subtract)((0,Vi.multiply)((0,Vi.multiply)((0,Zi.integer)(2*i+1),r),o),(0,Vi.multiply)((0,Zi.integer)(i),n)),(0,Zi.integer)(i+1));n=o,o=s}for(let i=0;i<t;i++)o=(0,YL.derivative)(o,r);return o}function KL(e,t,r){if(t===0)return;let n=(0,bq.subtract)(er.Constants.one,(0,a_.square)(r));(0,er.car)(r)===(0,Da.symbol)(er.COS)?n=(0,a_.square)((0,XL.sine)((0,er.cadr)(r))):(0,er.car)(r)===(0,Da.symbol)(er.SIN)&&(n=(0,a_.square)((0,zL.cosine)((0,er.cadr)(r))));let o=(0,Vi.multiply)(e,(0,ZL.power)(n,(0,Vi.multiply)((0,Zi.integer)(t),(0,Zi.rational)(1,2))));return t%2&&(o=(0,Vi.negate)(o)),o}});var yq=A(U0=>{"use strict";Object.defineProperty(U0,"__esModule",{value:!0});U0.Eval_lookup=void 0;var $0=N(),eC=U();function tC(e){return e=(0,$0.cadr)(e),!(0,$0.iscons)(e)&&(0,$0.cadr)(e).k===$0.SYM&&(e=(0,eC.get_binding)(e)),e}U0.Eval_lookup=tC});var qq=A(F0=>{"use strict";Object.defineProperty(F0,"__esModule",{value:!0});F0.Eval_mod=void 0;var ni=N(),B0=Ee(),rC=U(),G0=F(),vq=G(),l_=H(),nC=K(),oC=ln();function iC(e){let t=(0,vq.Eval)((0,ni.cadr)(e)),r=(0,vq.Eval)((0,ni.caddr)(e));return sC(t,r)}F0.Eval_mod=iC;function sC(e,t){if((0,l_.isZeroAtomOrTensor)(t)&&(0,B0.stop)("mod function: divide by zero"),!(0,ni.isNumericAtom)(e)||!(0,ni.isNumericAtom)(t))return(0,nC.makeList)((0,rC.symbol)(ni.MOD),e,t);if((0,ni.isdouble)(e)){let r=(0,G0.nativeInt)(e);isNaN(r)&&(0,B0.stop)("mod function: cannot convert float value to integer"),e=(0,G0.integer)(r)}if((0,ni.isdouble)(t)){let r=(0,G0.nativeInt)(t);isNaN(r)&&(0,B0.stop)("mod function: cannot convert float value to integer"),t=(0,G0.integer)(r)}return(!(0,l_.isinteger)(e)||!(0,l_.isinteger)(t))&&(0,B0.stop)("mod function: integer arguments expected"),new ni.Num((0,oC.mmod)(e.q.a,t.q.a))}});var Aq=A(V0=>{"use strict";Object.defineProperty(V0,"__esModule",{value:!0});V0.Eval_nroots=void 0;var aC=It(),Xi=N(),su=Ee(),lC=U(),uC=Ne(),cC=ue(),Eq=F(),fC=gi(),j0=G(),xq=Rn(),dC=Vr(),mC=ql(),_C=H(),bC=Z(),gC=Us(),hq=101,Y0=1e-6,yC=1e-9;function iu(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function z0(){return 4*Math.random()-2}var gn=class{constructor(){this.r=0,this.i=0}},Ke=new gn,Un=new gn,pt=new gn,gr=new gn,Sr=new gn,Gr=new gn,ka=new gn,Bn=new gn,Ye=[];for(let e=0;e<hq;e++)Ye[e]=new gn;function vC(e){let t=(0,j0.Eval)((0,Xi.caddr)(e));e=(0,j0.Eval)((0,Xi.cadr)(e)),t=t===(0,lC.symbol)(Xi.NIL)?(0,dC.guess)(e):t,(0,_C.ispolyexpandedform)(e,t)||(0,su.stop)("nroots: polynomial?");let r=(0,fC.coeff)(e,t),n=r.length;n>hq&&(0,su.stop)("nroots: degree?");for(let i=0;i<n;i++)e=(0,j0.Eval)((0,xq.yyfloat)((0,gC.real)(r[i]))),t=(0,j0.Eval)((0,xq.yyfloat)((0,mC.imag)(r[i]))),(!(0,Xi.isdouble)(e)||!(0,Xi.isdouble)(t))&&(0,su.stop)("nroots: coefficients?"),Ye[i].r=e.d,Ye[i].i=t.d;qC(n);let o=[];for(let i=n;i>1;i--)EC(i),Math.abs(Ke.r)<Y0&&(Ke.r=0),Math.abs(Ke.i)<Y0&&(Ke.i=0),o.push((0,cC.add)((0,Eq.double)(Ke.r),(0,bC.multiply)((0,Eq.double)(Ke.i),Xi.Constants.imaginaryunit))),xC(i);if(n=o.length,n==1)return o[0];if(n>1)return o.sort(uC.cmp_expr),e=(0,aC.alloc_tensor)(n),e.tensor.ndim=1,e.tensor.dim[0]=n,e.tensor.elem=o,e}V0.Eval_nroots=vC;function qC(e){gr.r=Ye[e-1].r,gr.i=Ye[e-1].i;let t=gr.r*gr.r+gr.i*gr.i;for(let r=0;r<e-1;r++)Ye[r].r=(Ye[r].r*gr.r+Ye[r].i*gr.i)/t,Ye[r].i=(Ye[r].i*gr.r-Ye[r].r*gr.i)/t;Ye[e-1].r=1,Ye[e-1].i=0}function EC(e){if(iu(Ye[0])<Y0){Ke.r=0,Ke.i=0;return}for(let t=0;t<100;t++){Ke.r=z0(),Ke.i=z0(),pq(e),Un.r=Ke.r,Un.i=Ke.i,Gr.r=Sr.r,Gr.i=Sr.i,Ke.r=z0(),Ke.i=z0();for(let r=0;r<1e3;r++){pq(e);let n=iu(Sr);if(Xi.DEBUG&&console.log(`nrabs: ${n}`),n<yC)return;iu(Sr)<iu(Gr)&&(pt.r=Ke.r,pt.i=Ke.i,Ke.r=Un.r,Ke.i=Un.i,Un.r=pt.r,Un.i=pt.i,pt.r=Sr.r,pt.i=Sr.i,Sr.r=Gr.r,Sr.i=Gr.i,Gr.r=pt.r,Gr.i=pt.i),ka.r=Un.r-Ke.r,ka.i=Un.i-Ke.i,Bn.r=Gr.r-Sr.r,Bn.i=Gr.i-Sr.i;let o=Bn.r*Bn.r+Bn.i*Bn.i;if(o===0)break;gr.r=(ka.r*Bn.r+ka.i*Bn.i)/o,gr.i=(ka.i*Bn.r-ka.r*Bn.i)/o,Ke.r=Un.r-(gr.r*Gr.r-gr.i*Gr.i),Ke.i=Un.i-(gr.r*Gr.i+gr.i*Gr.r)}}(0,su.stop)("nroots: convergence error")}function pq(e){pt.r=Ke.r,pt.i=Ke.i,Sr.r=Ye[0].r+Ye[1].r*pt.r-Ye[1].i*pt.i,Sr.i=Ye[0].i+Ye[1].r*pt.i+Ye[1].i*pt.r;for(let t=2;t<e;t++){let r=Ke.r*pt.r-Ke.i*pt.i;pt.i=Ke.r*pt.i+Ke.i*pt.r,pt.r=r,Sr.r+=Ye[t].r*pt.r-Ye[t].i*pt.i,Sr.i+=Ye[t].r*pt.i+Ye[t].i*pt.r}}function xC(e){for(let t=e-1;t>0;t--)Ye[t-1].r+=Ye[t].r*Ke.r-Ye[t].i*Ke.i,Ye[t-1].i+=Ye[t].i*Ke.r+Ye[t].r*Ke.i;iu(Ye[0])>Y0&&(0,su.stop)("nroots: residual error");for(let t=0;t<e-1;t++)Ye[t].r=Ye[t+1].r,Ye[t].i=Ye[t+1].i}});var Nq=A(Z0=>{"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});Z0.Eval_outer=void 0;var pC=It(),oi=N(),hC=Ee(),Oq=G(),Tq=Z(),Mq=qt();function AC(e){e=(0,oi.cdr)(e);let t=(0,Oq.Eval)((0,oi.car)(e));return(0,oi.iscons)(e)?e.tail().reduce((n,o)=>OC(n,(0,Oq.Eval)(o)),t):t}Z0.Eval_outer=AC;function OC(e,t){return(0,oi.istensor)(e)&&(0,oi.istensor)(t)?MC(e,t):(0,oi.istensor)(e)?(0,Mq.tensor_times_scalar)(e,t):(0,oi.istensor)(t)?(0,Mq.scalar_times_tensor)(e,t):(0,Tq.multiply)(e,t)}function MC(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>oi.MAXDIM&&(0,hC.stop)("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,o=(0,pC.alloc_tensor)(n);o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let i=0;for(let s=0;s<e.tensor.nelem;s++)for(let u=0;u<t.tensor.nelem;u++)o.tensor.elem[i++]=(0,Tq.multiply)(e.tensor.elem[s],t.tensor.elem[u]);return o}});var c_=A(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.Eval_patternsinfo=en.Eval_clearpatterns=en.do_clearPatterns=en.Eval_pattern=en.Eval_silentpattern=void 0;var Be=N(),u_=Ee(),$a=U(),TC=Ne(),NC=K(),Iq=eo();function IC(e){return Sq(e),(0,$a.symbol)(Be.NIL)}en.Eval_silentpattern=IC;function Sq(e){let t;(0,Be.iscons)((0,Be.cdr)(e))||(0,u_.stop)("pattern needs at least a template and a transformed version");let r=(0,Be.car)((0,Be.cdr)(e)),n=(0,Be.car)((0,Be.cdr)((0,Be.cdr)(e)));n===(0,$a.symbol)(Be.NIL)&&(0,u_.stop)("pattern needs at least a template and a transformed version"),(0,Be.iscons)((0,Be.cdr)((0,Be.cdr)(e)))?t=(0,Be.car)((0,Be.cdr)((0,Be.cdr)((0,Be.cdr)(e)))):t=(0,$a.symbol)(Be.NIL),(0,TC.equal)(r,n)&&(0,u_.stop)("recursive pattern");let o="template: "+(0,Iq.print_list)(r);o+=" tests: "+(0,Iq.print_list)(t),Be.DEBUG&&console.log(`pattern stringkey: ${o}`);let i=Be.defs.userSimplificationsInStringForm.indexOf(o);return i===-1?(Be.defs.userSimplificationsInStringForm.push(o),Be.defs.userSimplificationsInListForm.push((0,Be.cdr)(e))):(Be.DEBUG&&console.log(`pattern already exists, replacing. ${(0,Be.cdr)(e)}`),Be.defs.userSimplificationsInStringForm[i]=o,Be.defs.userSimplificationsInListForm[i]=(0,Be.cdr)(e)),(0,NC.makeList)((0,$a.symbol)(Be.PATTERN),(0,Be.cdr)(e))}en.Eval_pattern=Sq;function Rq(){Be.defs.userSimplificationsInListForm=[],Be.defs.userSimplificationsInStringForm=[]}en.do_clearPatterns=Rq;function SC(){return Rq(),(0,$a.symbol)(Be.NIL)}en.Eval_clearpatterns=SC;function RC(){let e=wC();return e!==""?new Be.Str(e):(0,$a.symbol)(Be.NIL)}en.Eval_patternsinfo=RC;function wC(){let e="";for(let t of Array.from(Be.defs.userSimplificationsInListForm))e+=Be.defs.userSimplificationsInListForm+`
`;return e}});var Lq=A(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0});X0.Eval_prime=void 0;var f_=N(),LC=Ee(),wq=F(),CC=G();function PC(e){return DC((0,CC.Eval)((0,f_.cadr)(e)))}X0.Eval_prime=PC;function DC(e){let t=(0,wq.nativeInt)(e);return(t<1||t>f_.MAXPRIMETAB)&&(0,LC.stop)("prime: Argument out of range."),t=f_.primetab[t-1],(0,wq.integer)(t)}});var Cq=A(H0=>{"use strict";Object.defineProperty(H0,"__esModule",{value:!0});H0.Eval_product=void 0;var Hi=N(),kC=Ee(),d_=U(),$C=F(),m_=G(),UC=Z();function BC(e){let t=(0,Hi.cadr)(e),r=(0,Hi.caddr)(e);(0,Hi.issymbol)(r)||(0,kC.stop)("sum: 2nd arg?");let n=(0,m_.evaluate_integer)((0,Hi.cadddr)(e));if(isNaN(n))return e;let o=(0,m_.evaluate_integer)((0,Hi.caddddr)(e));if(isNaN(o))return e;let i=(0,d_.get_binding)(r),s=Hi.Constants.one;for(let u=n;u<=o;u++){(0,d_.set_binding)(r,(0,$C.integer)(u));let c=(0,m_.Eval)(t),d=(0,UC.multiply)(s,c);Hi.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${s}`),console.log(`product - result: ${d}`)),s=d}return(0,d_.set_binding)(r,i),s}H0.Eval_product=BC});var Dq=A(W0=>{"use strict";Object.defineProperty(W0,"__esModule",{value:!0});W0.Eval_round=void 0;var Q0=N(),GC=U(),Pq=F(),FC=G(),jC=Rn(),zC=H(),YC=K();function VC(e){return ZC((0,FC.Eval)((0,Q0.cadr)(e)))}W0.Eval_round=VC;function ZC(e){return(0,Q0.isNumericAtom)(e)?(0,Q0.isdouble)(e)?(0,Pq.double)(Math.round(e.d)):(0,zC.isinteger)(e)?e:(e=(0,jC.yyfloat)(e),(0,Pq.integer)(Math.round(e.d))):(0,YC.makeList)((0,GC.symbol)(Q0.ROUND),e)}});var kq=A(J0=>{"use strict";Object.defineProperty(J0,"__esModule",{value:!0});J0.Eval_shape=void 0;var XC=It(),__=N(),HC=Ee(),QC=F(),WC=G(),JC=H();function KC(e){return e3((0,WC.Eval)((0,__.cadr)(e)))}J0.Eval_shape=KC;function e3(e){if(!(0,__.istensor)(e))return(0,JC.isZeroAtomOrTensor)(e)||(0,HC.stop)("transpose: tensor expected, 1st arg is not a tensor"),__.Constants.zero;let{ndim:t}=e.tensor,r=(0,XC.alloc_tensor)(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=(0,QC.integer)(e.tensor.dim[n]);return r}});var $q=A(K0=>{"use strict";Object.defineProperty(K0,"__esModule",{value:!0});K0.Eval_sum=void 0;var Ua=N(),t3=Ee(),b_=U(),r3=ue(),n3=F(),g_=G();function o3(e){let t=(0,Ua.cadr)(e),r=(0,Ua.caddr)(e);(0,Ua.issymbol)(r)||(0,t3.stop)("sum: 2nd arg?");let n=(0,g_.evaluate_integer)((0,Ua.cadddr)(e));if(isNaN(n))return e;let o=(0,g_.evaluate_integer)((0,Ua.caddddr)(e));if(isNaN(o))return e;let i=(0,b_.get_binding)(r),s=Ua.Constants.zero;for(let u=n;u<=o;u++)(0,b_.set_binding)(r,(0,n3.integer)(u)),s=(0,r3.add)(s,(0,g_.Eval)(t));return(0,b_.set_binding)(r,i),s}K0.Eval_sum=o3});var Gq=A(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.Eval_tan=void 0;var yn=N(),y_=U(),Fr=F(),i3=G(),s3=H(),Uq=K(),Qi=Z(),ef=Et();function a3(e){return Bq((0,i3.Eval)((0,yn.cadr)(e)))}tf.Eval_tan=a3;function Bq(e){if((0,yn.car)(e)===(0,y_.symbol)(yn.ARCTAN))return(0,yn.cadr)(e);if((0,yn.isdouble)(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),(0,Fr.double)(r)}if((0,s3.isnegative)(e))return(0,Qi.negate)(Bq((0,Qi.negate)(e)));let t=(0,Fr.nativeInt)((0,Qi.divide)((0,Qi.multiply)(e,(0,Fr.integer)(180)),yn.Constants.Pi()));if(t<0||isNaN(t))return(0,Uq.makeList)((0,y_.symbol)(yn.TAN),e);switch(t%360){case 0:case 180:return yn.Constants.zero;case 30:case 210:return(0,Qi.multiply)((0,Fr.rational)(1,3),(0,ef.power)((0,Fr.integer)(3),(0,Fr.rational)(1,2)));case 150:case 330:return(0,Qi.multiply)((0,Fr.rational)(-1,3),(0,ef.power)((0,Fr.integer)(3),(0,Fr.rational)(1,2)));case 45:case 225:return yn.Constants.one;case 135:case 315:return yn.Constants.negOne;case 60:case 240:return(0,ef.power)((0,Fr.integer)(3),(0,Fr.rational)(1,2));case 120:case 300:return(0,Qi.negate)((0,ef.power)((0,Fr.integer)(3),(0,Fr.rational)(1,2)));default:return(0,Uq.makeList)((0,y_.symbol)(yn.TAN),e)}}});var jq=A(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.Eval_tanh=void 0;var Wi=N(),Fq=U(),l3=F(),u3=G(),c3=H(),f3=K();function d3(e){return m3((0,u3.Eval)((0,Wi.cadr)(e)))}rf.Eval_tanh=d3;function m3(e){if((0,Wi.car)(e)===(0,Fq.symbol)(Wi.ARCTANH))return(0,Wi.cadr)(e);if((0,Wi.isdouble)(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),(0,l3.double)(t)}return(0,c3.isZeroAtomOrTensor)(e)?Wi.Constants.zero:(0,f3.makeList)((0,Fq.symbol)(Wi.TANH),e)}});var Vq=A(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.Eval_taylor=void 0;var Rr=N(),nf=U(),zq=ue(),q_=F(),_3=Ri(),Ba=G(),b3=pi(),g3=Vr(),y3=H(),v3=K(),v_=Z(),Yq=Yr();function q3(e){e=(0,Rr.cdr)(e);let t=(0,Ba.Eval)((0,Rr.car)(e));e=(0,Rr.cdr)(e);let r=(0,Ba.Eval)((0,Rr.car)(e)),n=r===(0,nf.symbol)(Rr.NIL)?(0,g3.guess)(t):r;e=(0,Rr.cdr)(e),r=(0,Ba.Eval)((0,Rr.car)(e));let o=r===(0,nf.symbol)(Rr.NIL)?(0,q_.integer)(24):r;e=(0,Rr.cdr)(e),r=(0,Ba.Eval)((0,Rr.car)(e));let i=r===(0,nf.symbol)(Rr.NIL)?Rr.Constants.zero:r;return E3(t,n,o,i)}of.Eval_taylor=q3;function E3(e,t,r,n){let o=(0,q_.nativeInt)(r);if(isNaN(o))return(0,v3.makeList)((0,nf.symbol)(Rr.TAYLOR),e,t,r,n);let i=Rr.Constants.one,s=(0,Ba.Eval)((0,Yq.subst)(e,t,n));for(let u=1;u<=o&&(e=(0,_3.derivative)(e,t),!(0,y3.isZeroAtomOrTensor)(e));u++){i=(0,v_.multiply)(i,(0,zq.subtract)(t,n));let c=(0,Ba.Eval)((0,Yq.subst)(e,t,n));s=(0,zq.add)(s,(0,v_.divide)((0,v_.multiply)(c,i),(0,b3.factorial)((0,q_.integer)(u))))}return s}});var Zq=A(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.Eval_or=Ut.Eval_and=Ut.Eval_not=Ut.Eval_testlt=Ut.Eval_testle=Ut.Eval_testgt=Ut.Eval_testge=Ut.Eval_testeq=Ut.Eval_test=void 0;var be=N(),x3=U(),E_=ue(),po=G(),p3=Rn(),Ji=H(),sf=Zo();function h3(e){let t=e;for(e=(0,be.cdr)(e);(0,be.iscons)(e);){if((0,be.cdr)(e)===(0,x3.symbol)(be.NIL))return(0,po.Eval)((0,be.car)(e));let r=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)((0,be.car)(e));if(r==null)return t;if(r)return(0,po.Eval)((0,be.cadr)(e));e=(0,be.cddr)(e)}return be.Constants.zero}Ut.Eval_test=h3;function A3(e){let t=e,r=(0,E_.subtract)((0,po.Eval)((0,be.cadr)(e)),(0,po.Eval)((0,be.caddr)(e))),n=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)(r);if(n)return be.Constants.zero;if(n!=null&&!n)return be.Constants.one;let o=(0,sf.simplify)((0,po.Eval)((0,be.cadr)(e))),i=(0,sf.simplify)((0,po.Eval)((0,be.caddr)(e)));return r=(0,E_.subtract)(o,i),n=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)(r),n?be.Constants.zero:n!=null&&!n?be.Constants.one:t}Ut.Eval_testeq=A3;function O3(e){let t=e,r=af(e);return r==null?t:r>=0?be.Constants.one:be.Constants.zero}Ut.Eval_testge=O3;function M3(e){let t=e,r=af(e);return r==null?t:r>0?be.Constants.one:be.Constants.zero}Ut.Eval_testgt=M3;function T3(e){let t=e,r=af(e);return r==null?t:r<=0?be.Constants.one:be.Constants.zero}Ut.Eval_testle=T3;function N3(e){let t=e,r=af(e);return r==null?t:r<0?be.Constants.one:be.Constants.zero}Ut.Eval_testlt=N3;function I3(e){let t=e,r=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)((0,be.cadr)(e));return r==null?t:r?be.Constants.zero:be.Constants.one}Ut.Eval_not=I3;function S3(e){let t=e,r=(0,be.cdr)(t),n=!1;for(;(0,be.iscons)(r);){let o=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)((0,be.car)(r));if(o==null)n=!0,r=(0,be.cdr)(r);else if(o)r=(0,be.cdr)(r);else if(!o)return be.Constants.zero}return n?t:be.Constants.one}Ut.Eval_and=S3;function R3(e){let t=e,r=(0,be.cdr)(t),n=!1;for(;(0,be.iscons)(r);){let o=(0,Ji.isZeroLikeOrNonZeroLikeOrUndetermined)((0,be.car)(r));if(o==null)n=!0,r=(0,be.cdr)(r);else{if(o)return be.Constants.one;o||(r=(0,be.cdr)(r))}}return n?t:be.Constants.zero}Ut.Eval_or=R3;function af(e){let t=0,r=(0,sf.simplify)((0,po.Eval)((0,be.cadr)(e))),n=(0,sf.simplify)((0,po.Eval)((0,be.caddr)(e)));if(e=(0,E_.subtract)(r,n),e.k!==be.NUM&&e.k!==be.DOUBLE&&(e=(0,po.Eval)((0,p3.yyfloat)(e))),(0,Ji.isZeroAtomOrTensor)(e))return 0;switch(e.k){case be.NUM:(0,be.MSIGN)(e.q.a)===-1?t=-1:t=1;break;case be.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var Xq=A(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.Eval_zero=void 0;var w3=It(),lf=N(),L3=G();function C3(e){let t=Array(lf.MAXDIM).fill(0),r=1,n=0;if((0,lf.iscons)(e))for(let o of e.tail()){let i=(0,L3.evaluate_integer)(o);if(i<1||isNaN(i))return lf.Constants.zero;r*=i,t[n++]=i}if(n===0)return lf.Constants.zero;e=(0,w3.alloc_tensor)(r),e.tensor.ndim=n;for(let o=0;o<n;o++)e.tensor.dim[o]=t[o];return e}uf.Eval_zero=C3});var au=A(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.defn=Ga.init=void 0;var P3=on(),D3=ue(),k3=hd(),$3=Dm(),U3=r1(),B3=o1(),G3=s1(),F3=l1(),j3=ud(),z3=c1(),Y3=ds(),V3=Nd(),Z3=Id(),Hq=F(),X3=m1(),H3=b1(),Q3=v1(),W3=M1(),Qq=h_(),J3=Du(),K3=gi(),eP=pd(),tP=gl(),rP=yi(),nP=N1(),oP=Lo(),iP=Sd(),sP=Jd(),aP=Cf(),lP=S1(),uP=v0(),cP=Mn(),fP=Ri(),dP=Cd(),x_=$1(),mP=z1(),_P=Wm(),bt=G(),bP=tq(),gP=Fm(),yP=jm(),vP=dl(),qP=ll(),EP=Rn(),xP=nq(),pP=oq(),hP=lq(),AP=_i(),OP=ql(),Wq=Go(),MP=Fl(),TP=uq(),NP=fq(),IP=Df(),SP=mq(),RP=gq(),wP=K(),LP=mm(),CP=yq(),PP=qq(),DP=Z(),kP=Aq(),$P=oo(),UP=Nq(),cf=c_(),BP=ku(),GP=Et(),FP=Lq(),ii=eo(),jP=Cq(),zP=Fu(),YP=yl(),VP=Us(),ZP=Kn(),XP=Qd(),HP=Dq(),QP=Yo(),WP=bm(),JP=kq(),KP=Zo(),eD=Qn(),tD=gm(),rD=$q(),nD=Gq(),oD=jq(),iD=Vq(),ho=Zq(),sD=om(),aD=Xq(),g=N(),y=U(),p_=0;function lD(){p_=0,(0,g.reset_after_error)(),g.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!p_&&(p_=1,(0,y.reset_symbols)(),Kq())}Ga.init=lD;var Jq=['version="'+g.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function Kq(){(0,y.std_symbol)(g.ABS,P3.Eval_abs),(0,y.std_symbol)(g.ADD,D3.Eval_add),(0,y.std_symbol)(g.ADJ,k3.Eval_adj),(0,y.std_symbol)(g.AND,ho.Eval_and),(0,y.std_symbol)(g.APPROXRATIO,$3.Eval_approxratio),(0,y.std_symbol)(g.ARCCOS,U3.Eval_arccos),(0,y.std_symbol)(g.ARCCOSH,B3.Eval_arccosh),(0,y.std_symbol)(g.ARCSIN,G3.Eval_arcsin),(0,y.std_symbol)(g.ARCSINH,F3.Eval_arcsinh),(0,y.std_symbol)(g.ARCTAN,j3.Eval_arctan),(0,y.std_symbol)(g.ARCTANH,z3.Eval_arctanh),(0,y.std_symbol)(g.ARG,Y3.Eval_arg),(0,y.std_symbol)(g.ATOMIZE),(0,y.std_symbol)(g.BESSELJ,V3.Eval_besselj),(0,y.std_symbol)(g.BESSELY,Z3.Eval_bessely),(0,y.std_symbol)(g.BINDING,bt.Eval_binding),(0,y.std_symbol)(g.BINOMIAL,X3.Eval_binomial),(0,y.std_symbol)(g.CEILING,H3.Eval_ceiling),(0,y.std_symbol)(g.CHECK,bt.Eval_check),(0,y.std_symbol)(g.CHOOSE,Q3.Eval_choose),(0,y.std_symbol)(g.CIRCEXP,W3.Eval_circexp),(0,y.std_symbol)(g.CLEAR,Qq.Eval_clear),(0,y.std_symbol)(g.CLEARALL,Qq.Eval_clearall),(0,y.std_symbol)(g.CLEARPATTERNS,cf.Eval_clearpatterns),(0,y.std_symbol)(g.CLOCK,J3.Eval_clock),(0,y.std_symbol)(g.COEFF,K3.Eval_coeff),(0,y.std_symbol)(g.COFACTOR,eP.Eval_cofactor),(0,y.std_symbol)(g.CONDENSE,tP.Eval_condense),(0,y.std_symbol)(g.CONJ,rP.Eval_conj),(0,y.std_symbol)(g.CONTRACT,nP.Eval_contract),(0,y.std_symbol)(g.COS,oP.Eval_cos),(0,y.std_symbol)(g.COSH,iP.Eval_cosh),(0,y.std_symbol)(g.DECOMP,sP.Eval_decomp),(0,y.std_symbol)(g.DEFINT,lP.Eval_defint),(0,y.std_symbol)(g.DEGREE,uP.Eval_degree),(0,y.std_symbol)(g.DENOMINATOR,cP.Eval_denominator),(0,y.std_symbol)(g.DET,bt.Eval_det),(0,y.std_symbol)(g.DERIVATIVE,fP.Eval_derivative),(0,y.std_symbol)(g.DIM,bt.Eval_dim),(0,y.std_symbol)(g.DIRAC,dP.Eval_dirac),(0,y.std_symbol)(g.DIVISORS,bt.Eval_divisors),(0,y.std_symbol)(g.DO,bt.Eval_do),(0,y.std_symbol)(g.DOT,Wq.Eval_inner),(0,y.std_symbol)(g.DRAW),(0,y.std_symbol)(g.DSOLVE),(0,y.std_symbol)(g.ERF,mP.Eval_erf),(0,y.std_symbol)(g.ERFC,_P.Eval_erfc),(0,y.std_symbol)(g.EIGEN,x_.Eval_eigen),(0,y.std_symbol)(g.EIGENVAL,x_.Eval_eigenval),(0,y.std_symbol)(g.EIGENVEC,x_.Eval_eigenvec),(0,y.std_symbol)(g.EVAL,bt.Eval_Eval),(0,y.std_symbol)(g.EXP,bt.Eval_exp),(0,y.std_symbol)(g.EXPAND,bP.Eval_expand),(0,y.std_symbol)(g.EXPCOS,gP.Eval_expcos),(0,y.std_symbol)(g.EXPSIN,yP.Eval_expsin),(0,y.std_symbol)(g.FACTOR,vP.Eval_factor),(0,y.std_symbol)(g.FACTORIAL,bt.Eval_factorial),(0,y.std_symbol)(g.FACTORPOLY,bt.Eval_factorpoly),(0,y.std_symbol)(g.FILTER,qP.Eval_filter),(0,y.std_symbol)(g.FLOATF,EP.Eval_float),(0,y.std_symbol)(g.FLOOR,xP.Eval_floor),(0,y.std_symbol)(g.FOR,pP.Eval_for),(0,y.std_symbol)(g.FUNCTION,aP.Eval_function_reference),(0,y.std_symbol)(g.GAMMA,hP.Eval_gamma),(0,y.std_symbol)(g.GCD,AP.Eval_gcd),(0,y.std_symbol)(g.HERMITE,bt.Eval_hermite),(0,y.std_symbol)(g.HILBERT,bt.Eval_hilbert),(0,y.std_symbol)(g.IMAG,OP.Eval_imag),(0,y.std_symbol)(g.INDEX,bt.Eval_index),(0,y.std_symbol)(g.INNER,Wq.Eval_inner),(0,y.std_symbol)(g.INTEGRAL,MP.Eval_integral),(0,y.std_symbol)(g.INV,bt.Eval_inv),(0,y.std_symbol)(g.INVG,bt.Eval_invg),(0,y.std_symbol)(g.ISINTEGER,bt.Eval_isinteger),(0,y.std_symbol)(g.ISPRIME,TP.Eval_isprime),(0,y.std_symbol)(g.LAGUERRE,NP.Eval_laguerre),(0,y.std_symbol)(g.LCM,IP.Eval_lcm),(0,y.std_symbol)(g.LEADING,SP.Eval_leading),(0,y.std_symbol)(g.LEGENDRE,RP.Eval_legendre),(0,y.std_symbol)(g.LOG,LP.Eval_log),(0,y.std_symbol)(g.LOOKUP,CP.Eval_lookup),(0,y.std_symbol)(g.MOD,PP.Eval_mod),(0,y.std_symbol)(g.MULTIPLY,DP.Eval_multiply),(0,y.std_symbol)(g.NOT,ho.Eval_not),(0,y.std_symbol)(g.NROOTS,kP.Eval_nroots),(0,y.std_symbol)(g.NUMBER,bt.Eval_number),(0,y.std_symbol)(g.NUMERATOR,$P.Eval_numerator),(0,y.std_symbol)(g.OPERATOR,bt.Eval_operator),(0,y.std_symbol)(g.OR,ho.Eval_or),(0,y.std_symbol)(g.OUTER,UP.Eval_outer),(0,y.std_symbol)(g.PATTERN,cf.Eval_pattern),(0,y.std_symbol)(g.PATTERNSINFO,cf.Eval_patternsinfo),(0,y.std_symbol)(g.POLAR,BP.Eval_polar),(0,y.std_symbol)(g.POWER,GP.Eval_power),(0,y.std_symbol)(g.PRIME,FP.Eval_prime),(0,y.std_symbol)(g.PRINT,ii.Eval_print),(0,y.std_symbol)(g.PRINT2DASCII,ii.Eval_print2dascii),(0,y.std_symbol)(g.PRINTFULL,ii.Eval_printcomputer),(0,y.std_symbol)(g.PRINTLATEX,ii.Eval_printlatex),(0,y.std_symbol)(g.PRINTLIST,ii.Eval_printlist),(0,y.std_symbol)(g.PRINTPLAIN,ii.Eval_printhuman),(0,y.std_symbol)(g.PRINT_LEAVE_E_ALONE),(0,y.std_symbol)(g.PRINT_LEAVE_X_ALONE),(0,y.std_symbol)(g.PRODUCT,jP.Eval_product),(0,y.std_symbol)(g.QUOTE,bt.Eval_quote),(0,y.std_symbol)(g.QUOTIENT,zP.Eval_quotient),(0,y.std_symbol)(g.RANK,bt.Eval_rank),(0,y.std_symbol)(g.RATIONALIZE,YP.Eval_rationalize),(0,y.std_symbol)(g.REAL,VP.Eval_real),(0,y.std_symbol)(g.YYRECT,ZP.Eval_rect),(0,y.std_symbol)(g.ROOTS,XP.Eval_roots),(0,y.std_symbol)(g.ROUND,HP.Eval_round),(0,y.std_symbol)(g.SETQ,bt.Eval_setq),(0,y.std_symbol)(g.SGN,WP.Eval_sgn),(0,y.std_symbol)(g.SILENTPATTERN,cf.Eval_silentpattern),(0,y.std_symbol)(g.SIMPLIFY,KP.Eval_simplify),(0,y.std_symbol)(g.SIN,eD.Eval_sin),(0,y.std_symbol)(g.SINH,tD.Eval_sinh),(0,y.std_symbol)(g.SHAPE,JP.Eval_shape),(0,y.std_symbol)(g.SQRT,bt.Eval_sqrt),(0,y.std_symbol)(g.STOP,bt.Eval_stop),(0,y.std_symbol)(g.SUBST,bt.Eval_subst),(0,y.std_symbol)(g.SUM,rD.Eval_sum),(0,y.std_symbol)(g.SYMBOLSINFO,y.Eval_symbolsinfo),(0,y.std_symbol)(g.TAN,nD.Eval_tan),(0,y.std_symbol)(g.TANH,oD.Eval_tanh),(0,y.std_symbol)(g.TAYLOR,iD.Eval_taylor),(0,y.std_symbol)(g.TEST,ho.Eval_test),(0,y.std_symbol)(g.TESTEQ,ho.Eval_testeq),(0,y.std_symbol)(g.TESTGE,ho.Eval_testge),(0,y.std_symbol)(g.TESTGT,ho.Eval_testgt),(0,y.std_symbol)(g.TESTLE,ho.Eval_testle),(0,y.std_symbol)(g.TESTLT,ho.Eval_testlt),(0,y.std_symbol)(g.TRANSPOSE,sD.Eval_transpose),(0,y.std_symbol)(g.UNIT,bt.Eval_unit),(0,y.std_symbol)(g.ZERO,aD.Eval_zero),(0,y.std_symbol)(g.NIL),(0,y.std_symbol)(g.AUTOEXPAND),(0,y.std_symbol)(g.BAKE),(0,y.std_symbol)(g.ASSUME_REAL_VARIABLES),(0,y.std_symbol)(g.LAST),(0,y.std_symbol)(g.LAST_PRINT),(0,y.std_symbol)(g.LAST_2DASCII_PRINT),(0,y.std_symbol)(g.LAST_FULL_PRINT),(0,y.std_symbol)(g.LAST_LATEX_PRINT),(0,y.std_symbol)(g.LAST_LIST_PRINT),(0,y.std_symbol)(g.LAST_PLAIN_PRINT),(0,y.std_symbol)(g.TRACE),(0,y.std_symbol)(g.FORCE_FIXED_PRINTOUT),(0,y.std_symbol)(g.MAX_FIXED_PRINTOUT_DIGITS),(0,y.std_symbol)(g.YYE),(0,y.std_symbol)(g.DRAWX),(0,y.std_symbol)(g.METAA),(0,y.std_symbol)(g.METAB),(0,y.std_symbol)(g.METAX),(0,y.std_symbol)(g.SECRETX),(0,y.std_symbol)(g.VERSION),(0,y.std_symbol)(g.PI),(0,y.std_symbol)(g.SYMBOL_A),(0,y.std_symbol)(g.SYMBOL_B),(0,y.std_symbol)(g.SYMBOL_C),(0,y.std_symbol)(g.SYMBOL_D),(0,y.std_symbol)(g.SYMBOL_I),(0,y.std_symbol)(g.SYMBOL_J),(0,y.std_symbol)(g.SYMBOL_N),(0,y.std_symbol)(g.SYMBOL_R),(0,y.std_symbol)(g.SYMBOL_S),(0,y.std_symbol)(g.SYMBOL_T),(0,y.std_symbol)(g.SYMBOL_X),(0,y.std_symbol)(g.SYMBOL_Y),(0,y.std_symbol)(g.SYMBOL_Z),(0,y.std_symbol)(g.SYMBOL_IDENTITY_MATRIX),(0,y.std_symbol)(g.SYMBOL_A_UNDERSCORE),(0,y.std_symbol)(g.SYMBOL_B_UNDERSCORE),(0,y.std_symbol)(g.SYMBOL_X_UNDERSCORE),(0,y.std_symbol)(g.C1),(0,y.std_symbol)(g.C2),(0,y.std_symbol)(g.C3),(0,y.std_symbol)(g.C4),(0,y.std_symbol)(g.C5),(0,y.std_symbol)(g.C6),uD();let e=g.defs.codeGen;g.defs.codeGen=!1;for(let t=0;t<Jq.length;t++){let r=Jq[t],[,n]=(0,QP.scan)(r);g.DEBUG&&(console.log(`... evaling ${r}`),console.log("top of stack:"),console.log((0,ii.print_list)(n))),(0,bt.Eval)(n)}g.defs.codeGen=e}Ga.defn=Kq;function uD(){let e=(0,wP.makeList)((0,y.symbol)(g.POWER),(0,Hq.integer)(-1),(0,Hq.rational)(1,2));g.DEBUG&&console.log((0,ii.print_list)(e)),g.Constants.imaginaryunit=e}});var h_=A(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.Eval_clear=si.do_clearall=si.Eval_clearall=void 0;var Ao=N(),cD=au(),fD=lo(),dD=Ee(),ff=U(),mD=c_();function _D(){return eE(),(0,ff.symbol)(Ao.NIL)}si.Eval_clearall=_D;function eE(){return Ao.defs.test_flag||(0,fD.clear_term)(),(0,mD.do_clearPatterns)(),(0,ff.clear_symbols)(),(0,cD.defn)(),Ao.defs.codeGen=!1}si.do_clearall=eE;function bD(e){let t;for(t=(0,Ao.cdr)(e);(0,Ao.iscons)(t);){let r=(0,Ao.car)(t);r.k!==Ao.SYM&&(0,dD.stop)("symbol error"),(0,ff.clear_symbol)(r),t=(0,Ao.cdr)(t)}return(0,ff.symbol)(Ao.NIL)}si.Eval_clear=bD});var S_=A(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.print2dascii=void 0;var v=N(),gD=lo(),vn=U(),uu=on(),za=F(),tr=H(),yD=eo(),sE=1e4,A_=class{constructor(){this.c=0,this.x=0,this.y=0}},gt=[];for(let e=0;e<sE;e++)gt[e]=new A_;var ut=0,Gn=0,Fn=0,tE=0;function O_(e){let t="";return t+=e,t}function vD(e){return O_(e)}function qD(e){ut=0,Gn=0,Fn=0,ED(e);let[t,r,n]=Array.from(Ya(0,ut));if(r>100){(0,yD.printline)(e);return}return LD()}mf.print2dascii=qD;function ED(e){if((0,v.car)(e)===(0,vn.symbol)(v.SETQ)){yr((0,v.cadr)(e)),I_(" = "),yr((0,v.caddr)(e));return}(0,v.istensor)(e)?PD(e):yr(e)}function rE(e){if(Gn>0)return!1;if((0,tr.isfraction)(e))return!0;if(!(0,v.ismultiply)(e))return!1;if((0,tr.isfraction)((0,v.cadr)(e)))return!0;for(;(0,v.iscons)(e);){if(Ki((0,v.car)(e)))return!0;e=(0,v.cdr)(e)}return!1}function yr(e){if(tE++,(0,v.isadd)(e))for(e=(0,v.cdr)(e),Fa((0,v.car)(e))&&(me("-"),rE((0,v.car)(e))&&me(" ")),ja((0,v.car)(e)),e=(0,v.cdr)(e);(0,v.iscons)(e);)Fa((0,v.car)(e))?(me(" "),me("-"),me(" ")):(me(" "),me("+"),me(" ")),ja((0,v.car)(e)),e=(0,v.cdr)(e);else Fa(e)&&(me("-"),rE(e)&&me(" ")),ja(e);tE--}function xD(e){if((0,v.isadd)(e))for(e=(0,v.cdr)(e),ja((0,v.car)(e)),e=(0,v.cdr)(e);(0,v.iscons)(e);)Fa((0,v.car)(e))?(me(" "),me("-"),me(" ")):(me(" "),me("+"),me(" ")),ja((0,v.car)(e)),e=(0,v.cdr)(e);else ja(e)}function Fa(e){return!!((0,tr.isnegativenumber)(e)||(0,v.ismultiply)(e)&&(0,tr.isnegativenumber)((0,v.cadr)(e)))}function ja(e){if((0,v.ismultiply)(e)){let t=pD(e);t&&Gn===0?AD(e,t):hD(e,t)}else qn(e)}function Ki(e){return(0,v.ispower)(e)&&(0,v.cadr)(e)!==(0,vn.symbol)(v.E)&&Fa((0,v.caddr)(e))}function pD(e){let t=0;for(e=(0,v.cdr)(e);(0,v.iscons)(e);){let r=(0,v.car)(e);Ki(r)&&t++,e=(0,v.cdr)(e)}return t}function hD(e,t){if(t===0)for(e=(0,v.cdr)(e),((0,tr.isplusone)((0,v.car)(e))||(0,tr.isminusone)((0,v.car)(e)))&&(e=(0,v.cdr)(e)),qn((0,v.car)(e)),e=(0,v.cdr)(e);(0,v.iscons)(e);)me(" "),qn((0,v.car)(e)),e=(0,v.cdr)(e);else OD(e),me("/"),t>1||(0,tr.isfraction)((0,v.cadr)(e))?(me("("),nE(e),me(")")):nE(e)}function AD(e,t){let r,n,o=0,i=0,s=0,u=0,c=0,d=v.Constants.one,_=v.Constants.one;for((0,v.isrational)((0,v.cadr)(e))&&(d=(0,uu.absval)((0,za.mp_numerator)((0,v.cadr)(e))),_=(0,za.mp_denominator)((0,v.cadr)(e))),(0,v.isdouble)((0,v.cadr)(e))&&(d=(0,uu.absval)((0,v.cadr)(e))),u=(0,tr.isplusone)(d)?0:1,r=(0,v.cdr)(e),(0,v.isNumericAtom)((0,v.car)(r))&&(r=(0,v.cdr)(r));(0,v.iscons)(r);)n=(0,v.car)(r),Ki(n)||u++,r=(0,v.cdr)(r);for(c=Fn,i=ut,o=0,(0,tr.isplusone)(d)||(Oo(d,0),o++),r=(0,v.cdr)(e),(0,v.isNumericAtom)((0,v.car)(r))&&(r=(0,v.cdr)(r));(0,v.iscons)(r);)n=(0,v.car)(r),Ki(n)||(o>0&&me(" "),u===1?yr(n):qn(n),o++),r=(0,v.cdr)(r);for(o===0&&me("1"),s=ut,o=0,(0,tr.isplusone)(_)||(Oo(_,0),o++,t++),r=(0,v.cdr)(e),(0,v.isrational)((0,v.car)(r))&&(r=(0,v.cdr)(r));(0,v.iscons)(r);)n=(0,v.car)(r),Ki(n)&&(o>0&&me(" "),T_(n,t),o++),r=(0,v.cdr)(r);N_(c,i,s)}function OD(e){let t=v.Constants.one;e=(0,v.cdr)(e),(0,v.isrational)((0,v.car)(e))?(t=(0,uu.absval)((0,za.mp_numerator)((0,v.car)(e))),e=(0,v.cdr)(e)):(0,v.isdouble)((0,v.car)(e))&&(t=(0,uu.absval)((0,v.car)(e)),e=(0,v.cdr)(e));let r=0;for((0,tr.isplusone)(t)||(Oo(t,0),r++);(0,v.iscons)(e);)Ki((0,v.car)(e))||(r>0&&me(" "),qn((0,v.car)(e)),r++),e=(0,v.cdr)(e);r===0&&me("1")}function nE(e){let t=0;if(e=(0,v.cdr)(e),(0,tr.isfraction)((0,v.car)(e))){let r=(0,za.mp_denominator)((0,v.car)(e));Oo(r,0),t++,e=(0,v.cdr)(e)}for(;(0,v.iscons)(e);)Ki((0,v.car)(e))&&(t>0&&me(" "),T_((0,v.car)(e),0),t++),e=(0,v.cdr)(e)}function qn(e){if((0,v.istensor)(e)){df(e);return}if((0,v.isdouble)(e)){Oo(e,0);return}if((0,v.isadd)(e)||(0,v.ismultiply)(e)){ai(e);return}if((0,v.ispower)(e)){TD(e);return}if((0,v.iscons)(e)){ND(e);return}if((0,v.isNumericAtom)(e)){Gn===0?MD(e):Oo(e,0);return}if((0,v.issymbol)(e)){aE(e);return}(0,v.isstr)(e)&&RD(e)}function MD(e){let t=(0,uu.absval)((0,za.mp_numerator)(e)),r=(0,za.mp_denominator)(e);if((0,tr.isplusone)(r)){Oo(t,0);return}let n=Fn,o=ut;Oo(t,0);let i=ut;Oo(r,0),N_(n,o,i)}function lu(e){return(0,v.iscons)(e)&&!(0,v.isadd)(e)&&!(0,v.ismultiply)(e)&&!(0,v.ispower)(e)||(0,v.issymbol)(e)?!0:(0,tr.isfraction)(e)||(0,tr.isnegativenumber)(e)?!1:!!(0,v.isNumericAtom)(e)}function TD(e){let t=0,r=0,n=0;if((0,v.cadr)(e)===(0,vn.symbol)(v.E)){I_("exp("),yr((0,v.caddr)(e)),me(")");return}if(Gn>0){(0,tr.isminusone)((0,v.caddr)(e))?(me("1"),me("/"),lu((0,v.cadr)(e))?qn((0,v.cadr)(e)):ai((0,v.cadr)(e))):(lu((0,v.cadr)(e))?qn((0,v.cadr)(e)):ai((0,v.cadr)(e)),me("^"),lu((0,v.caddr)(e))?qn((0,v.caddr)(e)):ai((0,v.caddr)(e)));return}if(Fa((0,v.caddr)(e))){n=Fn,t=ut,me("1"),r=ut,T_(e,1),N_(n,t,r);return}t=ut,lu((0,v.cadr)(e))?qn((0,v.cadr)(e)):ai((0,v.cadr)(e)),r=ut,Gn++,yr((0,v.caddr)(e)),Gn--,lE(t,r)}function T_(e,t){let r=0,n=0;if((0,tr.isminusone)((0,v.caddr)(e))){t===1?yr((0,v.cadr)(e)):qn((0,v.cadr)(e));return}r=ut,lu((0,v.cadr)(e))?qn((0,v.cadr)(e)):ai((0,v.cadr)(e)),n=ut,Gn++,xD((0,v.caddr)(e)),Gn--,lE(r,n)}function ND(e){if((0,v.car)(e)===(0,vn.symbol)(v.INDEX)&&(0,v.issymbol)((0,v.cadr)(e))){ID(e);return}if((0,v.isfactorial)(e)){SD(e);return}if((0,v.car)(e)===(0,vn.symbol)(v.DERIVATIVE)?me("d"):aE((0,v.car)(e)),me("("),e=(0,v.cdr)(e),(0,v.iscons)(e))for(yr((0,v.car)(e)),e=(0,v.cdr)(e);(0,v.iscons)(e);)me(","),yr((0,v.car)(e)),e=(0,v.cdr)(e);me(")")}function ID(e){if(e=(0,v.cdr)(e),(0,v.caar)(e)===(0,vn.symbol)(v.ADD)||(0,v.caar)(e)===(0,vn.symbol)(v.MULTIPLY)||(0,v.caar)(e)===(0,vn.symbol)(v.POWER)||(0,v.caar)(e)===(0,vn.symbol)(v.FACTORIAL)?ai((0,v.car)(e)):yr((0,v.car)(e)),me("["),e=(0,v.cdr)(e),(0,v.iscons)(e))for(yr((0,v.car)(e)),e=(0,v.cdr)(e);(0,v.iscons)(e);)me(","),yr((0,v.car)(e)),e=(0,v.cdr)(e);me("]")}function SD(e){e=(0,v.cadr)(e),(0,tr.isfraction)(e)||(0,v.isadd)(e)||(0,v.ismultiply)(e)||(0,v.ispower)(e)||(0,v.isfactorial)(e)?ai(e):yr(e),me("!")}function ai(e){me("("),yr(e),me(")")}function aE(e){if(e===(0,vn.symbol)(v.E)){I_("exp(1)");return}let t=(0,vn.get_printname)(e);for(let r=0;r<t.length;r++)me(t[r])}function RD(e){let t=e.str;me('"');for(let r=0;r<t.length;r++)me(t[r]);me('"')}function N_(e,t,r){let n=0,o=0,[i,s,u]=Array.from(Ya(t,r)),[c,d,_]=Array.from(Ya(r,ut));d>s?n=(d-s)/2:n=0,n++,o=-(u+i-1)-1,cu(t,r,n,o),d>s?n=-s:n=-s+(s-d)/2,n++,o=-_+1,cu(r,ut,n,o);let T=0;d>s?T=d:T=s,T+=2,Fn=e;for(let k=0;k<T;k++)me("-")}function lE(e,t){let r=0,n=0,o=0,i=0,s=0,u=0,c=0;[n,o,i]=Array.from(Ya(e,t)),[s,u,c]=Array.from(Ya(t,ut)),r=-c-s+1,r+=i-1,cu(t,ut,0,r)}function cu(e,t,r,n){for(let o=e;o<t;o++)gt[o].x+=r,gt[o].y+=n}function Ya(e,t){let r=gt[e].x,n=gt[e].x,o=gt[e].y,i=gt[e].y;for(let d=e+1;d<t;d++)gt[d].x<r&&(r=gt[d].x),gt[d].x>n&&(n=gt[d].x),gt[d].y<o&&(o=gt[d].y),gt[d].y>i&&(i=gt[d].y);let s=i-o+1,u=n-r+1;return[s,u,o]}function me(e){if(ut!==sE)return gt[ut]==null&&v.breakpoint,gt[ut].c=e,gt[ut].x=Fn,gt[ut].y=0,ut++,Fn++}function I_(e){for(let t=0;t<e.length;t++)me(e[t])}function Oo(e,t){let r="";switch(e.k){case v.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)me(r[n]);if(r=e.q.b.toString(),r==="1")break;me("/");for(let n=0;n<r.length;n++)me(r[n]);break;case v.DOUBLE:r=(0,gD.doubleToReasonableString)(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)me(r[n]);break}}function wD(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function LD(){let e="",t=gt.slice(0,ut);t.sort(wD),gt=[].concat(t).concat(gt.slice(ut));let r=0,{y:n}=gt[0];for(let o=0;o<ut;o++){for(;gt[o].y>n;)e+=vD(`
`),r=0,n++;for(;gt[o].x>r;)e+=O_(" "),r++;e+=O_(gt[o].c),r++}return e}var CD=100,M_=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Tt=[];for(let e=0;e<1e4;e++)Tt[e]=new M_;var oE=3,iE=1;function PD(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){df(e);return}let o=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let i=o*t;if(i>CD){df(e);return}let s=Fn;for(let T=0;T<i;T++)Tt[T].index=ut,Tt[T].x=Fn,yr(e.tensor.elem[T]),Tt[T].count=ut-Tt[T].index,[Tt[T].h,Tt[T].w,Tt[T].y]=Array.from(Ya(Tt[T].index,ut));let u=0,c=0;for(let T=0;T<i;T++)Tt[T].h>u&&(u=Tt[T].h),Tt[T].w>c&&(c=Tt[T].w);let d=o*u+(o-1)*iE,_=t*c+(t-1)*oE,R=-(d/2);for(let T=0;T<o;T++)for(let k=0;k<t;k++){let V=T*t+k;r=s-Tt[V].x,n=R-Tt[V].y,cu(Tt[V].index,Tt[V].index+Tt[V].count,r,n),r=0,k>0&&(r=k*(c+oE)),n=0,T>0&&(n=T*(u+iE)),r+=(c-Tt[V].w)/2,n+=(u-Tt[V].h)/2,cu(Tt[V].index,Tt[V].index+Tt[V].count,r,n)}Fn=s+_}function df(e){uE(e,0,0)}function uE(e,t,r){me("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(yr(e.tensor.elem[r]),r=r+1):r=uE(e,t+1,r),n+1<e.tensor.dim[t]&&me(",");return me(")"),r}});var Ee=A(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.computeResultsAndJavaScriptFromAlgebra=rr.computeDependenciesFromAlgebra=rr.check_esc_flag=rr.top_level_eval=rr.check_stack=rr.run=rr.findDependenciesInScript=rr.stop=void 0;var DD=tm(),fE=h_(),kD=G(),fu=H(),cE=eo(),$D=S_(),dE=Yo(),UD=Zo(),_f=Yr(),p=N(),bf=au(),yt=U();function du(e){p.defs.errorMessage+="Stop: ",p.defs.errorMessage+=e;let t=p.defs.errorMessage;throw p.defs.errorMessage="",new Error(t)}rr.stop=du;function w_(e,t=!1){p.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;p.defs.codeGen=!0,p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.symbolsInExpressionsWithoutAssignments=[],p.defs.patternHasBeenFound=!1;let o=0,i="",s="",u=0,c={affectsVariables:[],affectedBy:[]},d=e;for(;;){try{p.defs.errorMessage="",Va(),p.DEBUG&&console.log("findDependenciesInScript: scanning"),[u]=(0,dE.scan)(e.substring(o)),p.DEBUG&&console.log("scanned"),Va()}catch(z){p.PRINTOUTRESULT&&console.log(z),p.defs.errorMessage=z+"",(0,p.reset_after_error)();break}if(u===0)break;o+=u}let _="";p.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let z in p.defs.symbolsDependencies){let Ae=p.defs.symbolsDependencies[z];p.DEBUG&&console.log(`variable ${z} depends on: `),c.affectsVariables.push(z),_+=" variable "+z+" depends on: ";for(let et of Array.from(Ae))p.DEBUG&&console.log(`    ${et}`),et[0]!=="'"&&c.affectedBy.push(et),_+=et+", ";_+="; "}_+=". ",p.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let z of Array.from(p.defs.symbolsHavingReassignments))c.affectedBy.indexOf(z)===-1&&(c.affectedBy.push(z),_+=z+", ");_+=". ",p.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let z of Array.from(p.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(z)===-1&&(c.affectedBy.push(z),_+=z+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),p.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),p.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let R=["",""],T="",k="";if(p.defs.errorMessage===""&&!t){try{i="",s="",R=_E(e,!0),i="",s=""}catch(z){let Ae=z;p.PRINTOUTRESULT&&console.log(Ae),p.defs.errorMessage=Ae.toString(),(0,bf.init)()}if(p.defs.errorMessage==="")for(let z in p.defs.symbolsDependencies){p.defs.codeGen=!0,p.DEBUG&&console.log("  variable "+z+" is: "+(0,yt.get_binding)((0,yt.usr_symbol)(z)).toString()),p.defs.codeGen=!1,p.DEBUG&&console.log(`  variable ${z} depends on: `),_+=" variable "+z+" depends on: ";var V=[];let Ae=[],et=[];mE(z,V,[],Ae,[],et);for(let Oe of Array.from(Ae))p.DEBUG&&console.log(`    --> cycle through ${Oe}`);for(let Oe of Array.from(V))p.DEBUG&&console.log(`    ${Oe}`),_+=Oe+", ";_+="; ";for(let Oe of Array.from(et))_+=" "+Oe+", ";p.DEBUG&&console.log(`  code generation:${z} is: ${(0,yt.get_binding)((0,yt.usr_symbol)(z))}`);let Ve=(0,yt.get_binding)((0,yt.usr_symbol)(z)),De=[],it=[];for(let Oe of Array.from(V))if(Oe[0]==="'"){let st=Oe.substring(1),or=(0,yt.usr_symbol)(st),Bt=(0,yt.usr_symbol)("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+st);De.push(or),it.push(Bt),Ve=(0,_f.subst)(Ve,or,Bt),p.DEBUG&&console.log(`after substitution: ${Ve}`)}try{Ve=(0,UD.simplifyForCodeGeneration)(Ve)}catch(Oe){p.PRINTOUTRESULT&&console.log(Oe),p.defs.errorMessage=Oe+"",(0,bf.init)()}for(let Oe=0;Oe<De.length;Oe++)Ve=(0,_f.subst)(Ve,it[Oe],De[Oe]);if((0,yt.clearRenamedVariablesToAvoidBindingToExternalScope)(),p.defs.errorMessage===""){let Oe=Ve,st=[];(0,yt.collectUserSymbols)(Oe,st),i="",s="",p.defs.codeGen=!0;let or=Oe.toString();p.defs.codeGen=!1;let Bt=p.defs.printMode;p.defs.printMode=p.PRINTMODE_LATEX;let vr=Oe.toString();if(p.defs.printMode=Bt,Ae.indexOf(z)!==-1)T+="// "+z+" is part of a cyclic dependency, no code generated.",k+="#"+z+" is part of a cyclic dependency, no code generated.";else if(st=st.filter(Nt=>p.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(Nt+"")===-1),st=st.filter(Nt=>V.indexOf(Nt+"")!==-1||V.indexOf("'"+Nt)!==-1),st.length!==0){let Nt="(";for(let ci of Array.from(st))ci.printname!==z&&(Nt+=ci.printname+", ");Nt=Nt.replace(/, $/gm,""),Nt+=")",T+=z+" = function "+Nt+" { return ( "+or+" ); }",k+=z+Nt+" = "+vr}else T+=z+" = "+or+";",k+=z+" = "+vr;T+=`
`,k+=`
`,p.DEBUG&&console.log(`    ${T}`)}}}return T=T.replace(/\n$/gm,""),k=k.replace(/\n$/gm,""),p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.patternHasBeenFound=!1,p.defs.symbolsInExpressionsWithoutAssignments=[],p.DEBUG&&console.log(`testable string: ${_}`),gf&&console.log(`findDependenciesInScript time for: ${d} : ${new Date().getTime()-r}ms`),[_,R[0],T,k,R[1],p.defs.errorMessage,c]}rr.findDependenciesInScript=w_;function mE(e,t,r,n,o,i){if(r.push(e),p.defs.symbolsDependencies[o[o.length-1]]!=null&&p.defs.symbolsDependencies[o[o.length-1]].indexOf("'"+e)!==-1){p.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(o.push(e),p.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let s of Array.from(p.defs.symbolsDependencies[e]))if(o.indexOf(s)!==-1){p.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(o))n.indexOf(c)===-1&&n.push(c),p.DEBUG&&console.log(c+" --> "),u+=c+" --> ";p.DEBUG&&console.log(` ... then ${s} again`),u+=" ... then "+s+" again",i.push(u),n.indexOf(s)===-1&&n.push(s)}else mE(s,t,r,n,o,i),o.pop()}var BD="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function R_(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(p.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(p.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+BD+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function L_(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(p.dotprod_unicode)),e}var gf=!1;function _E(e,t=!1){let r,n,o,i=new Date().getTime();e=L_(e),p.defs.inited||(p.defs.inited=!0,(0,bf.init)());let s=0,u=0,c="",d="",_,R;for(;;){try{p.defs.errorMessage="",Va(),[s,r]=(0,dE.scan)(e.substring(u)),Va()}catch(k){p.PRINTOUTRESULT&&console.log(k),c+=k.message,t&&(d+=R_(k.message)),(0,p.reset_after_error)();break}if(s===0)break;u+=s;let T=!1;try{p.defs.stringsEmittedByUserPrintouts="",n=bE(r),Va(),(0,p.isstr)(n)&&(p.DEBUG&&console.log(n.str),p.DEBUG&&console.log(`
`)),n===(0,yt.symbol)(p.NIL)?(R=p.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+p.defs.stringsEmittedByUserPrintouts+"$$")):(R=(0,cE.print_expr)(n),R+=`
`,t&&(_="$$"+(0,cE.collectLatexStringFromReturnValue)(n)+"$$",p.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=R,t&&(d+=_),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("printline"),p.DEBUG&&console.log(R)),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("display:"),(0,$D.print2dascii)(n)),t&&(d+=`
`)}catch(k){T=!0,R=k.message,t&&(_=R_(k.message)),p.PRINTOUTRESULT&&console.log(R),c+=R,R!==""&&(c+=`
`),t&&(d+=_,d+=`
`),(0,bf.init)()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&d[d.length-1]===`
`&&(d=d.substring(0,d.length-1)),t?(p.DEBUG&&console.log(`allReturnedLatexStrings: ${d}`),o=[c,d]):o=c,gf){let T="run time on: "+e+" : "+(new Date().getTime()-i)+"ms";console.log(T)}return c="",d="",o}rr.run=_E;function Va(){p.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(p.breakpoint,du("symbols evaluation still ongoing?")),p.defs.evaluatingAsFloats&&(p.breakpoint,du("numeric evaluation still ongoing?")),p.defs.evaluatingPolar&&(p.breakpoint,du("evaluation of polar still ongoing?"))}rr.check_stack=Va;function bE(e){p.DEBUG&&console.log("#### top level eval"),p.defs.trigmode=0;let t=(0,yt.symbol)(p.AUTOEXPAND);p.defs.expanding=!(0,fu.isZeroAtomOrTensor)((0,yt.get_binding)(t));let r=e,n=(0,kD.Eval)(e);return n===(0,yt.symbol)(p.NIL)||((0,yt.set_binding)((0,yt.symbol)(p.LAST),n),(0,fu.isZeroAtomOrTensor)((0,yt.get_binding)((0,yt.symbol)(p.BAKE)))||(n=(0,DD.bake)(n)),(r===(0,yt.symbol)(p.SYMBOL_I)||r===(0,yt.symbol)(p.SYMBOL_J))&&(0,fu.isimaginaryunit)(n))?n:(0,fu.isimaginaryunit)((0,yt.get_binding)((0,yt.symbol)(p.SYMBOL_J)))?(0,_f.subst)(n,p.Constants.imaginaryunit,(0,yt.symbol)(p.SYMBOL_J)):(0,fu.isimaginaryunit)((0,yt.get_binding)((0,yt.symbol)(p.SYMBOL_I)))?(0,_f.subst)(n,p.Constants.imaginaryunit,(0,yt.symbol)(p.SYMBOL_I)):n}rr.top_level_eval=bE;function GD(){p.defs.esc_flag&&du("esc key")}rr.check_esc_flag=GD;function FD(e){let t,r;p.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,o=!0;if(p.defs.called_from_Algebra_block=!0,e=L_(e),!o){p.defs.userSimplificationsInListForm=[];let i="";for(let s of Array.from(p.defs.userSimplificationsInListForm))i+="silentpattern("+(0,p.car)(s)+","+(0,p.car)((0,p.cdr)(s))+","+(0,p.car)((0,p.cdr)((0,p.cdr)(s)))+`)
`;(0,fE.do_clearall)(),e=i+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(p.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let i of Array.from(p.defs.userSimplificationsInListForm))console.log((0,p.car)(i)+","+(0,p.cdr)(i)+")");console.log("...end of list --------------- ")}return p.defs.called_from_Algebra_block=!1,w_(e,!0)[6]}rr.computeDependenciesFromAlgebra=FD;function jD(e){let t,r,n,o,i,s,u,c,d,_=e,R=!0;p.defs.called_from_Algebra_block=!0;let T=new Date().getTime();gf&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=L_(e);let k=e;if(p.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(i of Array.from(p.defs.userSimplificationsInListForm))console.log((0,p.car)(i)+","+(0,p.cdr)(i)+")");console.log("...end of list --------------- ")}if(!R){p.defs.userSimplificationsInListForm=[];let V="";for(i of Array.from(p.defs.userSimplificationsInListForm))V+="silentpattern("+(0,p.car)(i)+","+(0,p.car)((0,p.cdr)(i))+","+(0,p.car)((0,p.cdr)((0,p.cdr)(i)))+`)
`;(0,fE.do_clearall)(),e=V+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[d,c,n,u,s,p.defs.errorMessage,o]=w_(e),p.defs.called_from_Algebra_block=!1,(u!==""||p.defs.errorMessage!=="")&&(c+=`
`+u,p.defs.errorMessage!==""&&(c+=`
`+p.defs.errorMessage),c=c.replace(/\n/g,`

`),s+=`
$$`+u+"$$",p.defs.errorMessage!==""&&(s+=R_(p.defs.errorMessage)),s=s.replace(/\n/g,`

`)),s=s.replace(/\n*/,""),s=s.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),gf&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+k+" : "+(new Date().getTime()-T)+"ms"),{code:n,result:s,latexResult:s,dependencyInfo:o}}rr.computeResultsAndJavaScriptFromAlgebra=jD});var qt=A(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.copy_tensor=vt.power_tensor=vt.compare_tensors=vt.d_tensor_scalar=vt.d_scalar_tensor=vt.d_tensor_tensor=vt.is_square_matrix=vt.check_tensor_dimensions=vt.scalar_times_tensor=vt.tensor_times_scalar=vt.tensor_plus_tensor=vt.Eval_tensor=void 0;var zn=It(),dr=N(),C_=Ee(),mu=U(),gE=Ne(),zD=ue(),YD=F(),D_=Ri(),VD=G(),ZD=Go(),XD=Il(),HD=H(),P_=K(),yE=Z();function QD(e){jn(e);let{nelem:t,ndim:r}=e.tensor,n=(0,zn.alloc_tensor)(t);return n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),jn(n),n.tensor.elem=e.tensor.elem.map(VD.Eval),jn(e),jn(n),ak(n)}vt.Eval_tensor=QD;function WD(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,d)=>c!==t.tensor.dim[d]))return(0,mu.symbol)(dr.NIL);let{nelem:r,ndim:n}=e.tensor,o=(0,zn.alloc_tensor)(r);o.tensor.ndim=n,o.tensor.dim=Array.from(e.tensor.dim);let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<r;c++)u[c]=(0,zD.add)(i[c],s[c]);return o}vt.tensor_plus_tensor=WD;function JD(e,t){let{ndim:r,nelem:n}=e.tensor,o=(0,zn.alloc_tensor)(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(e.tensor.dim),o.tensor.elem=e.tensor.elem.map(i=>(0,yE.multiply)(i,t)),o}vt.tensor_times_scalar=JD;function KD(e,t){let{ndim:r,nelem:n}=t.tensor,o=(0,zn.alloc_tensor)(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(i=>(0,yE.multiply)(e,i)),o}vt.scalar_times_tensor=KD;function jn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),dr.breakpoint}vt.check_tensor_dimensions=jn;function ek(e){return(0,dr.istensor)(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}vt.is_square_matrix=ek;function tk(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=dr.MAXDIM)return(0,P_.makeList)((0,mu.symbol)(dr.DERIVATIVE),e,t);let o=(0,zn.alloc_tensor)(n*t.tensor.nelem);o.tensor.ndim=r+1,o.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<n;c++)for(let d=0;d<t.tensor.nelem;d++)u[c*t.tensor.nelem+d]=(0,D_.derivative)(i[c],s[d]);return o}vt.d_tensor_tensor=tk;function rk(e,t){let r=(0,zn.alloc_tensor)(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>(0,D_.derivative)(e,n)),r}vt.d_scalar_tensor=rk;function nk(e,t){let r=(0,zn.alloc_tensor)(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>(0,D_.derivative)(n,t)),r}vt.d_tensor_scalar=nk;function ok(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!(0,gE.equal)(e.tensor.elem[r],t.tensor.elem[r]))return(0,gE.lessp)(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}vt.compare_tensors=ok;function ik(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return(0,P_.makeList)((0,mu.symbol)(dr.POWER),e,t);let n=(0,YD.nativeInt)(t);if(isNaN(n))return(0,P_.makeList)((0,mu.symbol)(dr.POWER),e,t);if(n===0){e.tensor.ndim!==2&&(0,C_.stop)("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=(0,zn.alloc_tensor)(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let s=0;s<n;s++)e.tensor.elem[n*s+s]=dr.Constants.one;return jn(e),e}let o=e;n<0&&(n=-n,o=(0,XD.inv)(o));let i=o;for(let s=1;s<n&&(i=(0,ZD.inner)(i,o),!(0,HD.isZeroAtomOrTensor)(i));s++);return i}vt.power_tensor=ik;function sk(e){let t=(0,zn.alloc_tensor)(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],jn(e),jn(t),t}vt.copy_tensor=sk;function ak(e){if(!(0,dr.istensor)(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(i=>!lk(t,i))&&(0,C_.stop)("Cannot promote tensor due to inconsistent tensor components."),!(0,dr.istensor)(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>dr.MAXDIM&&(0,C_.stop)("tensor rank > "+dr.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,o=(0,zn.alloc_tensor)(n);return o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim],o.tensor.elem=[].concat(...e.tensor.elem.map(i=>i.tensor.elem)),jn(t),jn(o),o}function lk(e,t){if(!(0,dr.istensor)(e)&&!(0,dr.istensor)(t))return!0;if(!(0,dr.istensor)(e)||!(0,dr.istensor)(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var It=A(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.alloc_tensor=void 0;var uk=qt(),vE=N();function ck(e){let t=new vE.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=vE.Constants.zero;return(0,uk.check_tensor_dimensions)(t),t}yf.alloc_tensor=ck});var Ne=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.sort=wt.square=wt.exponential=wt.yyexpand=wt.length=wt.cmp_expr=wt.sign=wt.lessp=wt.equal=wt.zero_matrix=void 0;var fk=It(),lt=N(),qE=lo(),_u=U(),EE=F(),dk=G(),xE=Et(),mk=qt();function _k(e,t){let r=(0,fk.alloc_tensor)(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}wt.zero_matrix=_k;function bk(e,t){return bu(e,t)===0}wt.equal=bk;function gk(e,t){return bu(e,t)<0}wt.lessp=gk;function vf(e){return e<0?-1:e>0?1:0}wt.sign=vf;function bu(e,t){let r=0;if(e===t)return 0;if(e===(0,_u.symbol)(lt.NIL))return-1;if(t===(0,_u.symbol)(lt.NIL))return 1;if((0,lt.isNumericAtom)(e)&&(0,lt.isNumericAtom)(t))return vf((0,EE.compare_numbers)(e,t));if((0,lt.isNumericAtom)(e))return-1;if((0,lt.isNumericAtom)(t))return 1;if((0,lt.isstr)(e)&&(0,lt.isstr)(t))return vf((0,qE.strcmp)(e.str,t.str));if((0,lt.isstr)(e))return-1;if((0,lt.isstr)(t))return 1;if((0,lt.issymbol)(e)&&(0,lt.issymbol)(t))return vf((0,qE.strcmp)((0,_u.get_printname)(e),(0,_u.get_printname)(t)));if((0,lt.issymbol)(e))return-1;if((0,lt.issymbol)(t))return 1;if((0,lt.istensor)(e)&&(0,lt.istensor)(t))return(0,mk.compare_tensors)(e,t);if((0,lt.istensor)(e))return-1;if((0,lt.istensor)(t))return 1;for(;(0,lt.iscons)(e)&&(0,lt.iscons)(t);){if(r=bu((0,lt.car)(e),(0,lt.car)(t)),r!==0)return r;e=(0,lt.cdr)(e),t=(0,lt.cdr)(t)}return(0,lt.iscons)(t)?-1:(0,lt.iscons)(e)?1:0}wt.cmp_expr=bu;function yk(e){return(0,lt.iscons)(e)?[...e].length:0}wt.length=yk;function vk(e){return(0,lt.doexpand)(dk.Eval,e)}wt.yyexpand=vk;function qk(e){return(0,xE.power)((0,_u.symbol)(lt.E),e)}wt.exponential=qk;function Ek(e){return(0,xE.power)(e,(0,EE.integer)(2))}wt.square=Ek;function xk(e){e.sort(bu)}wt.sort=xk});var Oc=A(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.countsize=li.countOccurrencesOfSymbol=li.count=void 0;var pk=Ne(),qf=N(),k_=e=>e.reduce((t,r)=>t+r,0);function Ef(e){let t;if((0,qf.iscons)(e)){let r=[...e];t=k_(r.map(Ef))+r.length}else t=1;return t}li.count=Ef;function pE(e,t){let r=0;return(0,qf.iscons)(t)?r=k_([...t].map(n=>pE(e,n))):(0,pk.equal)(e,t)&&(r=1),r}li.countOccurrencesOfSymbol=pE;function hk(e){let t=0;if((0,qf.istensor)(e))for(let r=0;r<e.tensor.nelem;r++)t+=Ef(e.tensor.elem[r]);else if((0,qf.iscons)(e)){let r=[...e];t=k_(r.map(Ef))+r.length}else t=1;return t}li.countsize=hk});var U=A(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.clear_symbol=ot.clearRenamedVariablesToAvoidBindingToExternalScope=ot.iskeyword=ot.symbol=ot.collectUserSymbols=ot.clear_symbols=ot.reset_symbols=ot.get_binding=ot.set_binding=ot.get_printname=ot.usr_symbol=ot.std_symbol=ot.inChildScope=ot.Eval_symbolsinfo=void 0;var Ak=Oc(),tn=N(),xf=Ee();function Ok(){let e=Mk();return e!==""?new tn.Str(e):hE(tn.NIL)}ot.Eval_symbolsinfo=Ok;function Mk(){return[...jr.symbolinfo()].join(`
`)}var ui=class{constructor(t){this.parent=t,this.symbols=new Map,this.bindings=new Map}getOrCreate(t){let r=this.getExisting(t);if(r)return r;let n=new tn.Sym(t);return this.symbols.set(t,n),n}getExisting(t){var r;return((r=this.parent)===null||r===void 0?void 0:r.getExisting(t))||this.symbols.get(t)}mustGet(t){var r;return this.symbols.get(t)||((r=this.parent)===null||r===void 0?void 0:r.mustGet(t))||(0,xf.stop)(`${t} not defined`)}has(t){return this.symbols.has(t.printname)}binding(t){var r;return this.bindings.get(t.printname)||((r=this.parent)===null||r===void 0?void 0:r.binding(t))||t}set(t,r){this.bindings.set(t.printname,r)}clear(){this.bindings.clear()}delete(t){var r;this.symbols.delete(t.printname),this.bindings.delete(t.printname),(r=this.parent)===null||r===void 0||r.delete(t)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[t,r]of this.symbols.entries()){let n=this.bindings.get(t)||r,o=(n+"").substring(0,4);yield`symbol: ${r} size: ${(0,Ak.countsize)(n)} value: ${o}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var t;for(let r of this.symbols.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(r);for(let r of this.bindings.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(r);(t=this.parent)===null||t===void 0||t.clearRenamedVariablesToAvoidBindingToExternalScope()}},es=new ui,jr=new ui(es);function Tk(e){let t=jr;try{return jr=new ui(jr),e()}finally{jr=t}}ot.inChildScope=Tk;function Nk(e,t){let r=es.getOrCreate(e);r.latexPrint=e,r.keyword=t}ot.std_symbol=Nk;function Ik(e){return jr.getOrCreate(e)}ot.usr_symbol=Ik;function Sk(e){return e.k!==tn.SYM&&(0,xf.stop)("symbol error"),e.printname}ot.get_printname=Sk;function Rk(e,t){e.k!==tn.SYM&&(0,xf.stop)("symbol error"),jr.set(e,t)}ot.set_binding=Rk;function wk(e){return e.k!==tn.SYM&&(0,xf.stop)("symbol error"),jr.binding(e)}ot.get_binding=wk;function Lk(e){return e.k!==tn.SYM?!1:/^[abcdjnrstxyz]_?$/.test(e.printname)||!es.has(e)}function Ck(){es=new ui,jr=new ui(es)}ot.reset_symbols=Ck;function Pk(){jr=new ui(es),es.clear()}ot.clear_symbols=Pk;function $_(e,t){if(t==null&&(t=[]),Lk(e)&&t.indexOf(e)===-1){t.push(e);return}if((0,tn.istensor)(e)){for(let r=0;r<e.tensor.nelem;r++)$_(e.tensor.elem[r],t);return}for(;(0,tn.iscons)(e);)$_((0,tn.car)(e),t),e=(0,tn.cdr)(e)}ot.collectUserSymbols=$_;function hE(e){return jr.mustGet(e)}ot.symbol=hE;function Dk(e){return(0,tn.issymbol)(e)&&e.keyword!=null}ot.iskeyword=Dk;function kk(){jr.clearRenamedVariablesToAvoidBindingToExternalScope()}ot.clearRenamedVariablesToAvoidBindingToExternalScope=kk;function $k(e){jr.delete(e)}ot.clear_symbol=$k});var eo=A(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.print_list=At.print_expr=At.printline=At.collectLatexStringFromReturnValue=At.print_str=At.Eval_printlist=At.Eval_printhuman=At.Eval_printlatex=At.Eval_printcomputer=At.Eval_print2dascii=At.Eval_print=void 0;var l=N(),ie=U(),ts=Ne(),Uk=on(),Af=F(),Bk=Mn(),Gk=G(),ht=H(),OE=Z(),Fk=oo(),jk=S_(),zk=Yo(),Yk="^";function Vk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa((0,l.cdr)(e),l.defs.printMode),(0,ie.symbol)(l.NIL)}At.Eval_print=Vk;function Zk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa((0,l.cdr)(e),l.PRINTMODE_2DASCII),(0,ie.symbol)(l.NIL)}At.Eval_print2dascii=Zk;function Xk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa((0,l.cdr)(e),l.PRINTMODE_COMPUTER),(0,ie.symbol)(l.NIL)}At.Eval_printcomputer=Xk;function Hk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa((0,l.cdr)(e),l.PRINTMODE_LATEX),(0,ie.symbol)(l.NIL)}At.Eval_printlatex=Hk;function Qk(e){let t=l.defs.test_flag;return l.defs.test_flag=!1,l.defs.stringsEmittedByUserPrintouts+=Xa((0,l.cdr)(e),l.PRINTMODE_HUMAN),l.defs.test_flag=t,(0,ie.symbol)(l.NIL)}At.Eval_printhuman=Qk;function Wk(e){let t=Xa((0,l.cdr)(e),l.PRINTMODE_LIST);return l.defs.stringsEmittedByUserPrintouts+=t,(0,ie.symbol)(l.NIL)}At.Eval_printlist=Wk;function Xa(e,t){let r="";for(;(0,l.iscons)(e);){let n=(0,Gk.Eval)((0,l.car)(e)),o=l.defs.printMode;t===l.PRINTMODE_COMPUTER?(l.defs.printMode=l.PRINTMODE_COMPUTER,r=pf(n),gu(r,l.LAST_FULL_PRINT)):t===l.PRINTMODE_HUMAN?(l.defs.printMode=l.PRINTMODE_HUMAN,r=pf(n),gu(r,l.LAST_PLAIN_PRINT)):t===l.PRINTMODE_2DASCII?(l.defs.printMode=l.PRINTMODE_2DASCII,r=(0,jk.print2dascii)(n),gu(r,l.LAST_2DASCII_PRINT)):t===l.PRINTMODE_LATEX?(l.defs.printMode=l.PRINTMODE_LATEX,r=pf(n),gu(r,l.LAST_LATEX_PRINT)):t===l.PRINTMODE_LIST&&(l.defs.printMode=l.PRINTMODE_LIST,r=Za(n),gu(r,l.LAST_LIST_PRINT)),l.defs.printMode=o,e=(0,l.cdr)(e)}return l.DEBUG&&console.log(`emttedString from display: ${l.defs.stringsEmittedByUserPrintouts}`),r}function gu(e,t){let[,r]=(0,zk.scan)('"'+e+'"');(0,ie.set_binding)((0,ie.symbol)(t),r)}function S(e){return l.DEBUG&&console.log(`emttedString from print_str: ${l.defs.stringsEmittedByUserPrintouts}`),e}At.print_str=S;function Jk(e){let t=l.defs.printMode;l.defs.printMode=l.PRINTMODE_LATEX;let r=l.defs.codeGen;l.defs.codeGen=!1;let n=C(e);return n=n.replace(/_/g,"\\_"),l.defs.printMode=t,l.defs.codeGen=r,l.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${l.defs.stringsEmittedByUserPrintouts}`),n}At.collectLatexStringFromReturnValue=Jk;function pf(e){let t="";return t+=C(e),t}At.printline=pf;function ME(e){let t="";return(0,ht.isfraction)(e)||(0,l.isadd)(e)||(0,l.ismultiply)(e)||(0,l.ispower)(e)||(0,ts.lessp)(e,l.Constants.zero)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function AE(e){let t="";return(0,ht.isfraction)(e)||(0,l.isadd)(e)||(0,l.ismultiply)(e)||(0,l.ispower)(e)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function Kk(e,t){let r="",n=(0,l.cadr)(e),o=(0,l.caddr)(e);return(0,ht.isminusone)(o)?(r+=ME(n),r):(t===1&&(r+="("),o=(0,OE.negate)(o),r+=vu(n,o),t===1&&(r+=")"),r)}function e$(e){let t,r,n="",o=0,i=0,s=0,u=(0,l.cdr)(e),c=(0,l.car)(u);for((0,l.isrational)(c)?(t=(0,Uk.absval)((0,Af.mp_numerator)(c)),r=(0,Af.mp_denominator)(c),(0,ht.isplusone)(t)||i++,(0,ht.isplusone)(r)||s++,u=(0,l.cdr)(u)):(t=l.Constants.one,r=l.Constants.one);(0,l.iscons)(u);)c=(0,l.car)(u),hf(c)?s++:i++,u=(0,l.cdr)(u);if(l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("\\frac{")),i===0)n+="1";else for(o=0,u=(0,l.cdr)(e),(0,l.isrational)((0,l.car)(u))&&(u=(0,l.cdr)(u)),(0,ht.isplusone)(t)||(n+=En(t),o=1);(0,l.iscons)(u);)c=(0,l.car)(u),hf(c)||(o&&(n+=B_()),n+=En(c),o=1),u=(0,l.cdr)(u);for(l.defs.printMode===l.PRINTMODE_LATEX?n+=S("}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" / "):n+=S("/"),s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+="("),o=0,u=(0,l.cdr)(e),(0,l.isrational)((0,l.car)(u))&&(u=(0,l.cdr)(u)),(0,ht.isplusone)(r)||(n+=En(r),o=1);(0,l.iscons)(u);)c=(0,l.car)(u),hf(c)&&(o&&(n+=B_()),n+=Kk(c,s),o=1),u=(0,l.cdr)(u);return s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=")"),l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("}")),n}function C(e){let t="";if((0,l.isadd)(e))for(e=(0,l.cdr)(e),yu((0,l.car)(e))==="-"&&(t+=S("-")),t+=U_((0,l.car)(e)),e=(0,l.cdr)(e);(0,l.iscons)(e);)yu((0,l.car)(e))==="+"?l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" + "):t+=S("+"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" - "):t+=S("-"),t+=U_((0,l.car)(e)),e=(0,l.cdr)(e);else yu(e)==="-"&&(t+=S("-")),t+=U_(e);return t}At.print_expr=C;function yu(e){let t="";return(0,l.ismultiply)(e)&&(0,l.isNumericAtom)((0,l.cadr)(e))&&(0,ts.lessp)((0,l.cadr)(e),l.Constants.zero)||(0,l.isNumericAtom)(e)&&(0,ts.lessp)(e,l.Constants.zero)?t+="-":t+="+",t}function U_(e){let t="";if((0,l.ismultiply)(e)&&D$(e))return t+=e$(e),t;if((0,l.ismultiply)(e)){let r,n;e=(0,l.cdr)(e),(0,ht.isminusone)((0,l.car)(e))&&(e=(0,l.cdr)(e));let o=!1;(0,l.isNumericAtom)((0,l.car)(e))&&(o=!0);let i=!1;for(l.defs.printMode===l.PRINTMODE_LATEX&&(0,l.iscons)((0,l.cdr)(e))&&(0,ht.isNumberOneOverSomething)((0,l.car)(e))&&(i=!0,r=(0,l.car)(e).q.b.toString()),i?(n=t,t=""):t+=En((0,l.car)(e)),e=(0,l.cdr)(e);(0,l.iscons)(e);)l.defs.printMode===l.PRINTMODE_LATEX&&o&&(0,l.caar)(e)===(0,ie.symbol)(l.POWER)&&(0,l.isNumericAtom)((0,l.car)((0,l.cdr)((0,l.car)(e))))&&((0,ht.isfraction)((0,l.car)((0,l.cdr)((0,l.cdr)((0,l.car)(e)))))||(t+=" \\cdot ")),t+=B_(),t+=En((0,l.car)(e),!1,!0),o=!1,(0,l.isNumericAtom)((0,l.car)(e))&&(o=!0),e=(0,l.cdr)(e);i&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=En(e);return t}function TE(e){let t="";return t+="(",t+=C(e),t+=")",t}function t$(e){let t="";return e=(0,l.cadr)(e),(0,ht.isfraction)(e)||(0,l.isadd)(e)||(0,l.ismultiply)(e)||(0,l.ispower)(e)||(0,l.isfactorial)(e)?t+=TE(e):t+=C(e),t+="!",t}function r$(e){let t="";return t+=S("\\left |"),t+=C((0,l.cadr)(e)),t+=S(" \\right |"),t}function n$(e){let t="";return t+=S("\\binom{"),t+=C((0,l.cadr)(e)),t+=S("}{"),t+=C((0,l.caddr)(e)),t+=S("} "),t}function o$(e){let t="";return t+=C((0,l.cadr)(e)),t+=S(" \\cdot "),t+=C((0,l.caddr)(e)),t}function i$(e){let t="dot(";return t+=C((0,l.cadr)(e)),t+=", ",t+=C((0,l.caddr)(e)),t+=")",t}function s$(e){let t="Math.sin(";return t+=C((0,l.cadr)(e)),t+=")",t}function a$(e){let t="Math.cos(";return t+=C((0,l.cadr)(e)),t+=")",t}function l$(e){let t="Math.tan(";return t+=C((0,l.cadr)(e)),t+=")",t}function u$(e){let t="Math.asin(";return t+=C((0,l.cadr)(e)),t+=")",t}function c$(e){let t="Math.acos(";return t+=C((0,l.cadr)(e)),t+=")",t}function f$(e){let t="Math.atan(";return t+=C((0,l.cadr)(e)),t+=")",t}function d$(e){let t="";return t+=S("\\sqrt{"),t+=C((0,l.cadr)(e)),t+=S("} "),t}function m$(e){let t="";return t+=S("{"),(0,l.iscons)((0,l.cadr)(e))&&(t+=S("(")),t+=C((0,l.cadr)(e)),(0,l.iscons)((0,l.cadr)(e))&&(t+=S(")")),t+=S("}"),t+=S("^T"),t}function _$(e){let t="";return t+=S("transpose("),t+=C((0,l.cadr)(e)),t+=S(")"),t}function b$(e){let t="";return t+=S("identity("),t+=C((0,l.cadr)(e)),t+=S(")"),t}function g$(e){let t="";return t+=S("{"),(0,l.iscons)((0,l.cadr)(e))&&(t+=S("(")),t+=C((0,l.cadr)(e)),(0,l.iscons)((0,l.cadr)(e))&&(t+=S(")")),t+=S("}"),t+=S("^{-1}"),t}function y$(e){let t="";return t+=S("inv("),t+=C((0,l.cadr)(e)),t+=S(")"),t}function v$(e){let t="",r=(0,l.car)((0,l.cdr)(e));e=(0,l.cdr)(e);let n=e,o=0;for(;(0,l.iscons)((0,l.cdr)((0,l.cdr)(e)));){o++;let i=(0,l.cdr)((0,l.cdr)(e));t+=S("\\int^{"),t+=C((0,l.car)((0,l.cdr)(i))),t+=S("}_{"),t+=C((0,l.car)(i)),t+=S("} \\! "),e=(0,l.cdr)(i)}t+=C(r),t+=S(" \\,"),e=n;for(let i=1;i<=o;i++){let s=(0,l.cdr)(e);t+=S(" \\mathrm{d} "),t+=C((0,l.car)(s)),i<o&&(t+=S(" \\, ")),e=(0,l.cdr)((0,l.cdr)(s))}return t}function q$(e){let t="";return t+=NE(e,0,0)[1],t}function NE(e,t,r){let n="";if(n+=S("["),t<e.tensor.ndim-1)for(let o=0;o<e.tensor.dim[t];o++){let i;[r,i]=Array.from(NE(e,t+1,r)),n+=i,o!==e.tensor.dim[t]-1&&(n+=S(","))}else for(let o=0;o<e.tensor.dim[t];o++)n+=C(e.tensor.elem[r]),o!==e.tensor.dim[t]-1&&(n+=S(",")),r++;return n+=S("]"),[r,n]}function E$(e){let t="";return e.tensor.ndim<=2&&(t+=IE(!0,e,0,0)[1]),t}function IE(e,t,r,n){let o="";if(e&&(o+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let i=0;i<t.tensor.dim[r];i++){let s;[n,s]=Array.from(IE(!1,t,r+1,n)),o+=s,i!==t.tensor.dim[r]-1&&(o+=S(" \\\\ "))}else for(let i=0;i<t.tensor.dim[r];i++)o+=C(t.tensor.elem[n]),i!==t.tensor.dim[r]-1&&(o+=S(" & ")),n++;return e&&(o+=" \\end{bmatrix}"),[n,o]}function x$(e){let t="\\sum_{";return t+=C((0,l.caddr)(e)),t+="=",t+=C((0,l.cadddr)(e)),t+="}^{",t+=C((0,l.caddddr)(e)),t+="}{",t+=C((0,l.cadr)(e)),t+="}",t}function p$(e){let t=(0,l.cadr)(e),r=(0,l.caddr)(e),n=(0,l.cadddr)(e),o=(0,l.caddddr)(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+C(t)+"; }  return holderSum;})()"}function h$(e){let t="\\left\\{ \\begin{array}{ll}";for(e=(0,l.cdr)(e);(0,l.iscons)(e);){if((0,l.cdr)(e)===(0,ie.symbol)(l.NIL)){t+="{",t+=C((0,l.car)(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=C((0,l.cadr)(e)),t+="} & if & ",t+=C((0,l.car)(e)),t+=" \\\\\\\\",e=(0,l.cddr)(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function A$(e){let t="(function(){";e=(0,l.cdr)(e);let r=0;for(;(0,l.iscons)(e);){if((0,l.cdr)(e)===(0,ie.symbol)(l.NIL)){t+="else {",t+="return ("+C((0,l.car)(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+C((0,l.car)(e))+"){",t+="return ("+C((0,l.cadr)(e))+");",t+="}",r++,e=(0,l.cddr)(e)}return t+="})()",t}function O$(e){let t="{";return t+=C((0,l.cadr)(e)),t+="}",t+=" < ",t+="{",t+=C((0,l.caddr)(e)),t+="}"}function M$(e){let t="{";return t+=C((0,l.cadr)(e)),t+="}",t+=" \\leq ",t+="{",t+=C((0,l.caddr)(e)),t+="}"}function T$(e){let t="{";return t+=C((0,l.cadr)(e)),t+="}",t+=" > ",t+="{",t+=C((0,l.caddr)(e)),t+="}"}function N$(e){let t="{";return t+=C((0,l.cadr)(e)),t+="}",t+=" \\geq ",t+="{",t+=C((0,l.caddr)(e)),t+="}"}function I$(e){let t="{";return t+=C((0,l.cadr)(e)),t+="}",t+=" = ",t+="{",t+=C((0,l.caddr)(e)),t+="}"}function S$(e){let t=(0,l.cadr)(e),r=(0,l.caddr)(e),n=(0,l.cadddr)(e),o=(0,l.caddddr)(e);return"(function(){ var "+r+";  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+C(t)+" } })()"}function R$(e){let t="";for(e=(0,l.cdr)(e);(0,l.iscons)(e);)t+=C((0,l.car)(e)),e=(0,l.cdr)(e);return t}function w$(e){let t="";return t+=C((0,l.cadr)(e)),t+=" = ",t+=C((0,l.caddr)(e)),t+="; ",t}function L$(e){let t="\\prod_{";return t+=C((0,l.caddr)(e)),t+="=",t+=C((0,l.cadddr)(e)),t+="}^{",t+=C((0,l.caddddr)(e)),t+="}{",t+=C((0,l.cadr)(e)),t+="}",t}function C$(e){let t=(0,l.cadr)(e),r=(0,l.caddr)(e),n=(0,l.cadddr)(e),o=(0,l.caddddr)(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+C(t)+"; }  return holderProduct;})()"}function vu(e,t){let r="";if(l.DEBUG&&console.log("power base: "+e+"  exponent: "+t),(0,ht.isoneovertwo)(t))if((0,ht.equaln)(e,2)){if(l.defs.codeGen)return r+=S("Math.SQRT2"),r}else{if(l.defs.printMode===l.PRINTMODE_LATEX)return r+=S("\\sqrt{"),r+=C(e),r+=S("}"),r;if(l.defs.codeGen)return r+=S("Math.sqrt("),r+=C(e),r+=S(")"),r}if((0,ht.equaln)((0,ie.get_binding)((0,ie.symbol)(l.PRINT_LEAVE_E_ALONE)),1)&&e===(0,ie.symbol)(l.E))return l.defs.codeGen?(r+=S("Math.exp("),r+=AE(t),r+=S(")"),r):(l.defs.printMode===l.PRINTMODE_LATEX?(r+=S("e^{"),r+=C(t),r+=S("}")):(r+=S("exp("),r+=C(t),r+=S(")")),r);if(l.defs.codeGen)return r+=S("Math.pow("),r+=ME(e),r+=S(", "),r+=AE(t),r+=S(")"),r;if((0,ht.equaln)((0,ie.get_binding)((0,ie.symbol)(l.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==(0,ie.symbol)(l.E)){if((0,ht.isminusone)(t))return l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/"),(0,l.iscons)(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=C(e),r+=S(")")):r+=C(e),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r;if((0,ht.isnegativeterm)(t)){l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/");let n=(0,OE.multiply)(t,l.Constants.negOne);return(0,l.iscons)(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=vu(e,n),r+=S(")")):r+=vu(e,n),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r}}if((0,ht.isfraction)(t)&&l.defs.printMode===l.PRINTMODE_LATEX){r+=S("\\sqrt");let n=(0,Bk.denominator)(t);return(0,ht.isplustwo)(n)||(r+=S("["),r+=C(n),r+=S("]")),r+=S("{"),t=(0,Fk.numerator)(t),r+=vu(e,t),r+=S("}"),r}}return l.defs.printMode===l.PRINTMODE_LATEX&&(0,ht.isplusone)(t)?r+=C(e):((0,l.isadd)(e)||(0,ht.isnegativenumber)(e)?(r+=S("("),r+=C(e),r+=S(")")):(0,l.ismultiply)(e)||(0,l.ispower)(e)?(l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S("(")),r+=En(e,!0),l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S(")"))):(0,l.isNumericAtom)(e)&&((0,ts.lessp)(e,l.Constants.zero)||(0,ht.isfraction)(e))?(r+=S("("),r+=En(e),r+=S(")")):r+=En(e),l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S(Yk):r+=S("^"),l.defs.printMode===l.PRINTMODE_LATEX?C(t).length>1?(r+=S("{"),r+=C(t),r+=S("}")):r+=C(t):(0,l.iscons)(t)||(0,ht.isfraction)(t)||(0,l.isNumericAtom)(t)&&(0,ts.lessp)(t,l.Constants.zero)?(r+=S("("),r+=C(t),r+=S(")")):r+=En(t)),r}function P$(e){let t="";if(e=(0,l.cdr)(e),(0,l.caar)(e)===(0,ie.symbol)(l.ADD)||(0,l.caar)(e)===(0,ie.symbol)(l.MULTIPLY)||(0,l.caar)(e)===(0,ie.symbol)(l.POWER)||(0,l.caar)(e)===(0,ie.symbol)(l.FACTORIAL)?t+=TE((0,l.car)(e)):t+=C((0,l.car)(e)),t+=S("["),e=(0,l.cdr)(e),(0,l.iscons)(e))for(t+=C((0,l.car)(e)),e=(0,l.cdr)(e);(0,l.iscons)(e);)t+=S(","),t+=C((0,l.car)(e)),e=(0,l.cdr)(e);return t+=S("]"),t}function En(e,t=!1,r=!1){let n="";if((0,l.isNumericAtom)(e))return r&&(0,ts.lessp)(e,l.Constants.zero)&&(n+="("),n+=(0,Af.print_number)(e,r),r&&(0,ts.lessp)(e,l.Constants.zero)&&(n+=")"),n;if((0,l.isstr)(e))return n+=S('"'),n+=S(e.str),n+=S('"'),n;if((0,l.istensor)(e))return l.defs.printMode===l.PRINTMODE_LATEX?n+=E$(e):n+=q$(e),n;if((0,l.ismultiply)(e))return t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\left ("):n+=S("(")),n+=C(e),t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\right ) "):n+=S(")")),n;if((0,l.isadd)(e))return t||(n+=S("(")),n+=C(e),t||(n+=S(")")),n;if((0,l.ispower)(e)){let o=(0,l.cadr)(e),i=(0,l.caddr)(e);return n+=vu(o,i),n}if((0,l.car)(e)===(0,ie.symbol)(l.FUNCTION)){let o=(0,l.cadr)(e);if(!l.defs.codeGen){let i=(0,l.caddr)(e);n+=S("function "),l.DEBUG&&console.log(`emittedString from print_factor ${l.defs.stringsEmittedByUserPrintouts}`),n+=Za(i),n+=S(" -> ")}return n+=C(o),n}if((0,l.car)(e)===(0,ie.symbol)(l.PATTERN))return n+=C((0,l.caadr)(e)),l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\rightarrow "):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" -> "):n+=S("->"),n+=C((0,l.car)((0,l.cdr)((0,l.cadr)(e)))),n;if((0,l.car)(e)===(0,ie.symbol)(l.INDEX)&&(0,l.issymbol)((0,l.cadr)(e)))return n+=P$(e),n;if((0,l.isfactorial)(e))return n+=t$(e),n;if((0,l.car)(e)===(0,ie.symbol)(l.ABS)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=r$(e),n;if((0,l.car)(e)===(0,ie.symbol)(l.SQRT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=d$(e),n;if((0,l.isfactorial)(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=m$(e),n;if(l.defs.codeGen)return n+=_$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.UNIT)){if(l.defs.codeGen)return n+=b$(e),n}else if((0,l.isinv)(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=g$(e),n;if(l.defs.codeGen)return n+=y$(e),n}else{if((0,l.car)(e)===(0,ie.symbol)(l.BINOMIAL)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=n$(e),n;if((0,l.car)(e)===(0,ie.symbol)(l.DEFINT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=v$(e),n;if((0,l.isinnerordot)(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=o$(e),n;if(l.defs.codeGen)return n+=i$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.SIN)){if(l.defs.codeGen)return n+=s$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.COS)){if(l.defs.codeGen)return n+=a$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TAN)){if(l.defs.codeGen)return n+=l$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.ARCSIN)){if(l.defs.codeGen)return n+=u$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.ARCCOS)){if(l.defs.codeGen)return n+=c$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.ARCTAN)){if(l.defs.codeGen)return n+=f$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.SUM)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=x$(e),n;if(l.defs.codeGen)return n+=p$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.PRODUCT)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=L$(e),n;if(l.defs.codeGen)return n+=C$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.FOR)){if(l.defs.codeGen)return n+=S$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.DO)){if(l.defs.codeGen)return n+=R$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TEST)){if(l.defs.codeGen)return n+=A$(e),n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=h$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TESTLT)){if(l.defs.codeGen)return n+="(("+C((0,l.cadr)(e))+") < ("+C((0,l.caddr)(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=O$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TESTLE)){if(l.defs.codeGen)return n+="(("+C((0,l.cadr)(e))+") <= ("+C((0,l.caddr)(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=M$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TESTGT)){if(l.defs.codeGen)return n+="(("+C((0,l.cadr)(e))+") > ("+C((0,l.caddr)(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=T$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TESTGE)){if(l.defs.codeGen)return n+="(("+C((0,l.cadr)(e))+") >= ("+C((0,l.caddr)(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=N$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.TESTEQ)){if(l.defs.codeGen)return n+="(("+C((0,l.cadr)(e))+") === ("+C((0,l.caddr)(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=I$(e),n}else if((0,l.car)(e)===(0,ie.symbol)(l.FLOOR)){if(l.defs.codeGen)return n+="Math.floor("+C((0,l.cadr)(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lfloor {"+C((0,l.cadr)(e))+"} \\rfloor ",n}else if((0,l.car)(e)===(0,ie.symbol)(l.CEILING)){if(l.defs.codeGen)return n+="Math.ceiling("+C((0,l.cadr)(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lceil {"+C((0,l.cadr)(e))+"} \\rceil ",n}else if((0,l.car)(e)===(0,ie.symbol)(l.ROUND)){if(l.defs.codeGen)return n+="Math.round("+C((0,l.cadr)(e))+")",n}else if((0,l.car)(e)===(0,ie.symbol)(l.SETQ))return l.defs.codeGen?(n+=w$(e),n):(n+=C((0,l.cadr)(e)),n+=S("="),n+=C((0,l.caddr)(e)),n)}if((0,l.iscons)(e)){if(n+=En((0,l.car)(e)),e=(0,l.cdr)(e),t||(n+=S("(")),(0,l.iscons)(e))for(n+=C((0,l.car)(e)),e=(0,l.cdr)(e);(0,l.iscons)(e);)n+=S(","),n+=C((0,l.car)(e)),e=(0,l.cdr)(e);return t||(n+=S(")")),n}return e===(0,ie.symbol)(l.DERIVATIVE)?n+="d":e===(0,ie.symbol)(l.E)?l.defs.codeGen?n+=S("Math.E"):n+=S("e"):e===(0,ie.symbol)(l.PI)?l.defs.printMode===l.PRINTMODE_LATEX?n+=S("\\pi"):n+=S("pi"):n+=S((0,ie.get_printname)(e)),n}function Za(e){let t="";switch(e.k){case l.CONS:for(t+="(",t+=Za((0,l.car)(e)),e===(0,l.cdr)(e)&&(console.log("oh no recursive!"),l.breakpoint),e=(0,l.cdr)(e);(0,l.iscons)(e);)t+=" ",t+=Za((0,l.car)(e)),e=(0,l.cdr)(e),e===(0,l.cdr)(e)&&e!==(0,ie.symbol)(l.NIL)&&(console.log("oh no recursive!"),l.breakpoint);e!==(0,ie.symbol)(l.NIL)&&(t+=" . ",t+=Za(e)),t+=")";break;case l.STR:t+=e.str;break;case l.NUM:case l.DOUBLE:t+=(0,Af.print_number)(e,!0);break;case l.SYM:t+=(0,ie.get_printname)(e);break;default:t+="<tensor>"}return t}At.print_list=Za;function B_(){let e="";return l.defs.printMode===l.PRINTMODE_LATEX||(l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag&&!l.defs.codeGen?e+=S(" "):e+=S("*")),e}function hf(e){return(0,l.ispower)(e)&&(0,l.cadr)(e)!==(0,ie.symbol)(l.E)&&(0,ht.isnegativeterm)((0,l.caddr)(e))}function D$(e){for(e=(0,l.cdr)(e);(0,l.iscons)(e);){let t=(0,l.car)(e);if(hf(t))return!0;e=(0,l.cdr)(e)}return!1}});var N=A(a=>{"use strict";var k$=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});a.CLEARALL=a.CLEAR=a.CIRCEXP=a.CHOOSE=a.CHECK=a.CEILING=a.BINOMIAL=a.BINDING=a.BESSELY=a.BESSELJ=a.ATOMIZE=a.ARG=a.ARCTANH=a.ARCTAN=a.ARCSINH=a.ARCSIN=a.ARCCOSH=a.ARCCOS=a.APPROXRATIO=a.AND=a.ADJ=a.ADD=a.ABS=a.SYM=a.TENSOR=a.STR=a.DOUBLE=a.NUM=a.CONS=a.Sym=a.Tensor=a.Str=a.Double=a.Num=a.Cons=a.BaseAtom=a.avoidCalculatingPowersIntoArctans=a.do_simplify_nested_radicals=a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=a.defs=a.PRINTMODE_LIST=a.PRINTMODE_HUMAN=a.PRINTMODE_COMPUTER=a.PRINTMODE_2DASCII=a.PRINTMODE_LATEX=a.PRINTOUTRESULT=a.DEBUG=a.NSYM=a.version=a.breakpoint=void 0;a.INVG=a.INV=a.INTEGRAL=a.INNER=a.INDEX=a.IMAG=a.HILBERT=a.HERMITE=a.GCD=a.GAMMA=a.FUNCTION=a.FOR=a.FLOOR=a.FLOATF=a.FILTER=a.FACTORPOLY=a.FACTORIAL=a.FACTOR=a.EXPSIN=a.EXPCOS=a.EXPAND=a.EXP=a.EVAL=a.ERFC=a.ERF=a.EIGENVEC=a.EIGENVAL=a.EIGEN=a.DSOLVE=a.DRAW=a.DOT=a.DO=a.DIVISORS=a.DIRAC=a.DIM=a.DET=a.DERIVATIVE=a.DENOMINATOR=a.DEGREE=a.DEFINT=a.DECOMP=a.COSH=a.COS=a.CONTRACT=a.CONJ=a.CONDENSE=a.COFACTOR=a.COEFF=a.CLOCK=a.CLEARPATTERNS=void 0;a.SUM=a.SUBST=a.STOP=a.SQRT=a.SHAPE=a.SINH=a.SIN=a.SIMPLIFY=a.SILENTPATTERN=a.SGN=a.SETQ=a.ROOTS=a.YYRECT=a.ROUND=a.REAL=a.RATIONALIZE=a.RANK=a.QUOTIENT=a.QUOTE=a.PRODUCT=a.PRINTPLAIN=a.PRINTLIST=a.PRINTLATEX=a.PRINTFULL=a.PRINT2DASCII=a.PRINT=a.PRINT_LEAVE_X_ALONE=a.PRINT_LEAVE_E_ALONE=a.PRIME=a.POWER=a.POLAR=a.PATTERNSINFO=a.PATTERN=a.OUTER=a.OR=a.OPERATOR=a.NUMERATOR=a.NUMBER=a.NROOTS=a.NOT=a.MULTIPLY=a.MOD=a.LOOKUP=a.LOG=a.LEGENDRE=a.LEADING=a.LCM=a.LAGUERRE=a.ISPRIME=a.ISINTEGER=void 0;a.SYMBOL_A_UNDERSCORE=a.SYMBOL_IDENTITY_MATRIX=a.SYMBOL_Z=a.SYMBOL_Y=a.SYMBOL_X=a.SYMBOL_T=a.SYMBOL_S=a.SYMBOL_R=a.SYMBOL_N=a.SYMBOL_J=a.SYMBOL_I=a.SYMBOL_D=a.SYMBOL_C=a.SYMBOL_B=a.SYMBOL_A=a.PI=a.VERSION=a.SECRETX=a.METAX=a.METAB=a.METAA=a.DRAWX=a.YYE=a.MAX_FIXED_PRINTOUT_DIGITS=a.FORCE_FIXED_PRINTOUT=a.TRACE=a.ASSUME_REAL_VARIABLES=a.BAKE=a.AUTOEXPAND=a.LAST_PLAIN_PRINT=a.LAST_LIST_PRINT=a.LAST_LATEX_PRINT=a.LAST_FULL_PRINT=a.LAST_2DASCII_PRINT=a.LAST_PRINT=a.LAST=a.NIL=a.ZERO=a.UNIT=a.TRANSPOSE=a.TESTLT=a.TESTLE=a.TESTGT=a.TESTGE=a.TESTEQ=a.TEST=a.TAYLOR=a.TANH=a.TAN=a.SYMBOLSINFO=void 0;a.caddadr=a.cddaddr=a.cadaddr=a.caddddr=a.cddddr=a.cadddr=a.cdaddr=a.caddar=a.cadadr=a.caaddr=a.cdddr=a.cddar=a.cdadr=a.cadar=a.caddr=a.caadr=a.cddr=a.cdar=a.cadr=a.caar=a.cdr=a.car=a.issymbol=a.isNumericAtomOrTensor=a.istensor=a.isstr=a.isNumericAtom=a.isdouble=a.isrational=a.iscons=a.dotprod_unicode=a.transpose_unicode=a.logbuf=a.mtotal=a.primetab=a.parse_time_simplifications=a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=a.MAXDIM=a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=a.MAXPRIMETAB=a.E=a.C6=a.C5=a.C4=a.C3=a.C2=a.C1=a.SYMBOL_X_UNDERSCORE=a.SYMBOL_B_UNDERSCORE=void 0;a.evalFloats=a.evalPolar=a.doexpand=a.noexpand=a.Constants=a.$=a.reset_after_error=a.MEQUAL=a.MZERO=a.MSIGN=a.isidentitymatrix=a.isinv=a.istranspose=a.isinnerordot=a.isfactorial=a.ispower=a.ismultiply=a.isadd=a.caddaddr=a.cdddaddr=void 0;var Of=k$(To()),SE=eo(),zr=U();function RE(){}a.breakpoint=RE;a.version="2.0.1";a.NSYM=1e3;a.DEBUG=!1;a.PRINTOUTRESULT=!1;a.PRINTMODE_LATEX="PRINTMODE_LATEX";a.PRINTMODE_2DASCII="PRINTMODE_2DASCII";a.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";a.PRINTMODE_HUMAN="PRINTMODE_HUMAN";a.PRINTMODE_LIST="PRINTMODE_LIST";var G_=class{constructor(){this.printMode=a.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};a.defs=new G_;a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;a.do_simplify_nested_radicals=!0;a.avoidCalculatingPowersIntoArctans=!0;var Mo=class{toString(){return(0,SE.print_expr)(this)}toLatexString(){return(0,SE.collectLatexStringFromReturnValue)(this)}};a.BaseAtom=Mo;var qu=class extends Mo{constructor(t,r){super(),this.k=a.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Ha(t);)yield Le(t),t=se(t)}tail(){return Ha(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=Le(this),n=se(this);return Ha(n)&&(n=n.map(t)),new qu(t(r),n)}};a.Cons=qu;var Qa=class extends Mo{constructor(t,r=Of.default.one){super(),this.a=t,this.b=r,this.q=this,this.k=a.NUM}};a.Num=Qa;var rs=class extends Mo{constructor(t){super(),this.d=t,this.k=a.DOUBLE}};a.Double=rs;var F_=class extends Mo{constructor(t){super(),this.str=t,this.k=a.STR}};a.Str=F_;var j_=class extends Mo{constructor(){super(...arguments),this.tensor=this,this.k=a.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};a.Tensor=j_;var z_=class extends Mo{constructor(t){super(),this.printname=t,this.k=a.SYM}};a.Sym=z_;a.CONS=0;a.NUM=1;a.DOUBLE=2;a.STR=3;a.TENSOR=4;a.SYM=5;a.ABS="abs";a.ADD="add";a.ADJ="adj";a.AND="and";a.APPROXRATIO="approxratio";a.ARCCOS="arccos";a.ARCCOSH="arccosh";a.ARCSIN="arcsin";a.ARCSINH="arcsinh";a.ARCTAN="arctan";a.ARCTANH="arctanh";a.ARG="arg";a.ATOMIZE="atomize";a.BESSELJ="besselj";a.BESSELY="bessely";a.BINDING="binding";a.BINOMIAL="binomial";a.CEILING="ceiling";a.CHECK="check";a.CHOOSE="choose";a.CIRCEXP="circexp";a.CLEAR="clear";a.CLEARALL="clearall";a.CLEARPATTERNS="clearpatterns";a.CLOCK="clock";a.COEFF="coeff";a.COFACTOR="cofactor";a.CONDENSE="condense";a.CONJ="conj";a.CONTRACT="contract";a.COS="cos";a.COSH="cosh";a.DECOMP="decomp";a.DEFINT="defint";a.DEGREE="deg";a.DENOMINATOR="denominator";a.DERIVATIVE="derivative";a.DET="det";a.DIM="dim";a.DIRAC="dirac";a.DIVISORS="divisors";a.DO="do";a.DOT="dot";a.DRAW="draw";a.DSOLVE="dsolve";a.EIGEN="eigen";a.EIGENVAL="eigenval";a.EIGENVEC="eigenvec";a.ERF="erf";a.ERFC="erfc";a.EVAL="eval";a.EXP="exp";a.EXPAND="expand";a.EXPCOS="expcos";a.EXPSIN="expsin";a.FACTOR="factor";a.FACTORIAL="factorial";a.FACTORPOLY="factorpoly";a.FILTER="filter";a.FLOATF="float";a.FLOOR="floor";a.FOR="for";a.FUNCTION="function";a.GAMMA="Gamma";a.GCD="gcd";a.HERMITE="hermite";a.HILBERT="hilbert";a.IMAG="imag";a.INDEX="component";a.INNER="inner";a.INTEGRAL="integral";a.INV="inv";a.INVG="invg";a.ISINTEGER="isinteger";a.ISPRIME="isprime";a.LAGUERRE="laguerre";a.LCM="lcm";a.LEADING="leading";a.LEGENDRE="legendre";a.LOG="log";a.LOOKUP="lookup";a.MOD="mod";a.MULTIPLY="multiply";a.NOT="not";a.NROOTS="nroots";a.NUMBER="number";a.NUMERATOR="numerator";a.OPERATOR="operator";a.OR="or";a.OUTER="outer";a.PATTERN="pattern";a.PATTERNSINFO="patternsinfo";a.POLAR="polar";a.POWER="power";a.PRIME="prime";a.PRINT_LEAVE_E_ALONE="printLeaveEAlone";a.PRINT_LEAVE_X_ALONE="printLeaveXAlone";a.PRINT="print";a.PRINT2DASCII="print2dascii";a.PRINTFULL="printcomputer";a.PRINTLATEX="printlatex";a.PRINTLIST="printlist";a.PRINTPLAIN="printhuman";a.PRODUCT="product";a.QUOTE="quote";a.QUOTIENT="quotient";a.RANK="rank";a.RATIONALIZE="rationalize";a.REAL="real";a.ROUND="round";a.YYRECT="rect";a.ROOTS="roots";a.SETQ="equals";a.SGN="sgn";a.SILENTPATTERN="silentpattern";a.SIMPLIFY="simplify";a.SIN="sin";a.SINH="sinh";a.SHAPE="shape";a.SQRT="sqrt";a.STOP="stop";a.SUBST="subst";a.SUM="sum";a.SYMBOLSINFO="symbolsinfo";a.TAN="tan";a.TANH="tanh";a.TAYLOR="taylor";a.TEST="test";a.TESTEQ="testeq";a.TESTGE="testge";a.TESTGT="testgt";a.TESTLE="testle";a.TESTLT="testlt";a.TRANSPOSE="transpose";a.UNIT="unit";a.ZERO="zero";a.NIL="nil";a.LAST="last";a.LAST_PRINT="lastprint";a.LAST_2DASCII_PRINT="last2dasciiprint";a.LAST_FULL_PRINT="lastfullprint";a.LAST_LATEX_PRINT="lastlatexprint";a.LAST_LIST_PRINT="lastlistprint";a.LAST_PLAIN_PRINT="lastplainprint";a.AUTOEXPAND="autoexpand";a.BAKE="bake";a.ASSUME_REAL_VARIABLES="assumeRealVariables";a.TRACE="trace";a.FORCE_FIXED_PRINTOUT="forceFixedPrintout";a.MAX_FIXED_PRINTOUT_DIGITS="maxFixedPrintoutDigits";a.YYE="~";a.DRAWX="$DRAWX";a.METAA="$METAA";a.METAB="$METAB";a.METAX="$METAX";a.SECRETX="$SECRETX";a.VERSION="version";a.PI="pi";a.SYMBOL_A="a";a.SYMBOL_B="b";a.SYMBOL_C="c";a.SYMBOL_D="d";a.SYMBOL_I="i";a.SYMBOL_J="j";a.SYMBOL_N="n";a.SYMBOL_R="r";a.SYMBOL_S="s";a.SYMBOL_T="t";a.SYMBOL_X="x";a.SYMBOL_Y="y";a.SYMBOL_Z="z";a.SYMBOL_IDENTITY_MATRIX="I";a.SYMBOL_A_UNDERSCORE="a_";a.SYMBOL_B_UNDERSCORE="b_";a.SYMBOL_X_UNDERSCORE="x_";a.C1="$C1";a.C2="$C2";a.C3="$C3";a.C4="$C4";a.C5="$C5";a.C6="$C6";a.E=a.YYE;a.MAXPRIMETAB=1e4;a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;a.MAXDIM=24;a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];a.parse_time_simplifications=!0;a.primetab=function(){let e=[2],t=3;for(;e.length<a.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]===0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[a.MAXPRIMETAB]=0,e}();var $$=!1;a.mtotal=0;a.logbuf="";a.transpose_unicode=7488;a.dotprod_unicode=183;function Ha(e){return e.k===a.CONS}a.iscons=Ha;function wE(e){return e.k===a.NUM}a.isrational=wE;function LE(e){return e.k===a.DOUBLE}a.isdouble=LE;function CE(e){return wE(e)||LE(e)}a.isNumericAtom=CE;function U$(e){return e.k===a.STR}a.isstr=U$;function PE(e){return e.k===a.TENSOR}a.istensor=PE;function DE(e){if(CE(e)||e===(0,zr.symbol)(a.SYMBOL_IDENTITY_MATRIX))return!0;if(!PE(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!DE(r[n]))return!1;return!0}a.isNumericAtomOrTensor=DE;function B$(e){return e.k===a.SYM}a.issymbol=B$;function Le(e){return Ha(e)?e.cons.car:(0,zr.symbol)(a.NIL)}a.car=Le;function se(e){return Ha(e)?e.cons.cdr:(0,zr.symbol)(a.NIL)}a.cdr=se;function G$(e){return Le(Le(e))}a.caar=G$;function F$(e){return Le(se(e))}a.cadr=F$;function j$(e){return se(Le(e))}a.cdar=j$;function z$(e){return se(se(e))}a.cddr=z$;function Y$(e){return Le(Le(se(e)))}a.caadr=Y$;function V$(e){return Le(se(se(e)))}a.caddr=V$;function Z$(e){return Le(se(Le(e)))}a.cadar=Z$;function X$(e){return se(Le(se(e)))}a.cdadr=X$;function H$(e){return se(se(Le(e)))}a.cddar=H$;function Q$(e){return se(se(se(e)))}a.cdddr=Q$;function W$(e){return Le(Le(se(se(e))))}a.caaddr=W$;function J$(e){return Le(se(Le(se(e))))}a.cadadr=J$;function K$(e){return Le(se(se(Le(e))))}a.caddar=K$;function eU(e){return se(Le(se(se(e))))}a.cdaddr=eU;function tU(e){return Le(se(se(se(e))))}a.cadddr=tU;function rU(e){return se(se(se(se(e))))}a.cddddr=rU;function nU(e){return Le(se(se(se(se(e)))))}a.caddddr=nU;function oU(e){return Le(se(Le(se(se(e)))))}a.cadaddr=oU;function iU(e){return se(se(Le(se(se(e)))))}a.cddaddr=iU;function sU(e){return Le(se(se(Le(se(e)))))}a.caddadr=sU;function aU(e){return se(se(se(Le(se(se(e))))))}a.cdddaddr=aU;function lU(e){return Le(se(se(Le(se(se(e))))))}a.caddaddr=lU;function uU(e){return Le(e)===(0,zr.symbol)(a.ADD)}a.isadd=uU;function cU(e){return Le(e)===(0,zr.symbol)(a.MULTIPLY)}a.ismultiply=cU;function fU(e){return Le(e)===(0,zr.symbol)(a.POWER)}a.ispower=fU;function dU(e){return Le(e)===(0,zr.symbol)(a.FACTORIAL)}a.isfactorial=dU;function mU(e){return Le(e)===(0,zr.symbol)(a.INNER)||Le(e)===(0,zr.symbol)(a.DOT)}a.isinnerordot=mU;function _U(e){return Le(e)===(0,zr.symbol)(a.TRANSPOSE)}a.istranspose=_U;function bU(e){return Le(e)===(0,zr.symbol)(a.INV)}a.isinv=bU;function gU(e){return e===(0,zr.symbol)(a.SYMBOL_IDENTITY_MATRIX)}a.isidentitymatrix=gU;function yU(e){return e.isPositive()?1:e.isZero()?0:-1}a.MSIGN=yU;function vU(e){return e.isZero()}a.MZERO=vU;function qU(e,t){return e==null,e.equals(t)}a.MEQUAL=qU;function EU(){a.defs.esc_flag=!1,$$=!1,a.defs.evaluatingAsFloats=!1,a.defs.evaluatingPolar=!1}a.reset_after_error=EU;a.$={};var nr=class{static One(){return a.defs.evaluatingAsFloats?nr.oneAsDouble:nr.one}static NegOne(){return a.defs.evaluatingAsFloats?nr.negOneAsDouble:nr.negOne}static Zero(){return a.defs.evaluatingAsFloats?nr.zeroAsDouble:nr.zero}static Pi(){return a.defs.evaluatingAsFloats?nr.piAsDouble:(0,zr.symbol)(a.PI)}};a.Constants=nr;nr.one=new Qa((0,Of.default)(1));nr.oneAsDouble=new rs(1);nr.negOne=new Qa((0,Of.default)(-1));nr.negOneAsDouble=new rs(-1);nr.zero=new Qa((0,Of.default)(0));nr.zeroAsDouble=new rs(0);nr.piAsDouble=new rs(Math.PI);function xU(e,...t){let r=a.defs.expanding;a.defs.expanding=!1;try{return e(...t)}finally{a.defs.expanding=r}}a.noexpand=xU;function pU(e,...t){let r=a.defs.expanding;a.defs.expanding=!0;try{return e(...t)}finally{a.defs.expanding=r}}a.doexpand=pU;function hU(e,...t){let r=a.defs.evaluatingPolar;a.defs.evaluatingPolar=!0;try{return e(...t)}finally{a.defs.evaluatingPolar=r}}a.evalPolar=hU;function AU(e,...t){let r=a.defs.evaluatingAsFloats;a.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{a.defs.evaluatingAsFloats=r}}a.evalFloats=AU});var UE=A(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.exec=Wa.parse=void 0;var Mf=Ee(),kE=F(),OU=K(),MU=Yo(),Eu=N(),TU=au(),Y_=U();Eu.defs.inited||(Eu.defs.inited=!0,(0,TU.init)());function $E(e){if(typeof e=="string"){let[,t]=(0,MU.scan)(e);return t}else return typeof e=="number"?e%1===0?(0,kE.integer)(e):(0,kE.double)(e):typeof e.k=="number"?e:(console.warn("unknown argument type",e),(0,Y_.symbol)(Eu.NIL))}function NU(e){let t;try{t=$E(e),(0,Mf.check_stack)()}catch(r){throw(0,Eu.reset_after_error)(),r}return t}Wa.parse=NU;function IU(e,...t){let r,n=(0,Y_.get_binding)((0,Y_.usr_symbol)(e));(0,Mf.check_stack)();let o=(0,OU.makeList)(n,...t.map($E));try{r=(0,Mf.top_level_eval)(o),(0,Mf.check_stack)()}catch(i){throw(0,Eu.reset_after_error)(),i}return r}Wa.exec=IU});var kU=A(Ka=>{Object.defineProperty(Ka,"__esModule",{value:!0});Ka.A=void 0;var ve=N(),SU=ir(),RU=au(),wU=Ee(),Ja=U(),V_=UE(),Tf=Dm(),LU=Fl(),Lt=H(),BE=Ne(),CU=Yo(),PU={version:ve.version,isadd:ve.isadd,ismultiply:ve.ismultiply,ispower:ve.ispower,isfactorial:ve.isfactorial,car:ve.car,cdr:ve.cdr,caar:ve.caar,cadr:ve.cadr,cdar:ve.cdar,cddr:ve.cddr,caadr:ve.caadr,caddr:ve.caddr,cadar:ve.cadar,cdadr:ve.cdadr,cddar:ve.cddar,cdddr:ve.cdddr,caaddr:ve.caaddr,cadadr:ve.cadadr,caddar:ve.caddar,cdaddr:ve.cdaddr,cadddr:ve.cadddr,cddddr:ve.cddddr,caddddr:ve.caddddr,cadaddr:ve.cadaddr,cddaddr:ve.cddaddr,caddadr:ve.caddadr,cdddaddr:ve.cdddaddr,caddaddr:ve.caddaddr,symbol:Ja.symbol,iscons:ve.iscons,isrational:ve.isrational,isdouble:ve.isdouble,isNumericAtom:ve.isNumericAtom,isstr:ve.isstr,istensor:ve.istensor,issymbol:ve.issymbol,iskeyword:Ja.iskeyword,CONS:ve.CONS,Cons:ve.Cons,NUM:ve.NUM,Num:ve.Num,DOUBLE:ve.DOUBLE,Double:ve.Double,STR:ve.STR,Str:ve.Str,TENSOR:ve.TENSOR,Tensor:ve.Tensor,SYM:ve.SYM,Sym:ve.Sym,approxRadicals:Tf.approxRadicals,approxRationalsOfLogs:Tf.approxRationalsOfLogs,approxAll:Tf.approxAll,testApprox:Tf.testApprox,make_hashed_itab:LU.make_hashed_itab,isZeroAtomOrTensor:Lt.isZeroAtomOrTensor,isnegativenumber:Lt.isnegativenumber,isplusone:Lt.isplusone,isminusone:Lt.isminusone,isinteger:Lt.isinteger,isnonnegativeinteger:Lt.isnonnegativeinteger,isposint:Lt.isposint,isnegativeterm:Lt.isnegativeterm,isimaginarynumber:Lt.isimaginarynumber,iscomplexnumber:Lt.iscomplexnumber,iseveninteger:Lt.iseveninteger,isnegative:Lt.isnegative,issymbolic:Lt.issymbolic,isintegerfactor:Lt.isintegerfactor,isoneover:Lt.isoneover,isfraction:Lt.isfraction,isoneoversqrttwo:Lt.isoneoversqrttwo,isminusoneoversqrttwo:Lt.isminusoneoversqrttwo,isfloating:Lt.isfloating,isimaginaryunit:Lt.isimaginaryunit,isquarterturn:Lt.isquarterturn,isnpi:Lt.isnpi,equal:BE.equal,length:BE.length,scan:CU.scan,Find:SU.Find,get_binding:Ja.get_binding,set_binding:Ja.set_binding,usr_symbol:Ja.usr_symbol,collectUserSymbols:Ja.collectUserSymbols,init:RU.init,exec:V_.exec,parse:V_.parse,run:wU.run},DU=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"],Z_=PU;Ka.A=Z_;Array.from(DU).map(e=>Z_[e]=V_.exec.bind(Ka,e));Ka.default=Z_});kU();})();
