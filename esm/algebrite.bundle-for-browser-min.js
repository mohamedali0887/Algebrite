(()=>{var ag=Object.create;var gl=Object.defineProperty;var lg=Object.getOwnPropertyDescriptor;var fg=Object.getOwnPropertyNames;var ug=Object.getPrototypeOf,cg=Object.prototype.hasOwnProperty;var mg=(t,r,e)=>r in t?gl(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var dg=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var xg=(t,r,e,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of fg(r))!cg.call(t,n)&&n!==e&&gl(t,n,{get:()=>r[n],enumerable:!(o=lg(r,n))||o.enumerable});return t};var _n=(t,r,e)=>(e=t!=null?ag(ug(t)):{},xg(r||!t||!t.__esModule?gl(e,"default",{value:t,enumerable:!0}):e,t));var rt=(t,r,e)=>(mg(t,typeof r!="symbol"?r+"":r,e),e);var Vo=dg((v2,$s)=>{var qr=function(t){"use strict";var r=1e7,e=7,o=9007199254740992,n=B(o),i="0123456789abcdefghijklmnopqrstuvwxyz",a=typeof BigInt=="function";function c(d,b,E,w){return typeof d>"u"?c[0]:typeof b<"u"?+b==10&&!E?bt(d):ng(d,b,E,w):bt(d)}function x(d,b){this.value=d,this.sign=b,this.isSmall=!1}x.prototype=Object.create(c.prototype);function g(d){this.value=d,this.sign=d<0,this.isSmall=!0}g.prototype=Object.create(c.prototype);function v(d){this.value=d}v.prototype=Object.create(c.prototype);function z(d){return-o<d&&d<o}function B(d){return d<1e7?[d]:d<1e14?[d%1e7,Math.floor(d/1e7)]:[d%1e7,Math.floor(d/1e7)%1e7,Math.floor(d/1e14)]}function J(d){nt(d);var b=d.length;if(b<4&&Io(d,n)<0)switch(b){case 0:return 0;case 1:return d[0];case 2:return d[0]+d[1]*r;default:return d[0]+(d[1]+d[2]*r)*r}return d}function nt(d){for(var b=d.length;d[--b]===0;);d.length=b+1}function ht(d){for(var b=new Array(d),E=-1;++E<d;)b[E]=0;return b}function $t(d){return d>0?Math.floor(d):Math.ceil(d)}function xr(d,b){var E=d.length,w=b.length,R=new Array(E),O=0,Z=r,F,j;for(j=0;j<w;j++)F=d[j]+b[j]+O,O=F>=Z?1:0,R[j]=F-O*Z;for(;j<E;)F=d[j]+O,O=F===Z?1:0,R[j++]=F-O*Z;return O>0&&R.push(O),R}function ar(d,b){return d.length>=b.length?xr(d,b):xr(b,d)}function kt(d,b){var E=d.length,w=new Array(E),R=r,O,Z;for(Z=0;Z<E;Z++)O=d[Z]-R+b,b=Math.floor(O/R),w[Z]=O-b*R,b+=1;for(;b>0;)w[Z++]=b%R,b=Math.floor(b/R);return w}x.prototype.add=function(d){var b=bt(d);if(this.sign!==b.sign)return this.subtract(b.negate());var E=this.value,w=b.value;return b.isSmall?new x(kt(E,Math.abs(w)),this.sign):new x(ar(E,w),this.sign)},x.prototype.plus=x.prototype.add,g.prototype.add=function(d){var b=bt(d),E=this.value;if(E<0!==b.sign)return this.subtract(b.negate());var w=b.value;if(b.isSmall){if(z(E+w))return new g(E+w);w=B(Math.abs(w))}return new x(kt(w,Math.abs(E)),E<0)},g.prototype.plus=g.prototype.add,v.prototype.add=function(d){return new v(this.value+bt(d).value)},v.prototype.plus=v.prototype.add;function nr(d,b){var E=d.length,w=b.length,R=new Array(E),O=0,Z=r,F,j;for(F=0;F<w;F++)j=d[F]-O-b[F],j<0?(j+=Z,O=1):O=0,R[F]=j;for(F=w;F<E;F++){if(j=d[F]-O,j<0)j+=Z;else{R[F++]=j;break}R[F]=j}for(;F<E;F++)R[F]=d[F];return nt(R),R}function vr(d,b,E){var w;return Io(d,b)>=0?w=nr(d,b):(w=nr(b,d),E=!E),w=J(w),typeof w=="number"?(E&&(w=-w),new g(w)):new x(w,E)}function Rr(d,b,E){var w=d.length,R=new Array(w),O=-b,Z=r,F,j;for(F=0;F<w;F++)j=d[F]+O,O=Math.floor(j/Z),j%=Z,R[F]=j<0?j+Z:j;return R=J(R),typeof R=="number"?(E&&(R=-R),new g(R)):new x(R,E)}x.prototype.subtract=function(d){var b=bt(d);if(this.sign!==b.sign)return this.add(b.negate());var E=this.value,w=b.value;return b.isSmall?Rr(E,Math.abs(w),this.sign):vr(E,w,this.sign)},x.prototype.minus=x.prototype.subtract,g.prototype.subtract=function(d){var b=bt(d),E=this.value;if(E<0!==b.sign)return this.add(b.negate());var w=b.value;return b.isSmall?new g(E-w):Rr(w,Math.abs(E),E>=0)},g.prototype.minus=g.prototype.subtract,v.prototype.subtract=function(d){return new v(this.value-bt(d).value)},v.prototype.minus=v.prototype.subtract,x.prototype.negate=function(){return new x(this.value,!this.sign)},g.prototype.negate=function(){var d=this.sign,b=new g(-this.value);return b.sign=!d,b},v.prototype.negate=function(){return new v(-this.value)},x.prototype.abs=function(){return new x(this.value,!1)},g.prototype.abs=function(){return new g(Math.abs(this.value))},v.prototype.abs=function(){return new v(this.value>=0?this.value:-this.value)};function Ve(d,b){var E=d.length,w=b.length,R=E+w,O=ht(R),Z=r,F,j,_t,Rt,yt;for(_t=0;_t<E;++_t){Rt=d[_t];for(var Qt=0;Qt<w;++Qt)yt=b[Qt],F=Rt*yt+O[_t+Qt],j=Math.floor(F/Z),O[_t+Qt]=F-j*Z,O[_t+Qt+1]+=j}return nt(O),O}function ne(d,b){var E=d.length,w=new Array(E),R=r,O=0,Z,F;for(F=0;F<E;F++)Z=d[F]*b+O,O=Math.floor(Z/R),w[F]=Z-O*R;for(;O>0;)w[F++]=O%R,O=Math.floor(O/R);return w}function Me(d,b){for(var E=[];b-- >0;)E.push(0);return E.concat(d)}function no(d,b){var E=Math.max(d.length,b.length);if(E<=30)return Ve(d,b);E=Math.ceil(E/2);var w=d.slice(E),R=d.slice(0,E),O=b.slice(E),Z=b.slice(0,E),F=no(R,Z),j=no(w,O),_t=no(ar(R,w),ar(Z,O)),Rt=ar(ar(F,Me(nr(nr(_t,F),j),E)),Me(j,2*E));return nt(Rt),Rt}function Os(d,b){return-.012*d-.012*b+15e-6*d*b>0}x.prototype.multiply=function(d){var b=bt(d),E=this.value,w=b.value,R=this.sign!==b.sign,O;if(b.isSmall){if(w===0)return c[0];if(w===1)return this;if(w===-1)return this.negate();if(O=Math.abs(w),O<r)return new x(ne(E,O),R);w=B(O)}return Os(E.length,w.length)?new x(no(E,w),R):new x(Ve(E,w),R)},x.prototype.times=x.prototype.multiply;function No(d,b,E){return d<r?new x(ne(b,d),E):new x(Ve(b,B(d)),E)}g.prototype._multiplyBySmall=function(d){return z(d.value*this.value)?new g(d.value*this.value):No(Math.abs(d.value),B(Math.abs(this.value)),this.sign!==d.sign)},x.prototype._multiplyBySmall=function(d){return d.value===0?c[0]:d.value===1?this:d.value===-1?this.negate():No(Math.abs(d.value),this.value,this.sign!==d.sign)},g.prototype.multiply=function(d){return bt(d)._multiplyBySmall(this)},g.prototype.times=g.prototype.multiply,v.prototype.multiply=function(d){return new v(this.value*bt(d).value)},v.prototype.times=v.prototype.multiply;function Bi(d){var b=d.length,E=ht(b+b),w=r,R,O,Z,F,j;for(Z=0;Z<b;Z++){F=d[Z],O=0-F*F;for(var _t=Z;_t<b;_t++)j=d[_t],R=2*(F*j)+E[Z+_t]+O,O=Math.floor(R/w),E[Z+_t]=R-O*w;E[Z+b]=O}return nt(E),E}x.prototype.square=function(){return new x(Bi(this.value),!1)},g.prototype.square=function(){var d=this.value*this.value;return z(d)?new g(d):new x(Bi(B(Math.abs(this.value))),!1)},v.prototype.square=function(d){return new v(this.value*this.value)};function Ts(d,b){var E=d.length,w=b.length,R=r,O=ht(b.length),Z=b[w-1],F=Math.ceil(R/(2*Z)),j=ne(d,F),_t=ne(b,F),Rt,yt,Qt,ge,ie,xl,pl;for(j.length<=E&&j.push(0),_t.push(0),Z=_t[w-1],yt=E-w;yt>=0;yt--){for(Rt=R-1,j[yt+w]!==Z&&(Rt=Math.floor((j[yt+w]*R+j[yt+w-1])/Z)),Qt=0,ge=0,xl=_t.length,ie=0;ie<xl;ie++)Qt+=Rt*_t[ie],pl=Math.floor(Qt/R),ge+=j[yt+ie]-(Qt-pl*R),Qt=pl,ge<0?(j[yt+ie]=ge+R,ge=-1):(j[yt+ie]=ge,ge=0);for(;ge!==0;){for(Rt-=1,Qt=0,ie=0;ie<xl;ie++)Qt+=j[yt+ie]-R+_t[ie],Qt<0?(j[yt+ie]=Qt+R,Qt=0):(j[yt+ie]=Qt,Qt=1);ge+=Qt}O[yt]=Rt}return j=Ui(j,F)[0],[J(O),J(j)]}function Ns(d,b){for(var E=d.length,w=b.length,R=[],O=[],Z=r,F,j,_t,Rt,yt;E;){if(O.unshift(d[--E]),nt(O),Io(O,b)<0){R.push(0);continue}j=O.length,_t=O[j-1]*Z+O[j-2],Rt=b[w-1]*Z+b[w-2],j>w&&(_t=(_t+1)*Z),F=Math.ceil(_t/Rt);do{if(yt=ne(b,F),Io(yt,O)<=0)break;F--}while(F);R.push(F),O=nr(O,yt)}return R.reverse(),[J(R),J(O)]}function Ui(d,b){var E=d.length,w=ht(E),R=r,O,Z,F,j;for(F=0,O=E-1;O>=0;--O)j=F*R+d[O],Z=$t(j/b),F=j-Z*b,w[O]=Z|0;return[w,F|0]}function Ze(d,b){var E,w=bt(b);if(a)return[new v(d.value/w.value),new v(d.value%w.value)];var R=d.value,O=w.value,Z;if(O===0)throw new Error("Cannot divide by zero");if(d.isSmall)return w.isSmall?[new g($t(R/O)),new g(R%O)]:[c[0],d];if(w.isSmall){if(O===1)return[d,c[0]];if(O==-1)return[d.negate(),c[0]];var F=Math.abs(O);if(F<r){E=Ui(R,F),Z=J(E[0]);var j=E[1];return d.sign&&(j=-j),typeof Z=="number"?(d.sign!==w.sign&&(Z=-Z),[new g(Z),new g(j)]):[new x(Z,d.sign!==w.sign),new g(j)]}O=B(F)}var _t=Io(R,O);if(_t===-1)return[c[0],d];if(_t===0)return[c[d.sign===w.sign?1:-1],c[0]];R.length+O.length<=200?E=Ts(R,O):E=Ns(R,O),Z=E[0];var Rt=d.sign!==w.sign,yt=E[1],Qt=d.sign;return typeof Z=="number"?(Rt&&(Z=-Z),Z=new g(Z)):Z=new x(Z,Rt),typeof yt=="number"?(Qt&&(yt=-yt),yt=new g(yt)):yt=new x(yt,Qt),[Z,yt]}x.prototype.divmod=function(d){var b=Ze(this,d);return{quotient:b[0],remainder:b[1]}},v.prototype.divmod=g.prototype.divmod=x.prototype.divmod,x.prototype.divide=function(d){return Ze(this,d)[0]},v.prototype.over=v.prototype.divide=function(d){return new v(this.value/bt(d).value)},g.prototype.over=g.prototype.divide=x.prototype.over=x.prototype.divide,x.prototype.mod=function(d){return Ze(this,d)[1]},v.prototype.mod=v.prototype.remainder=function(d){return new v(this.value%bt(d).value)},g.prototype.remainder=g.prototype.mod=x.prototype.remainder=x.prototype.mod,x.prototype.pow=function(d){var b=bt(d),E=this.value,w=b.value,R,O,Z;if(w===0)return c[1];if(E===0)return c[0];if(E===1)return c[1];if(E===-1)return b.isEven()?c[1]:c[-1];if(b.sign)return c[0];if(!b.isSmall)throw new Error("The exponent "+b.toString()+" is too large.");if(this.isSmall&&z(R=Math.pow(E,w)))return new g($t(R));for(O=this,Z=c[1];w&!0&&(Z=Z.times(O),--w),w!==0;)w/=2,O=O.square();return Z},g.prototype.pow=x.prototype.pow,v.prototype.pow=function(d){var b=bt(d),E=this.value,w=b.value,R=BigInt(0),O=BigInt(1),Z=BigInt(2);if(w===R)return c[1];if(E===R)return c[0];if(E===O)return c[1];if(E===BigInt(-1))return b.isEven()?c[1]:c[-1];if(b.isNegative())return new v(R);for(var F=this,j=c[1];(w&O)===O&&(j=j.times(F),--w),w!==R;)w/=Z,F=F.square();return j},x.prototype.modPow=function(d,b){if(d=bt(d),b=bt(b),b.isZero())throw new Error("Cannot take modPow with modulus 0");var E=c[1],w=this.mod(b);for(d.isNegative()&&(d=d.multiply(c[-1]),w=w.modInv(b));d.isPositive();){if(w.isZero())return c[0];d.isOdd()&&(E=E.multiply(w).mod(b)),d=d.divide(2),w=w.square().mod(b)}return E},v.prototype.modPow=g.prototype.modPow=x.prototype.modPow;function Io(d,b){if(d.length!==b.length)return d.length>b.length?1:-1;for(var E=d.length-1;E>=0;E--)if(d[E]!==b[E])return d[E]>b[E]?1:-1;return 0}x.prototype.compareAbs=function(d){var b=bt(d),E=this.value,w=b.value;return b.isSmall?1:Io(E,w)},g.prototype.compareAbs=function(d){var b=bt(d),E=Math.abs(this.value),w=b.value;return b.isSmall?(w=Math.abs(w),E===w?0:E>w?1:-1):-1},v.prototype.compareAbs=function(d){var b=this.value,E=bt(d).value;return b=b>=0?b:-b,E=E>=0?E:-E,b===E?0:b>E?1:-1},x.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=bt(d),E=this.value,w=b.value;return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:Io(E,w)*(this.sign?-1:1)},x.prototype.compareTo=x.prototype.compare,g.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=bt(d),E=this.value,w=b.value;return b.isSmall?E==w?0:E>w?1:-1:E<0!==b.sign?E<0?-1:1:E<0?1:-1},g.prototype.compareTo=g.prototype.compare,v.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=this.value,E=bt(d).value;return b===E?0:b>E?1:-1},v.prototype.compareTo=v.prototype.compare,x.prototype.equals=function(d){return this.compare(d)===0},v.prototype.eq=v.prototype.equals=g.prototype.eq=g.prototype.equals=x.prototype.eq=x.prototype.equals,x.prototype.notEquals=function(d){return this.compare(d)!==0},v.prototype.neq=v.prototype.notEquals=g.prototype.neq=g.prototype.notEquals=x.prototype.neq=x.prototype.notEquals,x.prototype.greater=function(d){return this.compare(d)>0},v.prototype.gt=v.prototype.greater=g.prototype.gt=g.prototype.greater=x.prototype.gt=x.prototype.greater,x.prototype.lesser=function(d){return this.compare(d)<0},v.prototype.lt=v.prototype.lesser=g.prototype.lt=g.prototype.lesser=x.prototype.lt=x.prototype.lesser,x.prototype.greaterOrEquals=function(d){return this.compare(d)>=0},v.prototype.geq=v.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals=x.prototype.geq=x.prototype.greaterOrEquals,x.prototype.lesserOrEquals=function(d){return this.compare(d)<=0},v.prototype.leq=v.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals=x.prototype.leq=x.prototype.lesserOrEquals,x.prototype.isEven=function(){return(this.value[0]&1)===0},g.prototype.isEven=function(){return(this.value&1)===0},v.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},x.prototype.isOdd=function(){return(this.value[0]&1)===1},g.prototype.isOdd=function(){return(this.value&1)===1},v.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},x.prototype.isPositive=function(){return!this.sign},g.prototype.isPositive=function(){return this.value>0},v.prototype.isPositive=g.prototype.isPositive,x.prototype.isNegative=function(){return this.sign},g.prototype.isNegative=function(){return this.value<0},v.prototype.isNegative=g.prototype.isNegative,x.prototype.isUnit=function(){return!1},g.prototype.isUnit=function(){return Math.abs(this.value)===1},v.prototype.isUnit=function(){return this.abs().value===BigInt(1)},x.prototype.isZero=function(){return!1},g.prototype.isZero=function(){return this.value===0},v.prototype.isZero=function(){return this.value===BigInt(0)},x.prototype.isDivisibleBy=function(d){var b=bt(d);return b.isZero()?!1:b.isUnit()?!0:b.compareAbs(2)===0?this.isEven():this.mod(b).isZero()},v.prototype.isDivisibleBy=g.prototype.isDivisibleBy=x.prototype.isDivisibleBy;function Is(d){var b=d.abs();if(b.isUnit())return!1;if(b.equals(2)||b.equals(3)||b.equals(5))return!0;if(b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5))return!1;if(b.lesser(49))return!0}function Gi(d,b){for(var E=d.prev(),w=E,R=0,O,Z,F,j;w.isEven();)w=w.divide(2),R++;t:for(F=0;F<b.length;F++)if(!d.lesser(b[F])&&(j=qr(b[F]).modPow(w,d),!(j.isUnit()||j.equals(E)))){for(O=R-1;O!=0;O--){if(j=j.square().mod(d),j.isUnit())return!1;if(j.equals(E))continue t}return!1}return!0}x.prototype.isPrime=function(d){var b=Is(this);if(b!==t)return b;var E=this.abs(),w=E.bitLength();if(w<=64)return Gi(E,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var R=Math.log(2)*w.toJSNumber(),O=Math.ceil(d===!0?2*Math.pow(R,2):R),Z=[],F=0;F<O;F++)Z.push(qr(F+2));return Gi(E,Z)},v.prototype.isPrime=g.prototype.isPrime=x.prototype.isPrime,x.prototype.isProbablePrime=function(d,b){var E=Is(this);if(E!==t)return E;for(var w=this.abs(),R=d===t?5:d,O=[],Z=0;Z<R;Z++)O.push(qr.randBetween(2,w.minus(2),b));return Gi(w,O)},v.prototype.isProbablePrime=g.prototype.isProbablePrime=x.prototype.isProbablePrime,x.prototype.modInv=function(d){for(var b=qr.zero,E=qr.one,w=bt(d),R=this.abs(),O,Z,F;!R.isZero();)O=w.divide(R),Z=b,F=w,b=E,w=R,E=Z.subtract(O.multiply(E)),R=F.subtract(O.multiply(R));if(!w.isUnit())throw new Error(this.toString()+" and "+d.toString()+" are not co-prime");return b.compare(0)===-1&&(b=b.add(d)),this.isNegative()?b.negate():b},v.prototype.modInv=g.prototype.modInv=x.prototype.modInv,x.prototype.next=function(){var d=this.value;return this.sign?Rr(d,1,this.sign):new x(kt(d,1),this.sign)},g.prototype.next=function(){var d=this.value;return d+1<o?new g(d+1):new x(n,!1)},v.prototype.next=function(){return new v(this.value+BigInt(1))},x.prototype.prev=function(){var d=this.value;return this.sign?new x(kt(d,1),!0):Rr(d,1,this.sign)},g.prototype.prev=function(){var d=this.value;return d-1>-o?new g(d-1):new x(n,!0)},v.prototype.prev=function(){return new v(this.value-BigInt(1))};for(var Ye=[1];2*Ye[Ye.length-1]<=r;)Ye.push(2*Ye[Ye.length-1]);var gn=Ye.length,Ro=Ye[gn-1];function Rs(d){return Math.abs(d)<=r}x.prototype.shiftLeft=function(d){var b=bt(d).toJSNumber();if(!Rs(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftRight(-b);var E=this;if(E.isZero())return E;for(;b>=gn;)E=E.multiply(Ro),b-=gn-1;return E.multiply(Ye[b])},v.prototype.shiftLeft=g.prototype.shiftLeft=x.prototype.shiftLeft,x.prototype.shiftRight=function(d){var b,E=bt(d).toJSNumber();if(!Rs(E))throw new Error(String(E)+" is too large for shifting.");if(E<0)return this.shiftLeft(-E);for(var w=this;E>=gn;){if(w.isZero()||w.isNegative()&&w.isUnit())return w;b=Ze(w,Ro),w=b[1].isNegative()?b[0].prev():b[0],E-=gn-1}return b=Ze(w,Ye[E]),b[1].isNegative()?b[0].prev():b[0]},v.prototype.shiftRight=g.prototype.shiftRight=x.prototype.shiftRight;function zi(d,b,E){b=bt(b);for(var w=d.isNegative(),R=b.isNegative(),O=w?d.not():d,Z=R?b.not():b,F=0,j=0,_t=null,Rt=null,yt=[];!O.isZero()||!Z.isZero();)_t=Ze(O,Ro),F=_t[1].toJSNumber(),w&&(F=Ro-1-F),Rt=Ze(Z,Ro),j=Rt[1].toJSNumber(),R&&(j=Ro-1-j),O=_t[0],Z=Rt[0],yt.push(E(F,j));for(var Qt=E(w?1:0,R?1:0)!==0?qr(-1):qr(0),ge=yt.length-1;ge>=0;ge-=1)Qt=Qt.multiply(Ro).add(qr(yt[ge]));return Qt}x.prototype.not=function(){return this.negate().prev()},v.prototype.not=g.prototype.not=x.prototype.not,x.prototype.and=function(d){return zi(this,d,function(b,E){return b&E})},v.prototype.and=g.prototype.and=x.prototype.and,x.prototype.or=function(d){return zi(this,d,function(b,E){return b|E})},v.prototype.or=g.prototype.or=x.prototype.or,x.prototype.xor=function(d){return zi(this,d,function(b,E){return b^E})},v.prototype.xor=g.prototype.xor=x.prototype.xor;var Fi=1<<30,dl=(r&-r)*(r&-r)|Fi;function Gn(d){var b=d.value,E=typeof b=="number"?b|Fi:typeof b=="bigint"?b|BigInt(Fi):b[0]+b[1]*r|dl;return E&-E}function Ls(d,b){if(b.compareTo(d)<=0){var E=Ls(d,b.square(b)),w=E.p,R=E.e,O=w.multiply(b);return O.compareTo(d)<=0?{p:O,e:R*2+1}:{p:w,e:R*2}}return{p:qr(1),e:0}}x.prototype.bitLength=function(){var d=this;return d.compareTo(qr(0))<0&&(d=d.negate().subtract(qr(1))),d.compareTo(qr(0))===0?qr(0):qr(Ls(d,qr(2)).e).add(qr(1))},v.prototype.bitLength=g.prototype.bitLength=x.prototype.bitLength;function Vi(d,b){return d=bt(d),b=bt(b),d.greater(b)?d:b}function zn(d,b){return d=bt(d),b=bt(b),d.lesser(b)?d:b}function $f(d,b){if(d=bt(d).abs(),b=bt(b).abs(),d.equals(b))return d;if(d.isZero())return b;if(b.isZero())return d;for(var E=c[1],w,R;d.isEven()&&b.isEven();)w=zn(Gn(d),Gn(b)),d=d.divide(w),b=b.divide(w),E=E.multiply(w);for(;d.isEven();)d=d.divide(Gn(d));do{for(;b.isEven();)b=b.divide(Gn(b));d.greater(b)&&(R=b,b=d,d=R),b=b.subtract(d)}while(!b.isZero());return E.isUnit()?d:d.multiply(E)}function eg(d,b){return d=bt(d).abs(),b=bt(b).abs(),d.divide($f(d,b)).multiply(b)}function og(d,b,E){d=bt(d),b=bt(b);var w=E||Math.random,R=zn(d,b),O=Vi(d,b),Z=O.subtract(R).add(1);if(Z.isSmall)return R.add(Math.floor(w()*Z));for(var F=Zi(Z,r).value,j=[],_t=!0,Rt=0;Rt<F.length;Rt++){var yt=_t?F[Rt]+(Rt+1<F.length?F[Rt+1]/r:0):r,Qt=$t(w()*yt);j.push(Qt),Qt<F[Rt]&&(_t=!1)}return R.add(c.fromArray(j,r,!1))}var ng=function(d,b,E,w){E=E||i,d=String(d),w||(d=d.toLowerCase(),E=E.toLowerCase());var R=d.length,O,Z=Math.abs(b),F={};for(O=0;O<E.length;O++)F[E[O]]=O;for(O=0;O<R;O++){var j=d[O];if(j!=="-"&&j in F&&F[j]>=Z){if(j==="1"&&Z===1)continue;throw new Error(j+" is not a valid digit in base "+b+".")}}b=bt(b);var _t=[],Rt=d[0]==="-";for(O=Rt?1:0;O<d.length;O++){var j=d[O];if(j in F)_t.push(bt(F[j]));else if(j==="<"){var yt=O;do O++;while(d[O]!==">"&&O<d.length);_t.push(bt(d.slice(yt+1,O)))}else throw new Error(j+" is not a valid character")}return Cf(_t,b,Rt)};function Cf(d,b,E){var w=c[0],R=c[1],O;for(O=d.length-1;O>=0;O--)w=w.add(d[O].times(R)),R=R.times(b);return E?w.negate():w}function ig(d,b){return b=b||i,d<b.length?b[d]:"<"+d+">"}function Zi(d,b){if(b=qr(b),b.isZero()){if(d.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(b.equals(-1)){if(d.isZero())return{value:[0],isNegative:!1};if(d.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-d.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var E=Array.apply(null,Array(d.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return E.unshift([1]),{value:[].concat.apply([],E),isNegative:!1}}var w=!1;if(d.isNegative()&&b.isPositive()&&(w=!0,d=d.abs()),b.isUnit())return d.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(d.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:w};for(var R=[],O=d,Z;O.isNegative()||O.compareAbs(b)>=0;){Z=O.divmod(b),O=Z.quotient;var F=Z.remainder;F.isNegative()&&(F=b.minus(F).abs(),O=O.next()),R.push(F.toJSNumber())}return R.push(O.toJSNumber()),{value:R.reverse(),isNegative:w}}function Pf(d,b,E){var w=Zi(d,b);return(w.isNegative?"-":"")+w.value.map(function(R){return ig(R,E)}).join("")}x.prototype.toArray=function(d){return Zi(this,d)},g.prototype.toArray=function(d){return Zi(this,d)},v.prototype.toArray=function(d){return Zi(this,d)},x.prototype.toString=function(d,b){if(d===t&&(d=10),d!==10)return Pf(this,d,b);for(var E=this.value,w=E.length,R=String(E[--w]),O="0000000",Z;--w>=0;)Z=String(E[w]),R+=O.slice(Z.length)+Z;var F=this.sign?"-":"";return F+R},g.prototype.toString=function(d,b){return d===t&&(d=10),d!=10?Pf(this,d,b):String(this.value)},v.prototype.toString=g.prototype.toString,v.prototype.toJSON=x.prototype.toJSON=g.prototype.toJSON=function(){return this.toString()},x.prototype.valueOf=function(){return parseInt(this.toString(),10)},x.prototype.toJSNumber=x.prototype.valueOf,g.prototype.valueOf=function(){return this.value},g.prototype.toJSNumber=g.prototype.valueOf,v.prototype.valueOf=v.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function kf(d){if(z(+d)){var b=+d;if(b===$t(b))return a?new v(BigInt(b)):new g(b);throw new Error("Invalid integer: "+d)}var E=d[0]==="-";E&&(d=d.slice(1));var w=d.split(/e/i);if(w.length>2)throw new Error("Invalid integer: "+w.join("e"));if(w.length===2){var R=w[1];if(R[0]==="+"&&(R=R.slice(1)),R=+R,R!==$t(R)||!z(R))throw new Error("Invalid integer: "+R+" is not a valid exponent.");var O=w[0],Z=O.indexOf(".");if(Z>=0&&(R-=O.length-Z-1,O=O.slice(0,Z)+O.slice(Z+1)),R<0)throw new Error("Cannot include negative exponent part for integers");O+=new Array(R+1).join("0"),d=O}var F=/^([0-9][0-9]*)$/.test(d);if(!F)throw new Error("Invalid integer: "+d);if(a)return new v(BigInt(E?"-"+d:d));for(var j=[],_t=d.length,Rt=e,yt=_t-Rt;_t>0;)j.push(+d.slice(yt,_t)),yt-=Rt,yt<0&&(yt=0),_t-=Rt;return nt(j),new x(j,E)}function sg(d){if(a)return new v(BigInt(d));if(z(d)){if(d!==$t(d))throw new Error(d+" is not an integer.");return new g(d)}return kf(d.toString())}function bt(d){return typeof d=="number"?sg(d):typeof d=="string"?kf(d):typeof d=="bigint"?new v(d):d}for(var bn=0;bn<1e3;bn++)c[bn]=bt(bn),bn>0&&(c[-bn]=bt(-bn));return c.one=c[1],c.zero=c[0],c.minusOne=c[-1],c.max=Vi,c.min=zn,c.gcd=$f,c.lcm=eg,c.isInstance=function(d){return d instanceof x||d instanceof g||d instanceof v},c.randBetween=og,c.fromArray=function(d,b,E){return Cf(d.map(bt),bt(b||10),E)},c}();typeof $s<"u"&&$s.hasOwnProperty("exports")&&($s.exports=qr);typeof define=="function"&&define.amd&&define(function(){return qr})});var ws=_n(Vo());var hr=_n(Vo());var pg=_n(Vo());function hn(t,r){return t.compare(r)}function it(t,r){if(ot(t,r))return!0;if(H(t)){for(let e=0;e<t.tensor.nelem;e++)if(it(t.tensor.elem[e],r))return!0;return!1}return M(t)?[...t].some(e=>it(e,r)):!1}function vn(t,r){if(Se(t))return!1;if(tt(t)&&!qt(A(r))&&it(l(t),f.imaginaryunit)||tt(t)&&wt(l(t),-1)&&!qt(A(r)))return!0;if(H(t)){for(let e=0;e<t.tensor.nelem;e++)if(vn(t.tensor.elem[e],r))return!0;return!1}return M(t)?[...t].some(e=>vn(e,r)):!1}function Fn(t){if(tt(t)&&l(t)===s(rr))return it(A(t),f.imaginaryunit);if(H(t)){for(let r=0;r<t.tensor.nelem;r++)if(Fn(t.tensor.elem[r]))return!0;return!1}return M(t)?[...t].some(Fn):!1}function Df(t,r){let{ndim:e}=t.tensor,o=r.length;o>e&&N("too many indices for tensor");let n=0;for(let c=0;c<o;c++){let x=et(r[c]);(x<1||x>t.tensor.dim[c])&&N("index out of range"),n=n*t.tensor.dim[c]+x-1}if(e===o)return t.tensor.elem[n];n=t.tensor.dim.slice(o).reduce((c,x)=>c*x,n);let i=t.tensor.dim.slice(o).reduce((c,x)=>c*x,1),a=mt(i);a.tensor.ndim=e-o,a.tensor.dim=t.tensor.dim.slice(o);for(let c=0;c<i;c++)a.tensor.elem[c]=t.tensor.elem[n+c];return Dt(t),Dt(a),a}function Bf(t,...r){r.length<2&&N("error in indexed assign");let[e,...o]=r;H(e)||N("error in indexed assign: assigning to something that is not a tensor");let{ndim:n}=e.tensor,i=o.length;i>n&&N("error in indexed assign");let a=0;for(let x=0;x<i;x++){let g=et(o[x]);(g<1||g>e.tensor.dim[x])&&N(`error in indexed assign
`),a=a*e.tensor.dim[x]+g-1}for(let x=i;x<n;x++)a=a*e.tensor.dim[x]+0;let c=mt(e.tensor.nelem);if(c.tensor.ndim=e.tensor.ndim,c.tensor.dim=Array.from(e.tensor.dim),c.tensor.elem=Array.from(e.tensor.elem),Dt(e),Dt(c),e=c,n===i)return H(t)&&N("error in indexed assign"),e.tensor.elem[a]=t,Dt(e),e;H(t)||N("error in indexed assign"),n-i!==t.tensor.ndim&&N("error in indexed assign");for(let x=0;x<t.tensor.ndim;x++)e.tensor.dim[i+x]!==t.tensor.dim[x]&&N("error in indexed assign");for(let x=0;x<t.tensor.nelem;x++)e.tensor.elem[a+x]=t.tensor.elem[x];return Dt(e),Dt(t),e}function q(...t){let r=s(L);for(let e=t.length-1;e>=0;e--)r=new Mr(t[e],r);return r}function Uf(t){let r=we(t),e=Vn(t),o=A(t);return pt(r)||N("function name?"),u(o)===s(io)&&(o=_(l(o))),o=q(s(je),o,e),Jt(r,o),s(L)}function Gf(t){return t}function zf(t){t=m(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>bl(e,_(o)),r)),r}function bl(t,r){return $r(gg,t,r)}function gg(t,r){return gr($($(Lr(t,r),t),r))}function Ff(t){t=m(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>so(e,_(o)),r)),r}function so(t,r){return bg(t,r)}function bg(t,r){return W(t)?_g(t,r):H(t)?hg(t,r):it(t,r)?f.zero:t}function _g(t,r){return M(t)?t.tail().reduce((e,o)=>I(e,so(o,r)),f.zero):f.zero}function hg(t,r){let e=t.tensor.nelem,o=mt(e);return o.tensor.ndim=t.tensor.ndim,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(n=>so(n,r)),o}function Gt(t,r,e){if(r===s(L)||e===s(L))return t;if(H(t)){let o=mt(t.tensor.nelem);return o.tensor.ndim=t.tensor.ndim,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(n=>{let i=Gt(n,r,e);return Dt(o),i}),o}return ot(t,r)?e:M(t)?new Mr(Gt(u(t),r,e),Gt(m(t),r,e)):t}function Vf(t){let r=_(zt(t)),e=_(A(t)),o=_(l(t));return r===s(L)&&(r=e,e=s(Xr)),so($(o,T(e,r)),e)}function Oe(t,r){let e=[];for(;;){let o=_(Gt(t,r,f.zero));if(e.push(o),t=Q(t,o),ot(t,f.zero))return e;t=$r($,t,r)}}var vg=!1;function Zf(t){return Yi(_(l(t)))}function Yi(t){let r=q(s(ut),f.negOne,$(Sr(t),f.Pi())),e=p(be(t),r);return vg&&(console.log(`clockform: abs of ${t} : ${be(t)}`),console.log(`clockform: arg of ${t} : ${Sr(t)}`),console.log(`clockform: divide : ${$(Sr(t),f.Pi())}`),console.log(`clockform: power : ${r}`),console.log(`clockform: multiply : ${e}`)),e}function Yf(t){return ji(_(l(t)))}function ji(t){return jf(()=>p(be(t),lr(p(f.imaginaryunit,Sr(t)))))}function Hf(t){return t=_(l(t)),it(t,f.imaginaryunit)?Te(t):Yi(Te(ji(t)))}function Te(t){return _(Gt(t,f.imaginaryunit,U(f.imaginaryunit)))}function mr(t){return it(t,s(Xr))?s(Xr):it(t,s(ao))?s(ao):it(t,s(lo))?s(lo):it(t,s(Yo))?s(Yo):it(t,s(Zo))?s(Zo):s(Xr)}var Xf=_n(Vo());function Cs(t,r){return t.add(r)}function Qf(t,r){return t.subtract(r)}var Jf=_n(Vo());function He(t,r){return Jf.default.gcd(t,r)}function yr(t,r){return t.multiply(r)}function kr(t,r){return t.divide(r)}function Zn(t,r){return t.mod(r)}function Wf(t,r){let e=t.divmod(r);return[e.quotient,e.remainder]}function Ps(t){return t.isProbablePrime()}var wr=(0,Xf.default)(0);function Kf(t){if(wt(t,0)||wt(t,1)||wt(t,-1))return t;wr=t.q.a;let r=yg();return r.length==1?r[0]:q(s(Ht),...r)}function yg(){let t=[];wr.isNegative()&&(wr=Yn(wr,1),t.push(f.negOne));for(let r=0;r<1e4;r++)if(t.push(...Eg(r)),wr.compare(1)===0)return t;return t.push(...Ag()),t}function Eg(t){let r=[],e,o=Lo(jn[t]),n=0;for(;;){if(wr.compare(1)===0)return n&&r.push(Hi(o,n)),r;let i;if([e,i]=Array.from(Wf(wr,o)),i.isZero())n++,wr=e;else break}return n&&r.push(Hi(o,n)),hn(e,o)===-1&&(r.push(Hi(wr,1)),wr=Lo(1)),r}function Ag(){let t=[],r=Lo(1),e=Lo(5),o=Lo(2),n=1,i=1;for(;;){if(Ps(wr))return t.push(Hi(wr,1)),t;for(;;){h.esc_flag&&N("esc");let a=Qf(o,e);a=Yn(a,1);let c=He(a,wr);if(Wt(c,1)){--n===0&&(o=e,i*=2,n=i),a=yr(e,e),e=Cs(a,r),a=Zn(e,wr),e=a;continue}if(t.push(Hi(c,1)),hn(c,wr)===0)return t;a=kr(wr,c),wr=a,a=Zn(e,wr),e=a,a=Zn(o,wr),o=a;break}}}function Hi(t,r){let e=new Ot(t);return r>1&&(e=q(s(ut),e,new Ot(Lo(r)))),e}function ru(t){let r=_(l(t)),e=_(A(t)),o=e===s(L)?mr(r):e,n=Qi(r,o);return t=jo(t),M(t)&&(n=[...t].reduce((i,a)=>qg(i,_(a)),n)),n}function qg(t,r){if(Y(t)){let o=[];return t.tail().forEach(n=>tu(o,n,r)),ks(o)}let e=[];return tu(e,t,r),e[0]}function tu(t,r,e){let o=_e(r,e);if(Y(o)){t.push(...o.tail());return}t.push(o)}function Qi(t,r){return qt(t)?Kf(t):_e(t,r)}function yn(t){isNaN(t)&&N("number too big to factor");let r=[];t<0&&(t=-t);for(let e=0;e<Hn;e++){let o=jn[e];if(o>t/o)break;let n=0;for(;t%o===0;)t/=o,n++;n&&(r.push(y(o)),r.push(y(n)))}return t>1&&(r.push(y(t)),r.push(f.one)),r}function eu(t){let r=Ds(t),e=r.length;r.sort(Ne);let o=mt(e);return o.tensor.ndim=1,o.tensor.dim[0]=e,o.tensor.elem=r,o}var Mg=t=>[].concat(...t);function Ds(t){let r=[];if(C(t))r.push(...yn(et(t)));else if(W(t))r.push(...Sg(t));else if(Y(t)){if(t=m(t),C(u(t))&&(r.push(...yn(et(u(t)))),t=m(t)),M(t)){let o=[...t].map(n=>tt(n)?[l(n),A(n)]:[n,f.one]);r.push(...Mg(o))}}else tt(t)?r.push(l(t),A(t)):r.push(t,f.one);let e=r.length;return r.push(f.one),ou(r,0,e),r.slice(e)}function ou(t,r,e){let o=t.pop();if(r===e){t.push(o);return}let n=t[r+0],i=t[r+1],a=et(i);if(!isNaN(a))for(let c=0;c<=Math.abs(a);c++)t.push(p(o,T(n,y(En(a)*c)))),ou(t,r+2,e)}function Sg(t){let r=M(t)?t.tail().reduce(Lr):u(t),e=[],o=r;if(Et(o))return e.push(t,f.one),e;if(C(o))e.push(...yn(et(o)));else if(Y(o)){let i=m(o);C(u(i))?e.push(...yn(et(u(i)))):e.push(u(i),f.one),M(i)&&i.tail().forEach(a=>e.push(a,f.one))}else e.push(o,f.one);o=gr(o);let n=M(t)?t.tail().reduce((i,a)=>I(i,p(o,a)),f.zero):m(t);return e.push(n,f.one),e}function nu(t){let r=_(l(t)),e=_(A(t)),o=_(zt(t));return o===s(L)&&(o=s(Xr)),Ji(r,e,o)}function Ji(t,r,e){let o=Oe(t,e),n=o.length-1,i=Oe(r,e),a=i.length-1,c=n-a,x=f.zero;for(;c>=0;){let g=$(o[n],i[a]);for(let v=0;v<=a;v++)o[c+v]=Q(o[c+v],p(i[v],g));x=I(x,p(g,T(e,y(c)))),n--,c--}return x}function iu(t){return br(_(l(t)))}function br(t){return W(t)?wg(t):su(t)}function wg(t){let r=m(t);for(;M(r);){let e=u(r);if(Qn(e)){let o=Q(t,e);return I(p(br(o),Or(e)),p(Or(o),br(e)))}r=m(r)}return su(t)}function su(t){if(u(t)===s(Qe))return l(t);if(X(t)){let e=Math.sin(t.d);return Math.abs(e)<1e-10&&(e=0),K(e)}if(se(t))return U(br(U(t)));if(u(t)===s(Fr))return p(l(t),T(I(f.one,T(l(t),y(2))),P(-1,2)));let r=et($(p(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(fr),t);switch(r%360){case 0:case 180:return f.zero;case 30:case 150:return P(1,2);case 210:case 330:return P(-1,2);case 45:case 135:return p(P(1,2),T(y(2),P(1,2)));case 225:case 315:return p(P(-1,2),T(y(2),P(1,2)));case 60:case 120:return p(P(1,2),T(y(3),P(1,2)));case 240:case 300:return p(P(-1,2),T(y(3),P(1,2)));case 90:return f.one;case 270:return f.negOne;default:return q(s(fr),t)}}function au(t){return Or(_(l(t)))}function Or(t){return W(t)?Og(t):lu(t)}function Og(t){if(M(t)){for(let r of t.tail())if(Qn(r)){let e=Q(t,r);return Q(p(Or(e),Or(r)),p(br(e),br(r)))}}return lu(t)}function lu(t){if(u(t)===s(Je))return l(t);if(X(t)){let e=Math.cos(t.d);return Math.abs(e)<1e-10&&(e=0),K(e)}if(se(t)&&(t=U(t)),u(t)===s(Fr)){let e=I(f.one,T(l(t),y(2)));return T(e,P(-1,2))}let r=et($(p(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(ur),t);switch(r%360){case 90:case 270:return f.zero;case 60:case 300:return P(1,2);case 120:case 240:return P(-1,2);case 45:case 315:return p(P(1,2),T(y(2),P(1,2)));case 135:case 225:return p(P(-1,2),T(y(2),P(1,2)));case 30:case 330:return p(P(1,2),T(y(3),P(1,2)));case 150:case 210:return p(P(-1,2),T(y(3),P(1,2)));case 0:return f.one;case 180:return f.negOne;default:return q(s(ur),t)}}var Wi=!1;function fu(t){return Tr(_(l(t)))}function Tr(t){let r=t;if(Wi&&(console.log(`RECT of ${r}`),console.log(`any clock forms in : ${r} ? ${vn(r,t)}`)),pt(t))return Wi&&console.log(` rect: simple symbol: ${r}`),V(xt(s(fo)))?q(s(Bs),t):t;if(!V(xt(s(fo)))&&!Fn(t)&&!vn(t,t)&&!(it(t,s(fr))&&it(t,s(ur))&&it(t,f.imaginaryunit)))return Wi&&console.log(` rect: simple symbol: ${r}`),t;if(Y(t)&&Se(l(t))&&!V(xt(s(fo))))return t;if(W(t))return Wi&&console.log(` rect - ${r} is a sum `),t.tail().reduce((o,n)=>I(o,Tr(n)),f.zero);let e=p(be(t),I(Or(Sr(t)),p(f.imaginaryunit,br(Sr(t)))));return Wi&&(console.log(` rect - ${r} is NOT a sum `),console.log(` rect - ${r} abs: ${be(t)}`),console.log(` rect - ${r} arg of ${t} : ${t}`),console.log(` rect - ${r} cosine: ${Or(Sr(t))}`),console.log(` rect - ${r} sine: ${br(Sr(t))}`),console.log(` rect - ${r} i * sine: ${p(f.imaginaryunit,br(Sr(t)))}`),console.log(` rect - ${r} cos + i * sine: ${I(Or(Sr(t)),p(f.imaginaryunit,br(Sr(t))))}`),console.log(`rect of ${r} : ${e}`)),e}function _e(t,r){return!it(t,r)||!Dr(t,r)||!pt(r)?t:Tg(t,r)}function Tg(t,r){let e,o,n,i;An(t)&&N("floating point numbers in polynomial");let a=Oe(t,r),c=a.length-1,x=Ng(a),g="real",v=null;for(;c>0;){var z,B;if(V(a[0])?(e=f.one,o=f.zero):g==="real"?[B,e,o]=Ig(a,c,r,e,o):g==="complex"&&([z,e]=Rg(v,a,c)),g==="real")if(B===!1){g="complex";continue}else{for(n=I(p(e,r),o),D&&console.log(`success
FACTOR=${n}`),x=uo(x,n),Lg(e,o,a,c);c&&V(a[c]);)c--;let nt=f.zero;for(let ht=0;ht<=c;ht++)nt=I(nt,p(a[ht],T(r,y(ht))));v=nt}else if(g==="complex"){if(z===!1)break;{let nt=Q(e,r),ht=Q(Te(e),r);n=p(nt,ht),D&&console.log(`success
FACTOR=${n}`);let $t=x;if(x=uo(x,n),v==null){let vr=f.zero;for(let Rr=0;Rr<=c;Rr++)vr=I(vr,p(a[Rr],T(r,y(Rr))));v=vr}let xr=r,ar=n,kt=v;v=Ji(kt,ar,xr);let nr=p(v,n);if(!ot(nr,kt))return D&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${$t} * ${kt}`)),uo($t,Vr(Jn,kt));for(let vr=0;vr<=c;vr++)a.pop();a.push(...Oe(v,r)),c-=2}}}let J=f.zero;for(let nt=0;nt<=c;nt++)J=I(J,p(a[nt],T(r,y(nt))));return t=J,D&&console.log(`POLY=${t}`),t=Vr(Jn,t),c>0&&Ct(a[c])&&(t=U(t),x=uu(x)),x=uo(x,t),D&&console.log(`RESULT=${x}`),x}function Ng(t){let r=f.one;for(let e of t)r=bl(Cr(e),r);for(let e=0;e<t.length;e++)t[e]=p(r,t[e]);return r=he(r),D&&console.log("rationalize_coefficients result"),r}function Ig(t,r,e,o,n){let i,a,c;if(D){let v=f.zero;for(let z=0;z<=r;z++)v=I(v,p(t[z],T(e,y(z))));i=v,console.log(`POLY=${i}`)}let x=Ds(t[r]),g=Ds(t[0]);if(D){console.log("divisors of base term");for(let v=0;v<g.length;v++)console.log(`, ${g[v]}`);console.log("divisors of leading term");for(let v=0;v<x.length;v++)console.log(`, ${x[v]}`)}for(let v=0;v<x.length;v++)for(let z=0;z<g.length;z++){if(o=x[v],n=g[z],a=U($(n,o)),c=Xi(a,t,r),D&&console.log(`try A=${o}
, B=${n}
, root ${e}
=-B/A=${a}
, POLY(${a}
)=${c}`),V(c))return D&&console.log("get_factor_from_real_root returning true"),[!0,o,n];if(n=U(n),a=U(a),c=Xi(a,t,r),D&&console.log(`try A=${o}
, B=${n}
, root ${e}
=-B/A=${a}
, POLY(${a}
)=${c}`),V(c))return D&&console.log("get_factor_from_real_root returning true"),[!0,o,n]}return D&&console.log("get_factor_from_real_root returning false"),[!1,o,n]}function Rg(t,r,e){let o,n,i,a;if(e<=2)return D&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,n];if(o=t,D&&console.log(`complex root finding for POLY=${o}`),n=Tr(T(f.negOne,P(2,3))),D&&console.log(`complex root finding: trying with ${n}`),i=n,a=Xi(i,r,e),D&&console.log(`complex root finding result: ${a}`),V(a))return D&&console.log("get_factor_from_complex_root returning true"),[!0,n];if(n=Tr(T(f.one,P(2,3))),D&&console.log(`complex root finding: trying with ${n}`),i=n,a=Xi(i,r,e),D&&console.log(`complex root finding result: ${a}`),V(a))return D&&console.log("get_factor_from_complex_root returning true"),[!0,n];for(let c=-10;c<=10;c++)for(let x=1;x<=5;x++){n=Tr(I(y(c),p(y(x),f.imaginaryunit)));let v=Xi(n,r,e);if(V(v))return D&&console.log(`found complex root: ${v}`),[!0,n]}return D&&console.log("get_factor_from_complex_root returning false"),[!1,n]}function Lg(t,r,e,o){let n=f.zero;for(let i=o;i>0;i--){let a=$(e[i],t);e[i]=n,n=a,e[i-1]=Q(e[i-1],p(n,r))}e[0]=n,D&&console.log("yydivpoly Q:")}function Xi(t,r,e){let o=f.zero;for(let n=e;n>=0;n--)D&&(console.log("Evalpoly top of stack:"),console.log(Kr(o))),o=I(p(o,t),r[n]);return o}function mu(t){t=m(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>Lr(e,_(o)),r)),r}function Lr(t,r){return $r($g,t,r)}function $g(t,r){let e;return ot(t,r)?t:lt(t)&&lt(r)?pu(t,r):(e=hl(t,r))?Cg(t,r,e):W(t)&&W(r)?Pg(t,r):(W(t)&&(t=cu(t)),W(r)&&(r=cu(r)),Y(t)?kg(t,r):Y(r)?Dg(t,r):Y(t)&&Y(r)?du(t,r):xu(t,r))}function hl(t,r){let e;if((e=_l(t))&&_l(r,e))return e}function Cg(t,r,e){return t=_e(t,e),r=_e(r,e),(Y(t)||Y(r))&&(Y(t)||(t=q(s(Ht),t,f.one)),Y(r)||(r=q(s(Ht),r,f.one))),Y(t)&&Y(r)?du(t,r):xu(t,r)}function du(t,r){let e=m(t),o=m(r);if(M(e))return[...e].reduce((n,i)=>{if(M(o))return p(n,[...o].reduce((a,c)=>p(a,Lr(i,c)),f.one))},f.one)}function xu(t,r){let e,o,n;if(tt(t)?(e=A(t),t=l(t)):e=f.one,tt(r)?(o=A(r),r=l(r)):o=f.one,!ot(t,r))return f.one;if(C(e)&&C(o)){let c=cr(e,o)?e:o;return T(t,c)}let i=$(e,o);if(C(i)){i=Y(e)&&C(l(e))?l(e):f.one,n=Y(o)&&C(l(o))?l(o):f.one;let c=cr(i,n)?e:o;return T(t,c)}if(i=Q(e,o),!C(i))return f.one;let a=It(i)?e:o;return T(t,a)}function Pg(t,r){let e,o,n,i;return _r(t)!==_r(r)?f.one:(e=M(t)?t.tail().reduce(Lr):u(m(t)),o=M(r)?r.tail().reduce(Lr):u(m(r)),n=$(t,e),i=$(r,o),ot(n,i)?p(n,Lr(e,o)):f.one)}function cu(t){return M(t)?t.tail().reduce(Lr):u(m(t))}function kg(t,r){return M(t)?t.tail().reduce((e,o)=>p(e,Lr(o,r)),f.one):f.one}function Dg(t,r){return M(r)?r.tail().reduce((e,o)=>p(e,Lr(t,o)),f.one):f.one}function gu(t){return Wn(_(l(t)))}function Wn(t){return Vr(Jn,t)}function Jn(t){if(!W(t))return t;let r=t.tail().reduce(Lr),e=gr(r),o=t.tail().reduce((i,a)=>I(i,uo(e,a)),f.zero),n=vl(o);return $(n,e)}function vu(t){return te(_(l(t)))}function te(t){let r=h.expanding,e=Bg(t);return h.expanding=r,e}function Bg(t){if(H(t))return Gg(t);if(h.expanding=!1,!W(t))return t;let r=Ug(t),e=f.zero;return M(t)&&(e=t.tail().reduce((o,n)=>I(o,p(r,n)),e)),$(Wn(e),r)}function Ug(t){return W(t)?t.tail().reduce((r,e)=>bu(e,r),f.one):bu(t,f.one)}function bu(t,r){return Y(t)?t.tail().reduce((e,o)=>_u(o,e),r):_u(t,r)}function _u(t,r){if(!tt(t))return r;let e=t;return t=A(t),It(t)?hu(r,gr(e)):Y(t)&&It(l(t))?hu(r,gr(e)):r}function Gg(t){return t=_(t),H(t)&&(t.tensor.elem=t.tensor.elem.map(te),Dt(t)),t}function hu(t,r){return $(p(t,r),Lr(t,r))}function yu(t){return Cr(_(l(t)))}function Cr(t){return W(t)&&(t=te(t)),Y(t)&&!Et(u(m(t)))?ae(t.tail().map(Cr)):lt(t)?Ie(t):tt(t)&&Ct(A(t))?he(t):f.one}function Eu(t){return Zr(_(l(t)))}function Zr(t){return W(t)&&(t=te(t)),Y(t)&&!Et(u(m(t)))?ae(t.tail().map(Zr)):lt(t)?Re(t):tt(t)&&Ct(A(t))?f.one:t}function Au(t){return Us(_(l(t)))}function Us(t){if(u(t)===s(ve))return l(t);if(X(t))return K(Math.atan(t.d));if(V(t))return f.zero;if(se(t))return U(Us(U(t)));if(it(t,s(fr))&&it(t,s(ur))){let r=Zr(t),e=Cr(t);if(u(r)===s(fr)&&u(e)===s(ur)&&ot(l(r),l(e)))return l(r)}return tt(t)&&wt(l(t),3)&&Ft(A(t),-1,2)||Y(t)&&Ft(u(m(t)),1,3)&&u(u(m(m(t))))===s(ut)&&wt(u(m(u(m(m(t))))),3)&&Ft(u(m(m(u(m(m(t)))))),1,2)?p(P(1,6),f.Pi()):wt(t,1)?p(P(1,4),f.Pi()):tt(t)&&wt(l(t),3)&&Ft(A(t),1,2)?p(P(1,3),f.Pi()):q(s(Fr),t)}var zg=!1;function qu(t){return Ho(_(l(t)))}function Ho(t){let r=Tr(t),e=Te(r),o=$(Q(r,e),y(2)),n=$(o,f.imaginaryunit);return zg&&(console.log(`IMAGE of ${r}`),console.log(` image: conjugate result: ${e}`),console.log(` image: 1st divide result: ${o}`),console.log(` image: 2nd divide result: ${n}`)),n}function Mu(t){return Yr(_(l(t)))}function Yr(t){let r=Tr(t);return $(I(r,Te(r)),y(2))}var Fg=!1;function wu(t){return Sr(_(l(t)))}function Sr(t){return Q(Su(Zr(t)),Su(Cr(t)))}function Su(t){if(qn(t)||t===s(vt))return X(t)||h.evaluatingAsFloats?f.zeroAsDouble:f.zero;if(It(t)){let r=X(t)||h.evaluatingAsFloats?f.piAsDouble:s(vt);return U(r)}if(pt(t))return q(s(Ki),t);if(tt(t)&&wt(l(t),-1))return p(f.Pi(),A(t));if(tt(t)&&l(t)===s(rr))return Ho(A(t));if(tt(t)&&Le(A(t))){let r=Sr(l(t));return Fg&&(console.log(`arg of a sqrt: ${t}`),er,console.log(` = 1/2 * ${r}`)),p(r,A(t))}if(Y(t))return t.tail().map(Sr).reduce(I,f.zero);if(W(t)){t=Tr(t);let r=Yr(t),e=Ho(t);if(V(r))return se(e)?U(f.Pi()):f.Pi();{let o=Us($(e,r));return se(r)?se(e)?Q(o,f.Pi()):I(o,f.Pi()):o}}return V(xt(s(fo)))?q(s(Ki),t):f.zero}function Ou(t,r){if(t===0&&r<0&&N("divide by zero"),t>=0||r%1===0)return K(Math.pow(t,r));let e=Math.pow(Math.abs(t),r),o=Math.PI*r,n=0,i=0;return r%.5===0?(n=0,i=Math.sin(o)):(n=Math.cos(o),i=Math.sin(o)),I(K(n*e),p(K(i*e),f.imaginaryunit))}function Ar(t){let r=et(t);return r<0||isNaN(r)?q(s(Br),t):Tu(r)}var Lu=_n(Vo());function $o(t,r){return t.pow(r)}var ts=_n(Vo());function Nu(t,r){t=t.abs(),r===0&&N("root index is zero");let e=0;for(;t.shiftRight(e).toJSNumber()>0;)e++;if(e===0)return Lo(0);e=Math.floor((e-1)/r);let o=Math.floor(e/32+1),n=(0,ts.default)(o);for(let i=0;i<o;i++)n=n.and((0,ts.default)(1).shiftLeft(i).not());for(;e>=0;){n=n.or((0,ts.default)(1).shiftLeft(e));let i=$o(n,r);switch(hn(i,t)){case 0:return n;case 1:n=n.and((0,ts.default)(1).shiftLeft(e).not());break}e--}return 0}function Iu(t,r){let e=yn(et(t)),o=e.length;for(let n=0;n<o;n+=2)e.push(...Vg(e[n],p(e[n+1],r)));return ae(e.slice(o))}function Vg(t,r){let e=Gs(r),o=Q(r,e),n;V(o)||(n=q(s(ut),t,o));let i=et(e);if(isNaN(i)){let c=q(s(ut),t,e);return n?[n,c]:[c]}if(i===0)return[n];let a=Ru(t,i);return n?[n,a]:[a]}function Xn(t,r){return Zg(t,r)}function Zg(t,r){if(Et(t)||V(r))return f.one;if(Nt(t)&&Le(r))return f.imaginaryunit;if(V(t))return It(r)&&N("divide by zero"),f.zero;if(Et(r))return t;let e=0,o,n;if(qt(r)){if(e=et(r),isNaN(e))return q(s(ut),t,r);if(o=$o(t.q.a,Math.abs(e)),n=$o(t.q.b,Math.abs(e)),e<0){let c=o;o=n,n=c,o=co(o,n),n=$u(n)}return new Ot(o,n)}if(Nt(t))return Yg(r);if(It(t))return p(Xn(U(t),r),Xn(f.negOne,r));if(!qt(t))return p(Xn(Re(t),r),Xn(Ie(t),U(r)));if(jg(t))return Iu(t,r);if(!rs(r.q.a)||!rs(r.q.b))return q(s(ut),t,r);let{a:i,b:a}=r.q;return o=Nu(t.q.a,a.toJSNumber()),o===0?q(s(ut),t,r):(n=$o(o,i),r.q.a.isNegative()?new Ot(Lu.default.one,n):new Ot(n))}function Yg(t){if(qt(t))return t.q.a.isOdd()?f.negOne:f.one;let r=Gs(t);It(t)&&(r=I(r,f.negOne));let e=Q(t,r),o=q(s(ut),f.negOne,e);return r.q.a.isOdd()&&(o=U(o)),o}function jg(t){return rs(t.q.a)}var Vt=!1;function Cu(t){Vt&&er;let r=_(l(t)),e=_(A(t));return T(r,e)}function T(t,r){return Hg(t,r)}function Hg(t,r){Vt&&er;let e=r,o=t;if(Vt&&console.log(`POWER: ${t} ^ ${r}`),ot(t,f.one)||V(r)){let g=f.One();return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(ot(r,f.one))return Vt&&console.log(`   power of ${o} ^ ${e}: ${t}`),t;if(Nt(t)&&Nt(r)){let g=U(f.One());return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(Nt(t)&&Le(r)){let g=f.imaginaryunit;return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(Nt(t)&&os(r)){let g=U(f.imaginaryunit);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}let n;if(Nt(t)&&!X(t)&&lt(r)&&!qt(r)&&qn(r)&&!h.evaluatingAsFloats){Vt&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${r.q.a} , ${r.q.b}`)),r.q.a<r.q.b?n=q(s(ut),t,r):(n=q(s(Ht),t,q(s(ut),t,P(r.q.a.mod(r.q.b),r.q.b))),Vt&&console.log(` trick applied : ${n}`));let g=Tr(n);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(lt(t)&&lt(r)){Vt&&console.log("   power: isrational(base) && isrational(exponent)");let g=Xn(t,r);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(C(t)&&C(r)){let g=Ou(mo(t),mo(r));return Vt&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(H(t)){let g=Du(t,r);return Vt&&(console.log("   power: istensor(base) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(u(t)===s($e)&&Mn(r)&&!V(xt(s(fo)))){let g=T(l(t),r);return Vt&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(t===s(rr)&&u(r)===s(Jo)){let g=l(r);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(t===s(rr)&&X(r)){let g=K(Math.exp(r.d));return Vt&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(t===s(rr)&&it(r,f.imaginaryunit)&&it(r,s(vt))&&!h.evaluatingPolar){let g=q(s(ut),t,r);Vt&&console.log(`   power: turning complex exponential to rect: ${g}`);let v=Tr(g);if(!it(v,s(vt)))return Vt&&console.log(`   power: turned complex exponential to rect: ${v}`),v}if(Y(t)&&qt(r)){t=m(t);let g=T(u(t),r);return M(t)&&(g=t.tail().reduce((v,z)=>p(v,T(z,r)),g)),Vt&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}let i=!1;if(C(l(t))&&(i=En(zs(l(t),f.zero))>0),tt(t)&&(qt(r)||i)){let g=T(l(t),p(A(t),r));return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}let a=!1;if(Mn(A(t))){let g=p(A(t),r);We(g)&&(a=!0)}if(tt(t)&&a){let g=be(l(t));return Vt&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(h.expanding&&W(t)&&C(r)){let g=et(r);if(g>1&&!isNaN(g)){Vt&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let v=Qg(g,t);return Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}}if(h.trigmode===1&&u(t)===s(fr)&&Mn(r)){let g=T(Q(f.one,T(Or(l(t)),y(2))),p(r,P(1,2)));return Vt&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(h.trigmode===2&&u(t)===s(ur)&&Mn(r)){let g=T(Q(f.one,T(br(l(t)),y(2))),p(r,P(1,2)));return Vt&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(Qo(t)){if(Vt&&console.log(" power - handling the case (a + ib) ^ n"),qt(r)){let g=Te(t),v=$(g,p(g,t));return We(r)||(v=T(v,U(r))),Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}if(C(r)){let g=h.evaluatingAsFloats||ku(t)&&X(r)?K(Math.PI):s(vt),v=p(T(be(t),r),T(f.negOne,$(p(Sr(t),r),g)));return Bu&&it(v,s(Fr))&&(v=q(s(ut),t,r)),Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}}let c=Jg(r);if(c!==void 0)return Vt&&console.log("   power: using simplify_polar"),c;let x=q(s(ut),t,r);return Vt&&(console.log("   power: nothing can be done "),console.log(`   power of ${o} ^ ${e}: ${x}`)),x}function Qg(t,r){let e=[],o=_r(r)-1,n=[];r=m(r);for(let i=0;i<o;i++){for(let a=0;a<=t;a++)n[i*(t+1)+a]=T(u(r),y(a));r=m(r)}r=Ar(y(t));for(let i=0;i<o;i++)e[i]=0;return Pu(o,t,e,0,t,n,r,f.zero)}function Pu(t,r,e,o,n,i,a,c){if(o<t-1){for(let g=0;g<=n;g++)e[o]=g,c=Pu(t,r,e,o+1,n-g,i,a,c);return c}e[o]=n;let x=a;for(let g=0;g<t;g++)x=$(x,Ar(y(e[g])));for(let g=0;g<t;g++)x=p(x,i[g*(r+1)+e[g]]);return I(c,x)}function Jg(t){let r=es(t);switch(r){case 0:break;case 1:return f.one;case 2:return f.negOne;case 3:return f.imaginaryunit;case 4:return U(f.imaginaryunit)}if(W(t)){let e=m(t);for(;M(e)&&(r=es(u(e)),!r);)e=m(e);let o;switch(r){case 0:return;case 1:o=f.one;break;case 2:o=f.negOne;break;case 3:o=f.imaginaryunit;break;case 4:o=U(f.imaginaryunit);break}return p(o,lr(Q(t,u(e))))}}function Uu(t){let r=_(l(t));return t=Er(t),M(t)&&(r=[...t].reduce((e,o)=>p(e,_(o)),r)),r}function p(t,r){return h.esc_flag&&N("escape key stop"),C(t)&&C(r)?ns(t,r):Wg(t,r)}function Wg(t,r){if(Kn(t)||Kn(r))return f.Zero();if(h.expanding&&W(t))return t.tail().reduce((x,g)=>I(x,p(g,r)),f.Zero());if(h.expanding&&W(r))return r.tail().reduce((x,g)=>I(x,p(t,g)),f.Zero());if(!H(t)&&H(r))return ri(t,r);if(H(t)&&!H(r))return ti(t,r);t=Y(t)?m(t):q(t),r=Y(r)?m(r):q(r);let e=[];if(C(u(t))&&C(u(r))){let x=u(t),g=u(r);e.push(ns(x,g)),t=m(t),r=m(r)}else C(u(t))?(e.push(u(t)),t=m(t)):C(u(r))?(e.push(u(r)),r=m(r)):e.push(f.One());let[o,n]=Fs(t),[i,a]=Vs(r);for(;M(t)&&M(r);){if(jr(t)===s(Wo)&&jr(r)===s(Wo)){e.push(new Mr(s(Wo),Gu(is(t),is(r)))),t=m(t),r=m(r),[o,n]=Fs(t),[i,a]=Vs(r);continue}switch(Ne(o,i)){case-1:e.push(u(t)),t=m(t),[o,n]=Fs(t);break;case 1:e.push(u(r)),r=m(r),[i,a]=Vs(r);break;case 0:Xg(e,i,n,a),t=m(t),r=m(r),[o,n]=Fs(t),[i,a]=Vs(r);break;default:N("internal error 2")}}if(M(t)&&e.push(...t),M(r)&&e.push(...r),Kg(e),h.expanding){for(let x=0;x<e.length;x++)if(W(e[x]))return ae(e)}let c=e.length;return c===1?e.pop():lt(e[0])&&wt(e[0],1)?c===2?e.pop():(e[0]=s(Ht),q(...e)):new Mr(s(Ht),q(...e))}function Fs(t){let r=u(t),e=f.One();return tt(r)&&(e=A(r),r=l(r)),[r,e]}function Vs(t){let r=u(t),e=f.One();return tt(r)&&(e=A(r),r=l(r)),[r,e]}function Xg(t,r,e,o){let n=T(r,I(e,o));if(C(n))t[0]=ns(t[0],n);else if(Y(n))if(C(l(n))&&jo(n)===s(L)){let i=t[0],a=l(n);t[0]=ns(i,a),t.push(A(n))}else t.push(n);else t.push(n)}function uo(t,r){return Vr(p,t,r)}function ae(t){if(t.length===1)return t[0];if(t.length===0)return f.One();let r=t[0];for(let e=1;e<t.length;e++)r=p(r,t[e]);return r}function ks(t){return Vr(ae,t)}function $(t,r){return C(t)&&C(r)?zu(t,r):p(t,gr(r))}function gr(t){return C(t)?Fu(t):T(t,f.negOne)}function he(t){return gr(t)}function U(t){return C(t)?Vu(t):p(t,f.NegOne())}function uu(t){return Vr(U,t)}function Kg(t){let r=0;if(Et(t[0])||Nt(t[0])||X(t[0]))return;for(r=1;r<t.length&&!yl(t[r]);r++);if(r===t.length)return;let e=Re(t[0]);for(let n=1;n<t.length&&!(Et(e)||Nt(e));n++){if(!yl(t[n]))continue;let i=l(t[n]),a=A(t[n]);if(!It(a))continue;let c=$(e,i);!qt(c)||(e=c,t[n]=q(s(ut),i,I(f.One(),a)))}let o=Ie(t[0]);for(let n=1;n<t.length&&!Et(o);n++){if(!yl(t[n]))continue;let i=l(t[n]),a=A(t[n]);if(It(a))continue;let c=$(o,i);if(!qt(c))continue;o=c;let x=Q(a,f.one);if(Zu&&qt(i)&&!qt(x)&&It(x)){e=$(e,i);break}t[n]=q(s(ut),i,x)}t[0]=$(e,o)}function yl(t){return tt(t)&&C(l(t))&&or(A(t))&&!Nt(l(t))}function Ys(t){if(!Co(t))return q(s(js),t);let r=t.tensor.elem;return r.every(o=>C(o))?t0(t):El(r,t.tensor.dim[0])}function El(t,r){let e=0,o=[];for(let a=0;a<r;a++)o[a]=a,o[a+r]=0,o[a+r+r]=1;let n=1,i=f.zero;for(;;){let a=y(n);for(let z=0;z<r;z++){let B=r*o[z]+z;a=p(a,t[B])}i=I(i,a);let c=r-1,x=0,g=!1;for(;;){if(e=o[r+c]+o[r+r+c],e<0){o[r+r+c]=-o[r+r+c],c--;continue}if(e===c+1){if(c===0){g=!0;break}x++,o[r+r+c]=-o[r+r+c],c--;continue}break}if(g)break;let v=o[c-o[r+c]+x];o[c-o[r+c]+x]=o[c-e+x],o[c-e+x]=v,o[r+c]=e,n=n===1?-1:1}return i}function t0(t){let r=t.tensor.dim[0],e=[...t.tensor.elem];return r0(e,r)}function xo(t,r,e,o){return t[r*e+o]}function Zs(t,r,e,o,n){t[r*e+o]=n}function r0(t,r){let e=f.one;for(let o=0;o<r-1;o++){if(ot(xo(t,r,o,o),f.zero)){let n=0;for(n=o+1;n<r&&ot(xo(t,r,n,o),f.zero);n++);if(n===r){e=f.zero;break}for(let i=o;i<r;i++){let a=xo(t,r,o,i);Zs(t,r,o,i,xo(t,r,n,i)),Zs(t,r,n,i,a)}e=U(e)}e=p(e,xo(t,r,o,o));for(let n=o+1;n<r;n++){let i=U($(xo(t,r,n,o),xo(t,r,o,o)));Zs(t,r,n,o,f.zero);for(let a=o+1;a<r;a++){let c=I(p(xo(t,r,o,a),i),xo(t,r,n,a));Zs(t,r,n,a,c)}}}return p(e,xo(t,r,r-1,r-1))}function Hs(t,r){return e0(t,r)}function e0(t,r){let e=et(r);return e<0||isNaN(e)?q(s(ei),t,r):pt(t)?Yu(e,t):_(Gt(Yu(e,s(Pt)),s(Pt),t))}function Yu(t,r){let e=f.zero,o=f.one;for(let n=0;n<t;n++){let i=e;e=o,o=p(Q(p(r,e),p(y(n),i)),y(2))}return o}function ju(t){let r=et(t);if(r<2)return q(s(Qs),t);let e=Hu(r,r);for(let o=0;o<r;o++)for(let n=0;n<r;n++)e.tensor.elem[o*r+n]=gr(y(o+n+1));return e}function Qu(t){let r=_(l(t));Co(r)||N("cofactor: 1st arg: square matrix expected");let e=r.tensor.dim[0],o=Hr(A(t));(o<1||o>e)&&N("cofactor: 2nd arg: row index expected");let n=Hr(zt(t));return(n<1||n>e)&&N("cofactor: 3rd arg: column index expected"),Al(r,e,o-1,n-1)}function Al(t,r,e,o){let n=[];for(let a=0;a<r;a++)for(let c=0;c<r;c++)a!==e&&c!==o&&n.push(t.tensor.elem[r*a+c]);let i=El(n,r-1);return(e+o)%2&&(i=U(i)),i}function Ju(t){return ql(_(l(t)))}function ql(t){Co(t)||N("adj: square matrix expected");let r=t.tensor.dim[0],e=mt(r*r);e.tensor.ndim=2,e.tensor.dim[0]=r,e.tensor.dim[1]=r;for(let o=0;o<r;o++)for(let n=0;n<r;n++)e.tensor.elem[r*n+o]=Al(t,r,o,n);return e}function Ws(t){let r=[];r.push(u(m(t))),u(m(m(t)))===s(L)&&N("pattern needs at least a template and a transformed version");let o=m(m(t));for(;o!==s(L);)r.push(u(o)),o=m(o);if(r.length>2){let a=q(s(Po),r[r.length-2],r[r.length-1]);for(let c=2;c<r.length;c++)a=q(s(Po),r[r.length-c-1],a);return Ws(a)}let n=[];Js(t,n);let i=[];for(let a=0;a<n.length;a++)n[a]!==s(Ce)&&i.push(n[a]);if(n=i,i=[],n.length>1){let a=0;for(let c=0;c<n.length&&c+a+1<=n.length-1;c++){if(Pe(n[c+a])||Pe(n[c+a+1]))i.push(n[c+a]);else{let x=po(_(n[c+a])),g=_(n[c+a+1]),v=Q(x,g);V(v)?a+=1:i.push(n[c+a])}if(c+a===n.length-2&&i.push(n[n.length-1]),c+a>=n.length-1)break}n=i}return n.length==0?s(Ce):(n=n.map(_),n.reduce(Ur))}function Ur(t,r){if(Ct(r)&&Ct(t)&&(r=U(r),t=U(t)),ke(t)&&(r=Ur(u(m(m(t))),r),t=u(m(t))),t===s(Ce))return r;if(r===s(Ce))return t;if(H(t)&&H(r))return o0(t,r);if(!(Pe(t)||Pe(r))){let e=Q(t,po(r));if(V(e))return s(Ce)}return h.expanding&&W(t)?t.tail().reduce((e,o)=>I(e,Ur(o,r)),f.zero):h.expanding&&W(r)?r.tail().reduce((e,o)=>I(e,Ur(t,o)),f.zero):H(t)&&C(r)?ti(t,r):C(t)&&H(r)?ri(t,r):C(t)||C(r)?p(t,r):q(s(Po),t,r)}function o0(t,r){let e=t.tensor.dim[t.tensor.ndim-1];e!==r.tensor.dim[0]&&(er,N("inner: tensor dimension check"));let o=t.tensor.ndim+r.tensor.ndim-2;o>ye&&N("inner: rank of result exceeds maximum");let n=t.tensor.elem,i=r.tensor.elem,a=t.tensor.dim.slice(0,t.tensor.dim.length-1).reduce((v,z)=>v*z,1),c=r.tensor.dim.slice(1).reduce((v,z)=>v*z,1),x=mt(a*c),g=x.tensor.elem;for(let v=0;v<a;v++)for(let z=0;z<e;z++)if(!V(n[v*e+z]))for(let B=0;B<c;B++)g[v*c+B]=I(p(n[v*e+z],i[z*c+B]),g[v*c+B]);return o===0?x.tensor.elem[0]:(x.tensor.ndim=o,x.tensor.dim=[...t.tensor.dim.slice(0,t.tensor.ndim-1),...r.tensor.dim.slice(1,r.tensor.ndim)],x)}function Js(t,r){if(!M(t)){Wu(t,r);return}if(m(t)===s(L)){Js(u(t),r);return}if(ke(t)){Js(u(m(t)),r),Js(m(m(t)),r);return}Wu(t,r)}function Wu(t,r){t!==s(L)&&r.push(t)}function po(t){if(Ks(t))return u(m(t));if(ta(t))return t;if(h.expanding&&ke(t)){let o=(M(t)?t.tail():[]).map(po);for(let n=o.length-1;n>0;n--)o[n-1]=Ur(o[n],o[n-1]);return o[0]}if(!Co(t))return q(s(ss),t);if(Pe(t))return Ku(t);let r=Ys(t);return V(r)&&N("inverse of singular matrix"),$(ql(t),r)}function Xu(t){return Co(t)?Ku(t):q(s(Xs),t)}function Ku(t){let r=t.tensor.dim[0],e=new Array(r*r);e.fill(f.zero);for(let i=0;i<r;i++)e[i*r+i]=f.one;let o=n0(e,t.tensor.elem,r),n=mt(r*r);return n.tensor.ndim=2,n.tensor.dim[0]=r,n.tensor.dim[1]=r,n.tensor.elem=o,n}function n0(t,r,e){for(let o=0;o<e;o++){if(ot(r[e*o+o],f.zero)){let i=0;for(i=o+1;i<e&&ot(r[e*i+o],f.zero);i++);i===e&&N("inverse of singular matrix");for(let a=0;a<e;a++){let c=r[e*o+a];r[e*o+a]=r[e*i+a],r[e*i+a]=c,c=t[e*o+a],t[e*o+a]=t[e*i+a],t[e*i+a]=c}}let n=r[e*o+o];for(let i=0;i<e;i++)i>o&&(r[e*o+i]=$(r[e*o+i],n)),t[e*o+i]=$(t[e*o+i],n);for(let i=0;i<e;i++){if(i===o)continue;let a=r[e*i+o];for(let c=0;c<e;c++)c>o&&(r[e*i+c]=Q(r[e*i+c],p(r[e*o+c],a))),t[e*i+c]=Q(t[e*i+c],p(t[e*o+c],a))}}return t}function tc(t){return Ko(_(l(t)),_(A(t)))}function Ko(t,r){return i0(t,r)}function i0(t,r){let e=et(r);if(X(t)&&!isNaN(e)){let o=rc(e,t.d);return K(o)}if(V(t)&&V(r))return f.one;if(V(t)&&!isNaN(e))return f.zero;if(r.k===Zt&&Wt(r.q.b,2)){if(Wt(r.q.a,1)){let n=h.evaluatingAsFloats?K(2/Math.PI):$(y(2),s(vt));return p(T($(n,t),P(1,2)),br(t))}if(Wt(r.q.a,-1)){let n=h.evaluatingAsFloats?K(2/Math.PI):$(y(2),s(vt));return p(T($(n,t),P(1,2)),Or(t))}let o=y(Xe(r.q.a));return Q(p(p($(y(2),t),Q(r,o)),Ko(t,Q(r,o))),Ko(t,Q(r,p(y(2),o))))}return Ct(t)?p(p(T(U(t),r),T(t,U(r))),q(s(Xo),U(t),r)):Ct(r)?p(T(f.negOne,r),q(s(Xo),t,U(r))):q(s(Xo),t,r)}function ec(t){return ra(_(l(t)),_(A(t)))}function ra(t,r){return s0(t,r)}function s0(t,r){let e=et(r);if(X(t)&&!isNaN(e)){let o=oc(e,t.d);return K(o)}return Ct(r)?p(T(f.negOne,r),q(s(Sn),t,U(r))):q(s(Sn),t,r)}function nc(t){return ea(_(l(t)))}function ea(t){if(u(t)===s(tn))return l(t);if(X(t)){let r=Math.cosh(t.d);return Math.abs(r)<1e-10&&(r=0),K(r)}return V(t)?f.one:q(s(go),t)}function ic(t){return Ml(_(l(t)))}function Ml(t){return a0(t)}function a0(t){return X(t)?t.d===0?f.one:f.zero:lt(t)?fe(yr(t.q.a,t.q.b))?f.one:f.zero:tt(t)?q(s(oi),l(t)):Ct(t)?q(s(oi),U(t)):((Ct(t)||W(t)&&Ct(l(t)))&&(t=U(t)),q(s(oi),t))}function sc(t,r){let e=f.one,o=e;if(t=m(t),!M(t))return[e,o];for(let n of t)it(n,r)?o=p(o,n):e=p(e,n);return[e,o]}var Ll=1001,$l=1002,oa=1003,Cl=1004,Ol=1006,Pl=1007,lc=1008,fc=1009,uc=1010,cc=1011,Tl=1012,at="",fs=0,kl=0,De=0,st=0,ii=0,ir="",na=null,Bt=null,ls=null,en=null,si=null,Yt=null,rn=!1,Nl=null,gt="";function _o(t){D&&console.log(`#### scanning ${t}`),na=null,Bt=[],ls=[],en=!0,si=[],Yt=[""],Nl=!1,gt=t,kl=0;let r=h.expanding;if(h.expanding=!0,De=0,st=0,Tt(),at==="")return h.expanding=r,[0,s(L)];let e=Do();return h.expanding=r,Nl||(h.symbolsInExpressionsWithoutAssignments=h.symbolsInExpressionsWithoutAssignments.concat(ls)),[ii-De,e]}function ia(t){gt=t,kl=1;let r=h.expanding;if(h.expanding=!0,De=0,st=0,Tt(),at==="")return h.expanding=r,s(L);let e=Do();return h.expanding=r,e}function Do(){let t=ac(),r=!1;if(at===Tl&&(r=!0),at===Tl||at==="="){let e=na;D&&console.log("assignment!"),Nl=!0,en=!1,Tt();let o=ac();if(r&&(o=q(s(aa),o)),t=q(s(Ee),t,o),en=!0,h.codeGen){let n=Bt.indexOf(e);if(n!==-1&&(Bt.splice(n,1),h.symbolsHavingReassignments.push(e)),D){console.log(`locally, ${e} depends on: `);for(let a of Array.from(Bt))console.log(`  ${a}`)}h.symbolsDependencies[e]==null&&(h.symbolsDependencies[e]=[]);let i=h.symbolsDependencies[e];for(let a of Array.from(Bt))i.indexOf(a)===-1&&i.push(a);Bt=[]}}return t}function ac(){let t=ko(),r;switch(at){case uc:return Tt(),r=ko(),q(s(Ue),t,r);case cc:return Tt(),r=ko(),q(s(sa),q(s(Ue),t,r));case fc:return Tt(),r=ko(),q(s(fi),t,r);case lc:return Tt(),r=ko(),q(s(ai),t,r);case"<":return Tt(),r=ko(),q(s(ui),t,r);case">":return Tt(),r=ko(),q(s(li),t,r)}return t}function ko(){let t=[s(Pr)];switch(at){case"+":Tt(),t.push(as());break;case"-":Tt(),t.push(U(as()));break;default:t.push(as())}for(;fs===0&&(at==="+"||at==="-");)at==="+"?(Tt(),t.push(as())):(Tt(),t.push(U(as())));return t.length===2?t[1]:q(...t)}function Dl(){if(typeof at=="string")return at.charCodeAt(0)}function l0(){if(Dl()===yo)return!0;switch(at){case"*":case"/":return!0;case"(":case oa:case Cl:case Ll:case $l:case Pl:return fs?(st=ii,!1):!0}return!1}function Sl(t){t.length>0&&lt(t[t.length-1])&&wt(t[t.length-1],1)&&t.pop()}function f0(t){if(t.length>1&&C(t[t.length-2])&&C(t[t.length-1])){let r=t.pop(),e=t.pop();t.push(p(e,r))}}function as(){let t=[ni()];for(Rl&&Sl(t);l0();)at==="*"?(Tt(),t.push(ni())):at==="/"?(Sl(t),Tt(),t.push(gr(ni()))):Dl()===yo?(Tt(),t.push(q(s(Po),t.pop(),ni()))):t.push(ni()),Rl&&(f0(t),Sl(t));return t.length===0?f.one:t.length==1?t[0]:q(s(Ht),...t)}function u0(t){return at==="^"?(Tt(),q(s(ut),t,ni())):t}function c0(t){Tt();let r=[s(vo),t,ko()];for(;at===",";)Tt(),r.push(ko());return at!=="]"&&bo("] expected"),Tt(),q(...r)}function ni(){let t=!1,r;for(at==="("?r=b0():at===oa?r=d0():at===Cl?r=p0():at==="["?r=_0():at===Ll?(t=!0,r=pc(ir),at=Tt()):at===$l?(t=!0,r=gc(ir),at=Tt()):at===Pl?r=x0():bo("syntax error");at==="["||at==="("&&fs===0&&!t;)at==="["?r=c0(r):at==="("&&(r=g0(r));for(;at==="!";)Tt(),r=q(s(Br),r);for(;Dl()===fa;)Tt(),r=q(s(Ke),r);return u0(r)}function Il(t){if(la.indexOf(t)===-1&&Bt.indexOf(t)===-1&&Bt.indexOf("'"+t)===-1&&!rn){D&&console.log(`... adding symbol: ${t} to the set of the symbols right of assignment`);let r="";for(let e=1;e<Yt.length;e++)Yt[e]!==""&&(r+=Yt[e]+"_"+e+"_");t=r+t,Bt.push(t)}}function m0(t){if(la.indexOf(t)===-1&&ls.indexOf(t)===-1&&ls.indexOf("'"+t)===-1&&!rn){D&&console.log(`... adding symbol: ${t} to the set of the symbols left of assignment`);let r="";for(let e=1;e<Yt.length;e++)Yt[e]!==""&&(r+=Yt[e]+"_"+e+"_");t=r+t,ls.push(t)}}function d0(){at!==oa&&bo("symbol expected");let t;if(kl&&typeof ir=="string"&&ir.length===1)switch(ir[0]){case"a":t=s(ue);break;case"b":t=s(ce);break;case"x":t=s(re);break;default:t=Be(ir)}else t=Be(ir);return si.length===0?(D&&console.log(`out of scanning parameters, processing ${ir}`),na=ir,en&&m0(ir)):(D&&console.log(`still scanning parameters, skipping ${ir}`),en&&Il("'"+ir)),D&&console.log(`found symbol: ${ir} left of assignment: ${en}`),en||Il(ir),Tt(),t}function x0(){let t=new ho(ir);return Tt(),t}function p0(){D&&console.log("-- scan_function_call_with_function_name start");let t=1,e=[Be(ir)],o=ir;if((o==="roots"||o==="defint"||o==="sum"||o==="product"||o==="for")&&Yt.push(ir),na=ir,en||Il(ir),Tt(),Tt(),si.push(!0),at!==")"){for(e.push(Do()),t++;at===",";)Tt(),t===2&&Yt[Yt.length-1].indexOf("roots")!==-1&&(Bt=Bt.filter(n=>!new RegExp("roots_"+(Yt.length-1)+"_"+ir).test(n)),rn=!0),t===2&&Yt[Yt.length-1].indexOf("sum")!==-1&&(Bt=Bt.filter(n=>!new RegExp("sum_"+(Yt.length-1)+"_"+ir).test(n)),rn=!0),t===2&&Yt[Yt.length-1].indexOf("product")!==-1&&(Bt=Bt.filter(n=>!new RegExp("product_"+(Yt.length-1)+"_"+ir).test(n)),rn=!0),t===2&&Yt[Yt.length-1].indexOf("for")!==-1&&(Bt=Bt.filter(n=>!new RegExp("for_"+(Yt.length-1)+"_"+ir).test(n)),rn=!0),Yt[Yt.length-1].indexOf("defint")!==-1&&(t===2||t>2&&(t-2)%3===0)&&(Bt=Bt.filter(n=>!new RegExp("defint_"+(Yt.length-1)+"_"+ir).test(n)),rn=!0),e.push(Do()),rn=!1,t++;t===2&&Yt[Yt.length-1].indexOf("roots")!==-1&&(Bt=Bt.filter(n=>!new RegExp("roots_"+(Yt.length-1)+"_x").test(n)))}si.pop();for(let n=0;n<=Bt.length;n++)Bt[n]!=null&&(o==="roots"&&(Bt[n]=Bt[n].replace(new RegExp("roots_"+(Yt.length-1)+"_"),"")),o==="defint"&&(Bt[n]=Bt[n].replace(new RegExp("defint_"+(Yt.length-1)+"_"),"")),o==="sum"&&(Bt[n]=Bt[n].replace(new RegExp("sum_"+(Yt.length-1)+"_"),"")),o==="product"&&(Bt[n]=Bt[n].replace(new RegExp("product_"+(Yt.length-1)+"_"),"")),o==="for"&&(Bt[n]=Bt[n].replace(new RegExp("for_"+(Yt.length-1)+"_"),"")));return at!==")"&&bo(") expected"),Tt(),(o==="roots"||o==="defint"||o==="sum"||o==="product"||o==="for")&&Yt.pop(),o===s(on).printname&&(h.patternHasBeenFound=!0),D&&console.log("-- scan_function_call_with_function_name end"),q(...e)}function g0(t){D&&console.log("-- scan_function_call_without_function_name start");let e=[q(s(io),t)];if(Tt(),si.push(!0),at!==")")for(e.push(Do());at===",";)Tt(),e.push(Do());return si.pop(),at!==")"&&bo(") expected"),Tt(),D&&console.log(`-- scan_function_call_without_function_name end: ${e[e.length-1]}`),q(...e)}function b0(){at!=="("&&bo("( expected"),at=Tt();let r=Do();return at!==")"&&bo(") expected"),Tt(),r}function _0(){at!=="["&&bo("[ expected"),Tt();let t=[Do()];for(;at===",";)at=Tt(),t.push(Do());let r=h0(t);return at!=="]"&&bo("] expected"),Tt(),r}function bo(t){for(h.errorMessage="";De!==st&&!((gt[De]===`
`||gt[De]==="\r")&&De+1===st);)h.errorMessage+=gt[De++];for(h.errorMessage+=" ? ";gt[De]&&gt[De]!==`
`&&gt[De]!=="\r";)h.errorMessage+=gt[De++];h.errorMessage+=`
`,N(t)}function h0(t){let r=mt(t.length);r.tensor.ndim=1,r.tensor.dim[0]=t.length;for(let e=0;e<t.length;e++)r.tensor.elem[e]=t[e];return Dt(r),r}function Tt(){for(fs=0;v0(),at===Ol;)fs=1;return D&&console.log(`get_next_token token: ${at}`),at}function v0(){for(;mc(gt[st]);){if(gt[st]===`
`||gt[st]==="\r"){at=Ol,st++;return}st++}if(ii=st,st===gt.length){at="";return}if(wn(gt[st])||gt[st]==="."){for(;wn(gt[st]);)st++;if(gt[st]==="."){for(st++;wn(gt[st]);)st++;if(gt[st]==="e"&&(gt[st+1]==="+"||gt[st+1]==="-"||wn(gt[st+1])))for(st+=2;wn(gt[st]);)st++;at=$l}else at=Ll;wl(ii,st);return}if(dc(gt[st])){for(;xc(gt[st]);)st++;gt[st]==="("?at=Cl:at=oa,wl(ii,st);return}if(gt[st]==='"'){for(st++;gt[st]!=='"';)st===gt.length-1&&(st++,bo("runaway string"),st--),st++;st++,at=Pl,wl(ii+1,st-1);return}if(gt[st]==="#"||gt[st]==="-"&&gt[st+1]==="-"){for(;gt[st]&&gt[st]!==`
`&&gt[st]!=="\r";)st++;gt[st]&&st++,at=Ol;return}if(gt[st]===":"&&gt[st+1]==="="){st+=2,at=Tl;return}if(gt[st]==="="&&gt[st+1]==="="){st+=2,at=uc;return}if(gt[st]==="!"&&gt[st+1]==="="){st+=2,at=cc;return}if(gt[st]==="<"&&gt[st+1]==="="){st+=2,at=fc;return}if(gt[st]===">"&&gt[st+1]==="="){st+=2,at=lc;return}at=gt[st++]}function wl(t,r){ir=gt.substring(t,r)}function bc(t){return ua(()=>_(Nr(_(l(t)))))}function ci(t){return ua(()=>{t=_(t),t=Nr(t),t=_(t)}),t}function Nr(t){return ua(Bl,t)}function Bl(t){return M(t)?q(...t.map(Bl)):H(t)?(t=to(t),t.tensor.elem=t.tensor.elem.map(Bl),t):lt(t)?_c(t):t===s(vt)?f.piAsDouble:t===s(rr)?K(Math.E):t}var Xt={debug:t=>{D&&console.log(t)}},y0=t=>[].concat(...t);function yc(t){let r=l(t),e;u(r)===s(Ee)||u(r)===s(Ue)?e=Q(_(l(r)),_(A(r))):(r=_(r),u(r)===s(Ee)||u(r)===s(Ue)?e=Q(_(l(r)),_(A(r))):e=r),r=_(A(t));let o=r===s(L)?mr(e):r;return Dr(e,o)||N("roots: 1st argument is not a polynomial in the variable "+o),mi(e,o)}function E0(t){return t.some(r=>Qo(r))}function A0(t){return t.length<=2||V(t[0])?!1:t.slice(1,t.length-1).every(r=>V(r))}function ca(t,r){let e=Oe(t,r),o=e[e.length-1];return e.map(n=>$(n,o))}function mi(t,r){if(h.recursionLevelNestedRadicalsRemoval>1)return s(L);Xt.debug(`checking if ${t} is a case of simple roots`);let e=ca(t,r),o=[];if(A0(e)){Xt.debug(`yes, ${e[e.length-1]} is a case of simple roots`);let a=e.length,c=e[0],x=e.pop(),g=q0(a,x,c);o.push(...g)}else{let a=M0(t,r);o.push(...a)}let n=o.length;if(n===0&&N("roots: the polynomial is not factorable, try nroots"),n===1)return o[0];Ec(o);let i=mt(n);i.tensor.ndim=1,i.tensor.dim[0]=n;for(let a=0;a<n;a++)i.tensor.elem[a]=o[a];return console.log(`roots returning ${i}`),i}function q0(t,r,e){Xt.debug("getSimpleRoots"),t=t-1;let o=$(T(e,P(1,t)),T(r,P(1,t))),n=[];if(t%2===0){for(let i=1;i<=t;i+=2){let a=p(o,T(f.negOne,P(i,t)));n.push(a),n.push(U(a))}return n}for(let i=1;i<=t;i++){let a=p(o,T(f.negOne,P(i,t)));i%2===0&&(a=U(a)),n.push(a)}return n}function M0(t,r){let e=ca(t,r);if(E0(e)||(t=_e(t,r)),Y(t)){let o=t.tail().map(n=>hc(n,r));return y0(o)}return hc(t,r)}function hc(t,r){if(tt(t)&&Dr(l(t),r)&&Tn(A(t))){let e=ca(l(t),r);return vc(e)}if(Dr(t,r)){let e=ca(t,r);return vc(e)}return[]}function vc(t){let r=t.length;if(r===2){let e=t.pop(),o=t.pop();return S0(e,o)}if(r===3){let e=t.pop(),o=t.pop(),n=t.pop();return w0(e,o,n)}if(r===4){let e=t.pop(),o=t.pop(),n=t.pop(),i=t.pop();return O0(e,o,n,i)}if(r===5){let e=t.pop(),o=t.pop(),n=t.pop(),i=t.pop(),a=t.pop();return N0(e,o,n,i,a)}return[]}function S0(t,r){return[U($(r,t))]}function w0(t,r,e){let o=T(Q(T(r,y(2)),p(p(y(4),t),e)),P(1,2)),n=$(Q(o,r),p(t,y(2))),i=p($(U(I(o,r)),t),P(1,2));return[n,i]}function O0(t,r,e,o){let n=p(p(e,e),e),i=p(r,r),a=p(i,r),c=p(p(a,o),y(-4)),x=p(a,y(2)),g=p(y(3),t),v=p(p(t,t),o),z=p(v,y(27)),B=p(p(v,o),y(-27)),J=p(p(t,e),r),nt=p(p(t,e),y(3)),ht=p(y(-4),p(t,n)),$t=U(p(J,y(9))),xr=p(p(J,o),y(18)),ar=Q(i,nt),kt=p(i,p(e,e)),nr=$(U(r),g),vr=p(T(ar,y(3)),y(4)),Rr=On(Mt(ar)),Ve=On(Mt(Gr([xr,c,kt,ht,B]))),ne=Gr([x,$t,z]),Me=Mt(T(Q(T(ne,y(2)),vr),P(1,2)));if(Xt.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),Xt.debug(`cubic: D0: ${ar}`),Xt.debug(`cubic: D0 as float: ${Rr}`),Xt.debug(`cubic: DETERMINANT: ${Ve}`),Xt.debug(`cubic: D1: ${ne}`),V(Ve))return T0(t,r,e,o,{R_DELTA0_toBeCheckedIfZero:Rr,R_m_b_over_3a:nr,R_DELTA0:ar,R_b3:a,R_a_b_c:J});let no=!1,Os=!1,No;for(;!no;){let Vi=Os?U(Me):Me;No=Mt(T(p(I(Vi,ne),P(1,2)),P(1,3)));let zn=On(Mt(No));Xt.debug(`cubic: C: ${No}`),Xt.debug(`cubic: C as absval and float: ${zn}`),V(zn)?(Xt.debug(" cubic: C IS ZERO flipping the sign"),Os=!0):no=!0}let Bi=p(p(No,g),y(2)),Ts=p(f.imaginaryunit,T(y(3),P(1,2))),Ns=I(f.one,Ts),Ui=Q(f.one,Ts),Ze=$(No,g),Io=nr,Is=U(Ze),Gi=U($(ar,p(No,g))),Ye=Mt(Gr([Io,Is,Gi])),gn=nr,Ro=$(p(Ze,Ns),y(2)),Rs=$(p(Ui,ar),Bi),zi=Mt(Gr([gn,Ro,Rs])),Fi=nr,dl=$(p(Ze,Ui),y(2)),Gn=$(p(Ns,ar),Bi),Ls=Mt(Gr([Fi,dl,Gn]));return[Ye,zi,Ls]}function T0(t,r,e,o,n){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:a,R_DELTA0:c,R_b3:x,R_a_b_c:g}=n;if(V(i))return Xt.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[a];Xt.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let v=$(Q(p(t,p(o,y(9))),p(r,e)),p(c,y(2))),z=U(x),B=U(p(t,p(t,p(o,y(9))))),J=p(g,y(4)),nt=$(Gr([J,B,z]),p(t,c));return[v,v,nt]}function N0(t,r,e,o,n){return Xt.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),V(r)&&V(o)&&!V(e)&&!V(n)?I0(t,r,e,o,n):V(r)?R0(t,r,e,o,n):L0(t,r,e,o,n)}function I0(t,r,e,o,n){Xt.debug("biquadratic case");let i=mi(I(p(t,T(s(Pt),y(2))),I(p(e,s(Pt)),n)),s(Pt)),a=[];for(let c of i.tensor.elem)a.push(Mt(T(c,P(1,2)))),a.push(Mt(U(T(c,P(1,2)))));return a}function R0(t,r,e,o,n){let i=e,a=o,c=n,x=p(P(5,2),i),g=Q(p(y(2),T(i,y(2))),c),v=I(p(P(-1,2),p(i,c)),I($(T(i,y(3)),y(2)),p(P(-1,8),T(a,y(2))))),z=I(T(s(Pt),y(3)),I(p(x,T(s(Pt),y(2))),I(p(g,s(Pt)),v)));Xt.debug(`resolventCubic: ${z}`);let B=mi(z,s(Pt));Xt.debug(`resolventCubicSolutions: ${B}`);let J=null;for(let Me of B.tensor.elem){Xt.debug(`examining solution: ${Me}`);let no=On(I(p(Me,y(2)),i));if(Xt.debug(`abs value is: ${Me}`),!V(no)){J=Me;break}}Xt.debug(`chosen solution: ${J}`);let nt=Mt(T(I(p(J,y(2)),i),P(1,2))),ht=Mt($(p(a,y(2)),nt)),$t=I(p(i,y(3)),p(J,y(2))),xr=Mt(T(U(I($t,ht)),P(1,2))),ar=$(I(nt,xr),y(2)),kt=Mt(T(U(I($t,ht)),P(1,2))),nr=$(Q(nt,kt),y(2)),vr=Mt(T(U(Q($t,ht)),P(1,2))),Rr=$(I(U(nt),vr),y(2)),Ve=Mt(T(U(Q($t,ht)),P(1,2))),ne=$(Q(U(nt),Ve),y(2));return[ar,nr,Rr,ne]}function L0(t,r,e,o,n){let i=$(I(p(y(8),p(e,t)),p(y(-3),T(r,y(2)))),p(y(8),T(t,y(2)))),a=$(I(T(r,y(3)),I(p(y(-4),p(t,p(r,e))),p(y(8),p(o,T(t,y(2)))))),p(y(8),T(t,y(3)))),c=p(p(t,t),t),x=p(r,r),g=p(p(t,t),o),v=$(I(p(T(r,y(4)),y(-3)),I(p(y(256),p(c,n)),I(p(y(-64),p(g,r)),p(y(16),p(x,p(t,e)))))),p(y(256),T(t,y(4)))),z=T(s(Pt),y(4)),B=p(i,T(s(Pt),y(2))),J=p(a,s(Pt)),nt=Mt(Gr([z,B,J,v])),ht=mi(nt,s(Pt));return Xt.debug(`p for depressed quartic: ${i}`),Xt.debug(`q for depressed quartic: ${a}`),Xt.debug(`r for depressed quartic: ${v}`),Xt.debug(`4 * x^4: ${z}`),Xt.debug(`R_p * x^2: ${B}`),Xt.debug(`R_q * x: ${J}`),Xt.debug(`R_r: ${v}`),Xt.debug(`solving depressed quartic: ${nt}`),Xt.debug(`depressedSolutions: ${ht}`),ht.tensor.elem.map($t=>{let xr=Mt(Q($t,$(r,p(y(4),t))));return Xt.debug(`solution from depressed: ${xr}`),xr})}function Ul(t){if(W(t)){let r=t.tail().map(Ac);return Gr(r)}return Ac(t)}function Ac(t){if(!Y(t))return t;let r=t.tail();for(;$0(r););return ks(r)}function $0(t){for(let r=0;r<t.length;r++){let e=t[r];for(let o=0;o<t.length;o++){if(r===o)continue;let n=t[o];if(le(e)&&tt(n)&&Nt(A(n))&&ot(l(e),l(n)))return t[r]=Ar(Q(l(e),f.one)),t[o]=f.one,!0;if(tt(n)&&Nt(A(n))&&we(n)===s(Br)&&ot(e,di(n)))return t[r]=he(Ar(I(e,f.negOne))),t[o]=f.one,!0;if(le(n)){let i=Q(e,l(n));if(Et(i))return t[r]=Ar(e),t[o]=f.one,!0}if(tt(e)&&Nt(A(e))&&tt(n)&&Nt(A(n))&&we(n)===s(Br)){let i=Q(l(e),l(l(n)));if(Et(i))return t[r]=he(Ar(l(e))),t[o]=f.one,!0}if(le(e)&&tt(n)&&Nt(A(n))&&we(n)===s(Br)){let i=Q(l(e),l(l(n)));if(Et(i))return t[r]=l(e),t[o]=f.one,!0;if(Nt(i))return t[r]=he(l(l(n))),t[o]=f.one,!0;if(wt(i,2))return t[r]=l(e),t[o]=I(l(e),f.negOne),!0;if(wt(i,-2))return t[r]=he(l(l(n))),t[o]=he(I(l(l(n)),f.negOne)),!0}}}return!1}function qc(t){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let r=_(l(t));t=_(A(t));let e=t===s(L)?mr(r):t,o=xi(!1,r,e);return q(s(L),...o)}function C0(t,r){return t.length>0&&ot(r,t[t.length-1])?!1:(t.push(r),!0)}function xi(t,r,e){if(D&&console.log(`DECOMPOSING ${r}`),t){if(!M(r))return D&&console.log(` ground thing: ${r}`),[r]}else if(!it(r,e))return D&&console.log(" entire expression is constant"),[r];if(W(r))return P0(t,r,e);if(Y(r))return k0(t,r,e);let o=m(r);D&&(console.log(" naive decomp"),console.log(`startig p3: ${o}`));let n=[];for(;M(o);)t&&n.push(u(o)),D&&(console.log("recursive decomposition"),console.log(`car(p3): ${u(o)}`),console.log(`p2: ${e}`)),n.push(...xi(t,u(o),e)),o=m(o);return n}function P0(t,r,e){D&&console.log(" decomposing the sum ");let o=m(r),n=[];for(;M(o);)(it(u(o),e)||t)&&n.push(...xi(t,u(o),e)),o=m(o);o=m(r);let i=[...o].filter(a=>!it(a,e));return i.length&&(o=Gr(i),C0(n,o),n.push(U(o))),n}function k0(t,r,e){D&&console.log(" decomposing the product ");let o=m(r),n=[];for(;M(o);)(it(u(o),e)||t)&&n.push(...xi(t,u(o),e)),o=m(o);o=m(r);let i=[];for(;M(o);){let a=u(o);it(a,e)||(i.length<1||!ot(a,i[i.length-1]))&&i.push(a),o=m(o)}return i.length>0&&n.push(ae(i)),n}function cs(t,r,e,o){D&&console.log(`         !!!!!!!!!   transform on: ${t}`);let n=D0();Jt(s(re),r);let i=Gl(t,r),a=xi(o,i,r);if(D){console.log(`  ${a.length} decomposed elements ====== `);for(let v=0;v<a.length;v++)console.log(`  decomposition element ${v}: ${a[v]}`)}let c=!1,x;if(o){if(!C(t)){let v=e;D&&(console.log(`applying transform: ${v}`),console.log(`scanning table entry ${v}`));let z=Gt(v,s(ma),s(ue));z=Gt(z,s(da),s(ce));let B=Gt(z,s(xa),s(re)),J=u(B);D&&console.log(`template expression: ${J}`),x=l(B);let nt=Er(B);if(Mc([f.one,...a],o,t,J,nt))c=!0;else{D&&(console.log(`p3 at this point: ${t}`),console.log(`car(p3): ${u(t)}`));let ht=[],$t=t;for(M($t)&&(ht.push(u(t)),$t=m(t));M($t);){let xr=u($t);$t=m($t),D&&(console.log(`testing: ${xr}`),console.log(`about to try to simplify other term: ${xr}`));let[ar,kt]=cs(xr,s(L),e,o);c=c||kt,ht.push(ar),D&&console.log(`tried to simplify other term: ${xr} ...successful?: ${kt} ...transformed: ${ht[ht.length-1]}`)}ht.length!==0&&(x=q(...ht))}}}else for(let v of Array.from(e))if(D&&(console.log(`scanning table entry ${v}`),(v+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&er),v){let z=ia(v),B=l(z);x=A(z);let J=jo(z);if(Mc([f.one,...a],o,t,B,J)){c=!0;break}}let g=c?_(x):o?t:s(L);return B0(n),[g,c]}function D0(){return{METAA:xt(s(ue)),METAB:xt(s(ce)),METAX:xt(s(re))}}function B0(t){Jt(s(re),t.METAX),Jt(s(ce),t.METAB),Jt(s(ue),t.METAA)}function Mc(t,r,e,o,n){for(let i of t){Jt(s(ue),i),D&&console.log(`  binding METAA to ${xt(s(ue))}`);for(let a of t){Jt(s(ce),a),D&&console.log(`  binding METAB to ${xt(s(ce))}`);let c=n;for(;M(c);){let g=_(u(c));if(V(g))break;c=m(c)}if(M(c))continue;let x=r?Vr(_,o):_(o);if(D&&(console.log(`about to evaluate template expression: ${o} binding METAA to ${xt(s(ue))} and binding METAB to ${xt(s(ce))} and binding METAX to ${xt(s(re))}`),console.log(`  comparing ${x} to: ${e}`)),V(Q(e,x)))return D&&(console.log(`binding METAA to ${xt(s(ue))}`),console.log(`binding METAB to ${xt(s(ce))}`),console.log(`binding METAX to ${xt(s(re))}`),console.log(`comparing ${e} to: ${o}`)),!0}}return!1}function Sc(t){let r=_(l(t)),e=f.one,o=y(2);return Er(t)!==s(L)&&(e=_(A(t)),o=_(zt(t))),pi(r,e,o)}function pi(t,r,e){let o=0,n=Array(ye).fill(0),i=Array(ye).fill(0);if(C(t)||(Et(r)&&Bo(e)||Et(e)&&Bo(r))&&ta(t))return t;if(wc(t)){let B=u(m(m(t))),J=u(m(m(m(t))));if(ot(B,e)&&ot(J,r)||ot(J,e)&&ot(B,r)||ot(B,s(L))&&ot(J,s(L))&&(Et(e)&&Bo(r)||Et(r)&&Bo(e)))return u(m(t))}if(h.expanding&&W(t))return t.tail().reduce((B,J)=>I(B,pi(J,r,e)),f.zero);if(h.expanding&&Y(t))return t.tail().reduce((B,J)=>p(B,pi(J,r,e)),f.one);if(h.expanding&&ke(t)){let B=[];return M(t)&&B.push(...t.tail().map(J=>[J,r,e])),B.reverse(),B.reduce((J,nt)=>Ur(J,pi(nt[0],nt[1],nt[2])),s(Ce))}if(!H(t))return V(t)?f.zero:(!Et(r)||!Bo(e))&&(!Et(e)||!Bo(r))?q(s(Ke),t,r,e):q(s(Ke),t);let{ndim:a,nelem:c}=t.tensor;if(a===1)return t;let x=et(r),g=et(e);(x<1||x>a||g<1||g>a)&&N("transpose: index out of range"),x--,g--,r=mt(c),r.tensor.ndim=a,r.tensor.dim=[...t.tensor.dim],r.tensor.dim[x]=t.tensor.dim[g],r.tensor.dim[g]=t.tensor.dim[x];let v=t.tensor.elem,z=r.tensor.elem;for(let B=0;B<a;B++)n[B]=0,i[B]=t.tensor.dim[B];for(let B=0;B<c;B++){o=n[x],n[x]=n[g],n[g]=o,o=i[x],i[x]=i[g],i[g]=o;let J=0;for(let nt=0;nt<a;nt++)J=J*i[nt]+n[nt];o=n[x],n[x]=n[g],n[g]=o,o=i[x],i[x]=i[g],i[g]=o,z[J]=v[B];for(let nt=a-1;nt>=0&&!(++n[nt]<i[nt]);nt--)n[nt]=0}return r}function Oc(t){let r=U0(l(t));return Mt(_(r))}function U0(t){if(h.userSimplificationsInListForm.length===0||it(t,s(Eo)))return t;D&&console.log(`runUserDefinedSimplifications passed: ${t}`);let r=Vr(_,t);if(D){console.log(`runUserDefinedSimplifications after eval no expanding: ${r}`),console.log("patterns to be checked: ");for(let n of Array.from(h.userSimplificationsInListForm))console.log(`...${n}`)}let e=!0,o=0;for(;e&&o<Fl;){e=!1,o++;for(let n of Array.from(h.userSimplificationsInListForm)){let i=!0,a=0;for(;i&&a<Vl;)a++,D&&console.log(`simplify - checking pattern: ${n} on: ${r}`),[r,i]=cs(r,s(L),n,!0),i&&(e=!0),D&&console.log(`p1 at this stage of simplification: ${r}`);a===Vl&&N(`maximum application of single transformation rule exceeded: ${n}`)}}return o===Fl&&N("maximum application of all transformation rules exceeded "),D&&(console.log(`METAX = ${xt(s(re))}`),console.log(`METAA = ${xt(s(ue))}`),console.log(`METAB = ${xt(s(ce))}`)),r}function Mt(t){if(h.codeGen&&u(t)===s(je)){let r=l(t),e=Mt(_(r)),o=A(t);t=q(s(je),e,o)}if(H(t))return G0(t);if(it(t,s(Br))){let r=Ul(t),e=Ul(te(t));t=Kt(r)<Kt(e)?r:e}if(t=Z0(t),t=z0(t),t=F0(t),t=V0(t),t=Y0(t),t=Nc(t),t=j0(t),t=Q0(t),Rc){let r;if([r,t]=J0(t),r)return D&&console.log("de-nesting successful into: "+t.toString()),Mt(t)}return t=H0(t),t=Ic(t),t}function G0(t){let r=mt(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=Array.from(t.tensor.dim),r.tensor.elem=t.tensor.elem.map(Mt),Dt(r),V(r)&&(r=f.zero),r}function z0(t){if(!W(t))return t;let r=te(t);return Kt(r)<Kt(t)&&(t=r),t}function F0(t){if(!W(t))return t;let r=Wn(t);return Kt(r)<=Kt(t)&&(t=r),t}function V0(t){let r=te(U(te(U(te(t)))));return Kt(r)<Kt(t)&&(t=r),t}function Z0(t){let r=u(t);if((r===s(Ht)||ke(t))&&u(u(m(t)))===s(Ke)&&u(u(m(m(t))))===s(Ke)){D&&console.log(`maybe collecting a transpose ${t}`);let e=l(u(m(t))),o=l(u(m(m(t)))),n;r===s(Ht)?n=p(e,o):ke(t)?n=Ur(o,e):n=N("f10: nothing to pop.");let i=Vr(()=>pi(n,f.one,y(2)));Kt(i)<Kt(t)&&(t=i),D&&console.log(`collecting a transpose ${i}`)}return t}function Y0(t){if(V(t))return t;let r=te(gr(te(gr(te(t)))));return Kt(r)<Kt(t)&&(t=r),t}function Tc(t){return Nc(t)}function Nc(t){if(!it(t,s(fr))&&!it(t,s(ur)))return t;let r=t;h.trigmode=1;let e=_(r);h.trigmode=2;let o=_(r);return h.trigmode=0,(Kt(o)<Kt(e)||pa(o)<pa(e))&&(e=o),(Kt(e)<Kt(t)||pa(e)<pa(t))&&(t=e),t}function j0(t){if(!W(t))return t;let r=m(t);return M(r)&&(r=[...r].reduce((e,o)=>Ic(I(e,Mt(o))),f.zero)),Kt(r)<Kt(t)&&(t=r),t}function Ic(t){var r,e,o,n,i;if(r=Cr(t),We(r)||(e=Zr(t),We(e))||!(n=hl(e,r))||(i=Qi(Lr(e,r),n),We(i)))return t;let a=Qi(e,n),c=gr(i),x=uo(a,c),g=Mt(x),v=Qi(r,n),z=uo(v,c),B=Mt(z),J=$(g,B);return o=Wn(J),Kt(o)<Kt(t)?o:t}function H0(t){let r;return!it(t,s(fr))&&!it(t,s(ur))||(r=Yi(_(t)),D&&console.log(`before simplification clockform: ${t} after: ${r}`),Kt(r)<Kt(t)&&(t=r)),t}function Q0(t){let r=zl(t),e=_(r);return Kt(e)<Kt(t)&&(t=e),t}function zl(t){if(Se(t))return t;if(ot(u(t),s(ut))&&Nt(l(t))){let r=U(f.one),e=zl(A(t));return Tr(ji(T(r,e)))}else return M(t)?t.map(zl):t}function pa(t){return W(t)?_r(t)-1:1}function J0(t){if(h.recursionLevelNestedRadicalsRemoval>0)return D&&console.log("denesting bailing out because of too much recursion"),[!1,t];let[r,e]=ga(t),o=Vr(Jn,r);return t=us(s(ut),r)<us(s(ut),o)?r:o,[e,t]}function ga(t){return h.recursionLevelNestedRadicalsRemoval>0?(D&&console.log("denesting bailing out because of too much recursion"),[t,!1]):ot(u(t),s(ut))?W0(t):M(t)?K0(t):[t,!1]}function W0(t){let r=l(t),e=A(t);if(Nt(e)||!ot(u(r),s(Pr))||!or(e)||!Ft(e,1,3)&&!Ft(e,1,2))return[t,!1];let o=l(r);ga(o);let n=A(r);ga(n);let i=0,a=r;for(;m(a)!==s(L);)i++,a=m(a);if(i>2)return[t,!1];let{commonBases:c,termsThatAreNotPowers:x}=X0(n);if(c.length===0)return[t,!1];let g=o,v=c.reduce(p,f.one),z=x.reduce(p,f.one),B;if(Ft(e,1,3)){let kt=$(p(U(g),v),z),nr=mo(Nr(Yr(kt)));if(Math.abs(nr)>Math.pow(2,32))return[t,!1];let vr=p(y(3),v),Rr=mo(Nr(Yr(vr)));if(Math.abs(Rr)>Math.pow(2,32))return[t,!1];let Ve=p(vr,s(Pt)),ne=$(p(y(-3),g),z),Me=mo(Nr(Yr(ne)));if(Math.abs(Me)>Math.pow(2,32))return[t,!1];B=Gr([kt,Ve,p(ne,T(s(Pt),y(2))),p(f.one,T(s(Pt),y(3)))])}else if(Ft(e,1,2)){let kt=mo(Nr(Yr(v)));if(Math.abs(kt)>Math.pow(2,32))return[t,!1];let nr=$(p(y(-2),g),z),vr=mo(Nr(Yr(nr)));if(Math.abs(vr)>Math.pow(2,32))return[t,!1];B=I(v,I(p(nr,s(Pt)),p(f.one,T(s(Pt),y(2)))))}h.recursionLevelNestedRadicalsRemoval++;let J=mi(B,s(Pt));if(h.recursionLevelNestedRadicalsRemoval--,ot(J,s(L)))return D&&console.log("roots bailed out because of too much recursion"),[t,!1];let nt=J.elem.filter(kt=>!it(kt,s(ut)));if(nt.length===0)return[t,!1];let ht=[],$t=[];for(let kt of Array.from(nt)){let nr=mo(Nr(Yr(kt)));ht.push(kt),$t.push(nr)}let xr=$t.indexOf(Math.max.apply(Math,$t)),ar=ht[xr];if(!Ft(e,1,3)&&!Ft(e,1,2))return[t,!1];if(Ft(e,1,3)){let kt=T($(g,I(T(ar,y(3)),p(p(y(3),v),ar))),P(1,3)),nr=p(kt,ar);return[Mt(I(p(kt,T(v,P(1,2))),nr)),!0]}if(Ft(e,1,2)){let kt=T($(g,I(T(ar,y(2)),v)),P(1,2)),nr=p(kt,ar),vr=Mt(I(p(kt,T(v,P(1,2))),nr)),Rr=Nr(Yr(vr));return It(Rr)?[Mt(I(p(U(kt),T(v,P(1,2))),U(nr))),!0]:[vr,!0]}return[null,!0]}function X0(t){let r=null,e=[],o=[];if(Y(t)){let n=m(t);if(M(n))for(;M(n);){let i=u(n);if(tt(i)){let a=l(i),c=A(i);Ft(c,1,2)&&(r==null?(r=c,e.push(a)):ot(c,r)&&e.push(a))}else o.push(i);n=m(n)}}else if(tt(t)){let n=l(t),i=A(t);r==null&&Ft(i,1,2)&&(r=i,e.push(n))}return{commonBases:e,termsThatAreNotPowers:o}}function K0(t){let r=!1,e=[];if(M(t)){let o=Array.from(t).map(n=>{if(!r){let i;return[i,r]=ga(n),i}return n});e.push(...o)}return[q(...e),r]}var tb=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function Lc(t){let r=0;t=m(t);let e=_(u(t));t=m(t);let o=_(u(t)),n,i;for(o===s(L)?(i=mr(e),n=s(L)):C(o)?(i=mr(e),n=o):(i=o,t=m(t),n=_(u(t)));;){C(n)?(r=et(n),isNaN(r)&&N("nth integral: check n")):r=1;let a=e;if(r>=0)for(let c=0;c<r;c++)a=Nn(a,i);else{r=-r;for(let c=0;c<r;c++)a=St(a,i)}if(e=a,n===s(L))break;if(C(n)){if(t=m(t),n=_(u(t)),n===s(L))break;C(n)||(i=n,t=m(t),n=_(u(t)))}else i=n,t=m(t),n=_(u(t))}return e}function Nn(t,r){let e;return W(t)?e=rb(t,r):Y(t)?e=eb(t,r):e=$c(t,r),it(e,s(Eo))&&N("integral: sorry, could not find a solution"),_(Mt(e))}function rb(t,r){t=m(t);let e=Nn(u(t),r);return M(t)&&(e=t.tail().reduce((o,n)=>I(o,Nn(n,r)),e)),e}function eb(t,r){let[e,o]=sc(t,r);return p(e,$c(o,r))}function $c(t,r){let e=In(t,r).toFixed(6),o=sb[e];if(!o)return q(s(Eo),t,r);let[n,i]=cs(t,r,o,!1);return n===s(L)?q(s(Eo),t,r):n}var Ao={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function In(t,r){if(pt(t))return ot(t,r)?Ao.x:Ao.constant;if(M(t)){let o=u(t);switch(pt(o)&&o.printname){case Pr:return nb(m(t),r);case Ht:return ib(m(t),r);case ut:return Zl(l(t),A(t),r);case ba:return Zl(s(rr),l(t),r);case gi:var e=K(.5);return Zl(l(t),e,r);default:return ob(t,r)}}return Ao.constant}function ob(t,r){if(!it(l(t),r))return Ao.constant;let e=u(t),o=In(l(t),r),n=Ao[e.printname];if(!n)throw new Error("Unsupported function "+e.printname);return Math.pow(n,o)}function nb(t,r){let e={};for(;M(t);){let n=u(t);t=m(t);let i=0;it(n,r)?i=In(n,r):i=Ao.constant,e[i.toFixed(6)]=!0}let o=0;for(let n of Object.keys(e||{})){let i=e[n];o=o+Number(n)}return o}function ib(t,r){let e=1;return M(t)&&[...t].forEach(o=>{it(o,r)&&(e=e*In(o,r))}),e}function Zl(t,r,e){let o=Ao.constant,n=Ao.constexp;if(it(t,e)&&(o=In(t,e)),it(r,e))n=In(r,e);else{if(o===Ao.constant)return Ao.constant;Nt(r)?n=-1:Le(r)?n=.5:os(r)?n=-.5:Ft(r,2,1)?n=2:Ft(r,-2,1)&&(n=-2)}return Math.pow(o,n)}function Cc(){let t={};for(let r of Array.from(tb)){let e=ia(r),o=l(e),i=In(o,s(re)).toFixed(6);t[i]||(t[i]=[]),t[i].push(r)}return console.log(`hashed_itab = ${JSON.stringify(t,null,2)}`),t}var sb={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]};function Pc(t){return nn(_(l(t)))}function nn(t){return t===s(rr)?f.one:wt(t,1)?f.zero:It(t)?I(nn(U(t)),p(f.imaginaryunit,f.Pi())):X(t)?K(Math.log(t.d)):or(t)?Q(nn(Zr(t)),nn(Cr(t))):tt(t)?p(A(t),nn(l(t))):Y(t)?t.tail().map(nn).reduce(I,f.zero):q(s(Jo),t)}function kc(t){return Yl(_(l(t)))}function Yl(t){return X(t)?t.d>0?f.one:t.d===0?f.one:f.negOne:lt(t)?Xe(yr(t.q.a,t.q.b))===-1?f.negOne:fe(yr(t.q.a,t.q.b))?f.zero:f.one:Qo(t)?p(T(f.negOne,me(t)),t):Ct(t)?p(q(s(Rn),U(t)),f.negOne):q(s(Rn),t)}function Dc(t){return jl(_(l(t)))}function jl(t){if(u(t)===s(sn))return l(t);if(X(t)){let r=Math.sinh(t.d);return Math.abs(r)<1e-10&&(r=0),K(r)}return V(t)?f.zero:q(s(qo),t)}function _a(t){t=m(t);let r=_(u(t));t=m(t);let e,o,n=_(u(t));for(n===s(L)?(e=mr(r),o=s(L)):C(n)?(e=mr(r),o=n):(e=n,t=m(t),o=_(u(t)));;){let i;C(o)?(i=et(o),isNaN(i)&&N("nth derivative: check n")):i=1;let a=r;if(i>=0)for(let c=0;c<i;c++)a=St(a,e);else{i=-i;for(let c=0;c<i;c++)a=Nn(a,e)}if(r=a,o===s(L))break;if(C(o)){if(t=m(t),o=_(u(t)),o===s(L))break;C(o)||(e=o,t=m(t),o=_(u(t)))}else e=o,t=m(t),o=_(u(t))}return r}function St(t,r){return C(r)&&N("undefined function"),H(t)?H(r)?Bc(t,r):Gc(t,r):H(r)?Uc(t,r):ab(t,r)}function ab(t,r){if(pt(r))return lb(t,r);let e=Gt(t,r,s(Pt));return Gt(St(e,s(Pt)),s(Pt),r)}function lb(t,r){if(ot(t,r))return f.one;if(!M(t))return f.zero;if(W(t))return fb(t,r);switch(u(t)){case s(Ht):return ub(t,r);case s(ut):return cb(t,r);case s(Qr):return db(t,r);case s(Jo):return mb(t,r);case s(fr):return pb(t,r);case s(ur):return gb(t,r);case s(ve):return bb(t,r);case s(Qe):return _b(t,r);case s(Je):return hb(t,r);case s(Fr):return vb(t,r);case s(qo):return yb(t,r);case s(go):return Eb(t,r);case s(Mo):return Ab(t,r);case s(sn):return qb(t,r);case s(tn):return Mb(t,r);case s(an):return Sb(t,r);case s($e):return wb(t,r);case s(Rn):return Ob(t,r);case s(ei):return Tb(t,r);case s(Ln):return Nb(t,r);case s(bi):return Ib(t,r);case s(Xo):return Rb(t,r);case s(Sn):return Cb(t,r);default:}return u(t)===s(Eo)&&A(t)===r?Db(t):xb(t,r)}function fb(t,r){let e=M(t)?t.tail().map(o=>St(o,r)):[];return Gr(e)}function ub(t,r){let e=_r(t)-1,o=[];for(let n=0;n<e;n++){let i=[],a=m(t);for(let c=0;c<e;c++){let x=u(a);n===c&&(x=St(x,r)),i.push(x),a=m(a)}o.push(ae(i))}return Gr(o)}function cb(t,r){let e=$(A(t),l(t)),o=St(l(t),r),n=nn(l(t)),i=St(A(t),r);return p(I(p(e,o),p(n,i)),t)}function mb(t,r){let e=St(l(t),r);return $(e,l(t))}function db(t,r){let e=St(l(t),r);return u(e)===s(Qr)?cr(A(e),A(t))?q(s(Qr),q(s(Qr),l(e),A(e)),A(t)):q(s(Qr),q(s(Qr),l(e),A(t)),A(e)):St(e,A(t))}function xb(t,r){let e=m(t);return e===s(L)||it(e,r)?q(s(Qr),t,r):f.zero}function pb(t,r){let e=St(l(t),r);return p(e,Or(l(t)))}function gb(t,r){let e=St(l(t),r);return U(p(e,br(l(t))))}function bb(t,r){let e=St(l(t),r);return p(e,T(Or(l(t)),y(-2)))}function _b(t,r){let e=St(l(t),r);return p(e,T(Q(f.one,T(l(t),y(2))),P(-1,2)))}function hb(t,r){let e=St(l(t),r);return U(p(e,T(Q(f.one,T(l(t),y(2))),P(-1,2))))}function vb(t,r){let e=St(l(t),r);return Mt(p(e,gr(I(f.one,T(l(t),y(2))))))}function yb(t,r){let e=St(l(t),r);return p(e,ea(l(t)))}function Eb(t,r){let e=St(l(t),r);return p(e,jl(l(t)))}function Ab(t,r){let e=St(l(t),r);return p(e,T(ea(l(t)),y(-2)))}function qb(t,r){let e=St(l(t),r);return p(e,T(I(T(l(t),y(2)),f.one),P(-1,2)))}function Mb(t,r){let e=St(l(t),r);return p(e,T(I(T(l(t),y(2)),f.negOne),P(-1,2)))}function Sb(t,r){let e=St(l(t),r);return p(e,gr(Q(f.one,T(l(t),y(2)))))}function wb(t,r){let e=St(l(t),r);return p(e,Yl(l(t)))}function Ob(t,r){let e=St(l(t),r);return p(p(e,Ml(l(t))),y(2))}function Tb(t,r){let e=St(l(t),r);return p(p(e,p(y(2),A(t))),Hs(l(t),I(A(t),f.negOne)))}function Nb(t,r){let e=St(l(t),r);return p(p(p(lr(p(T(l(t),y(2)),f.negOne)),T(f.Pi(),P(-1,2))),y(2)),e)}function Ib(t,r){let e=St(l(t),r);return p(p(p(lr(p(T(l(t),y(2)),f.negOne)),T(f.Pi(),P(-1,2))),y(-2)),e)}function Rb(t,r){return V(A(t))?Lb(t,r):$b(t,r)}function Lb(t,r){let e=St(l(t),r);return p(p(e,Ko(l(t),f.one)),f.negOne)}function $b(t,r){let e=St(l(t),r);return p(e,I(Ko(l(t),I(A(t),f.negOne)),p($(p(A(t),f.negOne),l(t)),Ko(l(t),A(t)))))}function Cb(t,r){return V(A(t))?Pb(t,r):kb(t,r)}function Pb(t,r){let e=St(l(t),r);return p(p(e,Ko(l(t),f.one)),f.negOne)}function kb(t,r){let e=St(l(t),r);return p(e,I(ra(l(t),I(A(t),f.negOne)),p($(p(A(t),f.negOne),l(t)),ra(l(t),A(t)))))}function Db(t){return l(t)}function Hl(t){if(D&&console.log(`Eval_user_function evaluating: ${u(t)}`),u(t)===s(_i)&&xt(s(_i))===s(_i))return _a(t);let r=_(u(t));C(r)?N("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):H(r)?N("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):ee(r)&&N("expected function, found string instead.");let e=u(m(r)),o=u(m(m(r))),n=m(t);if(u(r)!==s(je)||r===u(t))return q(r,...Ql(n));t=o;let i=n,a=[];for(;M(t)&&M(i);)a.push(u(t)),a.push(u(i)),t=m(t),i=m(i);return a.length&&(e=ha(e,a)),_(e)}function ha(t,r){if(H(t))return Bb(t,r);if(M(t)){let o=[];for(u(t)===r[0]?o.push(q(s(io),r[1])):o.push(u(t)),t=m(t);M(t);)o.push(ha(u(t),r)),t=m(t);return q(...o)}if(!pt(t))return t;for(let o=0;o<r.length;o+=2)if(t===r[o])return r[o+1];let e=xt(t);return t!==e&&ha(e,r)===e?t:e}function Bb(t,r){return t=to(t),t.tensor.elem=t.tensor.elem.map(e=>ha(e,r)),Dt(t),t}function Hr(t){return et(_(t))}function _(t){let r;va(),t==null&&er,!h.evaluatingAsFloats&&An(t)&&(r=!0,h.evaluatingAsFloats=!0);try{switch(t.k){case ln:return Gb(t);case Zt:return h.evaluatingAsFloats?K(Ge(t)):t;case Ut:case fn:return t;case un:return xm(t);case zr:return Ub(t);default:N("atom?")}}finally{r&&(h.evaluatingAsFloats=!1)}}function Ub(t){if(ya(t))return _(q(t,s(hi)));if(t===s(vt)&&h.evaluatingAsFloats)return f.piAsDouble;let r=xt(t);if(D&&console.log(`looked up: ${t} which contains: ${r}`),t!==r){let e=h.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(t);if(e!==-1){let o="";for(let n=e;n<h.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;n++)o+=h.chainOfUserSymbolsNotFunctionsBeingEvaluated[n].printname+" -> ";o+=t.printname,N("recursive evaluation of symbols: "+o);return}h.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(t),r=_(r),h.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return r}function Gb(t){let r=u(t);return u(r)===s(io)?Hl(t):(pt(r)||N("cons?"),r.keyword?r.keyword(t):Hl(t))}function zc(t){return xt(l(t))}function Fc(t){let r=Uo(l(t));return r==null?t:y(Number(r))}function Vc(t){let r=_(l(t));return Ys(r)}function Zc(t){let r=_(l(t)),e=M(Er(t))?Hr(A(t)):1;return H(r)?e<1||e>r.tensor.ndim?t:y(r.tensor.dim[e-1]):f.one}function Yc(t){return eu(_(l(t)))}function jc(t){let r=u(t);for(t=m(t);M(t);)r=_(u(t)),t=m(t);return r}function Hc(t){let r=_(l(t));for(t=Er(t);M(t);)r=Gt(r,_(u(t)),_(l(t))),t=Er(t);return _(r)}function Qc(t){return lr(_(l(t)))}function Jc(t){return Ar(_(l(t)))}function Wc(t){t=m(t);let r=_(u(t));t=m(t);let e=_(u(t)),o=_e(r,e);return M(t)&&(o=t.tail().reduce((n,i)=>_e(n,_(i)),o)),o}function Xc(t){let r=_(A(t)),e=_(l(t));return Hs(e,r)}function Kc(t){return ju(_(l(t)))}function tm(t){let r=t;t=m(t);let e=_(u(t));if(C(e)&&N("trying to access a scalar as a tensor"),!H(e))return r;let o=[];for(t=m(t);M(t);){if(o.push(_(u(t))),!dm(o[o.length-1]))return r;t=m(t)}return Df(e,o)}function rm(t){let r=_(l(t));return po(r)}function em(t){let r=_(l(t));return Xu(r)}function om(t){return t=_(l(t)),lt(t)?qt(t)?f.one:f.zero:X(t)?Math.floor(t.d)===t.d?f.one:f.zero:q(s(Ea),t)}function nm(t){return t=_(l(t)),t.k===Zt||t.k===Ut?f.one:f.zero}function im(t){return q(s(Wo),...Ql(m(t)))}function sm(t){return l(t)}function am(t){return t=_(l(t)),H(t)?y(t.tensor.ndim):f.zero}function lm(t){if(we(t)===s(vo))return zb(t);if(M(l(t)))return Uf(t);pt(l(t))||N("symbol assignment: error in symbol");let r=_(A(t));return Jt(l(t),r),s(L)}function zb(t){let r=di(t);console.log(`p4: ${r}`),pt(r)||N("indexed assignment: expected a symbol name");let e=_(A(t)),o=[],n=Vn(t);M(n)&&(o=[...n].map(_));let i=Bf(e,...o);return Jt(r,i),s(L)}function fm(t){let r=_(l(t));return T(r,P(1,2))}function um(){N("user stop")}function cm(t){let r=_(l(t)),e=_(A(t)),o=_(zt(t));return _(Gt(o,e,r))}function mm(t){let r=Hr(l(t));if(isNaN(r)||r<1)return t;t=mt(r*r),t.tensor.ndim=2,t.tensor.dim[0]=r,t.tensor.dim[1]=r;for(let e=0;e<r;e++)t.tensor.elem[r*e+e]=f.one;return Dt(t),t}function Jl(t){return u(t)===s(Ee)&&(t=q(s(Ue),l(t),A(t))),_(t)}function*Ql(t){if(M(t))for(let r of t)yield _(r)}var ms=0;function pm(t){let r=[];t=m(t);for(let e of t){let o=_(e);Aa(r,o)}return Xl(r)}function Xl(t){if(D)for(let r of t)console.log(Kr(r));for(let r=0;r<10&&!(t.length<2||(ms=0,t.sort(Vb),ms===0));r++)Zb(t);switch(t.length){case 0:return f.Zero();case 1:return t[0];default:return t.unshift(s(Pr)),q(...t)}}var Fb=0;function Vb(t,r){if(Fb++,C(t)&&C(r))return ms=1,0;if(H(t)&&H(r)){if(t.tensor.ndim<r.tensor.ndim)return-1;if(t.tensor.ndim>r.tensor.ndim)return 1;for(let o=0;o<t.tensor.ndim;o++){if(t.tensor.dim[o]<r.tensor.dim[o])return-1;if(t.tensor.dim[o]>r.tensor.dim[o])return 1}return ms=1,0}Y(t)&&(t=m(t),C(u(t))&&(t=m(t),m(t)===s(L)&&(t=u(t)))),Y(r)&&(r=m(r),C(u(r))&&(r=m(r),m(r)===s(L)&&(r=u(r))));let e=Ne(t,r);return e===0&&(ms=1),e}function Zb(t){let r=0;for(;r<t.length-1;){va();let e,o,n=t[r],i=t[r+1];if(H(n)&&H(i)){e=gm(n,i),e!==s(L)&&(t.splice(r,2,e),r--),r++;continue}if(H(n)||H(i)){r++;continue}if(C(n)&&C(i)){e=Wl(n,i),V(e)?t.splice(r,2):t.splice(r,2,e),r--,r++;continue}if(C(n)||C(i)){r++;continue}e=f.One(),o=f.One();let a=0;if(Y(n)&&(n=m(n),a=1,C(u(n))&&(e=u(n),n=m(n),m(n)===s(L)&&(n=u(n),a=0))),Y(i)&&(i=m(i),C(u(i))&&(o=u(i),i=m(i),m(i)===s(L)&&(i=u(i)))),!ot(n,i)){r++;continue}if(e=Wl(e,o),V(e)){t.splice(r,2),r--,r++;continue}let c=a?new Mr(s(Ht),n):n;t.splice(r,2,p(e,c)),r--,r++}}function Aa(t,r){W(r)?t.push(...r.tail()):Kn(r)||t.push(r)}function I(t,r){let e=[];return Aa(e,t),Aa(e,r),Xl(e)}function Gr(t){let r=[];for(let e of t)Aa(r,e);return Xl(r)}function Q(t,r){return I(t,U(r))}var de=!1;function bm(t){return be(_(l(t)))}function On(t){return ci(_(me(_(t))))}function be(t){let r=Zr(t),e=me(r),o=Cr(t),n=me(o),i=$(e,n);return de&&(console.trace(">>>>  ABS of "+t),console.log(`ABS numerator ${r}`),console.log(`ABSVAL numerator: ${e}`),console.log(`ABS denominator: ${o}`),console.log(`ABSVAL denominator: ${n}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}function me(t){let r=t;if(de&&console.log(`ABS of ${t}`),V(t))return de&&(console.log(` abs: ${t} just zero`),console.log(" --> ABS of "+r+" : "+f.zero)),f.zero;if(It(t))return de&&console.log(` abs: ${t} just a negative`),U(t);if(qn(t))return de&&(console.log(` abs: ${t} just a positive`),console.log(` --> ABS of ${r} : ${t}`)),t;if(t===s(vt))return de&&(console.log(` abs: ${t} of PI`),console.log(` --> ABS of ${r} : ${t}`)),t;if(W(t)&&(vn(t,t)||Fn(t)||it(t,f.imaginaryunit))){de&&(console.log(` abs: ${t} is a sum`),console.log("abs of a sum")),t=Tr(t);let o=Tc(T(I(T(Yr(t),y(2)),T(Ho(t),y(2))),P(1,2)));return de&&console.log(` --> ABS of ${r} : ${o}`),o}if(tt(t)&&wt(l(t),-1)){let o=f.One();if(de){console.log(` abs: ${t} is -1 to any power`);let n=h.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(n),console.log(` --> ABS of ${r} : ${o}`)}return o}if(tt(t)&&qn(A(t))){let o=T(be(l(t)),A(t));return de&&(console.log(` abs: ${t} is something to the power of a positive number`),console.log(` --> ABS of ${r} : ${o}`)),o}if(tt(t)&&l(t)===s(rr)){let o=lr(Yr(A(t)));return de&&(console.log(` abs: ${t} is an exponential`),console.log(` --> ABS of ${r} : ${o}`)),o}if(Y(t)){let o=t.tail().map(me).reduce(p);return de&&(console.log(` abs: ${t} is a product`),console.log(` --> ABS of ${r} : ${o}`)),o}if(u(t)===s($e)){let o=q(s($e),l(t));return de&&(console.log(` abs: ${t} is abs of a abs`),console.log(` --> ABS of ${r} : ${o}`)),o}if(H(t))return Yb(t);(Ct(t)||W(t)&&Ct(l(t)))&&(t=U(t));let e=q(s($e),t);return de&&(console.log(` abs: ${t} is nothing decomposable`),console.log(` --> ABS of ${r} : ${e}`)),e}function Yb(t){return t.tensor.ndim!==1&&N("abs(tensor) with tensor rank > 1"),_(Mt(T(Ur(t,Te(t)),P(1,2))))}var ds=!1;function Kn(t){switch(t.k){case Zt:if(fe(t.q.a))return!0;break;case Ut:if(t.d===0)return!0;break}return!1}function jb(t){return H(t)?t.tensor.elem.every(r=>V(r)):!1}function V(t){return Kn(t)||jb(t)}function Uo(t){let r=Jl(t);if(V(r))return!1;if(Pe(r))return!0;if(r=ci(r),V(r))return!1;if(Pe(r))return!0;if(it(r,f.imaginaryunit)){if(r=Jl(On(r)),V(r))return!1;if(Pe(r))return!0}return null}function It(t){switch(t.k){case Zt:if(Xe(t.q.a)===-1)return!0;break;case Ut:if(t.d<0)return!0;break}return!1}function qn(t){switch(t.k){case Zt:if(Xe(t.q.a)===1)return!0;break;case Ut:if(t.d>0)return!0;break}return!1}function Bo(t){switch(t.k){case Zt:if(Wt(t.q.a,2)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===2)return!0;break}return!1}function Et(t){switch(t.k){case Zt:if(Wt(t.q.a,1)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===1)return!0;break}return!1}function Nt(t){switch(t.k){case Zt:if(Wt(t.q.a,-1)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===-1)return!0;break}return!1}function We(t){return Et(t)||Nt(t)}function qt(t){return t.k===Zt&&Wt(t.q.b,1)}function dm(t){return t.k===Ut?t.d===Math.round(t.d):qt(t)}function Sa(t){return lt(t)&&Wt(t.q.b,1)&&Xe(t.q.a)===1}function Tn(t){return qt(t)&&Xe(t.q.a)===1}function _l(t,r){return r==null&&(r=mr(t)),Qb(t,r)&&Hb(it(t,s(Xr)),it(t,s(ao)),it(t,s(lo)))===1?r:!1}function Hb(...t){return t.reduce((r,e)=>r+Number(e),0)}function Qb(t,r){return Jb(t,r)}function Jb(t,r){return Y(t)?t.tail().every(e=>{let o=_m(e,r);return D&&(console.log(`ispolyfactoredorexpandedform_factor testing ${e}`),o&&console.log(`... tested negative:${e}`)),o}):_m(t,r)}function _m(t,r){return tt(t)?(D&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Tn(A(t)),D?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+qa(l(t),r)):void 0)),Tn(A(t))&&qa(l(t),r)):(D&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${t}`),qa(t,r))}function Dr(t,r){return it(t,r)?qa(t,r):!1}function qa(t,r){return W(t)?t.tail().every(e=>hm(e,r)):hm(t,r)}function hm(t,r){return Y(t)?t.tail().every(e=>vm(e,r)):vm(t,r)}function vm(t,r){return ot(t,r)?!0:tt(t)&&ot(l(t),r)?Tn(A(t)):!it(t,r)}function Ct(t){return It(t)||Y(t)&&It(l(t))}function Em(t){return tt(t)&&lt(u(m(m(t))))&&It(u(m(t)))?(ds&&console.log(`hasNegativeRationalExponent: ${t} has imaginary component`),!0):(ds&&console.log(`hasNegativeRationalExponent: ${t} has NO imaginary component`),!1)}function ym(t){return Y(t)&&_r(t)===3&&X(l(t))&&Em(A(t))||ot(t,f.imaginaryunit)}function Ma(t){return Y(t)&&_r(t)===3&&C(l(t))&&ot(A(t),f.imaginaryunit)||ot(t,f.imaginaryunit)||Em(A(t))?(ds&&console.log(`isimaginarynumber: ${t} is imaginary number`),!0):(ds&&console.log(`isimaginarynumber: ${t} isn't an imaginary number`),!1)}function ku(t){return W(t)&&_r(t)===3&&X(l(t))&&ym(A(t))||ym(t)}function Qo(t){return ds&&er,W(t)&&_r(t)===3&&C(l(t))&&Ma(A(t))||Ma(t)?(D&&console.log(`iscomplexnumber: ${t} is imaginary number`),!0):(D&&console.log(`iscomplexnumber: ${t} is imaginary number`),!1)}function Mn(t){return qt(t)&&t.q.a.isEven()}function se(t){return W(t)&&Ct(l(t))||Ct(t)}function Kl(t){return pt(t)?!0:M(t)?[...t].some(Kl):!1}function Am(t){return qt(t)||tt(t)&&qt(l(t))&&qt(A(t))}function qm(t){return or(t)&&Wt(t.q.a.abs(),1)}function Mm(t){return tt(t)&&Nt(A(t))}function or(t){return t.k===Zt&&!Wt(t.q.b,1)}function wt(t,r){switch(t.k){case Zt:return Wt(t.q.a,r)&&Wt(t.q.b,1);case Ut:return t.d===r;default:return!1}}function Ft(t,r,e){switch(t.k){case Zt:return Wt(t.q.a,r)&&Wt(t.q.b,e);case Ut:return t.d===r/e;default:return!1}}function Le(t){return Ft(t,1,2)}function os(t){return Ft(t,-1,2)}function $n(t){return tt(t)&&wt(l(t),2)&&Ft(A(t),-1,2)}function vi(t){return Y(t)&&wt(l(t),-1)&&$n(A(t))&&_r(t)===3}function wa(t){return Y(t)&&Le(l(t))&&Sm(A(t))&&_r(t)===3}function Oa(t){return Y(t)&&os(l(t))&&Sm(A(t))&&_r(t)===3}function Sm(t){return tt(t)&&wt(l(t),3)&&Le(A(t))}function An(t){return t.k===Ut||t===s(Ta)?!0:M(t)?[...t].some(An):!1}function Se(t){return ot(t,f.imaginaryunit)}function es(t){let r=0;if(!Y(t))return 0;if(ot(l(t),f.imaginaryunit))return A(t)!==s(vt)||_r(t)!==3?0:2;if(!C(l(t))||!ot(A(t),f.imaginaryunit)||zt(t)!==s(vt)||_r(t)!==4)return 0;let e=et(p(l(t),y(2)));if(isNaN(e))return 0;switch(e<1&&(r=1,e=-e),e%4){case 0:e=1;break;case 1:e=r?4:3;break;case 2:e=2;break;case 3:e=r?3:4}return e}function Qn(t){let r=0;return t===s(vt)?2:!Y(t)||!C(l(t))||A(t)!==s(vt)||_r(t)!==3||(r=et(p(l(t),y(2))),isNaN(r))?0:(r<0?r=4- -r%4:r=1+(r-1)%4,r)}function tf(t,r){return t===r?0:t>r?1:-1}function Na(t){let r;if(h.codeGen||h.fullDoubleOutput)return""+t;if(V(xt(s(Ia))))r=""+t,h.printMode===ft?/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):r=r.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"*10^($1)"):r=r.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let e=et(xt(s(Ra)));r=""+t.toFixed(e),r=r.replace(/(\.\d*?[1-9])0+$/gm,"$1"),r=r.replace(/\.0+$/gm,""),r.indexOf(".")===-1&&(r+=".0"),parseFloat(r)!==t&&(r=t.toFixed(e)+"...")}return r}function mc(t){return t==null?!1:t===" "||t==="	"||t===`
`||t==="\v"||t==="\f"||t==="\r"}function wn(t){return t==null?!1:/^\d+$/.test(t)}function dc(t){return t==null?!1:t.search(/[^A-Za-z]/)===-1}function Wb(t){return t==null?!1:t.search(/[^A-Za-z_]/)===-1}function xc(t){return t==null?!1:Wb(t)||wn(t)}function Gu(t,r){let e=[];return M(t)&&e.push(...t),M(r)&&e.push(...r),q(...e)}function rc(t,r){N("Not implemented")}function oc(t,r){N("Not implemented")}function wm(t,r){let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a),n=Cs(e,o);if(fe(n))return f.zero;let i=yr(t.q.b,r.q.b),a=He(n,i);a=co(a,i);let c=kr(n,a),x=kr(i,a);return new Ot(c,x)}function Om(t,r){if(fe(r.q.a)&&N("divide by zero"),fe(t.q.a))return f.zero;let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a),n=He(e,o);return n=co(n,o),new Ot(kr(e,n),kr(o,n))}function Tm(t,r){if(fe(t.q.a)||fe(r.q.a))return f.zero;let e=yr(t.q.a,r.q.a),o=yr(t.q.b,r.q.b),n=He(e,o);return n=co(n,o),new Ot(kr(e,n),kr(o,n))}function Lo(t){return(0,hr.default)(t)}function rs(t){return t.geq(Number.MIN_SAFE_INTEGER)&&t.leq(Number.MAX_SAFE_INTEGER)}function Yn(t,r){if(t.isPositive()){if(r<0)return t.multiply((0,hr.default)(-1))}else if(r>0)return t.multiply((0,hr.default)(-1));return t}function co(t,r){if(t.isPositive()){if(r.isNegative())return t.multiply((0,hr.default)(-1))}else if(r.isPositive())return t.multiply((0,hr.default)(-1));return t}function $u(t){return t.isNegative()?t.multiply((0,hr.default)(-1)):t}function Wl(t,r){if(lt(t)&&lt(r))return wm(t,r);let e=X(t)?t.d:Ge(t),o=X(r)?r.d:Ge(r);return K(e+o)}function ns(t,r){if(lt(t)&&lt(r))return Tm(t,r);let e=X(t)?t.d:Ge(t),o=X(r)?r.d:Ge(r);return new oe(e*o)}function zu(t,r){if(lt(t)&&lt(r))return Om(t,r);V(r)&&N("divide by zero");let e=X(t)?t.d:Ge(t),o=X(r)?r.d:Ge(r);return new oe(e/o)}function Fu(t){if(V(t)&&N("divide by zero"),X(t))return new oe(1/t.d);let r=(0,hr.default)(t.q.a),e=(0,hr.default)(t.q.b);return e=co(e,r),r=Yn(r,1),new Ot(e,r)}function Xb(t,r){let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a);return hn(e,o)}function zs(t,r){if(lt(t)&&lt(r))return Xb(t,r);let e=X(t)?t.d:Ge(t),o=X(r)?r.d:Ge(r);return e<o?-1:e>o?1:0}function Vu(t){if(V(t))return t;switch(t.k){case Zt:return new Ot((0,hr.default)(t.q.a.multiply(hr.default.minusOne)),(0,hr.default)(t.q.b));case Ut:return new oe(-t.d);default:N("bug caught in mp_negate_number")}}function Gs(t){let r=kr(t.q.a,t.q.b);return new Ot(r)}function Re(t){return lt(t)?new Ot((0,hr.default)(t.q.a)):f.one}function Ie(t){return lt(t)?new Ot((0,hr.default)(t.q.b)):f.one}function Ru(t,r){let e=$o(t.q.a,Math.abs(r)),o=$o(t.q.b,Math.abs(r));if(r<0){let n=e;e=o,o=n,e=co(e,o),o=Yn(o,1)}return new Ot(e,o)}function Ge(t){t.q==null&&er;let r=t.q.a.divmod(t.q.b);return r.quotient.toJSNumber()+r.remainder.toJSNumber()/t.q.b.toJSNumber()}function y(t){return new Ot((0,hr.default)(t))}function K(t){return new oe(t)}function P(t,r){return new Ot((0,hr.default)(t),(0,hr.default)(r))}function et(t){let r=NaN;switch(t.k){case Zt:qt(t)&&rs(t.q.a)&&(r=t.q.a.toJSNumber());break;case Ut:D&&console.log("popping integer but double is found"),Math.floor(t.d)===t.d&&(D&&console.log("...although it's an integer"),r=t.d);break}return r}function pc(t){let r=0,e=t[r];(e==="+"||e==="-")&&r++;let o=(0,hr.default)(t.substring(r)),n=new Ot(o);return e==="-"&&(n=U(n)),n}function gc(t){return K(parseFloat(t))}function rf(t,r){let e="",o="",n="";switch(t.k){case Zt:var i=t.q.a.toString();r||i[0]==="-"&&(i=i.substring(1)),h.printMode===ft&&or(t)&&(i="\\frac{"+i+"}{"),e+=i,or(t)&&(h.printMode!==ft&&(e+="/"),o=t.q.b.toString(),h.printMode===ft&&(o+="}"),e+=o);break;case Ut:i=Na(t.d),r||i[0]==="-"&&(i=i.substring(1)),e+=i;break}return e}function pu(t,r){let e=He(t.q.a,r.q.a),o=He(t.q.b,r.q.b);return new Ot(Yn(e,1),o)}function mo(t){let r=0;switch(t.k){case Zt:r=Ge(t);break;case Ut:({d:r}=t);break;default:r=0}return r}function _c(t){let r=Ge(t);return new oe(r)}function Tu(t){return new Ot(Kb(t))}function Kb(t){let r;if(t===0||t===1)return r=(0,hr.default)(1),r;r=(0,hr.default)(2);let e=(0,hr.default)(0);if(3<=t)for(let o=3;o<=t;o++)e=(0,hr.default)(o),r=yr(r,e);return r}function ef(t){return $r(t_,t)}function t_(t){let r=Dr(t,s(Zo)),e=Dr(t,s(Yo)),o=Dr(t,s(Xr)),n=Dr(t,s(ao)),i=Dr(t,s(lo)),a;return r&&!e&&!o&&!n&&!i?a=yi(t,s(Zo)):!r&&e&&!o&&!n&&!i?a=yi(t,s(Yo)):!r&&!e&&o&&!n&&!i?a=yi(t,s(Xr)):!r&&!e&&!o&&n&&!i?a=yi(t,s(ao)):!r&&!e&&!o&&!n&&i?a=yi(t,s(lo)):M(t)&&u(t)!==s(Ei)?a=q(u(t),...t.tail().map(ef)):a=t,a}function Gl(t,r){return Dr(t,r)?yi(t,r):M(t)?q(u(t),...t.tail().map(e=>Gl(e,r))):t}function yi(t,r){let e=Oe(t,r),o=[];for(let n=e.length-1;n>=0;n--){let i=e[n];o.push(...r_(n,i,r))}return o.length>1?new Mr(s(Pr),q(...o)):o[0]}function r_(t,r,e){if(V(r))return[];if(t===0)return W(r)?r.tail():[r];let o=[];return Y(r)?o.push(...r.tail()):wt(r,1)||o.push(r),t===1?o.push(e):o.push(q(s(ut),e,y(t))),o.length>1?[q(s(Ht),...o)]:o}function Nm(t){return La(l(t))}function La(t){if(H(t)){let r=mt(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=Array.from(t.tensor.dim),r.tensor.elem=r.tensor.elem.map(e=>{let o=La(e);return Dt(r),o}),r}return t.k===Ut?e_(t):M(t)?new Mr(La(u(t)),La(m(t))):t}function e_(t){let r=ci(t);if(r.k===Ut){let e=r.d,o=e.toString().split(".");if(o.length===2){let n=o[1].length,i=1/Math.pow(10,n),a=o_(e,i);return P(a[0],a[1])}return y(e)}return q(s($a),r)}function o_(t,r){if(isNaN(t))return[0,0];if(t===1/0)return[1,0];if(t===-1/0)return[-1,0];let e=t<0?-1:1;if(t=Math.abs(t),Math.abs(t-Math.floor(t))<r)return[t*e,1];if(t<1e-19)return[e,1e19];if(t>1e19)return[1e19*e,1];let o=t,n=0,i=1,a;for(;;){o=1/(o-Math.floor(o));let c=i;if(i=i*Math.floor(o)+n,n=c,a=Math.floor(t*i+.5),!(Math.abs(t-a/i)>r)||o===Math.floor(o))break}return a=e*a,[a,i]}var ze=0,n_=1,Im=2,Rm=3,of=4;var i_=6,Lm=7,s_=8,a_=9;function l_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let a=1;a<=10;a++){let c,x,g,v=Math.sqrt(i)/a;if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),c<2*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * sqrt( ${i} ) / ${a}`,i_,x,i,a])}}return o}function f_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let a of[1,2,3,5,6,7,8,10]){let c,x,g,v=Math.sqrt(i/a);if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),c<2*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * (sqrt( ${i} / ${a} )`,of,x,i,a])}}return o}function cn(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=l_(t);if(o!=null)return o;let n=f_(t);return n!=null?n:null}function xs(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=sf(t);if(o!=null)return o;let n=u_(t);return n!=null?n:null}function sf(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let a=1;a<=5;a++){let c,x,g,v=Math.log(i)/a;if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),!(x!==1&&Math.abs(Math.floor(x/a))===Math.abs(x/a))&&c<2.2*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * log( ${i} ) / ${a}`,a_,x,i,a])}}return o}function u_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let a=1;a<=5;a++){let c,x,g,v=Math.log(i/a);if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),c<1.96*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * log( ${i} / ${a} )`,s_,x,i,a])}}return o}function $m(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let a=1;a<=12;a++){let c,x,g,v=Math.pow(Math.E,i)/a;if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),c<2*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * (e ^ ${i} ) / ${a}`,Lm,x,i,a])}}return o}function nf(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let a=1;a<=12;a++){let c,x,g,v=Math.pow(Math.PI,i)/a;if(Math.abs(v)>1e-10?(g=t/v,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-v)),c<2*r){let z=Ae(x,i,a);z<n&&(n=z,o=[`${x} * (pi ^ ${i} ) / ${a} )`,Rm,x,i,a])}}return o}function ps(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=c_(t);if(o!=null)return o;let n=m_(t);return n!=null?n:null}function c_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let a=1;a<=4;a++){let c,x,g,v=i/a,z=Math.sin(v);if(Math.abs(z)>1e-10?(g=t/z,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-z)),c<2*r){let B=Ae(x,i,a);B<n&&(n=B,o=[`${x} * sin( ${i}/${a} )`,n_,x,i,a])}}return o}function m_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let a=1;a<=13;a++){let c,x,g,v=i/a,z=Math.sin(Math.PI*v);if(Math.abs(z)>1e-10?(g=t/z,x=Math.round(g),c=Math.abs(1-g/x)):(g=1,x=1,c=Math.abs(t-z)),c<23*r){let B=Ae(x,i,a);B<n&&(n=B,o=[`${x} * sin( ${i}/${a} * pi )`,Im,x,i,a])}}return o}function At(t){let r,e=t.toString().split(".");if(e.length===2){let B=e[1].length;r=1/Math.pow(10,B)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=Number.MAX_VALUE,n=0,i=null,a=!0,c=cn(t);c!=null&&(n=Ae(c),n<o?(a&&console.log(`better explanation by approxRadicals: ${c} complexity: ${n}`),o=n,i=c):a&&console.log(`subpar explanation by approxRadicals: ${c} complexity: ${n}`));let x=xs(t);x!=null&&(n=Ae(x),n<o?(a&&console.log(`better explanation by approxLogs: ${x} complexity: ${n}`),o=n,i=x):a&&console.log(`subpar explanation by approxLogs: ${x} complexity: ${n}`));let g=$m(t);g!=null&&(n=Ae(g),n<o?(a&&console.log(`better explanation by approxRationalsOfPowersOfE: ${g} complexity: ${n}`),o=n,i=g):a&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${g} complexity: ${n}`));let v=nf(t);v!=null&&(n=Ae(v),n<o?(a&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${v} complexity: ${n}`),o=n,i=v):a&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${v} complexity: ${n}`));let z=ps(t);return z!=null&&(n=Ae(z),n<o?(a&&console.log(`better explanation by approxTrigonometric: ${z} complexity: ${n}`),o=n,i=z):a&&console.log(`subpar explanation by approxTrigonometric: ${z} complexity: ${n}`)),i}function Ae(t,r,e){let o=0;if(t instanceof Array){switch(t[1]){case Im:o=4;break;case Rm:o=Math.pow(4,Math.abs(t[3]))*Math.abs(t[2]);break;case Lm:o=Math.pow(3,Math.abs(t[3]))*Math.abs(t[2]);break;default:o=0}o+=Math.abs(t[2])*(Math.abs(t[3])+Math.abs(t[4]))}else o+=Math.abs(t)*(Math.abs(r)+Math.abs(e));return t[2]===1?o-=1:o+=1,t[3]===1?o-=1:o+=1,t[4]===1?o-=1:o+=1,o<0&&(o=0),o}function Cm(){for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${r} ) / ${e}`);let o=r/e,n=Math.sqrt(r)/e,i=cn(n),a=i[2]*Math.sqrt(i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${r} ) / ${e} . obtained: ${i}`)}for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${r} ) / ${e}`);let o=r/e,n=Math.sqrt(r)/e,i=n.toFixed(4),a=cn(Number(i)),c=a[2]*Math.sqrt(a[3])/a[4];Math.abs(n-c)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${r} ) / ${e} . obtained: ${a}`)}for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${r} / ${e} )`);let o=r/e,n=Math.sqrt(r/e),i=cn(n);if(i!=null){let a=i[2]*Math.sqrt(i[3]/i[4]);i[1]===of&&Math.abs(n-a)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${r} / ${e} ) . obtained: ${i}`)}}for(let r of[1,2,3,5,6,7,8,10])for(let e of[1,2,3,5,6,7,8,10]){if(r===1&&e===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${r} / ${e} )`);let o=r/e,n=Math.sqrt(r/e),i=n.toFixed(4),a=cn(Number(i)),c=a[2]*Math.sqrt(a[3]/a[4]);a[1]===of&&Math.abs(n-c)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing: 1 * log(${r} ) / ${e}`);let o=r/e,n=Math.log(r)/e,i=At(n),a=i[2]*Math.log(i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * log(${r} ) / ${e} . obtained: ${i}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing with 4 digits: 1 * log(${r} ) / ${e}`);let o=r/e,n=Math.log(r)/e,i=n.toFixed(4),a=At(Number(i)),c=a[2]*Math.log(a[3])/a[4];Math.abs(n-c)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${r} ) / ${e} . obtained: ${a}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing: 1 * log(${r} / ${e} )}`);let o=r/e,n=Math.log(r/e),i=At(n),a=i[2]*Math.log(i[3]/i[4]);Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * log(${r} / ${e} ) . obtained: ${i}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing with 4 digits: 1 * log(${r} / ${e} )`);let o=r/e,n=Math.log(r/e),i=n.toFixed(4),a=At(Number(i)),c=a[2]*Math.log(a[3]/a[4]);Math.abs(n-c)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`testApproxAll testing: 1 * (e ^ ${r} ) / ${e}`);let o=r/e,n=Math.pow(Math.E,r)/e,i=At(n),a=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${r} ) / ${e} . obtained: ${i}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${r} ) / ${e}`);let o=r/e,n=Math.pow(Math.E,r)/e,i=n.toFixed(4),a=$m(Number(i)),c=a[2]*Math.pow(Math.E,a[3])/a[4];Math.abs(n-c)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${r} ) / ${e} . obtained: ${a}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`testApproxAll testing: 1 * pi ^ ${r} / ${e}`);let o=r/e,n=Math.pow(Math.PI,r)/e,i=At(n),a=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${r} / ${e} ) . obtained: ${i}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${r} / ${e}`);let o=r/e,n=Math.pow(Math.PI,r)/e,i=n.toFixed(4),a=nf(Number(i)),c=a[2]*Math.pow(Math.PI,a[3])/a[4];Math.abs(n-c)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing: 1 * sin( ${r}/${e} )}`);let o=r/e,n=Math.sin(o),i=At(n),a=i[3]/i[4],c=i[2]*Math.sin(a);Math.abs(n-c)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${r}/${e} ) . obtained: ${i}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${r}/${e} )`);let o=r/e,n=Math.sin(o),i=n.toFixed(5),a=At(Number(i));a==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${r}/${e} ) . obtained:  undefined `);let c=a[3]/a[4],x=a[2]*Math.sin(c),g=Math.abs(n-x);g>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${r}/${e} ) . obtained: ${a} error: ${g}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${r}/${e} )`);let o=r/e,n=Math.sin(o),i=n.toFixed(4),a=At(Number(i));a==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${r}/${e} ) . obtained:  undefined `);let c=a[3]/a[4],x=a[2]*Math.sin(c),g=Math.abs(n-x);g>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${r}/${e} ) . obtained: ${a} error: ${g}`)}let t=0;At(t)[0]!=="0"&&console.log("fail testApproxAll: 0"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),t=Math.sqrt(2),At(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),t=1.41,At(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),t=1.4,cn(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),t=.6,xs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),t=.69,xs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),t=.7,xs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),t=1.09,xs(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),t=1.09,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),t=1.098,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),t=1.1,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),t=1.11,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),t=Math.sqrt(3),At(t)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),t=3.141592,At(t)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),t=31.41592,At(t)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),t=314.1592,At(t)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),t=3141592653589793e-8,At(t)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),t=Math.sqrt(2),ps(t)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),t=Math.sqrt(3),ps(t)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),t=(Math.sqrt(6)-Math.sqrt(2))/4,At(t)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),t=Math.sqrt(2-Math.sqrt(2))/2,At(t)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),t=(Math.sqrt(6)+Math.sqrt(2))/4,At(t)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),t=Math.sqrt(2+Math.sqrt(3))/2,At(t)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),t=(Math.sqrt(5)-1)/4,At(t)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),t=Math.sqrt(10-2*Math.sqrt(5))/4,At(t)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),t=Math.sin(Math.PI/7),At(t)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),t=Math.sin(Math.PI/9),At(t)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),t=1836.15267,nf(t)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let r=1;r<=13;r++)for(let e=1;e<=13;e++){console.log(`approxTrigonometric testing: 1 * sin( ${r}/${e} * pi )`);let o=r/e;t=Math.sin(Math.PI*o);let n=ps(t),i=n[3]/n[4],a=n[2]*Math.sin(Math.PI*i);Math.abs(t-a)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${r}/${e} * pi ) . obtained: ${n}`)}for(let r=1;r<=13;r++)for(let e=1;e<=13;e++){if(r===5&&e===11||r===6&&e===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${r}/${e} * pi )`);let o=r/e,n=Math.sin(Math.PI*o),i=n.toFixed(4),a=ps(Number(i)),c=a[3]/a[4],x=a[2]*Math.sin(Math.PI*c),g=Math.abs(n-x);g>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${r}/${e} * pi ) . obtained: ${a} error: ${g}`)}return console.log("testApprox done")}function Pm(t){return d_(_(l(t)))}function d_(t){if(u(t)===s(ur))return l(t);if(X(t))return K(Math.acos(t.d));if($n(t)||Y(t)&&Ft(u(m(t)),1,2)&&u(u(m(m(t))))===s(ut)&&wt(u(m(u(m(m(t))))),2)&&Ft(u(m(m(u(m(m(t)))))),1,2))return h.evaluatingAsFloats?K(Math.PI/4):p(P(1,4),s(vt));if(vi(t)||Y(t)&&Ft(u(m(t)),-1,2)&&u(u(m(m(t))))===s(ut)&&wt(u(m(u(m(m(t))))),2)&&Ft(u(m(m(u(m(m(t)))))),1,2))return h.evaluatingAsFloats?K(Math.PI*3/4):p(P(3,4),s(vt));if(wa(t))return h.evaluatingAsFloats?K(Math.PI/6):p(P(1,6),s(vt));if(Oa(t))return h.evaluatingAsFloats?K(5*Math.PI/6):p(P(5,6),s(vt));if(!lt(t))return q(s(Je),t);switch(et(p(t,y(2)))){case-2:return f.Pi();case-1:return h.evaluatingAsFloats?K(Math.PI*2/3):p(P(2,3),s(vt));case 0:return h.evaluatingAsFloats?K(Math.PI/2):p(P(1,2),s(vt));case 1:return h.evaluatingAsFloats?K(Math.PI/3):p(P(1,3),s(vt));case 2:return f.Zero();default:return q(s(Je),t)}}function km(t){return x_(_(l(t)))}function x_(t){if(u(t)===s(go))return l(t);if(X(t)){let{d:r}=t;return r<1&&N("arccosh function argument is less than 1.0"),r=Math.log(r+Math.sqrt(r*r-1)),K(r)}return Et(t)?f.zero:q(s(tn),t)}function Dm(t){return p_(_(l(t)))}function p_(t){if(u(t)===s(fr))return l(t);if(X(t))return K(Math.asin(t.d));if($n(t)||Y(t)&&Ft(u(m(t)),1,2)&&u(u(m(m(t))))===s(ut)&&wt(u(m(u(m(m(t))))),2)&&Ft(u(m(m(u(m(m(t)))))),1,2))return p(P(1,4),s(vt));if(vi(t)||Y(t)&&Ft(u(m(t)),-1,2)&&u(u(m(m(t))))===s(ut)&&wt(u(m(u(m(m(t))))),2)&&Ft(u(m(m(u(m(m(t)))))),1,2))return h.evaluatingAsFloats?K(-Math.PI/4):p(P(-1,4),s(vt));if(wa(t))return h.evaluatingAsFloats?K(Math.PI/3):p(P(1,3),s(vt));if(Oa(t))return h.evaluatingAsFloats?K(-Math.PI/3):p(P(-1,3),s(vt));if(!lt(t))return q(s(Qe),t);switch(et(p(t,y(2)))){case-2:return h.evaluatingAsFloats?K(-Math.PI/2):p(P(-1,2),s(vt));case-1:return h.evaluatingAsFloats?K(-Math.PI/6):p(P(-1,6),s(vt));case 0:return f.Zero();case 1:return h.evaluatingAsFloats?K(Math.PI/6):p(P(1,6),s(vt));case 2:return h.evaluatingAsFloats?K(Math.PI/2):p(P(1,2),s(vt));default:return q(s(Qe),t)}}function Bm(t){return g_(_(l(t)))}function g_(t){if(u(t)===s(qo))return l(t);if(X(t)){let{d:r}=t;return r=Math.log(r+Math.sqrt(r*r+1)),K(r)}return V(t)?f.zero:q(s(sn),t)}function Um(t){return b_(_(l(t)))}function b_(t){if(u(t)===s(Mo))return l(t);if(X(t)){let{d:r}=t;return(r<-1||r>1)&&N("arctanh function argument is not in the interval [-1,1]"),r=Math.log((1+r)/(1-r))/2,K(r)}return V(t)?f.zero:q(s(an),t)}function Gm(t){let r=_(l(t)),e=_(A(t));return __(r,e)}function __(t,r){return h_(t,r)}function h_(t,r){return v_(t,r)?$($(Ar(t),Ar(r)),Ar(Q(t,r))):f.zero}function v_(t,r){return C(t)&&cr(t,f.zero)||C(r)&&cr(r,f.zero)?!1:!(C(t)&&C(r)&&cr(t,r))}function zm(t){return y_(_(l(t)))}function y_(t){return E_(t)}function E_(t){if(!C(t))return q(s(Ai),t);if(X(t))return K(Math.ceil(t.d));if(qt(t))return t;let r=new Ot(kr(t.q.a,t.q.b));return It(t)||(r=I(r,f.one)),r}function Fm(t){let r=_(l(t)),e=_(A(t));return A_(r,e)}function A_(t,r){return q_(t,r)?$($(Ar(t),Ar(r)),Ar(Q(t,r))):f.zero}function q_(t,r){return C(t)&&cr(t,f.zero)||C(r)&&cr(r,f.zero)?!1:!(C(t)&&C(r)&&cr(t,r))}function Vm(t){return af(_(l(t)))}function af(t){return I(p(lr(p(f.imaginaryunit,t)),P(1,2)),p(lr(p(U(f.imaginaryunit),t)),P(1,2)))}function Zm(t){return lf(_(l(t)))}function lf(t){return Q(p($(lr(p(f.imaginaryunit,t)),f.imaginaryunit),P(1,2)),p($(lr(p(U(f.imaginaryunit),t)),f.imaginaryunit),P(1,2)))}function Ym(t){let r=ff(_(l(t)));return _(r)}function ff(t){if(u(t)===s(ur))return af(l(t));if(u(t)===s(fr))return lf(l(t));if(u(t)===s(ve)){t=l(t);let r=lr(p(f.imaginaryunit,t)),e=lr(U(p(f.imaginaryunit,t)));return $(p(Q(e,r),f.imaginaryunit),I(r,e))}return u(t)===s(go)?(t=l(t),p(I(lr(t),lr(U(t))),P(1,2))):u(t)===s(qo)?(t=l(t),p(Q(lr(t),lr(U(t))),P(1,2))):u(t)===s(Mo)?(t=lr(p(l(t),y(2))),$(Q(t,f.one),I(t,f.one))):M(t)?t.map(ff):(t.k===un&&(t=to(t),t.tensor.elem=t.tensor.elem.map(ff)),t)}function jm(t){let r=_(l(t)),e,o;return Er(t)===s(L)?(e=f.one,o=y(2)):(e=_(A(t)),o=_(zt(t))),M_(r,e,o)}function M_(t,r,e){let o=[],n=[];if(!H(t))return V(t)||N("contract: tensor expected, 1st arg is not a tensor"),f.zero;let i=et(r),a=et(e),{ndim:c}=t.tensor;(i<1||i>c||a<1||a>c||i===a||t.tensor.dim[i-1]!==t.tensor.dim[a-1])&&N("contract: index out of range"),i--,a--;let x=t.tensor.dim[i],g=1;for(let J=0;J<c;J++)J!==i&&J!==a&&(g*=t.tensor.dim[J]);r=mt(g),r.tensor.ndim=c-2;let v=0;for(let J=0;J<c;J++)J!==i&&J!==a&&(r.tensor.dim[v++]=t.tensor.dim[J]);let z=t.tensor.elem,B=r.tensor.elem;for(let J=0;J<c;J++)o[J]=0,n[J]=t.tensor.dim[J];for(let J=0;J<g;J++){let nt=f.zero;for(let ht=0;ht<x;ht++){o[i]=ht,o[a]=ht;let $t=0;for(let xr=0;xr<c;xr++)$t=$t*n[xr]+o[xr];nt=I(nt,z[$t])}B[J]=nt;for(let ht=c-1;ht>=0;ht--)if(!(ht===i||ht===a)){if(++o[ht]<n[ht])break;o[ht]=0}}return g===1?B[0]:r}function Hm(t){let r=_(l(t));for(t=Er(t);M(t);){let e=_(u(t));t=m(t);let o=_(u(t));t=m(t);let n=_(u(t));t=m(t),r=Nn(r,e);let i=_(Gt(r,e,n)),a=_(Gt(r,e,o));r=Q(i,a)}return r}function Qm(t){let r=_(l(t));t=_(A(t));let e=t===s(L)?mr(r):t;return qi(r,e)}function qi(t,r){return Jm(t,r,f.zero)}function Jm(t,r,e){return ot(t,r)?V(e)&&(e=f.one):tt(t)?ot(l(t),r)&&C(A(t))&&cr(e,A(t))&&(e=A(t)):M(t)&&(e=t.tail().reduce((o,n)=>Jm(n,r,o),e)),e}var ct=0,Ir=[],Go=[];function Wm(t){let{arg:r}=uf(t);r||N("eigen: argument is not a square matrix");let[e,o]=cf(Mi,r);return t=Be("D"),Jt(t,e),t=Be("Q"),Jt(t,o),s(L)}function Xm(t){let{arg:r,invalid:e}=uf(t);if(e)return q(s(Si),e);let[o,n]=cf(Si,r);return o}function Km(t){let{arg:r,invalid:e}=uf(t);if(e)return q(s(wi),e);let[o,n]=cf(wi,r);return n}function uf(t){if(t=_(Nr(_(l(t)))),!H(t))return{invalid:t};(t.tensor.ndim!==2||t.tensor.dim[0]!==t.tensor.dim[1])&&N("eigen: argument is not a square matrix"),ct=t.tensor.dim[0],S_(t)||N("eigen: matrix is not numerical");for(let r=0;r<ct-1;r++)for(let e=r+1;e<ct;e++){let o=t.tensor.elem[ct*r+e],n=t.tensor.elem[ct*e+r];Math.abs(o.d-n.d)>1e-10&&N("eigen: matrix is not symmetrical")}return{arg:t}}function S_(t){for(let r=0;r<ct;r++)for(let e=0;e<ct;e++)if(!X(t.tensor.elem[ct*r+e]))return!1;return!0}function cf(t,r){for(let i=0;i<ct*ct;i++)Ir[i]=0;for(let i=0;i<ct*ct;i++)Go[i]=0;for(let i=0;i<ct;i++){Ir[ct*i+i]=r.tensor.elem[ct*i+i].d;for(let a=i+1;a<ct;a++)Ir[ct*i+a]=r.tensor.elem[ct*i+a].d,Ir[ct*a+i]=r.tensor.elem[ct*i+a].d}for(let i=0;i<ct;i++){Go[ct*i+i]=1;for(let a=i+1;a<ct;a++)Go[ct*i+a]=0,Go[ct*a+i]=0}let e=0;for(e=0;e<100&&w_()!==0;e++);e===100&&k(`
note: eigen did not converge
`);let o;if(t===Mi||t===Si){o=to(r);for(let i=0;i<ct;i++)for(let a=0;a<ct;a++)o.tensor.elem[ct*i+a]=K(Ir[ct*i+a])}let n;if(t===Mi||t===wi){n=to(r);for(let i=0;i<ct;i++)for(let a=0;a<ct;a++)n.tensor.elem[ct*i+a]=K(Go[ct*i+a])}return[o,n]}function w_(){let t=0;for(let r=0;r<ct-1;r++)for(let e=r+1;e<ct;e++)Ir[ct*r+e]!==0&&(O_(r,e),t++);return t}function O_(t,r){let e=.5*(Ir[ct*t+t]-Ir[ct*r+r])/Ir[ct*t+r],o=1/(Math.abs(e)+Math.sqrt(e*e+1));e<0&&(o=-o);let n=1/Math.sqrt(o*o+1),i=o*n;for(let a=0;a<ct;a++){let c=Ir[ct*t+a],x=Ir[ct*r+a];Ir[ct*t+a]=n*c+i*x,Ir[ct*r+a]=n*x-i*c}for(let a=0;a<ct;a++){let c=Ir[ct*a+t],x=Ir[ct*a+r];Ir[ct*a+t]=n*c+i*x,Ir[ct*a+r]=n*x-i*c}for(let a=0;a<ct;a++){let c=Go[ct*t+a],x=Go[ct*r+a];Go[ct*t+a]=n*c+i*x,Go[ct*r+a]=n*x-i*c}Ir[ct*t+r]=0,Ir[ct*r+t]=0}function td(t){return T_(_(l(t)))}function T_(t){if(X(t)){let r=mf(t.d);return K(r)}return V(t)?f.one:q(s(bi),t)}function mf(t){if(t===0)return 1;let r=Math.abs(t),e=1/(1+.5*r),o=e*Math.exp(-r*r-1.26551223+e*(1.00002368+e*(.37409196+e*(.09678418+e*(-.18628806+e*(.27886807+e*(-1.13520398+e*(1.48851587+e*(-.82215223+e*.17087277)))))))));return t>=0?o:2-o}function rd(t){return N_(_(l(t)))}function N_(t){return X(t)?K(1-mf(t.d)):V(t)?f.zero:Ct(t)?U(q(s(Ln),U(t))):q(s(Ln),t)}function df(t){let r=[];return W(t)?t.tail().forEach(e=>r.push(...ed(e))):r.push(...ed(t)),r}function ed(t){return Y(t)?t.tail():[t]}function id(t){let r=_(l(t)),e=_(A(t)),o=e===s(L)?mr(r):e;return xf(r,o)}function xf(t,r){if(H(t))return I_(t,r);if(W(t))return t.tail().reduce((c,x)=>I(c,xf(x,r)),f.zero);let e=Zr(t),o=Cr(t);if([o,e]=R_(o,e,r),(We(e)||We(o))&&(!Dr(o,r)||We(o)))return t;let n=Ji(e,o,r);if(e=Q(e,p(o,n)),V(e))return n;o=_e(o,r);let i=L_(o,r);e=C_(e,i,r),o=P_(o,i,r);let a;if(H(i)){let c=$r(po,i);a=Ur(Ur(c,e),o)}else{let c=$r($,e,i);a=p(c,o)}return I(a,n)}function I_(t,r){return t=to(t),t.tensor.elem=t.tensor.elem.map(e=>xf(e,r)),t}function R_(t,r,e){let o=[...df(t),...df(r)],n=0;for(let i=0;i<o.length;i++){let a=o[i];if(!tt(a)||l(a)!==e)continue;let c=et(A(a));isNaN(c)||c<n&&(n=c)}return n===0?[t,r]:(t=p(t,T(e,y(-n))),r=p(r,T(e,y(-n))),[t,r])}function L_(t,r){let e=[];Y(t)?t.tail().forEach(i=>e.push(...od(t,i,r))):e.push(...od(t,t,r));let o=e.length;if(o===1)return e[0];let n=mt(o*o);n.tensor.ndim=2,n.tensor.dim[0]=o,n.tensor.dim[1]=o;for(let i=0;i<o;i++)for(let a=0;a<o;a++){let c=T(r,y(i)),x=$r($,e[a],c);n.tensor.elem[o*i+a]=so(x,r)}return n}function od(t,r,e){let o,n=0;if(!it(r,e))return[];let i=$r($_,t,r);tt(r)?(n=et(A(r)),o=l(r)):(n=1,o=r);let a=[],c=et(qi(o,e));for(let x=0;x<n;x++)for(let g=0;g<c;g++){let v=T(o,y(x)),z=$r(p,i,v);v=T(e,y(g));let B=$r(p,z,v);a.push(B)}return a}function $_(t,r){let e=f.one;if(Y(t)){let o=[];t.tail().forEach(n=>{ot(n,r)||o.push(_(n))}),e=ae(o)}return e}function C_(t,r,e){if(!H(r))return t;let o=r.tensor.dim[0],n=mt(o);n.tensor.ndim=1,n.tensor.dim[0]=o;for(let i=0;i<o;i++){let a=T(e,y(i)),c=$r($,t,a);n.tensor.elem[i]=so(c,e)}return n}function P_(t,r,e){if(!H(r))return he(t);let o=[];Y(t)?t.tail().forEach(a=>{o.push(...nd(a,e))}):o=nd(t,e);let n=o.length,i=mt(n);return i.tensor.ndim=1,i.tensor.dim[0]=n,i.tensor.elem=o,i}function nd(t,r){let e=1;if(!it(t,r))return[];tt(t)&&(e=et(A(t)),t=l(t));let o=[],n=et(qi(t,r));for(let i=e;i>0;i--)for(let a=0;a<n;a++)o.push(p(he(T(t,y(i))),T(r,y(a))));return o}function sd(t){return k_(_(l(t)))}function k_(t){return D_(t)}function D_(t){if(!C(t))return q(s(Oi),t);if(X(t))return K(Math.floor(t.d));if(qt(t))return t;let r=new Ot(kr(t.q.a,t.q.b));return It(t)&&(r=I(r,f.negOne)),r}function ad(t){let r=A(t);pt(r)||N("for: 2nd arg should be the variable to loop over");let e=Hr(zt(t));if(isNaN(e))return t;let o=Hr(xe(t));if(isNaN(o))return t;let n=xt(r);for(let i=e;i<=o;i++)Jt(r,y(i)),_(l(t));return Jt(r,n),s(L)}function ld(t){return Ca(_(l(t)))}function Ca(t){return B_(t)}function B_(t){return lt(t)&&Wt(t.q.a,1)&&Wt(t.q.b,2)?T(f.Pi(),P(1,2)):lt(t)&&Wt(t.q.a,3)&&Wt(t.q.b,2)?p(T(f.Pi(),P(1,2)),P(1,2)):Ct(t)?$(p(f.Pi(),f.negOne),p(p(br(p(f.Pi(),t)),t),Ca(U(t)))):W(t)?U_(t):q(s(gs),t)}function U_(t){let r=m(t);return lt(u(r))&&Wt(u(r).q.a,1)&&Wt(u(r).q.b,1)?p(l(r),Ca(l(r))):lt(u(r))&&Wt(u(r).q.a,-1)&&Wt(u(r).q.b,1)?$(Ca(l(r)),I(l(r),f.negOne)):q(s(gs),t)}function fd(t){return G_(_(l(t)))}function G_(t){return Sa(t)&&Ps(t.q.a)?f.one:f.zero}function cd(t){let r=_(l(t)),e=_(A(t)),o=_(zt(t)),n=o===s(L)?f.zero:o;return z_(r,e,n)}function z_(t,r,e){let o=et(r);return o<0||isNaN(o)?q(s(Pa),t,r,e):pt(t)?ud(o,t,e):_(Gt(ud(o,s(Pt),e),s(Pt),t))}function ud(t,r,e){let o=f.zero,n=f.one;for(let i=0;i<t;i++){let a=$(Q(p(I(Q(y(2*i+1),r),e),n),p(I(y(i),e),o)),y(i+1));o=n,n=a}return n}function md(t){let r=_(l(t));t=_(A(t));let e=t===s(L)?mr(r):t;return F_(r,e)}function F_(t,r){let e=qi(t,r);return so($(t,T(r,e)),r)}function xd(t){let r=_(l(t)),e=_(A(t)),o=_(zt(t)),n=o===s(L)?f.zero:o;return V_(r,e,n)}function V_(t,r,e){return Z_(t,r,e)}function Z_(t,r,e){let o=et(r),n=et(e);if(o<0||isNaN(o)||n<0||isNaN(n))return q(s(Da),t,r,e);let i;if(pt(t))i=dd(o,n,t);else{let a=dd(o,n,s(Pt));i=_(Gt(a,s(Pt),t))}return i=Y_(i,n,t)||i,i}function dd(t,r,e){let o=f.zero,n=f.one;for(let i=0;i<t;i++){let a=$(Q(p(p(y(2*i+1),e),n),p(y(i),o)),y(i+1));o=n,n=a}for(let i=0;i<r;i++)n=St(n,e);return n}function Y_(t,r,e){if(r===0)return;let o=Q(f.one,ka(e));u(e)===s(ur)?o=ka(br(l(e))):u(e)===s(fr)&&(o=ka(Or(l(e))));let n=p(t,T(o,p(y(r),P(1,2))));return r%2&&(n=U(n)),n}function pd(t){return t=l(t),!M(t)&&l(t).k===zr&&(t=xt(t)),t}function gd(t){let r=_(l(t)),e=_(A(t));return j_(r,e)}function j_(t,r){if(V(r)&&N("mod function: divide by zero"),!C(t)||!C(r))return q(s(Ba),t,r);if(X(t)){let e=et(t);isNaN(e)&&N("mod function: cannot convert float value to integer"),t=y(e)}if(X(r)){let e=et(r);isNaN(e)&&N("mod function: cannot convert float value to integer"),r=y(e)}return(!qt(t)||!qt(r))&&N("mod function: integer arguments expected"),new Ot(Zn(t.q.a,r.q.a))}var _d=101,Ga=1e-6,H_=1e-9;function bs(t){return Math.sqrt(t.r*t.r+t.i*t.i)}function Ua(){return 4*Math.random()-2}var ro=class{constructor(){rt(this,"r",0);rt(this,"i",0)}},jt=new ro,So=new ro,dr=new ro,Jr=new ro,pe=new ro,qe=new ro,Ti=new ro,wo=new ro,Lt=[];for(let t=0;t<_d;t++)Lt[t]=new ro;function hd(t){let r=_(A(t));t=_(l(t)),r=r===s(L)?mr(t):r,Dr(t,r)||N("nroots: polynomial?");let e=Oe(t,r),o=e.length;o>_d&&N("nroots: degree?");for(let i=0;i<o;i++)t=_(Nr(Yr(e[i]))),r=_(Nr(Ho(e[i]))),(!X(t)||!X(r))&&N("nroots: coefficients?"),Lt[i].r=t.d,Lt[i].i=r.d;Q_(o);let n=[];for(let i=o;i>1;i--)J_(i),Math.abs(jt.r)<Ga&&(jt.r=0),Math.abs(jt.i)<Ga&&(jt.i=0),n.push(I(K(jt.r),p(K(jt.i),f.imaginaryunit))),W_(i);if(o=n.length,o==1)return n[0];if(o>1)return n.sort(Ne),t=mt(o),t.tensor.ndim=1,t.tensor.dim[0]=o,t.tensor.elem=n,t}function Q_(t){Jr.r=Lt[t-1].r,Jr.i=Lt[t-1].i;let r=Jr.r*Jr.r+Jr.i*Jr.i;for(let e=0;e<t-1;e++)Lt[e].r=(Lt[e].r*Jr.r+Lt[e].i*Jr.i)/r,Lt[e].i=(Lt[e].i*Jr.r-Lt[e].r*Jr.i)/r;Lt[t-1].r=1,Lt[t-1].i=0}function J_(t){if(bs(Lt[0])<Ga){jt.r=0,jt.i=0;return}for(let r=0;r<100;r++){jt.r=Ua(),jt.i=Ua(),bd(t),So.r=jt.r,So.i=jt.i,qe.r=pe.r,qe.i=pe.i,jt.r=Ua(),jt.i=Ua();for(let e=0;e<1e3;e++){bd(t);let o=bs(pe);if(D&&console.log(`nrabs: ${o}`),o<H_)return;bs(pe)<bs(qe)&&(dr.r=jt.r,dr.i=jt.i,jt.r=So.r,jt.i=So.i,So.r=dr.r,So.i=dr.i,dr.r=pe.r,dr.i=pe.i,pe.r=qe.r,pe.i=qe.i,qe.r=dr.r,qe.i=dr.i),Ti.r=So.r-jt.r,Ti.i=So.i-jt.i,wo.r=qe.r-pe.r,wo.i=qe.i-pe.i;let n=wo.r*wo.r+wo.i*wo.i;if(n===0)break;Jr.r=(Ti.r*wo.r+Ti.i*wo.i)/n,Jr.i=(Ti.i*wo.r-Ti.r*wo.i)/n,jt.r=So.r-(Jr.r*qe.r-Jr.i*qe.i),jt.i=So.i-(Jr.r*qe.i+Jr.i*qe.r)}}N("nroots: convergence error")}function bd(t){dr.r=jt.r,dr.i=jt.i,pe.r=Lt[0].r+Lt[1].r*dr.r-Lt[1].i*dr.i,pe.i=Lt[0].i+Lt[1].r*dr.i+Lt[1].i*dr.r;for(let r=2;r<t;r++){let e=jt.r*dr.r-jt.i*dr.i;dr.i=jt.r*dr.i+jt.i*dr.r,dr.r=e,pe.r+=Lt[r].r*dr.r-Lt[r].i*dr.i,pe.i+=Lt[r].r*dr.i+Lt[r].i*dr.r}}function W_(t){for(let r=t-1;r>0;r--)Lt[r-1].r+=Lt[r].r*jt.r-Lt[r].i*jt.i,Lt[r-1].i+=Lt[r].i*jt.r+Lt[r].r*jt.i;bs(Lt[0])>Ga&&N("nroots: residual error");for(let r=0;r<t-1;r++)Lt[r].r=Lt[r+1].r,Lt[r].i=Lt[r+1].i}function vd(t){t=m(t);let r=_(u(t));return M(t)?t.tail().reduce((o,n)=>X_(o,_(n)),r):r}function X_(t,r){return H(t)&&H(r)?K_(t,r):H(t)?ti(t,r):H(r)?ri(t,r):p(t,r)}function K_(t,r){let e=t.tensor.ndim+r.tensor.ndim;e>ye&&N("outer: rank of result exceeds maximum");let o=t.tensor.nelem*r.tensor.nelem,n=mt(o);n.tensor.ndim=e,n.tensor.dim=[...t.tensor.dim,...r.tensor.dim];let i=0;for(let a=0;a<t.tensor.nelem;a++)for(let c=0;c<r.tensor.nelem;c++)n.tensor.elem[i++]=p(t.tensor.elem[a],r.tensor.elem[c]);return n}function yd(t){return pf(t),s(L)}function pf(t){let r;M(m(t))||N("pattern needs at least a template and a transformed version");let e=u(m(t)),o=u(m(m(t)));o===s(L)&&N("pattern needs at least a template and a transformed version"),M(m(m(t)))?r=u(m(m(m(t)))):r=s(L),ot(e,o)&&N("recursive pattern");let n="template: "+Kr(e);n+=" tests: "+Kr(r),D&&console.log(`pattern stringkey: ${n}`);let i=h.userSimplificationsInStringForm.indexOf(n);return i===-1?(h.userSimplificationsInStringForm.push(n),h.userSimplificationsInListForm.push(m(t))):(D&&console.log(`pattern already exists, replacing. ${m(t)}`),h.userSimplificationsInStringForm[i]=n,h.userSimplificationsInListForm[i]=m(t)),q(s(on),m(t))}function gf(){h.userSimplificationsInListForm=[],h.userSimplificationsInStringForm=[]}function Ed(){return gf(),s(L)}function Ad(){let t=th();return t!==""?new ho(t):s(L)}function th(){let t="";for(let r of Array.from(h.userSimplificationsInListForm))t+=h.userSimplificationsInListForm+`
`;return t}function qd(t){return rh(_(l(t)))}function rh(t){let r=et(t);return(r<1||r>Hn)&&N("prime: Argument out of range."),r=jn[r-1],y(r)}function Md(t){let r=l(t),e=A(t);pt(e)||N("sum: 2nd arg?");let o=Hr(zt(t));if(isNaN(o))return t;let n=Hr(xe(t));if(isNaN(n))return t;let i=xt(e),a=f.one;for(let c=o;c<=n;c++){Jt(e,y(c));let x=_(r),g=p(a,x);D&&(console.log(`product - factor 1: ${x}`),console.log(`product - factor 2: ${a}`),console.log(`product - result: ${g}`)),a=g}return Jt(e,i),a}function Sd(t){return eh(_(l(t)))}function eh(t){return C(t)?X(t)?K(Math.round(t.d)):qt(t)?t:(t=Nr(t),y(Math.round(t.d))):q(s(Ni),t)}function wd(t){return oh(_(l(t)))}function oh(t){if(!H(t))return V(t)||N("transpose: tensor expected, 1st arg is not a tensor"),f.zero;let{ndim:r}=t.tensor,e=mt(r);e.tensor.ndim=1,e.tensor.dim[0]=r;for(let o=0;o<r;o++)e.tensor.elem[o]=y(t.tensor.dim[o]);return e}function Od(t){let r=l(t),e=A(t);pt(e)||N("sum: 2nd arg?");let o=Hr(zt(t));if(isNaN(o))return t;let n=Hr(xe(t));if(isNaN(n))return t;let i=xt(e),a=f.zero;for(let c=o;c<=n;c++)Jt(e,y(c)),a=I(a,_(r));return Jt(e,i),a}function Td(t){return Nd(_(l(t)))}function Nd(t){if(u(t)===s(Fr))return l(t);if(X(t)){let e=Math.tan(t.d);return Math.abs(e)<1e-10&&(e=0),K(e)}if(se(t))return U(Nd(U(t)));let r=et($(p(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(ve),t);switch(r%360){case 0:case 180:return f.zero;case 30:case 210:return p(P(1,3),T(y(3),P(1,2)));case 150:case 330:return p(P(-1,3),T(y(3),P(1,2)));case 45:case 225:return f.one;case 135:case 315:return f.negOne;case 60:case 240:return T(y(3),P(1,2));case 120:case 300:return U(T(y(3),P(1,2)));default:return q(s(ve),t)}}function Id(t){return nh(_(l(t)))}function nh(t){if(u(t)===s(an))return l(t);if(X(t)){let r=Math.tanh(t.d);return Math.abs(r)<1e-10&&(r=0),K(r)}return V(t)?f.zero:q(s(Mo),t)}function Rd(t){t=m(t);let r=_(u(t));t=m(t);let e=_(u(t)),o=e===s(L)?mr(r):e;t=m(t),e=_(u(t));let n=e===s(L)?y(24):e;t=m(t),e=_(u(t));let i=e===s(L)?f.zero:e;return ih(r,o,n,i)}function ih(t,r,e,o){let n=et(e);if(isNaN(n))return q(s(za),t,r,e,o);let i=f.one,a=_(Gt(t,r,o));for(let c=1;c<=n&&(t=St(t,r),!V(t));c++){i=p(i,Q(r,o));let x=_(Gt(t,r,o));a=I(a,$(p(x,i),Ar(y(c))))}return a}function Ld(t){let r=t;for(t=m(t);M(t);){if(m(t)===s(L))return _(u(t));let e=Uo(u(t));if(e==null)return r;if(e)return _(l(t));t=Er(t)}return f.zero}function $d(t){let r=t,e=Q(_(l(t)),_(A(t))),o=Uo(e);if(o)return f.zero;if(o!=null&&!o)return f.one;let n=Mt(_(l(t))),i=Mt(_(A(t)));return e=Q(n,i),o=Uo(e),o?f.zero:o!=null&&!o?f.one:r}function Cd(t){let r=t,e=Fa(t);return e==null?r:e>=0?f.one:f.zero}function Pd(t){let r=t,e=Fa(t);return e==null?r:e>0?f.one:f.zero}function kd(t){let r=t,e=Fa(t);return e==null?r:e<=0?f.one:f.zero}function Dd(t){let r=t,e=Fa(t);return e==null?r:e<0?f.one:f.zero}function Bd(t){let r=t,e=Uo(l(t));return e==null?r:e?f.zero:f.one}function Ud(t){let r=t,e=m(r),o=!1;for(;M(e);){let n=Uo(u(e));if(n==null)o=!0,e=m(e);else if(n)e=m(e);else if(!n)return f.zero}return o?r:f.one}function Gd(t){let r=t,e=m(r),o=!1;for(;M(e);){let n=Uo(u(e));if(n==null)o=!0,e=m(e);else{if(n)return f.one;n||(e=m(e))}}return o?r:f.zero}function Fa(t){let r=0,e=Mt(_(l(t))),o=Mt(_(A(t)));if(t=Q(e,o),t.k!==Zt&&t.k!==Ut&&(t=_(Nr(t))),V(t))return 0;switch(t.k){case Zt:Xe(t.q.a)===-1?r=-1:r=1;break;case Ut:t.d<0?r=-1:r=1;break;default:r=null}return r}function zd(t){let r=Array(ye).fill(0),e=1,o=0;if(M(t))for(let n of t.tail()){let i=Hr(n);if(i<1||isNaN(i))return f.zero;e*=i,r[o++]=i}if(o===0)return f.zero;t=mt(e),t.tensor.ndim=o;for(let n=0;n<o;n++)t.tensor.dim[n]=r[n];return t}var bf=0;function Cn(){bf=0,Pn(),h.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!bf&&(bf=1,jd(),_f())}var Fd=['version="'+Va+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function _f(){S($e,bm),S(Pr,pm),S(tx,Ju),S(rx,Ud),S($a,Nm),S(Je,Pm),S(tn,km),S(Qe,Dm),S(sn,Bm),S(Fr,Au),S(an,Um),S(Ki,wu),S(ex),S(Xo,tc),S(Sn,ec),S(ox,zc),S(Za,Gm),S(Ai,zm),S(nx,Fc),S(ix,Fm),S(sx,Ym),S(ax,Zd),S(lx,Vd),S(fx,Ed),S(ux,Zf),S(cx,Vf),S(mx,Qu),S(dx,gu),S(xx,Hf),S(px,jm),S(ur,au),S(go,nc),S(gx,qc),S(Ya,Hm),S(bx,Qm),S(_x,yu),S(js,Vc),S(Qr,_a),S(hx,Zc),S(oi,ic),S(vx,Yc),S(ja,jc),S(hf,Ws),S(yx),S(Ex),S(Ln,rd),S(bi,td),S(Mi,Wm),S(Si,Xm),S(wi,Km),S(io,Hc),S(ba,Qc),S(Ax,id),S(qx,Vm),S(Mx,Zm),S(Sx,ru),S(Br,Jc),S(wx,Wc),S(Ox,Ff),S(Ta,bc),S(Oi,sd),S(Ei,ad),S(je,Gf),S(gs,ld),S(Tx,mu),S(ei,Xc),S(Qs,Kc),S(Nx,qu),S(vo,tm),S(Po,Ws),S(Eo,Lc),S(ss,rm),S(Xs,em),S(Ea,om),S(Ix,fd),S(Pa,cd),S(Rx,zf),S(Lx,md),S(Da,xd),S(Jo,Pc),S($x,pd),S(Ba,gd),S(Ht,Uu),S(sa,Bd),S(Cx,hd),S(Px,nm),S(kx,Eu),S(Wo,im),S(Dx,Gd),S(Bx,vd),S(on,pf),S(Ux,Ad),S(Gx,Yf),S(ut,Cu),S(zx,qd),S(Fx,Hd),S(Vx,Qd),S(Zx,Jd),S(Yx,Wd),S(jx,Kd),S(Hx,Xd),S(Ha),S(Qa),S(Ja,Md),S(aa,sm),S(Qx,nu),S(Jx,am),S(Wx,vu),S(Xx,Mu),S(Bs,fu),S(Kx,yc),S(Ni,Sd),S(Ee,lm),S(Rn,kc),S(tp,yd),S(rp,Oc),S(fr,iu),S(qo,Dc),S(ep,wd),S(gi,fm),S(op,um),S(np,cm),S(Wa,Od),S(ip,Yd),S(ve,Td),S(Mo,Id),S(za,Rd),S(Xa,Ld),S(Ue,$d),S(ai,Cd),S(li,Pd),S(fi,kd),S(ui,Dd),S(Ke,Sc),S(Ka,mm),S(sp,zd),S(L),S(il),S(sl),S(fo),S(hi),S(ap),S(tl),S(rl),S(el),S(ol),S(nl),S(lp),S(Ia),S(Ra),S(vf),S(fp),S(ue),S(ce),S(re),S(Pt),S(up),S(vt),S(cp),S(mp),S(dp),S(_i),S(Ii),S(Ri),S(xp),S(pp),S(Zo),S(Yo),S(Xr),S(ao),S(lo),S(Ce),S(ma),S(da),S(xa),S(gp),S(bp),S(_p),S(hp),S(vp),S(yp),sh();let t=h.codeGen;h.codeGen=!1;for(let r=0;r<Fd.length;r++){let e=Fd[r],[,o]=_o(e);D&&(console.log(`... evaling ${e}`),console.log("top of stack:"),console.log(Kr(o))),_(o)}h.codeGen=t}function sh(){let t=q(s(ut),y(-1),P(1,2));D&&console.log(Kr(t)),f.imaginaryunit=t}function Vd(){return Ep(),s(L)}function Ep(){return h.test_flag||void 0,gf(),Ap(),_f(),h.codeGen=!1}function Zd(t){let r;for(r=m(t);M(r);){let e=u(r);e.k!==zr&&N("symbol error"),qp(e),r=m(r)}return s(L)}var Np=1e4,Ef=class{constructor(){rt(this,"c",0);rt(this,"x",0);rt(this,"y",0)}},sr=[];for(let t=0;t<Np;t++)sr[t]=new Ef;var tr=0,Oo=0,To=0,Mp=0;function Af(t){let r="";return r+=t,r}function ah(t){return Af(t)}function ll(t){tr=0,Oo=0,To=0,lh(t);let[r,e,o]=Array.from(Ci(0,tr));if(e>100){vs(t);return}return yh()}function lh(t){if(u(t)===s(Ee)){Wr(l(t)),wf(" = "),Wr(A(t));return}H(t)?Ah(t):Wr(t)}function Sp(t){if(Oo>0)return!1;if(or(t))return!0;if(!Y(t))return!1;if(or(l(t)))return!0;for(;M(t);){if(kn(u(t)))return!0;t=m(t)}return!1}function Wr(t){if(Mp++,W(t))for(t=m(t),Li(u(t))&&(dt("-"),Sp(u(t))&&dt(" ")),$i(u(t)),t=m(t);M(t);)Li(u(t))?(dt(" "),dt("-"),dt(" ")):(dt(" "),dt("+"),dt(" ")),$i(u(t)),t=m(t);else Li(t)&&(dt("-"),Sp(t)&&dt(" ")),$i(t);Mp--}function fh(t){if(W(t))for(t=m(t),$i(u(t)),t=m(t);M(t);)Li(u(t))?(dt(" "),dt("-"),dt(" ")):(dt(" "),dt("+"),dt(" ")),$i(u(t)),t=m(t);else $i(t)}function Li(t){return!!(It(t)||Y(t)&&It(l(t)))}function $i(t){if(Y(t)){let r=uh(t);r&&Oo===0?mh(t,r):ch(t,r)}else eo(t)}function kn(t){return tt(t)&&l(t)!==s(rr)&&Li(A(t))}function uh(t){let r=0;for(t=m(t);M(t);){let e=u(t);kn(e)&&r++,t=m(t)}return r}function ch(t,r){if(r===0)for(t=m(t),(Et(u(t))||Nt(u(t)))&&(t=m(t)),eo(u(t)),t=m(t);M(t);)dt(" "),eo(u(t)),t=m(t);else dh(t),dt("/"),r>1||or(l(t))?(dt("("),wp(t),dt(")")):wp(t)}function mh(t,r){let e,o,n=0,i=0,a=0,c=0,x=0,g=f.one,v=f.one;for(lt(l(t))&&(g=me(Re(l(t))),v=Ie(l(t))),X(l(t))&&(g=me(l(t))),c=Et(g)?0:1,e=m(t),C(u(e))&&(e=m(e));M(e);)o=u(e),kn(o)||c++,e=m(e);for(x=To,i=tr,n=0,Et(g)||(zo(g,0),n++),e=m(t),C(u(e))&&(e=m(e));M(e);)o=u(e),kn(o)||(n>0&&dt(" "),c===1?Wr(o):eo(o),n++),e=m(e);for(n===0&&dt("1"),a=tr,n=0,Et(v)||(zo(v,0),n++,r++),e=m(t),lt(u(e))&&(e=m(e));M(e);)o=u(e),kn(o)&&(n>0&&dt(" "),Mf(o,r),n++),e=m(e);Sf(x,i,a)}function dh(t){let r=f.one;t=m(t),lt(u(t))?(r=me(Re(u(t))),t=m(t)):X(u(t))&&(r=me(u(t)),t=m(t));let e=0;for(Et(r)||(zo(r,0),e++);M(t);)kn(u(t))||(e>0&&dt(" "),eo(u(t)),e++),t=m(t);e===0&&dt("1")}function wp(t){let r=0;if(t=m(t),or(u(t))){let e=Ie(u(t));zo(e,0),r++,t=m(t)}for(;M(t);)kn(u(t))&&(r>0&&dt(" "),Mf(u(t),0),r++),t=m(t)}function eo(t){if(H(t)){al(t);return}if(X(t)){zo(t,0);return}if(W(t)||Y(t)){mn(t);return}if(tt(t)){ph(t);return}if(M(t)){gh(t);return}if(C(t)){Oo===0?xh(t):zo(t,0);return}if(pt(t)){Ip(t);return}ee(t)&&hh(t)}function xh(t){let r=me(Re(t)),e=Ie(t);if(Et(e)){zo(r,0);return}let o=To,n=tr;zo(r,0);let i=tr;zo(e,0),Sf(o,n,i)}function _s(t){return M(t)&&!W(t)&&!Y(t)&&!tt(t)||pt(t)?!0:or(t)||It(t)?!1:!!C(t)}function ph(t){let r=0,e=0,o=0;if(l(t)===s(rr)){wf("exp("),Wr(A(t)),dt(")");return}if(Oo>0){Nt(A(t))?(dt("1"),dt("/"),_s(l(t))?eo(l(t)):mn(l(t))):(_s(l(t))?eo(l(t)):mn(l(t)),dt("^"),_s(A(t))?eo(A(t)):mn(A(t)));return}if(Li(A(t))){o=To,r=tr,dt("1"),e=tr,Mf(t,1),Sf(o,r,e);return}r=tr,_s(l(t))?eo(l(t)):mn(l(t)),e=tr,Oo++,Wr(A(t)),Oo--,Rp(r,e)}function Mf(t,r){let e=0,o=0;if(Nt(A(t))){r===1?Wr(l(t)):eo(l(t));return}e=tr,_s(l(t))?eo(l(t)):mn(l(t)),o=tr,Oo++,fh(A(t)),Oo--,Rp(e,o)}function gh(t){if(u(t)===s(vo)&&pt(l(t))){bh(t);return}if(le(t)){_h(t);return}if(u(t)===s(Qr)?dt("d"):Ip(u(t)),dt("("),t=m(t),M(t))for(Wr(u(t)),t=m(t);M(t);)dt(","),Wr(u(t)),t=m(t);dt(")")}function bh(t){if(t=m(t),jr(t)===s(Pr)||jr(t)===s(Ht)||jr(t)===s(ut)||jr(t)===s(Br)?mn(u(t)):Wr(u(t)),dt("["),t=m(t),M(t))for(Wr(u(t)),t=m(t);M(t);)dt(","),Wr(u(t)),t=m(t);dt("]")}function _h(t){t=l(t),or(t)||W(t)||Y(t)||tt(t)||le(t)?mn(t):Wr(t),dt("!")}function mn(t){dt("("),Wr(t),dt(")")}function Ip(t){if(t===s(rr)){wf("exp(1)");return}let r=dn(t);for(let e=0;e<r.length;e++)dt(r[e])}function hh(t){let r=t.str;dt('"');for(let e=0;e<r.length;e++)dt(r[e]);dt('"')}function Sf(t,r,e){let o=0,n=0,[i,a,c]=Array.from(Ci(r,e)),[x,g,v]=Array.from(Ci(e,tr));g>a?o=(g-a)/2:o=0,o++,n=-(c+i-1)-1,hs(r,e,o,n),g>a?o=-a:o=-a+(a-g)/2,o++,n=-v+1,hs(e,tr,o,n);let B=0;g>a?B=g:B=a,B+=2,To=t;for(let J=0;J<B;J++)dt("-")}function Rp(t,r){let e=0,o=0,n=0,i=0,a=0,c=0,x=0;[o,n,i]=Array.from(Ci(t,r)),[a,c,x]=Array.from(Ci(r,tr)),e=-x-a+1,e+=i-1,hs(r,tr,0,e)}function hs(t,r,e,o){for(let n=t;n<r;n++)sr[n].x+=e,sr[n].y+=o}function Ci(t,r){let e=sr[t].x,o=sr[t].x,n=sr[t].y,i=sr[t].y;for(let g=t+1;g<r;g++)sr[g].x<e&&(e=sr[g].x),sr[g].x>o&&(o=sr[g].x),sr[g].y<n&&(n=sr[g].y),sr[g].y>i&&(i=sr[g].y);let a=i-n+1,c=o-e+1;return[a,c,n]}function dt(t){if(tr!==Np)return sr[tr]==null&&er,sr[tr].c=t,sr[tr].x=To,sr[tr].y=0,tr++,To++}function wf(t){for(let r=0;r<t.length;r++)dt(t[r])}function zo(t,r){let e="";switch(t.k){case Zt:e=t.q.a.toString(),e[0]==="-"&&r===0&&(e=e.substring(1));for(let o=0;o<e.length;o++)dt(e[o]);if(e=t.q.b.toString(),e==="1")break;dt("/");for(let o=0;o<e.length;o++)dt(e[o]);break;case Ut:e=Na(t.d),e[0]==="-"&&r===0&&(e=e.substring(1));for(let o=0;o<e.length;o++)dt(e[o]);break}}function vh(t,r){return t.y<r.y?-1:t.y>r.y?1:t.x<r.x?-1:t.x>r.x?1:0}function yh(){let t="",r=sr.slice(0,tr);r.sort(vh),sr=[].concat(r).concat(sr.slice(tr));let e=0,{y:o}=sr[0];for(let n=0;n<tr;n++){for(;sr[n].y>o;)t+=ah(`
`),e=0,o++;for(;sr[n].x>e;)t+=Af(" "),e++;t+=Af(sr[n].c),e++}return t}var Eh=100,qf=class{constructor(){rt(this,"x",0);rt(this,"y",0);rt(this,"h",0);rt(this,"w",0);rt(this,"index",0);rt(this,"count",0)}},pr=[];for(let t=0;t<1e4;t++)pr[t]=new qf;var Op=3,Tp=1;function Ah(t){let r=0,e=0,o=0;if(t.tensor.ndim>2){al(t);return}let n=t.tensor.dim[0];t.tensor.ndim===2?r=t.tensor.dim[1]:r=1;let i=n*r;if(i>Eh){al(t);return}let a=To;for(let B=0;B<i;B++)pr[B].index=tr,pr[B].x=To,Wr(t.tensor.elem[B]),pr[B].count=tr-pr[B].index,[pr[B].h,pr[B].w,pr[B].y]=Array.from(Ci(pr[B].index,tr));let c=0,x=0;for(let B=0;B<i;B++)pr[B].h>c&&(c=pr[B].h),pr[B].w>x&&(x=pr[B].w);let g=n*c+(n-1)*Tp,v=r*x+(r-1)*Op,z=-(g/2);for(let B=0;B<n;B++)for(let J=0;J<r;J++){let nt=B*r+J;e=a-pr[nt].x,o=z-pr[nt].y,hs(pr[nt].index,pr[nt].index+pr[nt].count,e,o),e=0,J>0&&(e=J*(x+Op)),o=0,B>0&&(o=B*(c+Tp)),e+=(x-pr[nt].w)/2,o+=(c-pr[nt].h)/2,hs(pr[nt].index,pr[nt].index+pr[nt].count,e,o)}To=a+v}function al(t){Lp(t,0,0)}function Lp(t,r,e){dt("(");for(let o=0;o<t.tensor.dim[r];o++)r+1===t.tensor.ndim?(Wr(t.tensor.elem[e]),e=e+1):e=Lp(t,r+1,e),o+1<t.tensor.dim[r]&&dt(",");return dt(")"),e}function N(t){h.errorMessage+="Stop: ",h.errorMessage+=t;let r=h.errorMessage;throw h.errorMessage="",new Error(r)}var qh="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function $p(t){return t=t.replace(/\n/g,""),t=t.replace(/_/g,"} \\_ \\text{"),t=t.replace(new RegExp(String.fromCharCode(fa),"g"),"}{}^{T}\\text{"),t=t.replace(new RegExp(String.fromCharCode(yo),"g"),"}\\cdot \\text{"),t=t.replace("Stop:","}  \\quad \\text{Stop:"),t=t.replace("->","}  \\rightarrow \\text{"),t=t.replace("?","}\\enspace "+qh+" \\enspace  \\text{"),t="$$\\text{"+t.replace(/\n/g,"")+"}$$",t}function Mh(t){return t=t.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(yo)),t=t.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(yo)),t=t.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(yo)),t=t.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(yo)),t=t.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(yo)),t}var Sh=!1;function yf(t,r=!1){let e,o,n,i=new Date().getTime();t=Mh(t),h.inited||(h.inited=!0,Cn());let a=0,c=0,x="",g="",v,z;for(;;){try{h.errorMessage="",Dn(),[a,e]=_o(t.substring(c)),Dn()}catch(J){ys&&console.log(J),x+=J.message,r&&(g+=$p(J.message)),Pn();break}if(a===0)break;c+=a;let B=!1;try{h.stringsEmittedByUserPrintouts="",o=Of(e),Dn(),ee(o)&&(D&&console.log(o.str),D&&console.log(`
`)),o===s(L)?(z=h.stringsEmittedByUserPrintouts,r&&(v="$$"+h.stringsEmittedByUserPrintouts+"$$")):(z=G(o),z+=`
`,r&&(v="$$"+fl(o)+"$$",D&&console.log(`collectedLatexResult: ${v}`))),x+=z,r&&(g+=v),ys&&(D&&console.log("printline"),D&&console.log(z)),ys&&(D&&console.log("display:"),ll(o)),r&&(g+=`
`)}catch(J){B=!0,z=J.message,r&&(v=$p(J.message)),ys&&console.log(z),x+=z,z!==""&&(x+=`
`),r&&(g+=v,g+=`
`),Cn()}}if(x[x.length-1]===`
`&&(x=x.substring(0,x.length-1)),r&&g[g.length-1]===`
`&&(g=g.substring(0,g.length-1)),r?(D&&console.log(`allReturnedLatexStrings: ${g}`),n=[x,g]):n=x,Sh){let B="run time on: "+t+" : "+(new Date().getTime()-i)+"ms";console.log(B)}return x="",g="",n}function Dn(){h.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(er,N("symbols evaluation still ongoing?")),h.evaluatingAsFloats&&(er,N("numeric evaluation still ongoing?")),h.evaluatingPolar&&(er,N("evaluation of polar still ongoing?"))}function Of(t){D&&console.log("#### top level eval"),h.trigmode=0;let r=s(il);h.expanding=!V(xt(r));let e=t,o=_(t);return o===s(L)||(Jt(s(hi),o),V(xt(s(sl)))||(o=ef(o)),(e===s(Ii)||e===s(Ri))&&Se(o))?o:Se(xt(s(Ri)))?Gt(o,f.imaginaryunit,s(Ri)):Se(xt(s(Ii)))?Gt(o,f.imaginaryunit,s(Ii)):o}function va(){h.esc_flag&&N("esc key")}function xm(t){Dt(t);let{nelem:r,ndim:e}=t.tensor,o=mt(r);return o.tensor.ndim=e,o.tensor.dim=Array.from(t.tensor.dim),Dt(o),o.tensor.elem=t.tensor.elem.map(_),Dt(t),Dt(o),wh(o)}function gm(t,r){if(t.tensor.ndim!==r.tensor.ndim)return s(L);if(t.tensor.dim.some((x,g)=>x!==r.tensor.dim[g]))return s(L);let{nelem:e,ndim:o}=t.tensor,n=mt(e);n.tensor.ndim=o,n.tensor.dim=Array.from(t.tensor.dim);let i=t.tensor.elem,a=r.tensor.elem,c=n.tensor.elem;for(let x=0;x<e;x++)c[x]=I(i[x],a[x]);return n}function ti(t,r){let{ndim:e,nelem:o}=t.tensor,n=mt(o);return n.tensor.ndim=e,n.tensor.dim=Array.from(t.tensor.dim),n.tensor.elem=t.tensor.elem.map(i=>p(i,r)),n}function ri(t,r){let{ndim:e,nelem:o}=r.tensor,n=mt(o);return n.tensor.ndim=e,n.tensor.dim=Array.from(r.tensor.dim),n.tensor.elem=r.tensor.elem.map(i=>p(t,i)),n}function Dt(t){if(t.tensor.nelem!==t.tensor.elem.length)return console.log("something wrong in tensor dimensions"),er}function Co(t){return H(t)&&t.tensor.ndim===2&&t.tensor.dim[0]===t.tensor.dim[1]}function Bc(t,r){let{ndim:e,nelem:o}=t.tensor;if(e+1>=ye)return q(s(Qr),t,r);let n=mt(o*r.tensor.nelem);n.tensor.ndim=e+1,n.tensor.dim=[...t.tensor.dim,r.tensor.dim[0]];let i=t.tensor.elem,a=r.tensor.elem,c=n.tensor.elem;for(let x=0;x<o;x++)for(let g=0;g<r.tensor.nelem;g++)c[x*r.tensor.nelem+g]=St(i[x],a[g]);return n}function Uc(t,r){let e=mt(r.tensor.nelem);return e.tensor.ndim=1,e.tensor.dim[0]=r.tensor.dim[0],e.tensor.elem=r.tensor.elem.map(o=>St(t,o)),e}function Gc(t,r){let e=mt(t.tensor.nelem);return e.tensor.ndim=t.tensor.ndim,e.tensor.dim=[...t.tensor.dim],e.tensor.elem=t.tensor.elem.map(o=>St(o,r)),e}function Cp(t,r){if(t.tensor.ndim<r.tensor.ndim)return-1;if(t.tensor.ndim>r.tensor.ndim)return 1;for(let e=0;e<t.tensor.ndim;e++){if(t.tensor.dim[e]<r.tensor.dim[e])return-1;if(t.tensor.dim[e]>r.tensor.dim[e])return 1}for(let e=0;e<t.tensor.nelem;e++)if(!ot(t.tensor.elem[e],r.tensor.elem[e]))return cr(t.tensor.elem[e],r.tensor.elem[e])?-1:1;return 0}function Du(t,r){let e=t.tensor.ndim-1;if(t.tensor.dim[0]!==t.tensor.dim[e])return q(s(ut),t,r);let o=et(r);if(isNaN(o))return q(s(ut),t,r);if(o===0){t.tensor.ndim!==2&&N("power(tensor,0) with tensor rank not equal to 2"),o=t.tensor.dim[0],t=mt(o*o),t.tensor.ndim=2,t.tensor.dim[0]=o,t.tensor.dim[1]=o;for(let a=0;a<o;a++)t.tensor.elem[o*a+a]=f.one;return Dt(t),t}let n=t;o<0&&(o=-o,n=po(n));let i=n;for(let a=1;a<o&&(i=Ur(i,n),!V(i));a++);return i}function to(t){let r=mt(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=[...t.tensor.dim],r.tensor.elem=[...t.tensor.elem],Dt(t),Dt(r),r}function wh(t){if(!H(t))return t;let r=t.tensor.elem[0];if(t.tensor.elem.some(i=>!Oh(r,i))&&N("Cannot promote tensor due to inconsistent tensor components."),!H(r))return t;let e=t.tensor.ndim+r.tensor.ndim;e>ye&&N("tensor rank > "+ye);let o=t.tensor.nelem*r.tensor.nelem,n=mt(o);return n.tensor.ndim=e,n.tensor.dim=[...t.tensor.dim,...r.tensor.dim],n.tensor.elem=[].concat(...t.tensor.elem.map(i=>i.tensor.elem)),Dt(r),Dt(n),n}function Oh(t,r){if(!H(t)&&!H(r))return!0;if(!H(t)||!H(r)||t.tensor.ndim!==r.tensor.ndim)return!1;for(let e=0;e<t.tensor.ndim;e++)if(t.tensor.dim[e]!==r.tensor.dim[e])return!1;return!0}function mt(t){let r=new Pi;for(let e=0;e<t;e++)r.tensor.elem[e]=f.zero;return Dt(r),r}function Hu(t,r){let e=mt(t*r);return e.ndim=2,e.dim[0]=t,e.dim[1]=r,e}function ot(t,r){return Ne(t,r)===0}function cr(t,r){return Ne(t,r)<0}function En(t){return t<0?-1:t>0?1:0}function Ne(t,r){let e=0;if(t===r)return 0;if(t===s(L))return-1;if(r===s(L))return 1;if(C(t)&&C(r))return En(zs(t,r));if(C(t))return-1;if(C(r))return 1;if(ee(t)&&ee(r))return En(tf(t.str,r.str));if(ee(t))return-1;if(ee(r))return 1;if(pt(t)&&pt(r))return En(tf(dn(t),dn(r)));if(pt(t))return-1;if(pt(r))return 1;if(H(t)&&H(r))return Cp(t,r);if(H(t))return-1;if(H(r))return 1;for(;M(t)&&M(r);){if(e=Ne(u(t),u(r)),e!==0)return e;t=m(t),r=m(r)}return M(r)?-1:M(t)?1:0}function _r(t){return M(t)?[...t].length:0}function vl(t){return $r(_,t)}function lr(t){return T(s(rr),t)}function ka(t){return T(t,y(2))}function Ec(t){t.sort(Ne)}var Tf=t=>t.reduce((r,e)=>r+e,0);function Kt(t){let r;if(M(t)){let e=[...t];r=Tf(e.map(Kt))+e.length}else r=1;return r}function us(t,r){let e=0;return M(r)?e=Tf([...r].map(o=>us(t,o))):ot(t,r)&&(e=1),e}function Pp(t){let r=0;if(H(t))for(let e=0;e<t.tensor.nelem;e++)r+=Kt(t.tensor.elem[e]);else if(M(t)){let e=[...t];r=Tf(e.map(Kt))+e.length}else r=1;return r}function Yd(){let t=Th();return t!==""?new ho(t):s(L)}function Th(){return[...xn.symbolinfo()].join(`
`)}var Bn=class{constructor(r){rt(this,"parent");rt(this,"symbols",new Map);rt(this,"bindings",new Map);this.parent=r}getOrCreate(r){let e=this.getExisting(r);if(e)return e;let o=new ki(r);return this.symbols.set(r,o),o}getExisting(r){var e;return((e=this.parent)==null?void 0:e.getExisting(r))||this.symbols.get(r)}mustGet(r){var e;return this.symbols.get(r)||((e=this.parent)==null?void 0:e.mustGet(r))||N(`${r} not defined`)}has(r){return this.symbols.has(r.printname)}binding(r){var e;return this.bindings.get(r.printname)||((e=this.parent)==null?void 0:e.binding(r))||r}set(r,e){this.bindings.set(r.printname,e)}clear(){this.bindings.clear()}delete(r){var e;this.symbols.delete(r.printname),this.bindings.delete(r.printname),(e=this.parent)==null||e.delete(r)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[r,e]of this.symbols.entries()){let o=this.bindings.get(r)||e,n=(o+"").substring(0,4);yield`symbol: ${e} size: ${Pp(o)} value: ${n}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var r;for(let e of this.symbols.keys())e.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(e);for(let e of this.bindings.keys())e.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(e);(r=this.parent)==null||r.clearRenamedVariablesToAvoidBindingToExternalScope()}},Un=new Bn,xn=new Bn(Un);function S(t,r){let e=Un.getOrCreate(t);e.latexPrint=t,e.keyword=r}function Be(t){return xn.getOrCreate(t)}function dn(t){return t.k!==zr&&N("symbol error"),t.printname}function Jt(t,r){t.k!==zr&&N("symbol error"),xn.set(t,r)}function xt(t){return t.k!==zr&&N("symbol error"),xn.binding(t)}function Nh(t){return t.k!==zr?!1:/^[abcdjnrstxyz]_?$/.test(t.printname)||!Un.has(t)}function jd(){Un=new Bn,xn=new Bn(Un)}function Ap(){xn=new Bn(Un),Un.clear()}function Es(t,r){if(r==null&&(r=[]),Nh(t)&&r.indexOf(t)===-1){r.push(t);return}if(H(t)){for(let e=0;e<t.tensor.nelem;e++)Es(t.tensor.elem[e],r);return}for(;M(t);)Es(u(t),r),t=m(t)}function s(t){return xn.mustGet(t)}function ya(t){return pt(t)&&t.keyword!=null}function qp(t){xn.delete(t)}var Ih="^";function Hd(t){return h.stringsEmittedByUserPrintouts+=Di(m(t),h.printMode),s(L)}function Qd(t){return h.stringsEmittedByUserPrintouts+=Di(m(t),cl),s(L)}function Jd(t){return h.stringsEmittedByUserPrintouts+=Di(m(t),Ss),s(L)}function Wd(t){return h.stringsEmittedByUserPrintouts+=Di(m(t),ft),s(L)}function Xd(t){let r=h.test_flag;return h.test_flag=!1,h.stringsEmittedByUserPrintouts+=Di(m(t),Fe),h.test_flag=r,s(L)}function Kd(t){let r=Di(m(t),ml);return h.stringsEmittedByUserPrintouts+=r,s(L)}function Di(t,r){let e="";for(;M(t);){let o=_(u(t)),n=h.printMode;r===Ss?(h.printMode=Ss,e=vs(o),As(e,rl)):r===Fe?(h.printMode=Fe,e=vs(o),As(e,nl)):r===cl?(h.printMode=cl,e=ll(o),As(e,tl)):r===ft?(h.printMode=ft,e=vs(o),As(e,el)):r===ml&&(h.printMode=ml,e=Kr(o),As(e,ol)),h.printMode=n,t=m(t)}return D&&console.log(`emttedString from display: ${h.stringsEmittedByUserPrintouts}`),e}function As(t,r){let[,e]=_o('"'+t+'"');Jt(s(r),e)}function k(t){return D&&console.log(`emttedString from print_str: ${h.stringsEmittedByUserPrintouts}`),t}function fl(t){let r=h.printMode;h.printMode=ft;let e=h.codeGen;h.codeGen=!1;let o=G(t);return o=o.replace(/_/g,"\\_"),h.printMode=r,h.codeGen=e,D&&console.log(`emttedString from collectLatexStringFromReturnValue: ${h.stringsEmittedByUserPrintouts}`),o}function vs(t){let r="";return r+=G(t),r}function Dp(t){let r="";return or(t)||W(t)||Y(t)||tt(t)||cr(t,f.zero)?(r+="(",r+=G(t),r+=")"):r+=G(t),r}function kp(t){let r="";return or(t)||W(t)||Y(t)||tt(t)?(r+="(",r+=G(t),r+=")"):r+=G(t),r}function Rh(t,r){let e="",o=l(t),n=A(t);return Nt(n)?(e+=Dp(o),e):(r===1&&(e+="("),n=U(n),e+=Ms(o,n),r===1&&(e+=")"),e)}function Lh(t){let r,e,o="",n=0,i=0,a=0,c=m(t),x=u(c);for(lt(x)?(r=me(Re(x)),e=Ie(x),Et(r)||i++,Et(e)||a++,c=m(c)):(r=f.one,e=f.one);M(c);)x=u(c),ul(x)?a++:i++,c=m(c);if(h.printMode===ft&&(o+=k("\\frac{")),i===0)o+="1";else for(n=0,c=m(t),lt(u(c))&&(c=m(c)),Et(r)||(o+=oo(r),n=1);M(c);)x=u(c),ul(x)||(n&&(o+=If()),o+=oo(x),n=1),c=m(c);for(h.printMode===ft?o+=k("}{"):h.printMode===Fe&&!h.test_flag?o+=k(" / "):o+=k("/"),a>1&&h.printMode!==ft&&(o+="("),n=0,c=m(t),lt(u(c))&&(c=m(c)),Et(e)||(o+=oo(e),n=1);M(c);)x=u(c),ul(x)&&(n&&(o+=If()),o+=Rh(x,a),n=1),c=m(c);return a>1&&h.printMode!==ft&&(o+=")"),h.printMode===ft&&(o+=k("}")),o}function G(t){let r="";if(W(t))for(t=m(t),qs(u(t))==="-"&&(r+=k("-")),r+=Nf(u(t)),t=m(t);M(t);)qs(u(t))==="+"?h.printMode===Fe&&!h.test_flag?r+=k(" + "):r+=k("+"):h.printMode===Fe&&!h.test_flag?r+=k(" - "):r+=k("-"),r+=Nf(u(t)),t=m(t);else qs(t)==="-"&&(r+=k("-")),r+=Nf(t);return r}function qs(t){let r="";return Y(t)&&C(l(t))&&cr(l(t),f.zero)||C(t)&&cr(t,f.zero)?r+="-":r+="+",r}function Nf(t){let r="";if(Y(t)&&p2(t))return r+=Lh(t),r;if(Y(t)){let e,o;t=m(t),Nt(u(t))&&(t=m(t));let n=!1;C(u(t))&&(n=!0);let i=!1;for(h.printMode===ft&&M(m(t))&&qm(u(t))&&(i=!0,e=u(t).q.b.toString()),i?(o=r,r=""):r+=oo(u(t)),t=m(t);M(t);)h.printMode===ft&&n&&jr(t)===s(ut)&&C(u(m(u(t))))&&(or(u(m(m(u(t)))))||(r+=" \\cdot ")),r+=If(),r+=oo(u(t),!1,!0),n=!1,C(u(t))&&(n=!0),t=m(t);i&&(r=o+"\\frac{"+r+"}{"+e+"}")}else r+=oo(t);return r}function Bp(t){let r="";return r+="(",r+=G(t),r+=")",r}function $h(t){let r="";return t=l(t),or(t)||W(t)||Y(t)||tt(t)||le(t)?r+=Bp(t):r+=G(t),r+="!",r}function Ch(t){let r="";return r+=k("\\left |"),r+=G(l(t)),r+=k(" \\right |"),r}function Ph(t){let r="";return r+=k("\\binom{"),r+=G(l(t)),r+=k("}{"),r+=G(A(t)),r+=k("} "),r}function kh(t){let r="";return r+=G(l(t)),r+=k(" \\cdot "),r+=G(A(t)),r}function Dh(t){let r="dot(";return r+=G(l(t)),r+=", ",r+=G(A(t)),r+=")",r}function Bh(t){let r="Math.sin(";return r+=G(l(t)),r+=")",r}function Uh(t){let r="Math.cos(";return r+=G(l(t)),r+=")",r}function Gh(t){let r="Math.tan(";return r+=G(l(t)),r+=")",r}function zh(t){let r="Math.asin(";return r+=G(l(t)),r+=")",r}function Fh(t){let r="Math.acos(";return r+=G(l(t)),r+=")",r}function Vh(t){let r="Math.atan(";return r+=G(l(t)),r+=")",r}function Zh(t){let r="";return r+=k("\\sqrt{"),r+=G(l(t)),r+=k("} "),r}function Yh(t){let r="";return r+=k("{"),M(l(t))&&(r+=k("(")),r+=G(l(t)),M(l(t))&&(r+=k(")")),r+=k("}"),r+=k("^T"),r}function jh(t){let r="";return r+=k("transpose("),r+=G(l(t)),r+=k(")"),r}function Hh(t){let r="";return r+=k("identity("),r+=G(l(t)),r+=k(")"),r}function Qh(t){let r="";return r+=k("{"),M(l(t))&&(r+=k("(")),r+=G(l(t)),M(l(t))&&(r+=k(")")),r+=k("}"),r+=k("^{-1}"),r}function Jh(t){let r="";return r+=k("inv("),r+=G(l(t)),r+=k(")"),r}function Wh(t){let r="",e=u(m(t));t=m(t);let o=t,n=0;for(;M(m(m(t)));){n++;let i=m(m(t));r+=k("\\int^{"),r+=G(u(m(i))),r+=k("}_{"),r+=G(u(i)),r+=k("} \\! "),t=m(i)}r+=G(e),r+=k(" \\,"),t=o;for(let i=1;i<=n;i++){let a=m(t);r+=k(" \\mathrm{d} "),r+=G(u(a)),i<n&&(r+=k(" \\, ")),t=m(m(a))}return r}function Xh(t){let r="";return r+=Up(t,0,0)[1],r}function Up(t,r,e){let o="";if(o+=k("["),r<t.tensor.ndim-1)for(let n=0;n<t.tensor.dim[r];n++){let i;[e,i]=Array.from(Up(t,r+1,e)),o+=i,n!==t.tensor.dim[r]-1&&(o+=k(","))}else for(let n=0;n<t.tensor.dim[r];n++)o+=G(t.tensor.elem[e]),n!==t.tensor.dim[r]-1&&(o+=k(",")),e++;return o+=k("]"),[e,o]}function Kh(t){let r="";return t.tensor.ndim<=2&&(r+=Gp(!0,t,0,0)[1]),r}function Gp(t,r,e,o){let n="";if(t&&(n+="\\begin{bmatrix} "),e<r.tensor.ndim-1)for(let i=0;i<r.tensor.dim[e];i++){let a;[o,a]=Array.from(Gp(!1,r,e+1,o)),n+=a,i!==r.tensor.dim[e]-1&&(n+=k(" \\\\ "))}else for(let i=0;i<r.tensor.dim[e];i++)n+=G(r.tensor.elem[o]),i!==r.tensor.dim[e]-1&&(n+=k(" & ")),o++;return t&&(n+=" \\end{bmatrix}"),[o,n]}function t2(t){let r="\\sum_{";return r+=G(A(t)),r+="=",r+=G(zt(t)),r+="}^{",r+=G(xe(t)),r+="}{",r+=G(l(t)),r+="}",r}function r2(t){let r=l(t),e=A(t),o=zt(t),n=xe(t);return"(function(){ var "+e+";  var holderSum = 0;  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    holderSum += "+G(r)+"; }  return holderSum;})()"}function e2(t){let r="\\left\\{ \\begin{array}{ll}";for(t=m(t);M(t);){if(m(t)===s(L)){r+="{",r+=G(u(t)),r+="} & otherwise ",r+=" \\\\\\\\";break}r+="{",r+=G(l(t)),r+="} & if & ",r+=G(u(t)),r+=" \\\\\\\\",t=Er(t)}return r=r.substring(0,r.length-4),r+="\\end{array} \\right."}function o2(t){let r="(function(){";t=m(t);let e=0;for(;M(t);){if(m(t)===s(L)){r+="else {",r+="return ("+G(u(t))+");",r+="}";break}e&&(r+=" else "),r+="if ("+G(u(t))+"){",r+="return ("+G(l(t))+");",r+="}",e++,t=Er(t)}return r+="})()",r}function n2(t){let r="{";return r+=G(l(t)),r+="}",r+=" < ",r+="{",r+=G(A(t)),r+="}"}function i2(t){let r="{";return r+=G(l(t)),r+="}",r+=" \\leq ",r+="{",r+=G(A(t)),r+="}"}function s2(t){let r="{";return r+=G(l(t)),r+="}",r+=" > ",r+="{",r+=G(A(t)),r+="}"}function a2(t){let r="{";return r+=G(l(t)),r+="}",r+=" \\geq ",r+="{",r+=G(A(t)),r+="}"}function l2(t){let r="{";return r+=G(l(t)),r+="}",r+=" = ",r+="{",r+=G(A(t)),r+="}"}function f2(t){let r=l(t),e=A(t),o=zt(t),n=xe(t);return"(function(){ var "+e+";  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    "+G(r)+" } })()"}function u2(t){let r="";for(t=m(t);M(t);)r+=G(u(t)),t=m(t);return r}function c2(t){let r="";return r+=G(l(t)),r+=" = ",r+=G(A(t)),r+="; ",r}function m2(t){let r="\\prod_{";return r+=G(A(t)),r+="=",r+=G(zt(t)),r+="}^{",r+=G(xe(t)),r+="}{",r+=G(l(t)),r+="}",r}function d2(t){let r=l(t),e=A(t),o=zt(t),n=xe(t);return"(function(){ var "+e+";  var holderProduct = 1;  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    holderProduct *= "+G(r)+"; }  return holderProduct;})()"}function Ms(t,r){let e="";if(D&&console.log("power base: "+t+"  exponent: "+r),Le(r))if(wt(t,2)){if(h.codeGen)return e+=k("Math.SQRT2"),e}else{if(h.printMode===ft)return e+=k("\\sqrt{"),e+=G(t),e+=k("}"),e;if(h.codeGen)return e+=k("Math.sqrt("),e+=G(t),e+=k(")"),e}if(wt(xt(s(Ha)),1)&&t===s(rr))return h.codeGen?(e+=k("Math.exp("),e+=kp(r),e+=k(")"),e):(h.printMode===ft?(e+=k("e^{"),e+=G(r),e+=k("}")):(e+=k("exp("),e+=G(r),e+=k(")")),e);if(h.codeGen)return e+=k("Math.pow("),e+=Dp(t),e+=k(", "),e+=kp(r),e+=k(")"),e;if(wt(xt(s(Qa)),0)||t.printname!=="x"){if(t!==s(rr)){if(Nt(r))return h.printMode===ft?e+=k("\\frac{1}{"):h.printMode===Fe&&!h.test_flag?e+=k("1 / "):e+=k("1/"),M(t)&&h.printMode!==ft?(e+=k("("),e+=G(t),e+=k(")")):e+=G(t),h.printMode===ft&&(e+=k("}")),e;if(Ct(r)){h.printMode===ft?e+=k("\\frac{1}{"):h.printMode===Fe&&!h.test_flag?e+=k("1 / "):e+=k("1/");let o=p(r,f.negOne);return M(t)&&h.printMode!==ft?(e+=k("("),e+=Ms(t,o),e+=k(")")):e+=Ms(t,o),h.printMode===ft&&(e+=k("}")),e}}if(or(r)&&h.printMode===ft){e+=k("\\sqrt");let o=Cr(r);return Bo(o)||(e+=k("["),e+=G(o),e+=k("]")),e+=k("{"),r=Zr(r),e+=Ms(t,r),e+=k("}"),e}}return h.printMode===ft&&Et(r)?e+=G(t):(W(t)||It(t)?(e+=k("("),e+=G(t),e+=k(")")):Y(t)||tt(t)?(h.printMode!==ft&&(e+=k("(")),e+=oo(t,!0),h.printMode!==ft&&(e+=k(")"))):C(t)&&(cr(t,f.zero)||or(t))?(e+=k("("),e+=oo(t),e+=k(")")):e+=oo(t),h.printMode===Fe&&!h.test_flag?e+=k(Ih):e+=k("^"),h.printMode===ft?G(r).length>1?(e+=k("{"),e+=G(r),e+=k("}")):e+=G(r):M(r)||or(r)||C(r)&&cr(r,f.zero)?(e+=k("("),e+=G(r),e+=k(")")):e+=oo(r)),e}function x2(t){let r="";if(t=m(t),jr(t)===s(Pr)||jr(t)===s(Ht)||jr(t)===s(ut)||jr(t)===s(Br)?r+=Bp(u(t)):r+=G(u(t)),r+=k("["),t=m(t),M(t))for(r+=G(u(t)),t=m(t);M(t);)r+=k(","),r+=G(u(t)),t=m(t);return r+=k("]"),r}function oo(t,r=!1,e=!1){let o="";if(C(t))return e&&cr(t,f.zero)&&(o+="("),o+=rf(t,e),e&&cr(t,f.zero)&&(o+=")"),o;if(ee(t))return o+=k('"'),o+=k(t.str),o+=k('"'),o;if(H(t))return h.printMode===ft?o+=Kh(t):o+=Xh(t),o;if(Y(t))return r||(qs(t)==="-"||h.printMode!==ft)&&(h.printMode===ft?o+=k(" \\left ("):o+=k("(")),o+=G(t),r||(qs(t)==="-"||h.printMode!==ft)&&(h.printMode===ft?o+=k(" \\right ) "):o+=k(")")),o;if(W(t))return r||(o+=k("(")),o+=G(t),r||(o+=k(")")),o;if(tt(t)){let n=l(t),i=A(t);return o+=Ms(n,i),o}if(u(t)===s(je)){let n=l(t);if(!h.codeGen){let i=A(t);o+=k("function "),D&&console.log(`emittedString from print_factor ${h.stringsEmittedByUserPrintouts}`),o+=Kr(i),o+=k(" -> ")}return o+=G(n),o}if(u(t)===s(on))return o+=G(we(t)),h.printMode===ft?o+=k(" \\rightarrow "):h.printMode===Fe&&!h.test_flag?o+=k(" -> "):o+=k("->"),o+=G(u(m(l(t)))),o;if(u(t)===s(vo)&&pt(l(t)))return o+=x2(t),o;if(le(t))return o+=$h(t),o;if(u(t)===s($e)&&h.printMode===ft)return o+=Ch(t),o;if(u(t)===s(gi)&&h.printMode===ft)return o+=Zh(t),o;if(le(t)){if(h.printMode===ft)return o+=Yh(t),o;if(h.codeGen)return o+=jh(t),o}else if(u(t)===s(Ka)){if(h.codeGen)return o+=Hh(t),o}else if(Ks(t)){if(h.printMode===ft)return o+=Qh(t),o;if(h.codeGen)return o+=Jh(t),o}else{if(u(t)===s(Za)&&h.printMode===ft)return o+=Ph(t),o;if(u(t)===s(Ya)&&h.printMode===ft)return o+=Wh(t),o;if(ke(t)){if(h.printMode===ft)return o+=kh(t),o;if(h.codeGen)return o+=Dh(t),o}else if(u(t)===s(fr)){if(h.codeGen)return o+=Bh(t),o}else if(u(t)===s(ur)){if(h.codeGen)return o+=Uh(t),o}else if(u(t)===s(ve)){if(h.codeGen)return o+=Gh(t),o}else if(u(t)===s(Qe)){if(h.codeGen)return o+=zh(t),o}else if(u(t)===s(Je)){if(h.codeGen)return o+=Fh(t),o}else if(u(t)===s(Fr)){if(h.codeGen)return o+=Vh(t),o}else if(u(t)===s(Wa)){if(h.printMode===ft)return o+=t2(t),o;if(h.codeGen)return o+=r2(t),o}else if(u(t)===s(Ja)){if(h.printMode===ft)return o+=m2(t),o;if(h.codeGen)return o+=d2(t),o}else if(u(t)===s(Ei)){if(h.codeGen)return o+=f2(t),o}else if(u(t)===s(ja)){if(h.codeGen)return o+=u2(t),o}else if(u(t)===s(Xa)){if(h.codeGen)return o+=o2(t),o;if(h.printMode===ft)return o+=e2(t),o}else if(u(t)===s(ui)){if(h.codeGen)return o+="(("+G(l(t))+") < ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=n2(t),o}else if(u(t)===s(fi)){if(h.codeGen)return o+="(("+G(l(t))+") <= ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=i2(t),o}else if(u(t)===s(li)){if(h.codeGen)return o+="(("+G(l(t))+") > ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=s2(t),o}else if(u(t)===s(ai)){if(h.codeGen)return o+="(("+G(l(t))+") >= ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=a2(t),o}else if(u(t)===s(Ue)){if(h.codeGen)return o+="(("+G(l(t))+") === ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=l2(t),o}else if(u(t)===s(Oi)){if(h.codeGen)return o+="Math.floor("+G(l(t))+")",o;if(h.printMode===ft)return o+=" \\lfloor {"+G(l(t))+"} \\rfloor ",o}else if(u(t)===s(Ai)){if(h.codeGen)return o+="Math.ceiling("+G(l(t))+")",o;if(h.printMode===ft)return o+=" \\lceil {"+G(l(t))+"} \\rceil ",o}else if(u(t)===s(Ni)){if(h.codeGen)return o+="Math.round("+G(l(t))+")",o}else if(u(t)===s(Ee))return h.codeGen?(o+=c2(t),o):(o+=G(l(t)),o+=k("="),o+=G(A(t)),o)}if(M(t)){if(o+=oo(u(t)),t=m(t),r||(o+=k("(")),M(t))for(o+=G(u(t)),t=m(t);M(t);)o+=k(","),o+=G(u(t)),t=m(t);return r||(o+=k(")")),o}return t===s(Qr)?o+="d":t===s(rr)?h.codeGen?o+=k("Math.E"):o+=k("e"):t===s(vt)?h.printMode===ft?o+=k("\\pi"):o+=k("pi"):o+=k(dn(t)),o}function Kr(t){let r="";switch(t.k){case ln:for(r+="(",r+=Kr(u(t)),t===m(t)&&(console.log("oh no recursive!"),er),t=m(t);M(t);)r+=" ",r+=Kr(u(t)),t=m(t),t===m(t)&&t!==s(L)&&(console.log("oh no recursive!"),er);t!==s(L)&&(r+=" . ",r+=Kr(t)),r+=")";break;case fn:r+=t.str;break;case Zt:case Ut:r+=rf(t,!0);break;case zr:r+=dn(t);break;default:r+="<tensor>"}return r}function If(){let t="";return h.printMode===ft||(h.printMode===Fe&&!h.test_flag&&!h.codeGen?t+=k(" "):t+=k("*")),t}function ul(t){return tt(t)&&l(t)!==s(rr)&&Ct(A(t))}function p2(t){for(t=m(t);M(t);){let r=u(t);if(ul(r))return!0;t=m(t)}return!1}function er(){}var Va="2.0.1";var D=!1,ys=!1,ft="PRINTMODE_LATEX",cl="PRINTMODE_2DASCII",Ss="PRINTMODE_COMPUTER",Fe="PRINTMODE_HUMAN",ml="PRINTMODE_LIST",Rf=class{constructor(){rt(this,"printMode",Ss);rt(this,"recursionLevelNestedRadicalsRemoval",0);rt(this,"errorMessage","");rt(this,"symbolsDependencies",{});rt(this,"symbolsHavingReassignments",[]);rt(this,"symbolsInExpressionsWithoutAssignments",[]);rt(this,"patternHasBeenFound",!1);rt(this,"inited",!1);rt(this,"chainOfUserSymbolsNotFunctionsBeingEvaluated",[]);rt(this,"stringsEmittedByUserPrintouts","");rt(this,"called_from_Algebra_block",!1);rt(this,"expanding",!1);rt(this,"evaluatingAsFloats",!1);rt(this,"evaluatingPolar",!1);rt(this,"esc_flag",!1);rt(this,"trigmode",0);rt(this,"out_count",0);rt(this,"test_flag",!1);rt(this,"codeGen",!1);rt(this,"userSimplificationsInListForm",[]);rt(this,"userSimplificationsInStringForm",[]);rt(this,"fullDoubleOutput",!1)}},h=new Rf,Zu=!0,Rc=!0,Bu=!0,pn=class{toString(){return G(this)}toLatexString(){return fl(this)}},Mr=class extends pn{constructor(e,o){super();rt(this,"cons");rt(this,"k",ln);this.cons={car:e,cdr:o}}*[Symbol.iterator](){let e=this;for(;M(e);)yield u(e),e=m(e)}tail(){return M(this.cons.cdr)?[...this.cons.cdr]:[]}map(e){let o=u(this),n=m(this);return M(n)&&(n=n.map(e)),new Mr(e(o),n)}},Ot=class extends pn{constructor(e,o=ws.default.one){super();rt(this,"a");rt(this,"b");rt(this,"q",this);rt(this,"k",Zt);rt(this,"__ts_sign");rt(this,"__ts_integer");rt(this,"__ts_special");this.a=e,this.b=o}},oe=class extends pn{constructor(e){super();rt(this,"d");rt(this,"k",Ut);rt(this,"__ts_sign");rt(this,"__ts_integer");rt(this,"__ts_special");this.d=e}},ho=class extends pn{constructor(e){super();rt(this,"str");rt(this,"k",fn);this.str=e}},Pi=class extends pn{constructor(){super(...arguments);rt(this,"tensor",this);rt(this,"k",un);rt(this,"ndim",0);rt(this,"dim",[]);rt(this,"elem",[])}get nelem(){return this.elem.length}},ki=class extends pn{constructor(e){super();rt(this,"printname");rt(this,"k",zr);rt(this,"latexPrint");rt(this,"keyword");this.printname=e}},ln=0,Zt=1,Ut=2,fn=3,un=4,zr=5;var $e="abs",Pr="add",tx="adj",rx="and",$a="approxratio",Je="arccos",tn="arccosh",Qe="arcsin",sn="arcsinh",Fr="arctan",an="arctanh",Ki="arg",ex="atomize",Xo="besselj",Sn="bessely",ox="binding",Za="binomial",Ai="ceiling",nx="check",ix="choose",sx="circexp",ax="clear",lx="clearall",fx="clearpatterns",ux="clock",cx="coeff",mx="cofactor",dx="condense",xx="conj",px="contract",ur="cos",go="cosh",gx="decomp",Ya="defint",bx="deg",_x="denominator",Qr="derivative",js="det",hx="dim",oi="dirac",vx="divisors",ja="do",hf="dot",yx="draw",Ex="dsolve",Mi="eigen",Si="eigenval",wi="eigenvec",Ln="erf",bi="erfc",io="eval",ba="exp",Ax="expand",qx="expcos",Mx="expsin",Sx="factor",Br="factorial",wx="factorpoly",Ox="filter",Ta="float",Oi="floor",Ei="for",je="function",gs="Gamma",Tx="gcd",ei="hermite",Qs="hilbert",Nx="imag",vo="component",Po="inner",Eo="integral",ss="inv",Xs="invg",Ea="isinteger",Ix="isprime",Pa="laguerre",Rx="lcm",Lx="leading",Da="legendre",Jo="log",$x="lookup",Ba="mod",Ht="multiply",sa="not",Cx="nroots",Px="number",kx="numerator",Wo="operator",Dx="or",Bx="outer",on="pattern",Ux="patternsinfo",Gx="polar",ut="power",zx="prime",Ha="printLeaveEAlone",Qa="printLeaveXAlone",Fx="print",Vx="print2dascii",Zx="printcomputer",Yx="printlatex",jx="printlist",Hx="printhuman",Ja="product",aa="quote",Qx="quotient",Jx="rank",Wx="rationalize",Xx="real",Ni="round",Bs="rect",Kx="roots",Ee="equals",Rn="sgn",tp="silentpattern",rp="simplify",fr="sin",qo="sinh",ep="shape",gi="sqrt",op="stop",np="subst",Wa="sum",ip="symbolsinfo",ve="tan",Mo="tanh",za="taylor",Xa="test",Ue="testeq",ai="testge",li="testgt",fi="testle",ui="testlt",Ke="transpose",Ka="unit",sp="zero",L="nil",hi="last",ap="lastprint",tl="last2dasciiprint",rl="lastfullprint",el="lastlatexprint",ol="lastlistprint",nl="lastplainprint",il="autoexpand",sl="bake",fo="assumeRealVariables",lp="trace",Ia="forceFixedPrintout",Ra="maxFixedPrintoutDigits",vf="~",fp="$DRAWX",ue="$METAA",ce="$METAB",re="$METAX",Pt="$SECRETX",up="version",vt="pi",cp="a",mp="b",dp="c",_i="d",Ii="i",Ri="j",xp="n",pp="r",Zo="s",Yo="t",Xr="x",ao="y",lo="z",Ce="I",ma="a_",da="b_",xa="x_",gp="$C1",bp="$C2",_p="$C3",hp="$C4",vp="$C5",yp="$C6",rr=vf,Hn=1e4,Fl=5,Vl=10,ye=24,la=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],Rl=!0,jn=function(){let t=[2],r=3;for(;t.length<Hn;){let e=0,o=Math.sqrt(r);for(;e<t.length&&t[e]<=o;){if(r%t[e]===0){e=-1;break}e++}e!==-1&&t.push(r),r+=2}return t[Hn]=0,t}(),g2=!1;var fa=7488,yo=183;function M(t){return t.k===ln}function lt(t){return t.k===Zt}function X(t){return t.k===Ut}function C(t){return lt(t)||X(t)}function ee(t){return t.k===fn}function H(t){return t.k===un}function Pe(t){if(C(t)||t===s(Ce))return!0;if(!H(t))return!1;let r=t.tensor.nelem,e=t.tensor.elem;for(let o=0;o<r;o++)if(!Pe(e[o]))return!1;return!0}function pt(t){return t.k===zr}function u(t){return M(t)?t.cons.car:s(L)}function m(t){return M(t)?t.cons.cdr:s(L)}function jr(t){return u(u(t))}function l(t){return u(m(t))}function is(t){return m(u(t))}function Er(t){return m(m(t))}function we(t){return u(u(m(t)))}function A(t){return u(m(m(t)))}function zp(t){return u(m(u(t)))}function Vn(t){return m(u(m(t)))}function Fp(t){return m(m(u(t)))}function jo(t){return m(m(m(t)))}function Vp(t){return u(u(m(m(t))))}function di(t){return u(m(u(m(t))))}function Zp(t){return u(m(m(u(t))))}function Yp(t){return m(u(m(m(t))))}function zt(t){return u(m(m(m(t))))}function jp(t){return m(m(m(m(t))))}function xe(t){return u(m(m(m(m(t)))))}function Hp(t){return u(m(u(m(m(t)))))}function Qp(t){return m(m(u(m(m(t)))))}function Jp(t){return u(m(m(u(m(t)))))}function Wp(t){return m(m(m(u(m(m(t))))))}function Xp(t){return u(m(m(u(m(m(t))))))}function W(t){return u(t)===s(Pr)}function Y(t){return u(t)===s(Ht)}function tt(t){return u(t)===s(ut)}function le(t){return u(t)===s(Br)}function ke(t){return u(t)===s(Po)||u(t)===s(hf)}function wc(t){return u(t)===s(Ke)}function Ks(t){return u(t)===s(ss)}function ta(t){return t===s(Ce)}function Xe(t){return t.isPositive()?1:t.isZero()?0:-1}function fe(t){return t.isZero()}function Wt(t,r){return t==null,t.equals(r)}function Pn(){h.esc_flag=!1,g2=!1,h.evaluatingAsFloats=!1,h.evaluatingPolar=!1}var Fo=class{static One(){return h.evaluatingAsFloats?Fo.oneAsDouble:Fo.one}static NegOne(){return h.evaluatingAsFloats?Fo.negOneAsDouble:Fo.negOne}static Zero(){return h.evaluatingAsFloats?Fo.zeroAsDouble:Fo.zero}static Pi(){return h.evaluatingAsFloats?Fo.piAsDouble:s(vt)}},f=Fo;rt(f,"one",new Ot((0,ws.default)(1))),rt(f,"oneAsDouble",new oe(1)),rt(f,"negOne",new Ot((0,ws.default)(-1))),rt(f,"negOneAsDouble",new oe(-1)),rt(f,"zero",new Ot((0,ws.default)(0))),rt(f,"zeroAsDouble",new oe(0)),rt(f,"piAsDouble",new oe(Math.PI)),rt(f,"imaginaryunit");function Vr(t,...r){let e=h.expanding;h.expanding=!1;try{return t(...r)}finally{h.expanding=e}}function $r(t,...r){let e=h.expanding;h.expanding=!0;try{return t(...r)}finally{h.expanding=e}}function jf(t,...r){let e=h.evaluatingPolar;h.evaluatingPolar=!0;try{return t(...r)}finally{h.evaluatingPolar=e}}function ua(t,...r){let e=h.evaluatingAsFloats;h.evaluatingAsFloats=!0;try{return t(...r)}finally{h.evaluatingAsFloats=e}}h.inited||(h.inited=!0,Cn());function Kp(t){if(typeof t=="string"){let[,r]=_o(t);return r}else return typeof t=="number"?t%1===0?y(t):K(t):typeof t.k=="number"?t:(console.warn("unknown argument type",t),s(L))}function tg(t){let r;try{r=Kp(t),Dn()}catch(e){throw Pn(),e}return r}function Lf(t,...r){let e,o=xt(Be(t));Dn();let n=q(o,...r.map(Kp));try{e=Of(n),Dn()}catch(i){throw Pn(),i}return e}var b2={version:Va,isadd:W,ismultiply:Y,ispower:tt,isfactorial:le,car:u,cdr:m,caar:jr,cadr:l,cdar:is,cddr:Er,caadr:we,caddr:A,cadar:zp,cdadr:Vn,cddar:Fp,cdddr:jo,caaddr:Vp,cadadr:di,caddar:Zp,cdaddr:Yp,cadddr:zt,cddddr:jp,caddddr:xe,cadaddr:Hp,cddaddr:Qp,caddadr:Jp,cdddaddr:Wp,caddaddr:Xp,symbol:s,iscons:M,isrational:lt,isdouble:X,isNumericAtom:C,isstr:ee,istensor:H,issymbol:pt,iskeyword:ya,CONS:ln,Cons:Mr,NUM:Zt,Num:Ot,DOUBLE:Ut,Double:oe,STR:fn,Str:ho,TENSOR:un,Tensor:Pi,SYM:zr,Sym:ki,approxRadicals:cn,approxRationalsOfLogs:sf,approxAll:At,testApprox:Cm,make_hashed_itab:Cc,isZeroAtomOrTensor:V,isnegativenumber:It,isplusone:Et,isminusone:Nt,isinteger:qt,isnonnegativeinteger:Sa,isposint:Tn,isnegativeterm:Ct,isimaginarynumber:Ma,iscomplexnumber:Qo,iseveninteger:Mn,isnegative:se,issymbolic:Kl,isintegerfactor:Am,isoneover:Mm,isfraction:or,isoneoversqrttwo:$n,isminusoneoversqrttwo:vi,isfloating:An,isimaginaryunit:Se,isquarterturn:es,isnpi:Qn,equal:ot,length:_r,scan:_o,Find:it,get_binding:xt,set_binding:Jt,usr_symbol:Be,collectUserSymbols:Es,init:Cn,exec:Lf,parse:tg,run:yf},_2=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"],rg=b2;Array.from(_2).map(t=>rg[t]=Lf.bind(void 0,t));var b5=rg;})();
